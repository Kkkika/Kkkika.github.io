<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>【数分笔记】Udacity AB Testing</title>
      <link href="/2026/12/13/%E3%80%90%E6%95%B0%E5%88%86%E7%AC%94%E8%AE%B0%E3%80%91Udacity%20AB%20Testing/"/>
      <url>/2026/12/13/%E3%80%90%E6%95%B0%E5%88%86%E7%AC%94%E8%AE%B0%E3%80%91Udacity%20AB%20Testing/</url>
      
        <content type="html"><![CDATA[<p><a href="https://www.udacity.com/course/ab-testing-business-analysts--ud979">https://www.udacity.com/course/ab-testing-business-analysts--ud979</a></p><h1>🎯课程基础信息</h1><ol><li><p><strong>受众定位</strong>：面向拥有线上产品（网站 / 移动应用）的企业，聚焦 A/B 测试的<strong>设计 + 分析全流程</strong>，不涉及工程代码实现。</p></li><li><p><strong>核心模块</strong>：三大核心内容 —— 实验设计、指标选择、结果分析，形成 “变 - 指 - 设 - 采 - 析 - 决” 的完整闭环。</p></li><li><p>讲师背景</p><ul><li>Diane Tang：计算机博士，Google 12 年 + 经验，负责实验平台架构、指标设计、数据决策。</li><li>Carrie Grimes Bostock：统计学博士，Google 12 年 + 经验，主导假设检验、置信区间、功效分析等统计环节。</li><li>Caroline Buckey：优达学城开发人员，前硅谷软件工程师，负责案例拆解与实践落地。</li></ul></li><li><p><strong>课程结构</strong>：共 5 课，从宏观到微观层层深入</p><table><thead><tr><th style="text-align:center">课程</th><th style="text-align:center">核心内容</th></tr></thead><tbody><tr><td style="text-align:center">第一课</td><td style="text-align:center">A/B 测试定义、适用边界、完整闭环示例</td></tr><tr><td style="text-align:center">第二课</td><td style="text-align:center">实验伦理（用户隐私、知情同意、最小风险）</td></tr><tr><td style="text-align:center">第三课</td><td style="text-align:center">指标体系搭建（OMEC 框架、代理指标选择）</td></tr><tr><td style="text-align:center">第四课</td><td style="text-align:center">实验设计（分流单元、随机化、分层实验）</td></tr><tr><td style="text-align:center">第五课</td><td style="text-align:center">结果分析（置信区间、统计 / 业务显著、决策矩阵）</td></tr></tbody></table></li><li><p><strong>先修要求</strong>：无需 A/B 测试或编程经验，具备基础统计学知识（正态分布、均值、标准差）即可。</p></li></ol><h1>🎯核心认知</h1><p><strong>官方定义</strong></p><p>A/B 测试是<strong>在线场景下的假设检验方法</strong>，通过设置对照组（原有产品 / 功能）和实验组（新版产品 / 功能），随机分流用户，量化两组指标差异，科学判断新版本是否更优。</p><p><strong>本质</strong></p><ul><li>本质是<strong>局部优化工具</strong>：用 “爬山比喻”，A/B 测试能帮你爬上当前山的顶峰（局部最优），但无法帮你判断是否爬错了山（全局战略选择）。</li><li>核心原则：<strong>单一变量</strong>，确保实验组与对照组仅存在一个差异点，否则无法归因。</li></ul><p><strong>核心价值</strong></p><blockquote><p>迭代优化</p></blockquote><ul><li>用<strong>数据决策</strong>替代猜想，避免主观臆测。</li><li>实现产品<strong>迭代式优化</strong>，小步快跑、快速验证。</li></ul><h1>🎯A/B 测试适用边界</h1><blockquote><p>（核心：爬山比喻）</p></blockquote><ol><li>能做的事：局部最优解的探索（<strong>可量化、有明确基准</strong>）<ul><li><strong>UI / 功能迭代</strong>：按钮颜色、文案、页面布局、新功能上线（如 Google 测试 41 种蓝色阴影）</li><li><strong>算法优化</strong>：推荐排序、搜索结果排序（如 Amazon 个性化推荐、LinkedIn Feed 排序）</li><li><strong>性能优化</strong>：页面加载速度（如 Amazon 证实 100ms 延迟导致收入下降 1%）</li><li><strong>核心特征</strong>：用户可感知、指标可量化、实验周期可控</li></ul></li><li>不能做的事：全局战略选择（<strong>无基准、难量化、长周期</strong>）<ul><li><strong>0-1 创新 / 战略选择</strong>：全新产品形态、赛道切换（无现有版本做对照）</li><li><strong>长周期目标</strong>：低频高客单业务（如公寓租赁、汽车销售）的复购率、口碑推荐（实验周期远超商业耐心）</li><li><strong>情感 / 品牌类变更</strong>：品牌 Logo 更换（存在<strong>改变厌恶症</strong>和<strong>新奇效应</strong>，短期数据失真）</li><li><strong>缺失品类检测</strong>：判断网站是否缺少用户需要的商品（实验只能观测已上架商品，无法检测 “未存在” 的品类）</li><li><strong>无法随机分流的场景</strong>：Freemium 转 Premium 的付费升级（用户需主动选择，无法强制随机分组）</li></ul></li></ol><h2 id="经典案例">经典案例</h2><ul><li>Google：测试 41 种蓝色阴影的按钮点击率，验证微观优化的有效性。</li><li>Amazon：个性化推荐算法测试，显著提升用户购买率；页面延迟测试，量化性能对收入的影响。</li><li>LinkedIn：测试 Feed 流 “新文章 / 新增联系人” 优先级，平衡内容消费与关系链增长。</li></ul><h2 id="替代方法">替代方法</h2><blockquote><p>（A/B 测试不适用时）</p></blockquote><table><thead><tr><th style="text-align:center">方法</th><th style="text-align:center">作用</th><th style="text-align:center">特点</th></tr></thead><tbody><tr><td style="text-align:center">日志分析</td><td style="text-align:center">回溯用户行为，生成实验假设</td><td style="text-align:center">被动采集、低成本、大数据量</td></tr><tr><td style="text-align:center">问卷 / 焦点小组</td><td style="text-align:center">挖掘用户动机、需求</td><td style="text-align:center">定性数据、补充定量结果</td></tr><tr><td style="text-align:center">UX 研究 / 人为评价</td><td style="text-align:center">评估新体验的用户感受</td><td style="text-align:center">适合创新型、情感类变更</td></tr></tbody></table><p>补充：</p><ul><li>准实验方法：断点回归、双重差分（DID），适用于无法随机分流的场景。</li></ul><h1>🎯指标选择</h1><blockquote><p>选对指标是实验成功的前提</p></blockquote><ol><li><p>指标分类</p><ul><li>终极指标（Goal Metric）：业务核心目标，如课程完课率、商品购买率，但<strong>周期长、反馈慢</strong>，不适合直接作为实验指标。</li><li>代理指标（Proxy Metric）：与终极指标<strong>强相关</strong>的<strong>短期可观测指标</strong>，如 “点击概率（CTP）”，是实验的核心观测对象。</li></ul></li><li><p><strong>核心指标：点击概率（CTP）vs 点击率（CTR）</strong></p></li></ol><table><thead><tr><th style="text-align:center">指标</th><th style="text-align:center">计算公式</th><th style="text-align:center">适用场景</th></tr></thead><tbody><tr><td style="text-align:center">点击率（CTR）</td><td style="text-align:center">总点击数 / 总页面访问数</td><td style="text-align:center">衡量 UI 可用性（如按钮是否易点击）</td></tr><tr><td style="text-align:center">点击概率（CTP）</td><td style="text-align:center">至少点击 1 次的独立访客数 / 总独立访客数</td><td style="text-align:center">衡量用户覆盖度（如<strong>多少人进入漏斗第二层</strong>）</td></tr></tbody></table><ul><li>关键区别：CTR 包含重复点击噪音，CTP 为<strong>二项分布</strong>数据（点击 = 成功；未点击 = 失败），更适合统计推断。</li></ul><h1>🎯统计基础</h1><h2 id="二项分布">二项分布</h2><blockquote><p>（Binomial Distribution）</p></blockquote><p>二项分布适用条件</p><ul><li>二元结果：只有成功 / 失败两种可能（如点击 / 未点击）。</li><li>事件独立：一次实验结果不影响其他实验（如不同用户的点击行为独立）。</li><li>同概率性：实验期间成功概率恒定（排除时间、渠道等干扰因素）。</li><li>常见误区：不满足独立性（如同用户连续搜索、购物车多商品结账），事件不独立，需提升分析粒度（用户级 / 订单级）。</li></ul><p><strong>参数</strong>：</p><ul><li>均值 = p（成功概率）</li><li>标准偏差 = <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msqrt><mfrac><mrow><mi>p</mi><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>p</mi><mo stretchy="false">)</mo></mrow><mi>n</mi></mfrac></msqrt></mrow><annotation encoding="application/x-tex">\sqrt{\frac{p (1-p )}{n} }</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.84em;vertical-align:-0.5225em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3175em;"><span class="svg-align" style="top:-3.8em;"><span class="pstrut" style="height:3.8em;"></span><span class="mord" style="padding-left:1em;"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mbin mtight">−</span><span class="mord mathnormal mtight">p</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-3.2775em;"><span class="pstrut" style="height:3.8em;"></span><span class="hide-tail" style="min-width:1.02em;height:1.88em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.88em" viewBox="0 0 400000 1944" preserveAspectRatio="xMinYMin slice"><path d="M983 90l0 -0c4,-6.7,10,-10,18,-10 H400000v40H1013.1s-83.4,268,-264.1,840c-180.7,572,-277,876.3,-289,913c-4.7,4.7,-12.7,7,-24,7s-12,0,-12,0c-1.3,-3.3,-3.7,-11.7,-7,-25c-35.3,-125.3,-106.7,-373.3,-214,-744c-10,12,-21,25,-33,39s-32,39,-32,39c-6,-5.3,-15,-14,-27,-26s25,-30,25,-30c26.7,-32.7,52,-63,76,-91s52,-60,52,-60s208,722,208,722c56,-175.3,126.3,-397.3,211,-666c84.7,-268.7,153.8,-488.2,207.5,-658.5c53.7,-170.3,84.5,-266.8,92.5,-289.5zM1001 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5225em;"><span></span></span></span></span></span></span></span></span></li></ul><h2 id="中心极限定理">中心极限定理</h2><blockquote><p>（CLT）</p></blockquote><ul><li>当样本量 n 足够大（通常 n≥30），二项分布可近似为正态分布，简化置信区间计算。</li></ul><h2 id="标准误差">标准误差</h2><blockquote><p>（SE）</p></blockquote><p>量化抽样波动，即 “不同样本之间的差异程度”</p><ul><li><strong>概率估计</strong>：$\hat{p} =\frac{X}{N} $</li><li>比例形式公式：$SE=\sqrt{\frac{\hat{p} (1-\hat{p} )}{n} } $</li><li>核心规律：样本量越大，SE 越小；<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>p</mi><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{p}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">p</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span></span></span></span>越接近 0 或 1，SE 越小。</li></ul><h2 id="置信区间">置信区间</h2><blockquote><p>（CI）</p></blockquote><p>描述真实参数的可能范围</p><ul><li>定义：95% 置信区间表示<strong>重复抽样 100 次，有 95 次的区间会包含真实值</strong>（不是 “真实值落在区间的概率为 95%”）</li><li>计算公式：95%<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mi>I</mi><mo>=</mo><mover accent="true"><mi>p</mi><mo>^</mo></mover><mo>±</mo><mi>z</mi><mo>×</mo><mi>S</mi><mi>E</mi></mrow><annotation encoding="application/x-tex">CI=\hat{p}±z×SE</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">p</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">±</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">SE</span></span></span></span></li></ul><h3 id="公式分解">公式分解</h3><blockquote><p>**核心公式：**百分之多少<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mi>I</mi><mo>=</mo><mover accent="true"><mi>p</mi><mo>^</mo></mover><mo>±</mo><mi>z</mi><mo>×</mo><mi>S</mi><mi>E</mi></mrow><annotation encoding="application/x-tex">CI=\hat{p}±z×SE</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">p</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">±</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">SE</span></span></span></span></p></blockquote><ul><li><strong>概率估计</strong>：$\hat{p} =\frac{X}{N} $​</li><li><strong>标准误差</strong>：$SE=\sqrt{\frac{\hat{p} (1-\hat{p} )}{n} } $</li><li><strong>误差幅度</strong>：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>=</mo><mi>z</mi><mo>×</mo><mi>S</mi><mi>E</mi></mrow><annotation encoding="application/x-tex">m=z×SE</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">SE</span></span></span></span></li><li><strong>置信区间</strong>： <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mover accent="true"><mi>p</mi><mo>^</mo></mover><mo>−</mo><mi>m</mi><mo separator="true">,</mo><mover accent="true"><mi>p</mi><mo>^</mo></mover><mo>+</mo><mi>m</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[\hat{p} −m,\hat{p} +m]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">p</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">p</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">m</span><span class="mclose">]</span></span></span></span>​</li><li><strong>常用z值</strong>：<ul><li>95%置信度：z = 1.96</li><li>99%置信度：z = 2.58</li></ul></li><li><strong>正态近似条件</strong>：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>×</mo><mover accent="true"><mi>p</mi><mo>^</mo></mover><mo>&gt;</mo><mn>5</mn><mtext>且</mtext><mi>N</mi><mo>×</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mover accent="true"><mi>p</mi><mo>^</mo></mover><mo stretchy="false">)</mo><mo>&gt;</mo><mn>5</mn></mrow><annotation encoding="application/x-tex">N×\hat{p} &gt;5 且 N×(1−\hat{p} )&gt;5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">p</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord">5</span><span class="mord cjk_fallback">且</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">p</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">5</span></span></span></span></li></ul><h3 id="案例计算"><strong>案例计算</strong></h3><ul><li>已知：n=1000，点击访客数 = 100</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>p</mi><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{p}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">p</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span></span></span></span>为样本点击概率，n 为样本量</li><li>→ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>p</mi><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{p}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">p</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span></span></span></span>=0.1</li><li>计算 SE：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msqrt><mfrac><mrow><mn>0.1</mn><mo>×</mo><mn>0.9</mn></mrow><mn>1000</mn></mfrac></msqrt></mrow><annotation encoding="application/x-tex">\sqrt{\frac{0.1×0.9}{1000} }</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.84em;vertical-align:-0.6049em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.2351em;"><span class="svg-align" style="top:-3.8em;"><span class="pstrut" style="height:3.8em;"></span><span class="mord" style="padding-left:1em;"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1000</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0.1</span><span class="mbin mtight">×</span><span class="mord mtight">0.9</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-3.1951em;"><span class="pstrut" style="height:3.8em;"></span><span class="hide-tail" style="min-width:1.02em;height:1.88em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.88em" viewBox="0 0 400000 1944" preserveAspectRatio="xMinYMin slice"><path d="M983 90l0 -0c4,-6.7,10,-10,18,-10 H400000v40H1013.1s-83.4,268,-264.1,840c-180.7,572,-277,876.3,-289,913c-4.7,4.7,-12.7,7,-24,7s-12,0,-12,0c-1.3,-3.3,-3.7,-11.7,-7,-25c-35.3,-125.3,-106.7,-373.3,-214,-744c-10,12,-21,25,-33,39s-32,39,-32,39c-6,-5.3,-15,-14,-27,-26s25,-30,25,-30c26.7,-32.7,52,-63,76,-91s52,-60,52,-60s208,722,208,722c56,-175.3,126.3,-397.3,211,-666c84.7,-268.7,153.8,-488.2,207.5,-658.5c53.7,-170.3,84.5,-266.8,92.5,-289.5zM1001 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.6049em;"><span></span></span></span></span></span></span></span></span>≈0.0095</li><li>计算 95% CI：0.1±1.96×0.0095≈[0.081,0.119]</li><li>结论：真实点击概率有 95% 可能落在 8.1%~11.9% 之间</li><li>含义：重复抽样时，95% 的区间会包含真实点击概率；区间外的数值属于 “令人吃惊的结果”。</li></ul><h3 id="常用临界-Z-值">常用临界 Z 值</h3><table><thead><tr><th>置信水平</th><th>单尾 α</th><th>双尾 α</th><th>单尾 Z 临界值</th><th>双尾 Z 临界值</th></tr></thead><tbody><tr><td>90%</td><td>0.10</td><td>0.05</td><td>1.28</td><td>1.645</td></tr><tr><td>95%</td><td>0.05</td><td>0.025</td><td>1.645</td><td>1.96</td></tr><tr><td>99%</td><td>0.01</td><td>0.005</td><td>2.33</td><td>2.576</td></tr></tbody></table><hr><h2 id="假设检验">假设检验</h2><blockquote><p>统计显著性判定，判断差异是否显著</p></blockquote><p><strong>核心流程</strong></p><ol><li>建立假设<ul><li>零假设（H₀）：对照组与实验组指标无差异，即<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mrow><mi>e</mi><mi>x</mi><mi>p</mi></mrow></msub><mo>=</mo><msub><mi>P</mi><mrow><mi>c</mi><mi>o</mi><mi>n</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">P_{exp}=P_{cont}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">x</span><span class="mord mathnormal mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">co</span><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 。</li><li>备择假设（Hₐ）：两组指标有差异（双尾：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mrow><mi>e</mi><mi>x</mi><mi>p</mi></mrow></msub><mo mathvariant="normal">≠</mo><msub><mi>P</mi><mrow><mi>c</mi><mi>o</mi><mi>n</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">P_{exp}\ne P_{cont}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">x</span><span class="mord mathnormal mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="inner"><span class="mord"><span class="mrel"></span></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">co</span><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ；单尾：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mrow><mi>e</mi><mi>x</mi><mi>p</mi></mrow></msub><mtext>＞</mtext><msub><mi>P</mi><mrow><mi>c</mi><mi>o</mi><mi>n</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">P_{exp}＞P_{cont}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">x</span><span class="mord mathnormal mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback">＞</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">co</span><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>或<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mrow><mi>e</mi><mi>x</mi><mi>p</mi></mrow></msub><mtext>＜</mtext><msub><mi>P</mi><mrow><mi>c</mi><mi>o</mi><mi>n</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">P_{exp}＜P_{cont}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">x</span><span class="mord mathnormal mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback">＜</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">co</span><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>）</li><li>下面的例子是双尾</li></ul></li><li><strong>计算 p-value</strong>：在 H₀成立的前提下，出现当前样本差异或更极端差异的概率。</li><li>？？？计算两组指标差异的置信区间，若区间<strong>不包含 0</strong>，则拒绝零假设，认为差异具有<strong>统计显著性</strong>。</li><li><strong>判定结果</strong>：若 p-value &lt; 0.05（显著性水平 α），则<strong>拒绝 H₀</strong>，认为差异具有统计显著性。</li></ol><p><strong>等价判定</strong>：95% 置信区间不包含 0 ↔ p-value &lt; 0.05</p><h2 id="统计显著性-vs-实际显著性">统计显著性 vs 实际显著性</h2><ul><li><strong>确定显著性水平</strong>：<ul><li><strong>统计显著性</strong>：通常设定 α=0.05，即95%置信度。</li><li><strong>实际显著性</strong>：从业务角度判断的最小有意义变化。本例设定为点击概率提升 <strong>2%</strong> (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mrow><mi>m</mi><mi>i</mi><mi>n</mi></mrow></msub></mrow><annotation encoding="application/x-tex">d_{min}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">min</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>=0.02)。</li></ul></li></ul><table><thead><tr><th style="text-align:center">维度</th><th style="text-align:center">统计显著性</th><th style="text-align:center">实际显著性</th></tr></thead><tbody><tr><td style="text-align:center">定义</td><td style="text-align:center">差异由随机波动导致的概率 &lt; 5%</td><td style="text-align:center">差异达到业务决策阈值（如点击概率提升 2%）</td></tr><tr><td style="text-align:center">判定方法</td><td style="text-align:center">置信区间是否包含 0</td><td style="text-align:center">差异是否≥预设的最小可探测效果（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mrow><mi>m</mi><mi>i</mi><mi>n</mi></mrow></msub></mrow><annotation encoding="application/x-tex">d_{min}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">min</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>）</td></tr><tr><td style="text-align:center">决策价值</td><td style="text-align:center">排除偶然性</td><td style="text-align:center">决定是否值得发布新版本</td></tr></tbody></table><ul><li><strong>核心结论</strong>：只有同时满足<strong>统计显著 + 实际显著</strong>，才建议发布新版本。</li></ul><h1>🎯最小样本量</h1><blockquote><p>平衡功效与成本</p></blockquote><h2 id="核心概念">核心概念</h2><ul><li><strong>α（显著性水平）</strong>：错误拒绝零假设的概率（通常0.05）</li><li><strong>β</strong>：零假设为假时未能拒绝的概率</li><li><strong>统计功效/敏感性（1-β）</strong>：检测到真实差异的能力（通常0.8）</li><li><strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mrow><mi>m</mi><mi>i</mi><mi>n</mi></mrow></msub></mrow><annotation encoding="application/x-tex">d_{min}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">min</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></strong>：最小可探测效果（实际显著性边界）</li></ul><h2 id="样本量影响因素">样本量影响因素</h2><table><thead><tr><th style="text-align:center">因素</th><th>变化</th><th style="text-align:center">对样本量的影响</th></tr></thead><tbody><tr><td style="text-align:center">基准转化率</td><td>点击概率接近0.5</td><td style="text-align:center">越接近 0.5，样本量需求越大</td></tr><tr><td style="text-align:center">最小可探测效果（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mrow><mi>m</mi><mi>i</mi><mi>n</mi></mrow></msub></mrow><annotation encoding="application/x-tex">d_{min}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">min</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>）</td><td>增加实际显著性界限</td><td style="text-align:center">越大，样本量需求越小</td></tr><tr><td style="text-align:center">显著性水平（1-α）</td><td>提高置信度</td><td style="text-align:center">越高（如 99%→95%），样本量需求越大</td></tr><tr><td style="text-align:center">统计功效（1-β）</td><td>提高敏感性</td><td style="text-align:center">越高（如 90%→80%），样本量需求越大</td></tr></tbody></table><h2 id="计算工具">计算工具</h2><ol><li><strong>计算工具</strong>：可通过<a href="https://www.evanmiller.org/ab-testing/sample-size.html">在线计算器</a>、编程语言内置库实现，输入参数包括基准转化率、<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mrow><mi>m</mi><mi>i</mi><mi>n</mi></mrow></msub></mrow><annotation encoding="application/x-tex">d_{min}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">min</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>、α、1-β。</li><li><strong>案例</strong>：页面平均转化率为 10%，想提升​2%，α=0.05，1-β=0.8 → 每组至少需要 3623 个页面浏览量。</li><li>基准转化率（绝对/相对）</li></ol><p>![image-20260113223219988](./…/【数分笔记】Udacity AB Testing/image-20260113223219988.png)</p><ul><li>绝对提升：<strong>直接差值</strong>，单位是<strong>百分点（pp）</strong><ul><li>提升 2 个百分点</li><li>p1= 10% + 2% = 12% = 0.12</li></ul></li><li>相对提升：<strong>比例</strong>，单位是<strong>百分比（%）</strong><ul><li>提升 2%</li><li>p1= p0 × (1+2%) = 10% × 1.02 =10.2%=0.102</li></ul></li></ul><h1>🎯结果决策</h1><p>图示来说明。假设实际显著性边界 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mrow><mi>m</mi><mi>i</mi><mi>n</mi></mrow></msub></mrow><annotation encoding="application/x-tex">d_{min}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">min</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>=2%</p><p><strong>核心思路</strong>：我们需要看<strong>置信区间</strong>落在哪个位置，判断标准有两条线：</p><ul><li><strong>零线（0）</strong>：判断统计显著性</li><li><strong>实际显著性边界（±<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mrow><mi>m</mi><mi>i</mi><mi>n</mi></mrow></msub></mrow><annotation encoding="application/x-tex">d_{min}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">min</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>）</strong>：判断是否有商业价值</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">    负面          无意义区        正面有意义</span><br><span class="line">←─────────┼─────────┼─────────┼─────────→</span><br><span class="line">        -2%        0         +2%</span><br><span class="line">       -dmin               +dmin</span><br></pre></td></tr></table></figure><hr><h2 id="六种情况图解">六种情况图解</h2><blockquote><p><strong>核心问题就两个</strong>：</p><ol><li>置信区间是否跨越0？（决定统计显著性）</li><li>置信区间是否超过 dmin？（决定实际显著性）</li></ol></blockquote><p><strong>情况1：发布 ✅</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">                          [=======]</span><br><span class="line">────┼─────────┼─────────┼─────────→</span><br><span class="line">  -2%        0         +2%</span><br></pre></td></tr></table></figure><p>置信区间完全在 +2% 右边 → <strong>统计显著 + 实际显著</strong> → 发布！</p><p><strong>情况2：不发布（中性结果）</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">           [=====]</span><br><span class="line">────┼─────────┼─────────┼─────────→</span><br><span class="line">  -2%        0         +2%</span><br></pre></td></tr></table></figure><p>置信区间包含0，且整体在 ±2% 之间 → 没有变化 → 不发布</p><p><strong>情况3：不发布（太小不值得）</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">                [====]</span><br><span class="line">────┼─────────┼─────────┼─────────→</span><br><span class="line">  -2%        0         +2%</span><br></pre></td></tr></table></figure><p>置信区间 &gt; 0（统计显著），但 &lt; 2%（无实际意义）→ 变化太小，不值得发布</p><p><strong>情况4：重新测试（功效不足）</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">    [==================]</span><br><span class="line">────┼─────────┼─────────┼─────────→</span><br><span class="line">  -2%        0         +2%</span><br></pre></td></tr></table></figure><p>置信区间太宽，横跨 -2% 到 +2% → 可能增加10%也可能减少10%，无法判断 → 增大样本量重测</p><p><strong>情况5：重新测试（不确定）</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">            [==========]</span><br><span class="line">────┼─────────┼─────────┼─────────→</span><br><span class="line">  -2%        0         +2%</span><br></pre></td></tr></table></figure><p>置信区间跨越0，但部分超过 +2% → 可能有效也可能无效 → 增大样本量重测</p><p><strong>情况6：不发布（负面影响）</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[=======]</span><br><span class="line">────┼─────────┼─────────┼─────────→</span><br><span class="line">  -2%        0         +2%</span><br></pre></td></tr></table></figure><p>置信区间完全在负数区域 → 变更有害 → 绝对不发布</p><table><thead><tr><th>置信区间位置</th><th>含义</th><th>决策</th></tr></thead><tbody><tr><td>完全 &gt; +<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mrow><mi>m</mi><mi>i</mi><mi>n</mi></mrow></msub></mrow><annotation encoding="application/x-tex">d_{min}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">min</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></td><td>确定有正面且有意义的变化</td><td>✅ 发布</td></tr><tr><td>完全 &lt; -<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mrow><mi>m</mi><mi>i</mi><mi>n</mi></mrow></msub></mrow><annotation encoding="application/x-tex">d_{min}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">min</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></td><td>确定有负面且严重的变化</td><td>❌ 不发布</td></tr><tr><td>在0附近，宽度小</td><td>确定没什么变化</td><td>❌ 不发布</td></tr><tr><td>跨越太多区域</td><td>不确定，数据不够</td><td>🔄 重测</td></tr></tbody></table><h1>🎯实验全流程</h1><p><strong>总结：</strong></p><ol><li>明确变更点：确定要测试的产品 / 功能改动（单变量优先）。</li><li>选择指标：确定代理指标与终极指标，设定实际显著性阈值。</li><li>计算样本量：根据基准转化率、<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mrow><mi>m</mi><mi>i</mi><mi>n</mi></mrow></msub></mrow><annotation encoding="application/x-tex">d_{min}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">min</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>、α、1-β 确定实验规模。</li><li>随机分流：选择合适的分流单元（user_id/cookie/device），确保组间均衡。</li><li>运行实验：采集数据，避免中途偷看结果（p-hacking 风险）。</li><li>分析结果：计算置信区间，判断统计 / 实际显著性，做出决策。</li></ol><h1>🎯补充知识</h1><h2 id="历史渊源">历史渊源</h2><p>A/B 测试的方法论源于<strong>农业随机区组试验</strong>（Fisher 20 世纪 20 年代确立），后应用于医学临床试验（随机对照试验 RCT），最终在互联网时代因大数据优势普及，成为 Google、Amazon、Netflix 等大厂的标准配置。</p><h2 id="实验伦理-Checklist">实验伦理 Checklist</h2><ol><li>是否侵犯用户隐私（GDPR/CCPA 合规）？</li><li>是否对用户造成伤害（如功能故障、信息泄露）？</li><li>是否需要提前终止实验（如出现严重负向影响）？</li></ol><h2 id="核心金句">核心金句</h2><ol><li>A/B 测试能帮你爬上当前山峰的顶峰，但无法告诉你该爬哪座山。</li><li>统计显著性回答 “差异是否真实”，实际显著性回答 “差异是否值钱”。</li><li>样本量与最小可探测效果的平方成反比 —— 想探测更小的差异，需要指数级增加样本。</li><li>数据驱动不是数据独裁，当实验结果不确定时，需结合业务战略决策。</li></ol><h2 id="真实工作中">真实工作中</h2><blockquote><p>数据分析师在真实工作中分析AB实验计算流程</p></blockquote><p>**业务：**某电商测试红色“立即购买”按钮（B组）vs原蓝色按钮（A组），目标提升购物车转化率。</p><p><strong>实验数据（各10万用户，7天）</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">A组（蓝色）：成功下单1800，转化率1.80%</span><br><span class="line">B组（红色）：成功下单2184，转化率2.184%  </span><br><span class="line">相对提升：21.3% = (2.184%-1.80%)/1.80%</span><br></pre></td></tr></table></figure><p><strong>数据清洗（第1小时）</strong></p><p>SQL查询：<code>SELECT user_id, group, add_to_cart, purchase FROM ab_test WHERE date&gt;='2026-01-06' AND user_id NOT IN (SELECT user_id FROM fraud_list)</code></p><ul><li>剔除5%机器人流量，样本剩A:95000，B:95200</li><li>检查分桶：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>χ</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">χ²</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0085em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">χ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span>检验p=0.87（流量分配均匀）</li><li>基线校验：A/B点击率无差异(p=0.42&gt;0.05)</li></ul><p><strong>核心统计计算（Excel/Python，第2小时）</strong></p><p><strong>Excel操作</strong>：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">选中A列(0/1转化数据)、B列 → 数据 → 数据分析 → t检验:两样本不等方差</span><br><span class="line">结果：p值=0.00012（双尾），显著性通过</span><br><span class="line">置信区间公式：=CONFIDENCE.T(0.05,STDEV.P(A1:A95000)/SQRT(95000))*2 → ±0.12%</span><br><span class="line">最终：B提升21.3%，95%CI [13.2%, 29.4%]（下限&gt;0，可信）</span><br></pre></td></tr></table></figure><p><strong>Python验证</strong>：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">pythonfrom scipy.stats import ttest_ind</span><br><span class="line">a = df[df.group==&#x27;A&#x27;][&#x27;purchase&#x27;]  # 1800 True，其余False</span><br><span class="line">b = df[df.group==&#x27;B&#x27;][&#x27;purchase&#x27;]</span><br><span class="line">t_stat, p = ttest_ind(a, b, equal_var=False)  # p=0.00012</span><br><span class="line">print(&quot;显著！上线B按钮&quot;)</span><br></pre></td></tr></table></figure><p><strong>守门员指标检查</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">客单价：A $85.2 vs B $84.9，p=0.67（无恶化）</span><br><span class="line">D1留存：p=0.23（稳定）</span><br><span class="line">新客转化：提升25.1%（p=0.002，一致性好）</span><br></pre></td></tr></table></figure><p>多重检验校正：5指标，α=0.05/5=0.01，主指标p=0.00012仍显著。</p><p><strong>最终报告与决策（第3小时）</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">🟢 结论：红色按钮转化率提升21.3% (p&lt;0.001, CI[13%,29%])</span><br><span class="line">🟡 风险：监控D7留存</span><br><span class="line">🟢 决策：1月15日全量上线，预计月增收12万USD</span><br></pre></td></tr></table></figure><p><strong>真实结果</strong>：上线后稳定提升19%，年化ROI 800%。这个案例90%数据岗都这样干，重点是清洗+双检验+业务阈值。</p><h3 id="解释原因">解释原因</h3><blockquote><p>为啥选择卡方检验，方法选择要解释原因</p></blockquote><p>卡方检验在AB实验中常用于二分类计数数据（如“购买/未购买”），因为它直接检验<strong>观测频数表与期望频数的偏离</strong>，比t检验更稳健，不需假设正态分布。</p><p><strong>记忆口诀</strong>：<code>计数用卡方，均值用t检验</code></p><p><strong>90%电商AB实验直接卡方一键解决</strong>，因为指标天然是频数表，无需纠结正态性、方差齐性等t检验前置条件。</p><h3 id="假设检验类型">假设检验类型</h3><blockquote><p>假设检验类型，真实工作中怎么选择</p></blockquote><p>真实工作中AB实验假设检验有<strong>单侧/双侧</strong>、<strong>参数/非参数</strong>等类型，数据分析师按<strong>数据类型+样本量+业务假设</strong>选方法。</p><p><strong>检验类型分类</strong></p><p><strong>1. 方向性：单侧 vs 双侧</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">双侧（90%场景）：H1: μ1 ≠ μ2（红色按钮可能更好也可能更差）</span><br><span class="line">单侧（10%场景）：H1: μ1 &gt; μ2（新支付流程一定比旧快）</span><br></pre></td></tr></table></figure><p><strong>为什么双侧为主</strong>：商业决策需同时看收益+风险，美团/阿里标准做法。</p><p><strong>2. 参数检验 vs 非参数检验</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">参数检验（t/Z/卡方）：假设正态/二项分布，功效最高</span><br><span class="line">非参数（Mann-Whitney U）：分布未知，牺牲功效换鲁棒性</span><br></pre></td></tr></table></figure><p><strong>真实工作选择流程（决策树）</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Step1: 数据类型？</span><br><span class="line">├── 计数比例（点击率/转化率）→ 卡方/Z检验</span><br><span class="line">├── 连续变量（客单价/时长）→ t检验  </span><br><span class="line">└── 排序/等级数据 → Wilcoxon秩和检验</span><br><span class="line"></span><br><span class="line">Step2: 样本量？</span><br><span class="line">├── n&gt;1000 → Z检验（精确）</span><br><span class="line">├── 30&lt;n&lt;1000 → t检验</span><br><span class="line">└── n&lt;30 → 非参数或增加样本</span><br><span class="line"></span><br><span class="line">Step3: 方差？</span><br><span class="line">├── 已知（历史基线）→ Z检验</span><br><span class="line">└── 未知 → t检验（Welch变种处理不等方差）</span><br><span class="line"></span><br><span class="line">Step4: 业务假设？</span><br><span class="line">├── &quot;绝对比旧方案好&quot; → 单侧</span><br><span class="line">└── &quot;有差异就行&quot; → 双侧</span><br></pre></td></tr></table></figure><p><strong>电商场景全覆盖表</strong></p><table><thead><tr><th style="text-align:left">指标类型</th><th style="text-align:left">示例</th><th style="text-align:left">检验方法</th><th style="text-align:left">Excel公式</th><th style="text-align:left">Python函数</th></tr></thead><tbody><tr><td style="text-align:left"><strong>转化率</strong></td><td style="text-align:left">1.8%→2.18%</td><td style="text-align:left">卡方/Z</td><td style="text-align:left">数据透视→卡方</td><td style="text-align:left">chi2_contingency</td></tr><tr><td style="text-align:left"><strong>点击率</strong></td><td style="text-align:left">12.3%→13.1%</td><td style="text-align:left">卡方/Z</td><td style="text-align:left">同上</td><td style="text-align:left">proportions_ztest</td></tr><tr><td style="text-align:left"><strong>客单价</strong></td><td style="text-align:left">¥85→¥88</td><td style="text-align:left">t检验</td><td style="text-align:left">T.TEST(2,2)</td><td style="text-align:left">ttest_ind</td></tr><tr><td style="text-align:left"><strong>停留时长</strong></td><td style="text-align:left">45s→48s</td><td style="text-align:left">t检验</td><td style="text-align:left">同上</td><td style="text-align:left">ttest_ind</td></tr><tr><td style="text-align:left"><strong>NPS评分</strong></td><td style="text-align:left">7.2→7.5</td><td style="text-align:left">Wilcoxon</td><td style="text-align:left">不支持</td><td style="text-align:left">mannwhitneyu</td></tr><tr><td style="text-align:left"><strong>分布形状</strong></td><td style="text-align:left">UV值分布</td><td style="text-align:left">Kolmogorov-Smirnov</td><td style="text-align:left">不支持</td><td style="text-align:left">ks_2samp</td></tr></tbody></table><p><strong>特殊场景选择</strong></p><p><strong>高方差指标</strong>（如订单金额）：用<strong>对数变换</strong>后t检验，或<strong>Bootstrap置信区间</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">textdf[&#x27;log_amount&#x27;] = np.log1p(df[&#x27;amount&#x27;])</span><br><span class="line">ttest_ind(a_log, b_log)</span><br></pre></td></tr></table></figure><p><strong>多臂实验</strong>（A/B/C三组）：<strong>ANOVA</strong>首选，再事后t检验</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">textfrom statsmodels.stats.anova import anova_lm</span><br><span class="line">anova_lm(df, &#x27;value&#x27;, &#x27;group&#x27;)</span><br></pre></td></tr></table></figure><p><strong>时间序列</strong>（D1/D7留存）：<strong>CUPED</strong>降方差，或分层t检验</p><p><strong>工单选择</strong>：<strong>先看指标类型，再看样本量，最后看分布</strong>。90%电商场景卡方/t检验覆盖，复杂场景用Bootstrap最稳（无分布假设）。</p><h1>🎯字幕稿解读</h1><p>“逐句级”精读，把文件里所有时间轴、所有口语化表达、所有隐含细节全部拆成可检索的条目。<br>阅读方式：</p><ul><li>左侧是“原字幕逐句”→ 右侧是“翻译/拆解/补充/易忽略点”。</li><li>如果同一句话里出现 ≥2 个可拆信息，用 ‖ 分隔。</li><li>所有括号内文字是我额外补的“课外知识点”或“考试易考辨析”。</li></ul><hr><h3 id="文件-1-课程简介">文件 1  课程简介</h3><p>1  00:00:01,010 --&gt; 00:00:02,750<br>大家好 欢迎来到 A/B 测试<br>→ 标准开场白，无实质信息，可忽略。</p><p>2  00:00:02,750 --&gt; 00:00:06,730<br>本课中 我们将讨论如何为建有网站或移动应用的企业运行试验或 A/B 测试<br>→ 受众限定：已有线上产品（Web or App）；不面向线下业务。‖ “运行试验”=设计+分析，≠代码实现。</p><p>3  00:00:06,730 --&gt; 00:00:10,280<br>A/B 测试可以通过尝试可能的改变寻找用户更喜欢的方式<br>→ 关键词“可能的改变”=迭代式优化，非从 0 到 1 的创新。</p><p>4  00:00:10,280 --&gt; 00:00:14,910<br>帮助你科学地确定如何优化网站或移动应用<br>→ “科学地”=对照+随机+统计显著，后续会反复出现。</p><p>5  00:00:14,910 --&gt; 00:00:17,860<br>使用 A/B 测试意味着你可以根据数据做出决定<br>→ 对立面：HiPPO（Highest Paid Person’s Opinion）——直接点名“薪酬最高人员的意见”是反面教材。</p><p>6  00:00:17,860 --&gt; 00:00:19,551<br>而不是依赖猜想或臆测<br>→ 再次强调“数据 &gt; 直觉”。</p><p>7  00:00:19,551 --&gt; 00:00:24,380<br>我们将从头到尾地了解这个过程<br>→ 课程输出：完整闭环，不是碎片技巧。</p><p>8  00:00:24,380 --&gt; 00:00:27,160<br>从一开始确定你要测试的变更到得出结论的整个过程<br>→ 流程 6 字诀：变-指-设-采-析-决。</p><p>9  00:00:27,160 --&gt; 00:00:29,840<br>另一方面 我们不会关注如何实施你的 A/B 测试框架<br>→ 边界声明：不教工程代码（如 Airbnb 的 PlanOut、Google 的 Zanzibar）。</p><p>10  00:00:29,840 --&gt; 00:00:32,340<br>本课程会讲授如何设计任务、选择指标并分析结果<br>→ 三大核心模块：设计、指标、分析。</p><p>11  00:00:32,340 --&gt; 00:00:35,060<br>听起来十分不错 但是 在我们开始之前我们何不花点时间介绍一下我们自己？<br>→ 过渡句，提示接下来是讲师背书。</p><p>12  00:00:35,060 --&gt; 00:00:36,990<br>好的 我是 Diane Tang<br>→ Diane 出场。</p><p>13  00:00:36,990 --&gt; 00:00:39,590<br>计算机博士 在 Google 工作了 12 年多<br>→ 博士 title + 12 年 = 可信度；后续她负责“工程落地”视角。</p><p>14  00:00:39,590 --&gt; 00:00:42,090<br>我的工作涉及实验的各个方面<br>→ 暗示她跨域：平台、指标、分析、决策，全部踩过坑。</p><p>15  00:00:42,090 --&gt; 00:00:46,230<br>审查潜在的基础架构、设计指标和 dashboard<br>→ 潜在基础架构=实验平台性能、分流稳定性、数据漏损。</p><p>16  00:00:46,230 --&gt; 00:00:46,880<br>运行分析实验<br>→ 她也会亲手跑 SQL/R/Python，不是纯管理。</p><p>17  00:00:46,880 --&gt; 00:00:50,400<br>以及用以推动数据驱动决策的处理环境<br>→ “处理环境”=Google 内部实时实验看板（Data Studio 前身）。</p><p>18  00:00:50,400 --&gt; 00:00:51,650<br>我叫 Carrie Grimes Bostock 统计学博士<br>→ Carrie 出场，统计防线。</p><p>19  00:00:51,650 --&gt; 00:00:56,640<br>在 Google 工作近12年 涉及各种不同领域<br>→ “不同领域”=搜索、广告、Chrome、Android，暗示方法通用。</p><p>20  00:00:56,640 --&gt; 00:00:59,790<br>在如何得出 A/B 试验的结论方面我将给大家提出统计学方面的意见<br>→ 她负责 p-value、置信区间、多重检验、功效分析。</p><p>21  00:00:59,790 --&gt; 00:01:02,700<br>我是 Caroline Buckey<br>→ Caroline 出场，负责“让你练手”。</p><p>22  00:00:59,790 --&gt; 00:01:06,800<br>优达学城的开发人员 在此之前我是硅谷的软件工程师<br>→ 桥梁角色：把 Google 内部方法拆成外部可复现的练习。</p><p>23  00:01:06,800 --&gt; 00:01:09,380<br>我将通过各种示例研究所有细节并确保你能够将自学的内容运用于实践<br>→ 承诺：每个概念配案例 + 可运行作业（虽然课程里不会给你代码仓库，但会给伪代码/公式）。</p><hr><h3 id="文件-2-课程模式">文件 2  课程模式</h3><p>1  00:00:00,370 --&gt; 00:00:02,020<br>本课程分为五课<br>→ 给出宏观目录，后续每课对应一个文件簇。</p><p>2  00:00:02,020 --&gt; 00:00:05,280<br>第一课中 我们会大概介绍什么是 A/B 测试以及测试可用和不可用的情况<br>→ 第一课 = 你现在正在看的 8 个文件。</p><p>3  00:00:05,280 --&gt; 00:00:07,250<br>我们将一起从头到尾地了解 A/B 测试的示例<br>→ 承诺：第一课就会跑一遍“小闭环”，降低焦虑。</p><p>4  00:00:07,250 --&gt; 00:00:10,100<br>以便于你可以看到整个过程是怎样的<br>→ 目的：先见森林，再见树木。</p><p>5  00:00:10,100 --&gt; 00:00:12,220<br>在示例中 我们首先要选择用于试验的一项指标<br>→ 指标先行，避免“先改后想”。</p><p>6  00:00:12,220 --&gt; 00:00:15,020<br>查看必要的统计结果 随后我们将设计我们自己的试验<br>→ 顺序：指标→统计需求（样本量）→设计。</p><p>7  00:00:15,020 --&gt; 00:00:18,490<br>最终 我们将分析结果<br>→ 闭环到“分析”才算结束，避免“跑实验不看数”。</p><p>8  00:00:18,490 --&gt; 00:00:23,900<br>在之后的课程中 我们将深入了解整个过程中某个部分的具体细节<br>→ 预告：第 2-5 课把闭环拆成 4 段深度。</p><p>9  00:00:23,900 --&gt; 00:00:25,920<br>在第二课中 你将学到如何保护试验中的参与者<br>→ 伦理课：知情同意、最小风险、数据隐私（GDPR/CCPA）。</p><p>10  00:00:25,920 --&gt; 00:00:28,560<br>以及你应该不断问自己哪些关于实验伦理性方面的问题<br>→ 给出 checklist：是否对用户造成伤害？是否泄露 PII？能否提前终止？</p><p>11  00:00:28,560 --&gt; 00:00:31,830<br>在第三课中 我们将更具体地探讨如何选择和定义用于实验评估的指标<br>→ 指标类型：invariant、goal、guardrail、secondary；会讲 OMEC 框架。</p><p>12  00:00:31,830 --&gt; 00:00:34,630<br>在第四课中 我们将更多的讨论如何设计试验<br>→ 分流单元（user_id vs cookie vs device）、随机化块、分层实验、正交。</p><p>13  00:00:34,630 --&gt; 00:00:37,090<br>包括选择哪些用户进入对照组 哪些用户进入到实验组<br>→ 涉及“触发逻辑”（trigger）与“意向治疗（ITT）vs 按治疗（PP）”区别。</p><p>14  00:00:37,090 --&gt; 00:00:40,560<br>在第五课中 我们将查看大量示例 说明你的结果可能出现的形式<br>→ 会覆盖：置信区间、统计显著 vs 业务显著、第一类/第二类错误、样本比误导。</p><p>15  00:00:40,560 --&gt; 00:00:43,450<br>如何分析上述结果 如何得出有效的结论<br>→ 给出“决策矩阵”：发布/不发布/需更大样本/需重做。</p><p>16  00:00:43,450 --&gt; 00:00:46,230<br>现在 要参加这个课程 你不需要任何以前使用 A/B 测试的经验<br>→ 再次降低门槛，吸引零基础。</p><p>17  00:00:46,230 --&gt; 00:00:49,149<br>因为我们将从最基础的部分开始<br>→ 基础 = 随机化概念、均值比较、中心极限定理。</p><p>18  00:00:49,149 --&gt; 00:00:52,010<br>同时你也不需要任何编程经验<br>→ 课程作业用 Excel/计算器/在线样本量工具即可完成。</p><p>19  00:00:52,010 --&gt; 00:00:55,260<br>因为本课程不会包含如何执行 A/B 测试的框架<br>→ 与文件 1 第 9 条呼应，避免学员抱怨“没代码”。</p><p>20  00:00:55,260 --&gt; 00:00:58,817<br>本课程讲的是如何设计和分析实验<br>→ 核心卖点：Design &amp; Analysis，Implementation 自己找工程团队。</p><p>21  00:00:58,817 --&gt; 00:01:02,331<br>另一方面 我们需要的是统计学入门知识<br>→ 先修门槛再次明确：知道“正态分布、均值、标准差”即可。</p><p>22  00:01:02,331 --&gt; 00:01:05,540<br>因此 如果你需要复习 就查看讲师注释中的链接<br>→ 讲师注释会放 Khan Academy 或 Coursera 统计学链接。</p><p>23  00:01:05,540 --&gt; 00:01:08,480<br>在整个课程中 我将向大家展示大量示例<br>→ Caroline 负责“示例”，保证每 5 分钟一个案例。</p><p>24  00:01:08,480 --&gt; 00:01:11,440<br>你也拥有运用所学内容的机会<br>→ 每课后有 quiz + 开放问答题（手写计算置信区间）。</p><p>25  00:01:11,440 --&gt; 00:01:14,290<br>我还会与 Dianne 和 Carrie 一起讨论她们在 A/B 测试中的经验<br>→ 三人圆桌访谈形式，穿插在课后“Bonus”视频。</p><h3 id="文件-3-A-B-测试简介">文件 3  A/B 测试简介</h3><p>1  00:00:00,930 --&gt; 00:00:04,462<br>Diane、Carrie 究竟什么是 A/B 测试？<br>→ 主持人抛问题，暗示后面是“官方定义”。</p><p>2  00:00:04,462 --&gt; 00:00:07,920<br>A/B 测试是一个用于在线测试的常规方法<br>→ 关键词“在线”→ 线下业务（如门店促销）不直接适用。</p><p>3  00:00:07,920 --&gt; 00:00:09,370<br>可用来测试新产品或新功能<br>→ 范围限定：产品或功能，不是品牌定位或战略。</p><p>4  00:00:09,370 --&gt; 00:00:12,170<br>你需要做的是设置两组用户<br>→ 最小模型：仅两组（对照/实验），多臂 bandit 留到进阶课。</p><p>5  00:00:12,170 --&gt; 00:00:16,030<br>将其中一组设置为对照组 采用已有的产品或功能<br>→ 对照组 = “基准”，必须可观测同期数据，避免历史对照陷阱。</p><p>6  00:00:16,030 --&gt; 00:00:19,480<br>另一组是实验组 采用新版产品或功能<br>→ 实验组 = “单变量差异”，否则解释不了因果。</p><p>7  00:00:19,480 --&gt; 00:00:20,170<br>你需要做的是找到上述用户做出的不同响应<br>→ 不同响应 = 指标差异，强调可量化。</p><p>8  00:00:20,170 --&gt; 00:00:22,670<br>然后确认哪个版本的功能更好<br>→ 决策标准：统计显著 + 业务显著，后面会拆。</p><p>9  00:00:22,670 --&gt; 00:00:25,870<br>对所有考虑进行的变更使用 A/B 测试 还是说 A/B 测试是否更适用于一些特定类型的改变？<br>→ 主持人抛出“适用边界”问题，引出 mountain 比喻。</p><p>10  00:00:25,870 --&gt; 00:00:29,380<br>我曾经和 John Lilly 讨论过 他现在是 Greylock 的 VC 但是 他曾任 Mozilla 的 CEO<br>→ 背书：John Lilly = Mozilla 前 CEO + 风投，增加比喻可信度。</p><p>11  00:00:29,380 --&gt; 00:00:31,850<br>他打了一个十分恰当的比方<br>→ 预告 mountain 比喻即将上线。</p><p>12  00:00:31,850 --&gt; 00:00:34,530<br>他说 A/B 测试能够帮你爬上你面前高山的顶峰<br>→ 意译：A/B 只能局部最优（hill climbing），不能全局最优。</p><p>13  00:00:34,530 --&gt; 00:00:37,090<br>但是如果你想弄清楚自己是否想爬上这座山还是另一座山 那么 A/B 测试就没那么有用了<br>→ 换句话说：战略方向、赛道选择、0-1 创新，A/B 帮不上。</p><p>14  00:00:37,090 --&gt; 00:00:41,350<br>也就是说 你可以通过 A/B 测试对很大范围的事情进行测试<br>→ 拉回正题：虽然战略不行，但战术范围仍然很大。</p><p>15  00:00:41,350 --&gt; 00:00:45,960<br>比如一些新功能 用户界面中增加的内容 网站的不同外观<br>→ 列举“可见变化”，暗示“用户可感知”是前提。</p><p>16  00:00:45,960 --&gt; 00:00:48,880<br>很多公司都在使用 A/B 测试<br>→ 过渡句，准备举大厂案例。</p><p>17  00:00:48,880 --&gt; 00:00:52,010<br>例如 Amazon 首次开始做个性化推荐时<br>→ 案例 1：推荐系统，属于“算法排序”类。</p><p>18  00:00:52,010 --&gt; 00:00:55,260<br>他们想看一下人们是否真的会购买更多商品<br>→ 指标 = 购买率/收入，后续会讲“如何选指标”。</p><p>19  00:00:55,260 --&gt; 00:00:57,090<br>他们发现由于个性化推荐 他们的收益有了显著增加<br>→ 结果：显著 + 业务大，所以成为经典案例。</p><p>20  00:00:57,090 --&gt; 00:01:00,440<br>所以 你可以将它用于十分复杂的改变<br>→ 强调“复杂”也行，只要变量单一。</p><p>21  00:01:00,440 --&gt; 00:01:03,630<br>现在 Google 有时可能 A/B 测试做太多了<br>→ 自我吐槽，铺垫“过度实验”陷阱。</p><p>22  00:01:03,630 --&gt; 00:01:07,670<br>有一次我们在用户界面中运行 41 个不同的蓝色阴影<br>→ 名场面：41 种蓝，外界黑 Google“数据僵化”。</p><p>23  00:01:07,670 --&gt; 00:01:10,350<br>来查看用户有什么反响 如果他们做出反应<br>→ 指标 = 点击率/搜索量，确实能测出差异。</p><p>24  00:01:10,350 --&gt; 00:01:12,220<br>它本身十分有趣并有用<br>→ 官方态度：微观优化有效，但别神话。</p><p>25  00:01:12,220 --&gt; 00:01:15,150<br>但是实验做的太过了<br>→ 自我批评：边际收益递减 + 工程师时间浪费。</p><p>26  00:01:15,150 --&gt; 00:01:18,780<br>但是我们能够测试少量的用户可见的变化<br>→ 拉回正轨：适度即可。</p><p>27  00:01:18,780 --&gt; 00:01:23,697<br>例如 排名变动<br>→ 案例 2：搜索/推荐排序，属于“看不见但可感知”变化。</p><p>28  00:01:23,697 --&gt; 00:01:24,847<br>LinkedIn 测试了一个改变<br>→ 案例 3：LinkedIn feed 排序。</p><p>29  00:01:24,847 --&gt; 00:01:27,724<br>尝试确定他们是否应显示新文章还是鼓励大家增加新联系人<br>→ 业务问题：关系链增长 vs 内容消费，两者 KPI 冲突。</p><p>30  00:01:27,724 --&gt; 00:01:31,250<br>这就是排名变动<br>→ 总结：任何 feed 流皆可 A/B。</p><p>31  00:01:31,250 --&gt; 00:01:36,030<br>Google 做了很多检索列表和广告之间的排名<br>→ 案例 4：广告位高低，直接决定收入，敏感。</p><p>32  00:01:36,030 --&gt; 00:01:37,720<br>我们也通过 A/B 测试对所有上述改变进行了测试<br>→ 再次强调“全覆盖”。</p><p>33  00:01:37,720 --&gt; 00:01:41,090<br>你也可以针对你不确信用户是否会注意到的改变进行测试<br>→ 引出“不可见变化”案例：性能。</p><p>34  00:01:41,090 --&gt; 00:01:45,400<br>例如 100 毫秒的页面加载时间不是太多<br>→ 量级：100 ms = 0.1 s，用户主观难察觉。</p><p>35  00:01:45,400 --&gt; 00:01:46,840<br>但是 Amazon 和 Google 都运行了测试<br>→ 双厂背书，增加可信度。</p><p>36  00:01:46,840 --&gt; 00:01:49,040<br>Amazon 在 2007 年证实<br>→ 时间点：2007，论文/博客可考证（Greg Linden 公开过）。</p><p>37  00:01:49,040 --&gt; 00:01:52,520<br>每个页面增加 100 毫秒的延迟会导致收入降低 1%<br>→ 数字：100 ms ↓ 1%，常被引用做“性能 ROI”标杆。</p><p>38  00:01:52,520 --&gt; 00:01:55,260<br>对于 Google 来说 我们得到了相似的结果<br>→ Google 内部 2009 年也跑过，结论一致。</p><p>39  00:01:55,260 --&gt; 00:01:57,620<br>平均来看 虽然 100 毫秒看起来不多<br>→ 强调“小延迟也有大影响”，为后面“性能优化优先级”埋伏笔。</p><p>40  00:01:57,620 --&gt; 00:02:01,650<br>人们查询的数量真地降低了<br>→ 指标 = 每用户查询数（queries/user），属于 engagement。</p><p>41  00:02:01,650 --&gt; 00:02:04,420<br>这就是可以从 A/B 测试中学到的东西<br>→ 小结：性能也能 A/B，只要能量化。</p><p>42  00:02:04,420 --&gt; 00:02:07,070<br>那你不能用 A/B 测试做的事情是哪些呢？<br>→ 主持人过渡，准备讲“边界”。</p><p>43  00:02:07,070 --&gt; 00:02:10,380<br>在测试新的体验时 A/B 测试的用途就没那么大了<br>→ 新体验 = 用户从未见过，无基准可比。</p><p>44  00:02:10,380 --&gt; 00:02:12,600<br>但是你可以用更明显的方式考虑这个问题 对吧？<br>→ 反问句，提示下面将给出“可感知”例子。</p><p>45  00:02:12,600 --&gt; 00:02:14,730<br>你在测试新的体验时 你当前已有的那些用户可能会觉得<br>→ 点出“改变厌恶症”（change aversion）。</p><p>46  00:02:14,730 --&gt; 00:02:18,200<br>“你改变了我的体验 发生了什么 我喜欢我原来的方式 我有点不高兴”<br>→ 用户情绪成本，需长期观测。</p><p>47  00:02:18,200 --&gt; 00:02:21,310<br>这也被称为改变厌恶症<br>→ 给出术语：change aversion，可检索论文。</p><p>48  00:02:21,310 --&gt; 00:02:23,830<br>另一方面 他们可能觉得 这是新的 然后他们尝试所有东西<br>→ 对立面：新奇效应（novelty effect）。</p><p>49  00:02:23,830 --&gt; 00:02:26,960<br>这就被称为新奇效应 对吧？<br>→ 给出术语：novelty effect。</p><p>50  00:02:26,960 --&gt; 00:02:29,443<br>那么 在新的体验中会发生什么<br>→ 总结：两种偏差同时存在，短期数据失真。</p><p>51  00:02:29,443 --&gt; 00:02:32,860<br>一个问题是 你比较的基准是什么<br>→ 自问自答：基准缺失，无法判断。</p><p>52  00:02:32,860 --&gt; 00:02:35,210<br>第二个问题 你需要多少时间为了在实际中让你的用户接受新的体验<br>→ 隐含：需长期观测，但业务等不起。</p><p>53  00:02:35,210 --&gt; 00:02:37,090<br>实际上就是平稳的体验会是什么样<br>→ 只有“平稳后”数据才能用于决策。</p><p>54  00:02:37,090 --&gt; 00:02:40,790<br>我能够据此做出稳健的决策<br>→ 关键词：稳健（robust），统计+业务双显著。</p><p>55  00:02:40,790 --&gt; 00:02:44,990<br>由于其他一些原因 时间也可能成为难题所在<br>→ 引出“长周期业务”案例。</p><p>56  00:02:44,990 --&gt; 00:02:48,920<br>例如 你有一个网站 推荐公寓租赁的<br>→ 案例：公寓租赁，低频高客单。</p><p>57  00:02:48,920 --&gt; 00:02:52,010<br>人们寻找公寓不是那么频繁<br>→ 频率低 → 事件稀疏 → 实验周期长。</p><p>58  00:02:52,010 --&gt; 00:02:55,260<br>那么 你真正想要的是回报的业务 或通过推荐给其他喜欢这项服务的人扩大业务<br>→ 目标：复购 + 口碑，但二者都难在短期实验观测。</p><p>59  00:02:55,260 --&gt; 00:02:57,620<br>现实是 在试验的范围内十分难以测定<br>→ 直接结论：A/B 测不准。</p><p>60  00:02:57,620 --&gt; 00:03:01,650<br>人们是否真的因为更多的推介回到你的网站<br>→ 指标： referral rate，追踪链路断裂。</p><p>61  00:03:01,650 --&gt; 00:03:04,420<br>即便人们向他们的朋友推荐 老实说 是否需要等到下一周？<br>→ 反问句：实验窗口无法确定。</p><p>62  00:03:04,420 --&gt; 00:03:07,070<br>是否需要等到六个月后？<br>→ 拉长窗口 → 流量/预算/工程成本高。</p><p>63  00:03:07,070 --&gt; 00:03:10,380<br>所以你可能想知道关于你的网站的一些东西 但通过短期的 A/B 测试却十分难以实现<br>→ 小结：长周期目标 → A/B 失灵。</p><p>64  00:03:10,380 --&gt; 00:03:12,600<br>我们将在第三课中讨论针对这些情况 有哪些好的指标可以选择<br>→ 预告：第三课会讲“代理指标”（proxy metric）。</p><p>65  00:03:12,600 --&gt; 00:03:15,480<br>因此 最后我们提供的示例中 A/B 测试不是十分有效<br>→ 过渡到最后一个反例：遗漏检测。</p><p>66  00:03:15,480 --&gt; 00:03:19,290<br>因为 A/B 测试无法真实地告诉你是否遗漏了什么东西<br>→ 核心：A/B 只能测“已存在差异”，不能测“不存在”。</p><p>67  00:03:19,290 --&gt; 00:03:21,340<br>现在 假设你在做数码相机评论网站<br>→ 案例：内容覆盖率。</p><p>68  00:03:21,340 --&gt; 00:03:25,530<br>A/B 测试可以告诉你是否需要在这相机评论上面发表相机评论<br>→ 白话：已上架的评测能不能放首页。</p><p>69  00:03:25,530 --&gt; 00:03:28,390<br>但是 A/B 测试无法告诉你 你是否完全忽略了其他需要你来评价但是你根本没有评价的相机<br>→ 致命盲区：遗漏的 SKU 无法被实验观测，必须用搜索词、问卷、竞品爬虫补充。</p><p>70  00:03:28,390 --&gt; 00:03:30,770<br>明白了<br>→ 口语结束，提示本节收尾。</p><hr><h3 id="文件-4-你可以做和不可以做的事（题目）">文件 4  你可以做和不可以做的事（题目）</h3><p>1  00:00:00,350 --&gt; 00:00:03,890<br>在接下来的视频中 我们将看到更多示例<br>→ 预告：下面 4 道判断题是互动环节。</p><p>2  00:00:03,890 --&gt; 00:00:06,280<br>说明什么时候可以或不可以使用 A/B 测试<br>→ 目标：让学员先猜，形成认知冲突。</p><p>3  00:00:06,280 --&gt; 00:00:09,950<br>可以使用的替代 A/B 测试的技术<br>→ 提前埋点：后续会讲“日志回溯、问卷、焦点小组”。</p><p>4  00:00:09,950 --&gt; 00:00:12,020<br>以及 A/B 测试的历史简介<br>→ 历史简介被砍，实际视频里没出现，可忽略。</p><p>5  00:00:12,020 --&gt; 00:00:15,610<br>随后 我将介绍我们在本课接下来要使用的 A/B 测试的示例<br>→ 预告：会拿一个“完整闭环”案例贯穿。</p><p>6  00:00:15,610 --&gt; 00:00:17,010<br>如果你要跳到这里<br>→ 给快捷键：讲师注释放时间戳。</p><p>7  00:00:17,010 --&gt; 00:00:19,470<br>你可以利用讲师注释中的链接<br>→ Udacity 平台支持“互动视频”，可跳段。</p><p>8  00:00:19,470 --&gt; 00:00:21,980<br>现在 我们来看一下你可能考虑使用 A/B 测试的变更列表<br>→ 过渡句，准备出题。</p><p>9  00:00:21,980 --&gt; 00:00:25,420<br>首先 假设有一家在线购物公司例如 Amazon<br>→ 案例 1：电商缺货检测。</p><p>10  00:00:25,420 --&gt; 00:00:27,170<br>想知道他们的网站是否全面<br>→ “全面”= 商品覆盖率，无法随机。</p><p>11  00:00:27,170 --&gt; 00:00:30,760<br>或者是否存在用户想要购买但是他们无法提供的产品<br>→ 隐含：缺失的商品不在实验组里，无法比较。</p><p>12  00:00:30,760 --&gt; 00:00:33,080<br>要求你确定什么情况下 A/B 测试是合适的<br>→ 题型：勾选框 → 让学员主动思考。</p><p>13  00:00:33,080 --&gt; 00:00:37,070<br>第二 假设公司已经有了免费服务 他们可能拥有待办事项应用<br>→ 案例 2：Freemium → Premium 升级。</p><p>14  00:00:37,070 --&gt; 00:00:40,530<br>他们想提供带有其他功能的高级服务<br>→ 关键：用户需主动升级 → 无法强制随机。</p><p>15  00:00:40,530 --&gt; 00:00:43,450<br>如需使用高级服务 用户需要升级 创建登录帐户 并探寻新的功能<br>→ 三步摩擦：升级→注册→探索，每一步都可 dropout。</p><p>16  00:00:43,450 --&gt; 00:00:46,230<br>第三 假设一个网站 为用户提供电影建议例如 Netflix<br>→ 案例 3：算法排序，经典可 A/B 场景。</p><p>17  00:00:46,230 --&gt; 00:00:49,149<br>他们创建了一个新的算法 对可能的建议进行排序<br>→ 单一变量：算法差异，可随机。</p><p>18  00:00:49,149 --&gt; 00:00:52,010<br>第四 假设你想要改变基础架构的后台<br>→ 案例 4：后端性能，用户无感知。</p><p>19  00:00:52,010 --&gt; 00:00:55,260<br>这可能影响页面加载的速度、用户可以看到的显示结果等等<br>→ 指标：速度/收入/报错率，均可量化。</p><p>20  00:00:55,260 --&gt; 00:00:57,670<br>使用 A/B 测试对这个改变进行测试是否合适？<br>→ 结束提问，等待文件 5 解析。</p><hr><h3 id="文件-5-你可以做和不可以做的事（解析）">文件 5  你可以做和不可以做的事（解析）</h3><p>1  00:00:00,420 --&gt; 00:00:03,810<br>第一种情况 你通过 A/B 测试无法确认你是否提供了所有产品<br>→ 直接给答案：缺货检测 ❌。</p><p>2  00:00:03,810 --&gt; 00:00:06,160<br>你可以尝试额外增加产品 但是如果用户不购买 你仍然无法知道是否缺少其他产品<br>→ 解释：实验只能观测“已上架”商品的表现。</p><p>3  00:00:06,160 --&gt; 00:00:10,070<br>相反 你可能想要询问用户他们是否觉得缺少什么东西<br>→ 替代方案：站内问卷、搜索词挖掘、客服工单 NLP。</p><p>4  00:00:10,070 --&gt; 00:00:13,710<br>第二 使用 A/B 测试无法全面测试高级服务是否是好的商业决策<br>→ Freemium → Premium ❌（无法强制随机）。</p><p>5  00:00:13,710 --&gt; 00:00:16,860<br>用户需要选择进入高级服务 因此随机指定人员进入到一组 而另一组无法起作用<br>→ 核心：无对称对照组 → 因果推断失效。</p><p>6  00:00:16,860 --&gt; 00:00:18,200<br>你仍然可以从 A/B 测试中获得有价值的信息<br>→ 让步：可做“升级漏斗”分析，但无法测“整体收入因果”。</p><p>7  00:00:18,200 --&gt; 00:00:21,310<br>例如 你可以看到多少用户会访问增加的功能或如果提供选择 多少用户会选择升级<br>→ 可测指标：入口点击率、升级转化率、付费留存。</p><p>8  00:00:21,310 --&gt; 00:00:24,590<br>但是你无法全面测试所做的改变<br>→ 再次强调：不能回答“如果全员强制升级会怎样”。</p><p>9  00:00:24,590 --&gt; 00:00:26,930<br>第三 是使用 A/B 测试的主要情形<br>→ 算法排序 ✅，经典场景。</p><p>10  00:00:26,930 --&gt; 00:00:29,660<br>有明确的对照组和实验组 旧算法和新算法<br>→ 单一变量 + 随机分流 → 因果清晰。</p><p>11  00:00:29,660 --&gt; 00:00:32,170<br>也可以找到一些能够评估改变的明确的指标<br>→ 指标：CTR、观看完成率、人均播放数。</p><p>12  00:00:32,170 --&gt; 00:00:35,540<br>第四 测试有点复杂 取决于你是否拥有同时运行两个后台版本的计算能力<br>→ 后端性能 ✅ 有条件：工程能双跑。</p><p>13  00:00:35,540 --&gt; 00:00:38,930<br>如果同时运行两个版本 你当然可以对变化的结果进行 A/B 测试<br>→ 前提：工程资源 + 数据管道双倍成本。</p><p>14  00:00:38,930 --&gt; 00:00:41,240<br>再者 你拥有明确的对照组和实验组<br>→ 因果成立，但需权衡成本。</p><p>15  00:00:41,240 --&gt; 00:00:43,710<br>因此 只要你拥有计算能力 同时运行两个版本 你会十分容易完成测试<br>→ 结论：技术上可行，商业上看 ROI。</p><hr><h3 id="文件-6-再给你-3-个场景（第二轮练习）">文件 6  再给你 3 个场景（第二轮练习）</h3><p>1  00:00:00,360 --&gt; 00:00:02,790<br>为了向你展示更丰富的多样性 我们将看另外三个可能的变化<br>→ 第二轮互动，加深记忆。</p><p>2  00:00:02,790 --&gt; 00:00:05,420<br>对于每种情况 如果你觉得对改变运行 A/B 测试有用 请勾选方框<br>→ 题型依旧：先猜后讲。</p><p>3  00:00:05,420 --&gt; 00:00:06,430<br>首先 假设你有一个销售汽车的网站<br>→ 案例 1：汽车复购 + 口碑，低频长周期。</p><p>4  00:00:06,430 --&gt; 00:00:10,520<br>你考虑做出改变 你想要知道变更是否会让客户更可能再次访问网站或者向他们的朋友推荐<br>→ 指标：return rate + referral rate，都难短期观测。</p><p>5  00:00:10,520 --&gt; 00:00:14,300<br>第二 假设一家公司想要更新他们的品牌 包括网站的主要 Logo<br>→ 案例 2：品牌 Logo，情绪/习惯干扰。</p><p>6  00:00:14,300 --&gt; 00:00:16,820<br>你能对改变进行 A/B 测试吗？<br>→ 提问，等待文件 7 解析。</p><p>7  00:00:16,820 --&gt; 00:00:19,470<br>第三 假设你想对移动应用首页的改变进行测试<br>→ 案例 3：首页信息架构，典型可 A/B。</p><p>8  00:00:19,470 --&gt; 00:00:22,410<br>你想要变更包含的信息 使用的措辞、颜色等<br>→ 变量：文案 + 配色 + 信息顺序，可单因素切分。</p><p>9  00:00:22,410 --&gt; 00:00:25,680<br>选择你认为最合适进行 A/B 测试的情况<br>→ 结束提问。</p><hr><h3 id="文件-7-第二轮解析">文件 7  第二轮解析</h3><p>1  00:00:00,410 --&gt; 00:00:04,350<br>第一种情况 不能使用 A/B 测试<br>→ 汽车复购 ❌。</p><p>2  00:00:04,350 --&gt; 00:00:06,450<br>人们很少购买汽车<br>→ 频率低 → 事件稀疏 → 实验周期&gt;&gt;商业耐心。</p><p>3  00:00:06,450 --&gt; 00:00:09,630<br>所以你需要很长时间才能看到是否有回头客<br>→ 统计功效不足，样本量需求爆炸。</p><p>4  00:00:09,630 --&gt; 00:00:13,440<br>你甚至不需要获得用户是否向朋友建议此网站的数据<br>→ 口碑追踪链路断裂（无 referrer/分享 ID）。</p><p>5  00:00:13,440 --&gt; 00:00:16,860<br>第二 看起来很容易进行 A/B 测试<br>→ Logo ❌（短期）。</p><p>6  00:00:16,860 --&gt; 00:00:19,200<br>你肯定能够收集关于新、旧 Logo 的用户行为数据<br>→ 技术可行：CTR/停留时长/滚动深度都能采。</p><p>7  00:00:19,200 --&gt; 00:00:22,410<br>但是改变你的公司的品牌肯定对用户来说是情感上的冲击<br>→ 情感冲击 → 短期数据失真（改变厌恶 + 新奇并存）。</p><p>8  00:00:22,410 --&gt; 00:00:25,680<br>他们可能需要时间习惯新的 Logo 因此你不需要根据 A/B 测试中采集到的短期数据做出决定<br>→ 建议：拉长观测窗到季度或年，或改用问卷/焦点小组。</p><p>9  00:00:25,680 --&gt; 00:00:28,390<br>第三 最适合使用 A/B 测试<br>→ 首页改版 ✅。</p><p>10  00:00:28,390 --&gt; 00:00:30,970<br>存在明确的对照组和实验组<br>→ 随机分流易实现。</p><p>11  00:00:30,970 --&gt; 00:00:33,460<br>并且比起前面两个案例 更容易选择适合的指标评估此类改变<br>→ 指标：首页→下一步 CTR、留存、单会话时长。</p><p>12  00:00:33,460 --&gt; 00:00:36,230<br>你可以选择某些指标 例如用户通过初始页面的概率<br>→ 给出具体示例：初始页面转化率（即 bounce rate 的补数）。</p><hr><h3 id="文件-8-其他技巧">文件 8  其他技巧</h3><p>1  00:00:00,230 --&gt; 00:00:03,719<br>我们刚刚看到了 A/B 测试不太有用的情况<br>→ 承接上文，准备给“替代工具箱”。</p><p>2  00:00:03,719 --&gt; 00:00:05,260<br>在这种情况下 我们要怎么做呢？<br>→ 反问句，引出“混合方法”。</p><p>3  00:00:05,260 --&gt; 00:00:07,390<br>是否有其他可用的技术？<br>→ 预告：下面列出“日志、问卷、焦点小组、UX 研究”。</p><p>4  00:00:07,390 --&gt; 00:00:10,344<br>还有很多不同的收集关于用户数据的方法<br>→ 总起句：多源数据互补。</p><p>5  00:00:10,344 --&gt; 00:00:13,137<br>同时 部分方法甚至还可以作为运行 A/B 测试的补充<br>→ 强调“互补”而非“替代”。</p><p>6  00:00:13,137 --&gt; 00:00:14,607<br>例如 通常你会有记录用户在你的网站进行操作的日志<br>→ 日志 = 被动大数据，低成本。</p><p>7  00:00:14,607 --&gt; 00:00:19,200<br>你可以通过检查或观察分析日志得出假设 是什么原因造成其行为改变<br>→ 流程：回溯日志 → 形成假设 → 前瞻性实验验证。</p><p>8  00:00:19,200 --&gt; 00:00:24,250<br>可能你就要沿着这个方向努力 然后设计实验完成随机化和试验 进行前瞻性分析<br>→ 标准“数据 → 假设 → 实验”闭环，与科研方法一致。</p><p>9  00:00:24,250 --&gt; 00:00:28,000<br>同时 你可以使用两个数据来源作为相互补充的类别<br>→ 再次强调“互补”策略。</p><p>10  00:00:28,000 --&gt; 00:00:31,340<br>这种情况下 你可以通过查看日志建立一个假设 但是 实际上你想测试你能否在实验中让假设成真<br>→ 避免“数据 dredging”：先假设后实验，防止 p-hacking。</p><p>11  00:00:31,340 --&gt; 00:00:35,460<br>因此 你还需要运行 A/B 测试比较结果 查看你的理论是否合理<br>→ 结论：日志不能代替实验，只能生成假设。</p><p>12  00:00:35,460 --&gt; 00:00:38,930<br>也有一大堆其他技术 从用户体验研究到焦点小组、调查和人为评价<br>→ 清单：UX Research、Focus Group、Survey、Human Evaluation。</p><p>13  00:00:38,930 --&gt; 00:00:42,830<br>现在 A/B 测试可以给你大量的宽泛的定量数据<br>→ 定量：大样本、低偏差、可统计推断。</p><p>14  00:00:42,830 --&gt; 00:00:46,060<br>但是 上述其他技术会给到你非常深入的定性数据<br>→ 定性：动机、情绪、认知负荷，无法通过实验量化。</p><p>15  00:00:46,060 --&gt; 00:00:50,600<br>作为 A/B 测试的补充 比如 上述其他技术可以告诉你应该翻越哪座山<br>→ 呼应 mountain 比喻：定性帮你选山，定量帮你爬山。</p><p>16  00:00:50,600 --&gt; 00:00:52,740<br>因此 我们将在第三课中介绍上面所说的一些其他技术<br>→ 预告：第三课讲“指标 + 混合方法”。</p><p>17  00:00:52,740 → 00:00:55,500<br>当然有一些情况用 A/B 测试十分难以测试<br>→ 过渡：准备讲“完全无法随机”场景。</p><p>18  00:00:55,500 → 00:00:58,930<br>例如 如果你彻底重新建立你的网站或改变用户互动的方式<br>→ 案例：全站重构 → 无法保持“单一变量”。</p><p>19  00:00:58,930 → 00:01:01,290<br>这些情况中 你很难运行对照组的实验<br>→ 隐含：需用 quasi-experiment（断点、DID）或长期队列。</p><p>20  00:01:01,290 → 00:01:03,719<br>我们将在稍后的课程中讨论<br>→ 预告：第四课“设计”会展开 quasi-experiment。</p><hr><p>以下把 9–17 号字幕（历史→商业案例→指标→二项分布）逐句拆成“知识点卡片”。<br>格式说明：</p><ul><li>左侧＝原字幕时间轴+原文；右侧＝翻译/拆解/考试或面试易考点。</li><li>用 ‖ 分隔同一句话里的多个隐藏信息。</li><li>加粗★为必须背下来的“结论性原话”。</li></ul><hr><h3 id="文件-9-A-B-测试的历史">文件 9  A/B 测试的历史</h3><p>1  00:00:00,151 --&gt; 00:00:02,911<br>人类最初从什么时候开始使用 A/B 测试？<br>→ 开场提问，暗示“早于互联网”。</p><p>2  00:00:02,911 --&gt; 00:00:06,447<br>A/B 测试的历史很长 一开始应该是出现在农业领域<br>★ 最早形态：农田分区试验（随机区组设计）。‖ 农业= factorial design 源头，Fisher 20 世纪 20 年代确立。</p><p>3  00:00:06,447 --&gt; 00:00:10,242<br>虽然那时候还不叫 A/B 测试<br>→ 术语是后来借用的，方法论同源：对照+随机。</p><p>4  00:00:10,242 --&gt; 00:00:13,845<br>人们将土地分为各个部分<br>→ 早期“分流单元”= 地块；现代= user_id/cookie/device。</p><p>5  00:00:13,845 --&gt; 00:00:17,610<br>然后测试哪个地方最适合某种作物或者作物如何生长<br>→ 指标= 产量/株高；在线= CTR/收入。</p><p>6  00:00:17,610 --&gt; 00:00:20,654<br>其实有很多不同的领域在很长时间内都在实际使用 A/B 测试<br>→ 暗示“通用科学方法”，不只市场或产品。</p><p>7  00:00:20,654 --&gt; 00:00:22,731<br>一般来说 在科学领域中假设检验是确定创新的关键方法<br>★ 官方定义：A/B = 在线场景下的“假设检验”。</p><p>8  00:00:22,731 --&gt; 00:00:28,408<br>医学上的 A/B 测试称为临床试验<br>→ 医学= 黄金标准：双盲、随机、对照（RCT）。</p><p>9  00:00:28,408 --&gt; 00:00:32,220<br>他们会藉此确定新药品是否有效<br>→ 医学指标= 生存率/副作用；在线= 转化率/留存。</p><p>10  00:00:32,220 --&gt; 00:00:35,406<br>在 A/B 测试中你最想看到的是对照组和实验组返回一致的响应<br>→ 一致= 除实验变量外其他分布均衡，可排除混杂。</p><p>11  00:00:35,406 --&gt; 00:00:41,902<br>让你能够真正地决定试验的结构 确定实验组以及对照组是否有很明显的行为改变<br>→ 结构= 随机化方案+样本量+指标；行为改变= 统计显著+业务显著。</p><p>12  00:00:41,902 --&gt; 00:00:45,498<br>所以运行这些试验以及在线 A/B 测试之间有什么不同？<br>→ 过渡句，准备比较“线下 vs 线上”。</p><p>13  00:00:45,498 --&gt; 00:00:49,094<br>网络上 我们有更多更多的数据 但是分辨率更低<br>★ 核心对比：大数据+低像素（unknown user）。</p><p>14  00:00:49,094 --&gt; 00:00:57,425<br>传统医学/UX 试验：10–50 人，知道年龄/体重/驾照；在线：百万级访问，但不知“网咖里是一个人还是多个人”<br>→ 线上= 大样本+高功效，但混杂因子多（同一设备多人、爬虫、机器人）。</p><p>15  00:00:57,425 --&gt; 00:01:00,840<br>网络世界中要谨记的一件事就是当你做 A/B 测试时目的是要确认用户是否会喜欢这个新产品或新功能<br>→ 目的= 产品/功能偏好，而非科学发论文。</p><p>16  00:01:00,840 --&gt; 00:01:07,960<br>设计一个合理且能够给到你可复验的结果 让你能够很好地决定是否要发布一款产品或功能<br>★ 关键词：合理（randomized）、可复验（reproducible）、发布决策（ship or not）。</p><p>17  00:01:07,960 --&gt; 00:01:10,538<br>我知道优达学城使用 A/B 测试 其他技术公司呢？<br>→ 过渡，准备列“行业清单”。</p><p>18  00:01:10,538 --&gt; 00:01:16,484<br>Google、Microsoft、eBay、PayPal、Netflix 基本上所有主要的公司都在使用 A/B 测试<br>→ 面试可用：报出大厂名单，体现“行业标准”。</p><p>19  00:01:16,484 --&gt; 00:01:20,359<br>甚至还有公司专门为小公司提供这些服务<br>→ 指 Optimizely、VWO、Google Optimize 等 SaaS，降低门槛。</p><p>20  00:01:20,359 --&gt; 00:01:23,211<br>帮助他们优化网站等等<br>→ 结论：A/B 已成“水电煤”基础设施。</p><hr><h3 id="文件-10-商业案例概述">文件 10  商业案例概述</h3><p>1  00:00:00,420 --&gt; 00:00:02,270<br>好了 我们已经回顾了 A/B 测试的历史<br>→ 承上启下，进入“实战闭环”示例。</p><p>2  00:00:02,270 --&gt; 00:00:05,470<br>现在让我们来看一些示例<br>→ 以下用“Audacity” fake 公司贯穿全课。</p><p>3  00:00:05,470 --&gt; 00:00:06,440<br>在整个课程中我们会使用与优达学城相似的一个在线教育公司作为示例<br>→ 说明：业务模型= 线上教育+付费课程，指标通用性强。</p><p>4  00:00:06,440 --&gt; 00:00:10,610<br>我们称它为 Audacity<br>→ 避免用真实 Udacity 数据，防止泄密。</p><p>5  00:00:10,610 --&gt; 00:00:12,710<br>Audacity 专攻金融课程<br>→ 限定领域：金融类课程，单价高，漏斗长。</p><p>6  00:00:12,710 --&gt; 00:00:15,900<br>他们在试着测试功能 增强学生互动<br>→ 业务目标：提升互动→最终提高完课率/收入。</p><p>7  00:00:15,900 --&gt; 00:00:18,890<br>首先 让我们来谈谈 Audacity 网站典型的用户流程是怎样的<br>→ 准备画“漏斗”。</p><p>8  00:00:18,890 --&gt; 00:00:23,700<br>你可以看到主页的最大用户访问数 → 少量用户查看不同页面 → 更少数创建账户 → 更少完成购买/上课/完课<br>→ 标准四层漏斗：Visit → Explore → Sign-up → Convert/Complete。</p><p>9  00:00:23,700 --&gt; 00:00:27,460<br>这种流程类型通常被称为客户漏斗模型<br>★ 关键词：funnel（漏斗）+ swirl（涡旋，用户来回跳转）。</p><p>10  00:00:27,460 --&gt; 00:00:30,420<br>对网站而言 这是个很常见的概念<br>→ 面试可随口画漏斗，体现“业务抽象能力”。</p><p>11  00:00:30,420 --&gt; 00:00:34,310<br>但这个概念太过简单化了<br>→ 预告：真实用户路径非线性，会跳过/回流。</p><p>12  00:00:34,310 --&gt; 00:00:37,930<br>客户会在不同的状态间来回涡旋 而回访者会跳过中间这些步骤<br>→ 涡旋= 多次访问，状态机比线性漏斗更准确。</p><p>13  00:00:37,930 --&gt; 00:00:41,320<br>我们会在第三课中进一步讨论漏斗和涡旋及其与指标选择的关系<br>→ 预告：指标要“层控”——上层用概率，下层用比率/人均。</p><p>14  00:00:41,320 --&gt; 00:00:45,436<br>而在后面的第一课内容中 我们会从头到尾讲解一个简单的实验<br>→ 承诺：马上跑一遍“小闭环”。</p><p>15  00:00:45,436 --&gt; 00:00:48,480<br>具体来说 我们考虑改变一下“现在开始”这个按钮<br>→ 实验变量：按钮颜色（橙→粉），单因素。</p><p>16  00:00:48,480 --&gt; 00:00:50,150<br>用户点击后会看到课程清单<br>→ 说明：按钮= 漏斗第 1→2 层关键跃迁。</p><p>17  00:00:50,150 --&gt; 00:00:54,640<br>我们假设：颜色改变 → 提高点击 → 提高探索 → 最终提高完课<br>→ 逻辑链：颜色→点击概率→完课，需验证传递性。</p><p>18  00:00:54,640 --&gt; 00:00:57,770<br>也就是 移动至漏斗的第二步<br>→ 指标定位：把“点击概率”当 proximal metric，完课当 distal metric。</p><hr><h3 id="文件-11-度量选择">文件 11  度量选择</h3><p>1  00:00:00,400 --&gt; 00:00:02,620<br>现在我们已经大概了解了想进行的变更 我们需要选择一个指标来测量这个变更<br>→ 标准流程：变→指→设→采→析。</p><p>2  00:00:02,620 --&gt; 00:00:05,180<br>在当前的假设中 我们还没有谈及如何测量改变颜色是否真的是一种改进<br>→ 颜色本身≠改进，必须量化到“可观测指标”。</p><p>3  00:00:05,180 --&gt; 00:00:08,320<br>Audacity 在意的归根究底还是有多少人完成了课程<br>→ ★ 终极指标（goal metric）= 完课数，但周期长。</p><p>4  00:00:08,320 --&gt; 00:00:11,510<br>所以可以选择“完成课程的数量”作为指标 然而学生可能需要几周或几个月<br>→ 问题：反馈慢 → 无法快速迭代；引出“代理指标”需求。</p><p>5  00:00:11,510 --&gt; 00:00:15,100<br>采用这个作为指标的话会耗费太多时间了 不太现实<br>→ 结论：goal metric 不适合做实验 primary metric。</p><p>6  00:00:15,100 --&gt; 00:00:19,798<br>另外一个选择就是“有多少用户实际点击了现在开始按钮”<br>→ 候选 proximal metric：原始点击数。</p><p>7  00:00:19,798 --&gt; 00:00:23,980<br>但如果总访客不同，点击数会失真 → 引出“率”与“概率”之争。<br>→ 给出例子：橙组 1000 访客 100 点击；粉组 800 访客 95 点击——谁赢？</p><p>8  00:00:23,980 --&gt; 00:00:27,940<br>我们可以使用“访客点击页面的比例”即点击次数/主页访问次数 → 点击率（CTR）<br>→ CTR 含重复点击，易受“连点/慢加载”噪音放大。</p><p>9  00:00:27,940 --&gt; 00:00:32,210<br>另一个指标：点击概率 = 至少点击一次的独立访客 / 独立访客<br>→ ★ 官方选定：click-through probability（CTP）= binomial metric，每人最多 1 次成功。</p><p>10  00:00:32,210 --&gt; 00:00:36,620<br>举例：用户 A 点 5 次 → CTR=5，CTP=1；用户 B 0 次 → CTR=0，CTP=0；合计 CTR=2.5，CTP=0.5<br>→ 用数字演示“比率 vs 概率”差异，面试可现场画表。</p><p>11  00:00:36,620 --&gt; 00:00:40,910<br>比率与概率有不同的特点 第三课会进一步讨论<br>→ 预告：CTR 适合 UI 可用性；CTP 适合“渗透/覆盖”型目标。</p><p>12  00:00:40,910 --&gt; 00:00:45,530<br>本课中 我们将使用点击概率作为指标 而不是点击率<br>★ 结论：Primary metric = CTP（binomial），便于后续用二项分布算置信区间。</p><p>13  00:00:45,530 --&gt; 00:00:49,850<br>我们还假设这会最终提高终极业务指标即完成课程的总数<br>→ 需要验证“proxy→goal”传递性，否则可能局部最优但全局无效（后续课会讲“指标链”）。</p><hr><h3 id="文件-12-估计点击概率">文件 12  估计点击概率</h3><p>1  00:00:00,310 --&gt; 00:00:04,129<br>在 Audacity 示例中 我们决定使用点击概率 而不是点击率<br>→ 复习：已拍板 CTP。</p><p>2  00:00:04,129 --&gt; 00:00:08,080<br>一般来说 你想测量网站的可用性就使用比率；你想测量总影响就使用概率<br>★ 金句：Usability → ratio（CTR）；Reach/Impact → probability（CTP）。</p><p>3  00:00:08,080 --&gt; 00:00:11,570<br>举例：按钮易找性 → CTR；只想知道多少人进入二级页面 → CTP<br>→ 给出口诀：重复点击=噪音时用概率。</p><p>4  00:00:11,570 --&gt; 00:00:16,850<br>我们想知道的是用户是否会进入漏斗的第二层 这就是我们选择概率的原因<br>→ 再次确认：目标=“覆盖更多人”，而非“让人点多几次”。</p><p>5  00:00:16,850 --&gt; 00:00:20,980<br>要计算概率 你首先要和工程师合作修改你的网站 确保你能捕捉网页访问中的任何事件<br>→ 工程前提：事件日志必须“访问级”+“点击级”可关联。</p><p>6  00:00:20,980 --&gt; 00:00:25,250<br>当用户点击时 你能捕捉到点击事件<br>→ 关键字段：user_id (或 cookie), page_id, event_type, timestamp。</p><p>7  00:00:25,250 --&gt; 00:00:28,780<br>一旦你获得了数据 要计算“比率”你只需要页面访问总数 &amp; 点击总数 然后相除<br>→ CTR 计算成本最低，SQL 一行：sum(clicks)/sum(impressions)。</p><p>8  00:00:28,780 --&gt; 00:01:16,850<br>但对于概率 你必须将每个页面访问对应上所有的子点击 → 每人最多记 1 次成功<br>→ 需要“访客去重”逻辑：同一访客在实验期内多次访问只算 1 次成功/失败。<br>→ 工程实现：group by visitor_id → boolean max(is_click)。</p><p>9  00:01:16,850 --&gt; 00:01:20,980<br>所以每个页面访问 你最多计算一个子点击<br>→ 强调“binomial”定义：n=独立访客，x=至少点击 1 次的访客。</p><hr><h3 id="文件-13-重复实验">文件 13  重复实验</h3><p>1  00:00:00,380 --&gt; 00:00:03,100<br>让我们来测量“现在开始”这个按钮的点击概率<br>→ 进入“统计推断”环节：点估计 → 区间估计。</p><p>2  00:00:03,100 --&gt; 00:00:08,610<br>Audacity 主页的单独用户为 1000；其中 100 位至少点击了一次 → 点估计 p̂ = 10 %<br>→ 给出数字：n=1000, x=100, p̂=0.10。</p><p>3  00:00:08,610 --&gt; 00:00:15,770<br>但你对这个预测有多确定？——如果再来 1000 访客，结果会多接近 100？<br>→ 引出“抽样波动”概念，为置信区间埋伏笔。</p><p>4  00:00:15,770 --&gt; 00:00:21,320<br>勾选所有让你吃惊的答案：101？110？150？900？<br>→ 互动题：测学员直觉版“置信区间宽度”。</p><p>5  00:00:21,320 --&gt; 00:00:27,560<br>我们之后会讨论如何对其进行量化（标准误差、置信区间）<br>→ 预告：下一步上“二项分布→正态近似→公式”。</p><hr><h3 id="文件-14-重复实验-Solution">文件 14  重复实验 Solution</h3><p>1  00:00:00,420 --&gt; 00:00:03,920<br>我认为新的测量结果会接近 100；900 或 150 会让我吃惊<br>→ 讲师暴露“主观区间”≈ ±50，对应后期 95% 置信约 ±1.96×SE。</p><p>2  00:00:03,920 --&gt; 00:00:11,313<br>110 或 101 比较符合我的预期 → 标准误差会精确描述不同样本之间会有多大区别<br>→ 金句：SE 量化“样本–样本”波动。</p><p>3  00:00:11,313 --&gt; 00:00:18,900<br>之后我们会讨论样本的标准误差 → 它告诉你同规模样本之间会有多大区别<br>→ 再次预告：SE = √(p̂(1−p̂)/n)。</p><hr><h3 id="文件-15-哪个分布？">文件 15  哪个分布？</h3><p>1  00:00:00,460 --&gt; 00:00:03,610<br>接下来讨论“150 次点击是否让人吃惊”背后的数据<br>→ 准备上“二项分布”。</p><p>2  00:00:03,610 --&gt; 00:00:06,220<br>如果你已熟悉二项分布、置信区间和假设检验，可跳过<br>→ 给出快捷键：讲师注释放链接。</p><p>3  00:00:06,220 --&gt; 00:00:09,040<br>Carrie 你怎么知道 150 次点击是否让人吃惊？<br>→ 核心问题：需要概率模型。</p><p>4  00:00:09,040 --&gt; 00:00:12,190<br>数据中经常会有特定的一些分布帮助我们了解数据有可能有多大的变化<br>→ 分布= 抽样波动的“模板”。</p><p>5  00:00:12,190 --&gt; 00:00:15,490<br>像分级的钟形曲线就是正态分布的好例子<br>→ 正态= 连续；点击= 离散→ 需二项。</p><p>6  00:00:15,490 --&gt; 00:00:19,970<br>针对这里的数据我们会使用与二项分布稍微不同的一种分布<br>→ 口误：实际就是二项，不是“不同”。</p><p>7  00:00:19,970 --&gt; 00:00:23,930<br>因为我们的数据不是连续数据 而是有成功有失败<br>→ 离散二元 → 二项分布 Bin(n, p)。</p><p>8  00:00:23,930 --&gt; 00:00:27,480<br>我们可以将点击叫做成功 将没有页面点击称为失败<br>→ 定义：success=1（点击），failure=0（未点击）。</p><p>9  00:00:27,480 --&gt; 00:00:32,049<br>重要的是我们有两种可能的结果 点击或没有点击 而我们要计算的指标是概率<br>→ 再次确认：Binomial 适用条件①二元②独立③同概率。</p><hr><h3 id="文件-16-二项分布">文件 16  二项分布</h3><p>1  00:00:00,350 --&gt; 00:00:02,250<br>假如我们有一个偏倚硬币 翻出正面的概率是 3/4<br>→ 用“硬币”当教具，降低数学恐惧。</p><p>2  00:00:02,250 --&gt; 00:00:06,350<br>这个硬币可以代表“有 3/4 的概率点击按钮的网页访客”<br>→ 把 p=0.75 对应到按钮点击，建立直觉。</p><p>3  00:00:06,350 --&gt; 00:00:09,660<br>我们将成功认作是正面 而失败是背面<br>→ 统一语言：success=点击/正面，failure=未点击/背面。</p><p>4  00:00:09,660 --&gt; 00:00:18,610<br>翻 10 次硬币 → 正面次数 k=0~10；k=7,8 最可能；6–9 都算合理<br>→ 图形化：二项直方图，中心≈np，宽度≈√np(1−p)。</p><p>5  00:00:18,610 --&gt; 00:00:24,900<br>像 Carrie 提及过的 这种分布称为二项分布<br>→ 正式给出名称：Binomial distribution。</p><p>6  00:00:24,900 --&gt; 00:00:27,600<br>我们可以为翻任意次数的硬币绘制此图<br>→ 通用：Bin(n, p) 对任意 n 可画。</p><p>7  00:00:27,600 --&gt; 00:00:29,480<br>当你增加 n 的时候 二项分布会越来越像正态分布<br>★ 中心极限定理（CLT）雏形：n→∞ 时 Bin≈N(np, np(1−p))。</p><p>8  00:00:29,480 --&gt; 00:00:33,400<br>这里二项分布的 n 为 30 而正态分布用蓝色表示<br>→ 图示：n≥30 近似已很好（常用 rule of thumb）。</p><p>9  00:00:33,400 --&gt; 00:00:35,970<br>均值相同 都等于 p<br>→ 均值 μ = np（次数）或 p（比例）。</p><p>10  00:00:35,970 --&gt; 00:00:39,010<br>标准偏差为 √[p(1−p)/n]  （这里已换成“比例”口径）<br>★ 必背公式：SE(p̂) = √(p̂(1−p̂)/n)。</p><p>11  00:00:39,010 --&gt; 00:00:43,300<br>例子：n=20, x=16 → p̂ = 16/20 = 0.8<br>→ 给出数字练习，代入公式。</p><p>12  00:00:43,300 --&gt; 00:00:47,830<br>要估计硬币偏倚 → p̂ = x/n = 最大似然估计（MLE）。<br>→ 无贝叶斯先验时，默认用 MLE。</p><p>13  00:00:47,830 --&gt; 00:00:51,110<br>当然 这也可能就是一个公平硬币 刚好翻出正面多过背面<br>→ 强调：点估计≠真实参数，需区间/假设检验。</p><p>14  00:00:51,110 --&gt; 00:00:54,750<br>但根据结果来看 硬币很可能是偏倚性的<br>→ 口语版“似然思想”。</p><p>15  00:00:54,750 --&gt; 00:00:58,700<br>二项分布三个假设：①二元结果 ②事件独立 ③同概率<br>★ 必背 checklist：用 binomial 前先验证这三条。</p><p>16  00:00:58,700 --&gt; 00:01:02,420<br>实践中要确认事件是否独立有时候比较棘手<br>→ 提前预警：真实场景常 violated（网络搜索、购物车）。</p><p>17  00:01:02,420 --&gt; 00:01:05,920<br>例子 1：洗好的 52 张牌抽 20 次 → 不是独立（无放回）<br>→ 无放回→超几何分布；若牌堆无限大可近似二项。</p><p>18  00:01:05,920 --&gt; 00:01:10,400<br>例子 2：掷骰子 50 次 → 独立，满足二项。<br>→ 经典正面教材。</p><p>19  00:01:10,400 --&gt; 00:01:16,630<br>例子 3：搜索引擎连续两次搜索 → 不独立（用户改词再搜）<br>→ 同一用户 session 内事件常相关→ 需“用户级去重”或“session 合并”。</p><p>20  00:01:16,630 --&gt; 00:01:21,850<br>例子 4：优达学城学生完课 → 近似独立（全球学生多，小概率重复账号）<br>→ 给出“可接受近似”场景。</p><p>21  00:01:21,850 --&gt; 00:01:26,590<br>例子 5：亚马逊购物车→ 不独立（同一用户多商品一起结账）<br>→ 事件级=SKU，但用户行为聚合→ 需“订单级”或“用户级”才能二项。</p><p>22  00:01:26,590 --&gt; 00:01:28,710<br>标准偏差为 √[p(1−p)/n]  （比例形式）<br>→ 再次重复 SE 公式，强化记忆。</p><p>23  00:01:28,710 --&gt; 00:01:33,400<br>当前情况下我们假设已知硬币翻出正面的概率；现在考虑：如果我们不知道这个概率<br>→ 过渡：从“已知 p”→“估计 p”，为置信区间铺垫。</p><p>24  00:01:33,400 --&gt; 00:01:35,970<br>我们翻了 20 次硬币 其中十六次翻出正面 → p̂ = 16/20 = 0.8<br>→ 数字例子，后续算 CI 时用。</p><p>25  00:01:35,970 --&gt; 00:01:39,010<br>要估计这个偏倚性 → p̂ = x/n = MLE<br>→ 再次强调 MLE 无偏且相合。</p><p>26  00:01:39,010 --&gt; 00:01:43,300<br>我们得到结果五分之四 → 最佳估计是该硬币翻出正面的概率是 0.8<br>→ 口语化“最佳估计”= 点估计。</p><p>27  00:01:43,300 --&gt; 00:01:47,830<br>如果你想更具体地了解不同参数的二项分布会是什么样的 讲师注释中的页面链接可能会有所帮助<br>→ 给出互动可视化链接（通常是被屏蔽的 Khan 或 Wolfram）。</p><p>28  00:01:47,830 --&gt; 00:01:51,110<br>在使用二项分布时 必须使用一些假设<br>→ 进入“假设验证”清单。</p><p>29  00:01:51,110 --&gt; 00:01:54,750<br>第一 必须有两个不同的结果 我们称之为成功与失败<br>→ 条件①二元：pass/fail, click/no-click。</p><p>30  00:01:54,750 --&gt; 00:01:59,390<br>第二 事件必须是独立的 知道了某一次翻硬币的结果也不会知道下一次翻硬币结果是什么<br>→ 条件②独立：用户级随机化最易满足；事件级常 violated。</p><p>31  00:01:59,390 --&gt; 00:02:02,870<br>第三 事件要遵循同一种分布 也就是说每一次翻硬币的成功概率必须是一致的<br>→ 条件③同概率：实验期间 p 恒定→ 排除“星期效应”“投放时段差异”等。</p><p>32  00:02:02,870 --&gt; 00:02:05,040<br>在实践中要确认事件是否是独立的 有时候可能比较棘手<br>→ 再次预警：真实世界≠理想硬币。</p><p>33  00:02:05,040 --&gt; 00:02:07,700<br>所以让我们来看看一些例子<br>→ 准备用 5 个案例让学员勾选“是否独立”。</p><p>34  00:02:07,700 --&gt; 00:02:10,400<br>这里二项分布的 n 为 30 而正态分布用蓝色表示<br>→ 图示：n≥30 可正态近似，方便后面用 z-test。</p><p>35  00:02:10,400 --&gt; 00:02:13,770<br>二项分布以及与其类似的正态分布 均值相同 都等于 p<br>→ 均值 μ = np（次数）或 p（比例）。</p><p>36  00:02:13,770 --&gt; 00:02:16,630<br>标准偏差为 √[p(1−p)/n]<br>→ 第三次重复 SE 公式，确保背下。</p><hr><h3 id="文件-17-二项分布-Solution">文件 17  二项分布 Solution</h3><p>1  00:00:00,370 --&gt; 00:00:02,400<br>洗好的纸牌不是独立的<br>→ 解析 ①：无放回 → 概率随抽牌变化 → 超几何。</p><p>2  00:00:02,400 --&gt; 00:00:06,330<br>由于每一张牌在一副牌中只出现一次 你每抽取一张牌 它会提供一些关于下一张牌的信息<br>→ 条件概率：P(黑|已抽 5 黑) ≠ P(黑|初始)。</p><p>3  00:00:06,330 --&gt; 00:00:08,570<br>如果第一张牌是黑色的 那第二张牌是黑色的可能性会更小<br>→ 直观解释负相关。</p><p>4  00:00:08,570 --&gt; 00:00:10,400<br>如果你的一副牌无限大 这个就不是问题<br>→ 无限牌堆→放回抽样→二项成立；有限牌堆→超几何。</p><p>5  00:00:10,400 --&gt; 00:00:13,410<br>掷骰子是独立的 → 成功的概率是 1/6 ≠ 0.5 但二项分布不要求 p=0.5<br>→ 澄清：p 可为任意值，只要恒定。</p><p>6  00:00:13,410 --&gt; 00:00:16,300<br>每掷一次骰子都不会影响下一次掷骰子的结果<br>→ 经典独立案例。</p><p>7  00:00:16,300 --&gt; 00:00:19,410<br>搜索引擎这个不是独立的 → 如果有的人第一次没找到想要的内容 他们会立刻用稍微有点不同的词再搜索一次<br>→ 同一用户连续搜索→事件相关→ 违反②。</p><p>8  00:00:19,410 --&gt; 00:00:22,570<br>教育公司这个例子“近似独立”→ 每个学生对应一个事件 而不是多个 且学生遍布全球<br>→ 给出“可接受偏差”思路：现实中只要偏差&lt;&lt;效应量即可。</p><p>9  00:00:22,570 --&gt; 00:01:25,060<br>购物车的案例不是独立的 → 一个人可能往购物车加入多个物品然后一起购买 → 不同事件的结果之间高度关联<br>→ 提示：需把“事件粒度”提升到“订单”或“用户”才能近似二项。</p><p>10  00:01:25,060 --&gt; 00:01:28,020<br>小结：判断是否二项前 先问“事件是否独立/同概率”→ 不满足就换模型或提升粒度<br>→ 通用解题思路：模型 violated → 升/降粒度 or 换分布。</p><h3 id="文件-18-置信区间">文件 18  置信区间</h3><p>1  00:00:00,300 --&gt; 00:00:04,290<br>好了 我们预计点击概率会遵循二项分布<br>→ 承上启下：已确定用 Binomial 模型。</p><p>2  00:00:04,290 --&gt; 00:00:07,860<br>那如何利用这个来确定哪些值是让我们吃惊的值？<br>→ 引出“区间 + 显著性”需求。</p><p>3  00:00:07,860 --&gt; 00:00:11,220<br>当你知道它遵循二项分布之后 一个好处就是我们可以使用样本二项分布的标准误差的公式<br>★ 关键：模型已知 → 可用 SE 公式量化波动。</p><p>4  00:00:11,220 --&gt; 00:00:15,770<br>来估计点击的整体概率会有多大变化<br>→ SE 描述“样本–样本”波动，即抽样误差。</p><p>5  00:00:15,770 --&gt; 00:00:20,730<br>意思是 如果置信区间为 95%<br>→ 首次给出 95% 水平，后续所有实验沿用。</p><p>6  00:00:20,730 --&gt; 00:00:23,970<br>置信区间也是会经常听到的词 理论上如果我们不断地重复实验 我们在样本均值附近建立的区间会有 95% 的几率涵盖真正的值<br>★ 正式定义：95% CI = 重复抽样下 95% 区间包含真实参数。</p><p>7  00:00:23,970 --&gt; 00:00:38,060<br>→ 面试可背：CI 不是“参数落进区间的概率”，而是“区间捕捉参数的概率”。</p><h3 id="文件-19-计算置信区间">文件 19  计算置信区间</h3><p>1  00:00:00,380 --&gt; 00:00:03,680<br>现在让我们来看看如何计算样本的置信区间<br>→ 进入“手撕公式”环节。</p><p>2  00:00:03,680 --&gt; 00:00:05,810<br>我们已经找到了区间的中心：点击的概率 p̂ = X / N<br>→ 中心 = 点估计 MLE。</p><p>3  00:00:05,810 --&gt; 00:00:11,901<br>这里 X 是指点击的用户数量；N 是访问页面的用户总数量<br>→ 给出符号：X=success，N=sample size。</p><p>4  00:00:11,901 --&gt; 00:00:17,425<br>在这里 p̂ 是 100 / 1000 = 0.1<br>→ 数字例子：n=1000, x=100, p̂=0.10。</p><p>5  00:00:17,425 --&gt; 00:00:22,778<br>所以置信区间的中心应为 0.1<br>→ 中心固定，下一步算“宽度”。</p><p>6  00:00:22,778 --&gt; 00:00:26,500<br>然后我需要计算置信区间的宽度 也称为误差幅度 margin = m<br>★ 术语：margin of error (m) = 半宽。</p><p>7  00:00:26,500 --&gt; 00:00:29,870<br>为此我需要使用二项分布的标准误差<br>→ SE 是构造 m 的核心。</p><p>8  00:00:29,870 --&gt; 00:00:33,900<br>如果样本规模够大 可以不使用二项分布 我假设分布是正态的<br>→ 正态近似条件：np̂≥5 且 n(1−p̂)≥5（后续课放宽到≥10）。</p><p>9  00:00:33,900 --&gt; 00:00:37,720<br>这里 N × p̂ = 100 ≥ 5 → 合理<br>→ 现场验证条件满足。</p><p>10  00:00:37,720 --&gt; 00:00:40,240<br>置信区间的宽度 = z × SE<br>→ 公式：m = z_(1−α/2) × SE。</p><p>11  00:00:40,240 --&gt; 00:00:45,750<br>SE = √[p̂(1−p̂)/N]<br>★ 必背：Binomial SE（比例形式）。</p><p>12  00:00:45,750 --&gt; 00:00:49,050<br>成功概率离 0.5 越远 标准误差会越小 → 分布更紧凑 → 置信区间更小<br>→ 重要洞察：p̂ 接近 0 或 1 时，同样 n 下区间变窄。</p><p>13  00:00:49,050 --&gt; 00:00:53,570<br>样本数量越大 标准误差与置信区间则越小<br>→ 另一洞察：m ∝ 1/√n，想减半区间需 4×样本。</p><p>14  00:00:53,570 --&gt; 00:00:57,150<br>现在我需要寻求 95% 置信区间 边界的 z 值<br>→ z=1.96（双尾 2.5%→97.5% 分位）。</p><p>15  00:00:57,150 --&gt; 00:02:02,116<br>1.96 这个值称为 z 分数 我们可以在表格中查询<br>→ 现场查表→得 1.96。</p><p>16  00:02:02,116 --&gt; 00:02:09,479<br>代入：m = 1.96 × √[0.1×0.9/1000] ≈ 0.019<br>→ 手算：SE≈0.00949，m≈0.0186→取 0.019。</p><p>17  00:02:09,479 --&gt; 00:02:14,310<br>上限 = 0.1 + 0.019 = 0.119；下限 = 0.1 − 0.019 = 0.081<br>→ 95% CI：[8.1%, 11.9%]。</p><p>18  00:02:14,310 --&gt; 00:02:18,578<br>也就是说你继续对几千次页面访问进行实验 你可以预估每一千次访问中点击在 80 至 120 次之间<br>→ 把比例转回“每千次点击”便于业务理解。</p><p>19  00:02:18,578 --&gt; 00:02:24,120<br>超过或低于这个值都是让人吃惊的数字<br>→ 定义“吃惊”= 落在 CI 外 → 后续直接对应 p-value&lt;0.05。</p><p>20  00:02:24,120 → 00:02:30,613<br>留作业：n=2000, x=300, 求 99% CI → 让学员手算一遍固化公式。<br>→ 99% z=2.58；p̂=0.15；SE=√(0.15×0.85/2000)=0.0079；m=0.0204 → CI[0.129, 0.171]。</p><h3 id="文件-20-计算置信区间-Solution">文件 20  计算置信区间 Solution</h3><p>1  00:00:00,340 --&gt; 00:00:03,260<br>要计算置信区间 首先我要预估成功的概率 即点估计<br>→ 步骤①：p̂ = 300 / 2000 = 0.150。</p><p>2  00:00:03,260 --&gt; 00:00:07,590<br>→ 步骤②：99% 双尾 z=2.58（查表）。</p><p>3  00:00:07,590 --&gt; 00:00:11,967<br>SE = √[0.15×0.85/2000] ≈ 0.0079<br>→ 步骤③：代公式。</p><p>4  00:00:11,967 --&gt; 00:00:18,390<br>m = 2.58 × 0.0079 ≈ 0.021<br>→ 步骤④：得误差幅度。</p><p>5  00:00:18,390 --&gt; 00:00:25,230<br>上限 = 0.15 + 0.021 = 0.171；下限 = 0.15 − 0.021 = 0.129<br>→ 步骤⑤：写区间 [12.9%, 17.1%]。</p><p>6  00:00:25,230 --&gt; 00:00:30,613<br>★ 结论：99% 置信下，真实点击概率落在 12.9%–17.1%；若对照组区间与此无重叠→可认为差异显著。</p><h3 id="文件-21-建立统计显著性">文件 21  建立统计显著性</h3><p>1  00:00:00,340 --&gt; 00:00:02,930<br>现在我们已经预估了“现在开始”按钮的点击概率 但是我们还没有真正地变更按钮<br>→ 过渡：从“估计”到“比较”。</p><p>2  00:00:02,930 --&gt; 00:00:06,420<br>在变更之后我们会运行实验 我们要如何分析结果呢？<br>→ 引出“假设检验”流程。</p><p>3  00:00:06,420 --&gt; 00:00:10,420<br>在统计学中有个概念叫假设检验或推断 它能以量化的方式确定你的结果发生的概率<br>★ 定义：假设检验 = 量化“结果是否偶然”。</p><p>4  00:00:10,420 --&gt; 00:00:14,430<br>首先我们需要一个零假设 或者说基准<br>→ 标准流程：H₀ 先立。</p><p>5  00:00:14,430 --&gt; 00:00:20,310<br>在这里也就是对照组和实验组之间的点击概率没有区别<br>→ H₀：Pexp = Pcont（或差值=0）。</p><p>6  00:00:20,310 --&gt; 00:00:24,140<br>然后我们需要考虑备择假设 我们感兴趣的是点击概率是否不同？更高？更低？任何区别？<br>→ 选双尾 or 单尾 → 影响后续 z 临界值。</p><p>7  00:00:24,140 → 00:02:24,120<br>留互动：付款流程实验，让学员写 H₀ 与 HA → 强化“写假设”是第一步。</p><h3 id="文件-22-零假设和对立假设">文件 22  零假设和对立假设</h3><p>1  00:00:00,320 --&gt; 00:00:03,250<br>要使用假设检验 确保结果具有统计显著性 你需要计算结果是偶然出现的可能性<br>→ 显著性核心：P(数据│H₀) 足够小 → 拒绝 H₀。</p><p>2  00:00:03,250 --&gt; 00:00:08,320<br>要计算这个概率 你需要先假设“如果实验没有效果 结果会是怎样”<br>→ 再次强调：先设“无效世界”基准。</p><p>3  00:00:08,320 --&gt; 00:00:12,200<br>在 Audacity 的例子中 我们采集了两个样本 对照组使用橙色按钮 实验组使用粉色按钮<br>→ 两组独立样本，比例之差检验。</p><p>4  00:00:12,200 --&gt; 00:00:17,650<br>我们假设每组都遵循二项分布 但是两组的概率可能会不同<br>→ 模型：Xcont~Bin(ncont, Pcont)；Xexp~Bin(nexp, Pexp)。</p><p>5  00:00:17,650 --&gt; 00:00:22,570<br>如果变更按钮颜色没有效果 这样两组的分布相同 → Pexp = Pcont → 差值=0<br>★ H₀：Pexp − Pcont = 0。</p><p>6  00:00:22,570 --&gt; 00:00:26,510<br>如果实验有效 → 备择假设 HA：Pexp − Pcont ≠ 0（双尾）<br>→ 课程默认双尾，α=0.05，z=±1.96。</p><p>7  00:00:26,510 --&gt; 00:00:31,730<br>流程：采集数据 → 计算 p̂exp, p̂cont → 差值 → 计算在 H₀ 下出现该差值或更极端的概率（p-value）→ 若 &lt;0.05 排除 H₀<br>→ 与置信区间等价：95% CI 不包含 0 ↔ p&lt;0.05。</p><h3 id="文件-23-零假设和对立假设-Solution">文件 23  零假设和对立假设 Solution</h3><p>1  00:00:00,480 --&gt; 00:00:04,260<br>我选择的零假设是两组人完成付款的概率相同<br>→ 示范：H₀：Ppay,exp = Ppay,cont。</p><p>2  00:00:04,260 --&gt; 00:00:07,930<br>备择假设是两组人完成付款的概率不同 → HA：Ppay,exp ≠ Ppay,cont<br>→ 双尾写法，差值≠0。</p><p>3  00:00:07,930 --&gt; 00:00:11,480<br>即 Pexp − Pcont = 0 vs ≠ 0<br>→ 一句话模板，任何比例差检验都能照抄。</p><p>4  00:00:11,480 --&gt; 00:00:18,630<br>强调：写假设时只谈参数（总体概率），不谈样本统计量<br>→ 避免新手错把“样本差=0”当 H₀。</p><h3 id="24-比较两个样本">24 - 比较两个样本</h3><p>1 00:00:00,410 --&gt; 00:00:02,200<br>现在我们已经设立了假设检验</p><p>2 00:00:02,200 --&gt; 00:00:04,620<br>我们如何决定是否要拒绝零假设？</p><p>3 00:00:04,620 --&gt; 00:00:07,440<br>我们需要从一个稍微不同的角度</p><p>4 00:00:07,440 --&gt; 00:00:08,500<br>来看看置信区间</p><p>5 00:00:08,500 --&gt; 00:00:11,610<br>要记得 在这个案例中 我们有两组样本</p><p>6 00:00:11,610 --&gt; 00:00:12,910<br>一组是对照组</p><p>7 00:00:12,910 --&gt; 00:00:16,100<br>一组是实验组 两者的用户数量可能会不同</p><p>8 00:00:16,100 --&gt; 00:00:21,030<br>我们需要做的就是将预计的对照组点击比率</p><p>9 00:00:21,030 --&gt; 00:00:24,130<br>与实验组的比率进行对比</p><p>10 00:00:24,130 --&gt; 00:00:27,730<br>量化任务会告诉我们 我们得到的结果</p><p>11 00:00:27,730 --&gt; 00:00:31,440<br>即观察到的区别 是否是偶然出现的</p><p>12 00:00:31,440 --&gt; 00:00:34,920<br>或者如果两组结果完全一致 是否非常不可能出现这种区别</p><h3 id="25-合并标准误差">25 - 合并标准误差</h3><p>1<br>00:00:00,380 --&gt; 00:00:02,120<br>因为我们有两组样本</p><p>2<br>00:00:02,120 --&gt; 00:00:05,840<br>我们需要选择一个标准误差 方面我们进行对比</p><p>3<br>00:00:05,840 --&gt; 00:00:08,510<br>最简单的方法就是计算</p><p>4<br>00:00:08,510 --&gt; 00:00:09,790<br>合并标准误差</p><p>5<br>00:00:09,790 --&gt; 00:00:12,440<br>我们会测量每一组中进行了点击的用户数</p><p>6<br>00:00:12,440 --&gt; 00:00:16,379<br>我们称之为 Xcont 和 Xexp</p><p>7<br>00:00:16,379 --&gt; 00:00:20,510<br>以及每一组的总用户数 称为 Ncont 与 Nexp</p><p>8<br>00:00:20,510 --&gt; 00:00:23,430<br>现在 我们要做的第一件事是计算</p><p>9<br>00:00:23,430 --&gt; 00:00:25,040<br>合并点击概率</p><p>10<br>00:00:25,040 --&gt; 00:00:28,010<br>这里我用 p? 因为这是预计的概率</p><p>11<br>00:00:28,010 --&gt; 00:00:31,760<br>合并概率是整个组的</p><p>12<br>00:00:31,760 --&gt; 00:00:33,270<br>点击概率 即</p><p>13<br>00:00:33,270 --&gt; 00:00:37,247<br>进行过点击的用户总数除以用户总数</p><p>14<br>00:00:37,247 --&gt; 00:00:41,250<br>然后我们计算合并标准误差 通过这个公式计算</p><p>15<br>00:00:41,250 --&gt; 00:00:45,160<br>现在 我们要预计 P?exp 与 P?cont</p><p>16<br>00:00:45,160 --&gt; 00:00:48,950<br>之间的差额 这个差额我称为 D?</p><p>17<br>00:00:48,950 --&gt; 00:00:53,840<br>在零假设中 真正的差额 d 等于零</p><p>18<br>00:00:53,840 --&gt; 00:00:59,390<br>所以我们可以预计 d? 应该为正态分布</p><p>19<br>00:00:59,390 --&gt; 00:01:03,990<br>而均值为 0 标准偏差为合并标准误差</p><p>20<br>00:01:03,990 --&gt; 00:01:08,250<br>如果预计中 d? 大于 1.96 我们的 z 分数</p><p>21<br>00:01:08,250 --&gt; 00:01:12,220<br>乘以合并标准误差 或小于这个临界值的负值</p><p>22<br>00:01:12,220 --&gt; 00:01:15,220<br>我们可以拒绝零假设</p><p>23<br>00:01:15,220 --&gt; 00:01:18,390<br>认为我们的差别具有统计显著性</p><h3 id="26-实用或实质性显著性">26 - 实用或实质性显著性</h3><p>1<br>00:00:00,145 --&gt; 00:00:02,319<br>好了 我们现在能够使用假设检验确定</p><p>2<br>00:00:02,319 --&gt; 00:00:06,235<br>确定实验中观察到的差异是否具有统计显著性</p><p>3<br>00:00:06,235 --&gt; 00:00:07,315<br>那接下来呢？</p><p>4<br>00:00:07,315 --&gt; 00:00:11,233<br>我们接下来需要从商业角度来决定</p><p>5<br>00:00:11,233 --&gt; 00:00:15,108<br>怎样的点击概率变化具有实际显著性</p><p>6<br>00:00:15,108 --&gt; 00:00:17,208<br>也就是说 变更对我们来说有多重要</p><p>7<br>00:00:17,208 --&gt; 00:00:19,027<br>作为统计学家来讲</p><p>8<br>00:00:19,027 --&gt; 00:00:22,618<br>这是统计显著性以外的实质性</p><p>9<br>00:00:22,618 --&gt; 00:00:24,904<br>这就是工程师与统计学家</p><p>10<br>00:00:24,904 --&gt; 00:00:26,001<br>的不同说法了</p><p>11<br>00:00:26,001 --&gt; 00:00:29,820<br>实质性与实际显著性其实是指一样的东西</p><p>12<br>00:00:29,820 --&gt; 00:00:30,609<br>好的</p><p>13<br>00:00:30,609 --&gt; 00:00:34,018<br>为什么我们不认为在商业上所有变更都比较重要？</p><p>14<br>00:00:34,018 --&gt; 00:00:36,968<br>我们不能进行任何能够造成差别的实验么？</p><p>15<br>00:00:36,968 --&gt; 00:00:40,538<br>你可以 但是你可能不想这么做 这有多个原因</p><p>16<br>00:00:40,538 --&gt; 00:00:43,746<br>首先 变更本身可能是需要投资的</p><p>17<br>00:00:43,746 --&gt; 00:00:47,067<br>可能你觉得并不值得 或者说你想要等下一次变更</p><p>18<br>00:00:47,067 --&gt; 00:00:50,885<br>觉得这里变更会不错 但是那样做会更好</p><p>19<br>00:00:50,885 --&gt; 00:00:52,386<br>比如在医学方面</p><p>20<br>00:00:52,386 --&gt; 00:00:54,835<br>你必须清楚知道变更是否值得</p><p>21<br>00:00:54,835 --&gt; 00:00:58,940<br>如果你在测试一种新药 可能病人的反应会稍微好一点</p><p>22<br>00:00:58,940 --&gt; 00:01:01,738<br>但你必须要投资用来培训护士</p><p>23<br>00:01:01,738 --&gt; 00:01:03,372<br>才能实际推出这种药</p><p>24<br>00:01:03,372 --&gt; 00:01:04,370<br>诸如此类的</p><p>25<br>00:01:04,370 --&gt; 00:01:07,971<br>所以你可能需要更高的实际显著性</p><p>26<br>00:01:07,971 --&gt; 00:01:09,751<br>才变更治疗方案</p><p>27<br>00:01:09,751 --&gt; 00:01:12,715<br>这个也是网络世界和传统科学</p><p>28<br>00:01:12,715 --&gt; 00:01:14,873<br>之间的重大差异之一 对吧？</p><p>29<br>00:01:14,873 --&gt; 00:01:18,251<br>在医学中 5%、10%</p><p>30<br>00:01:18,251 --&gt; 00:01:21,093<br>15% 的变更才是实质性的</p><p>31<br>00:01:21,093 --&gt; 00:01:22,966<br>对吧？ 但是比如说 在 Google</p><p>32<br>00:01:22,966 --&gt; 00:01:27,520<br>点击概率里的1%或者2%的改变就已经很大了</p><p>33<br>00:01:27,520 --&gt; 00:01:29,786<br>所以被认为具有实际显著性的差异</p><p>34<br>00:01:29,786 --&gt; 00:01:33,002<br>也是非常不同的</p><p>35<br>00:01:33,002 --&gt; 00:01:36,500<br>是的 所以你真正关注的应该是可重复性</p><p>36<br>00:01:36,500 --&gt; 00:01:39,110<br>统计显著性讨论的就是可重复性</p><p>37<br>00:01:39,110 --&gt; 00:01:42,180<br>所以在你设置实验时 你想要确保</p><p>38<br>00:01:42,180 --&gt; 00:01:44,483<br>对的 这些结果是可重复的</p><p>39<br>00:01:44,483 --&gt; 00:01:46,085<br>那它就具有统计显著性</p><p>40<br>00:01:46,085 --&gt; 00:01:49,586<br>但你还需要确认从商业角度来说</p><p>41<br>00:01:49,586 --&gt; 00:01:52,145<br>你在实验中也看到了你感兴趣的改变</p><p>42<br>00:01:52,145 --&gt; 00:01:55,728<br>它就具有实际显著性 也具有统计显著性</p><p>43<br>00:01:55,728 --&gt; 00:01:59,613<br>所以你要恰当地设计实验的规模</p><p>44<br>00:01:59,613 --&gt; 00:02:03,393<br>确保统计显著性条柱低于实际显著性条柱</p><p>45<br>00:02:03,393 --&gt; 00:02:04,205<br>有道理</p><p>46<br>00:02:04,205 --&gt; 00:02:05,781<br>那在 Audacity 的例子中</p><p>47<br>00:02:05,781 --&gt; 00:02:08,365<br>我们仍需要选一个实际显著性的边界</p><p>48<br>00:02:08,365 --&gt; 00:02:09,073<br>对的</p><p>49<br>00:02:09,073 --&gt; 00:02:12,164<br>比如说 从商业角度来说</p><p>50<br>00:02:12,164 --&gt; 00:02:16,950<br>2%的点击概率改变就具有实际显著性</p><h3 id="27-权衡样本容量及功效">27 - 权衡样本容量及功效</h3><p>1<br>00:00:00,370 --&gt; 00:00:04,350<br>好了 现在我们已经了解了如何计算合并标准误差以及置信区间</p><p>2<br>00:00:04,350 --&gt; 00:00:06,120<br>是不是可以开始进行实验了？</p><p>3<br>00:00:06,120 --&gt; 00:00:07,500<br>其实还没有</p><p>4<br>00:00:07,500 --&gt; 00:00:10,250<br>我们首先要设计实验</p><p>5<br>00:00:10,250 --&gt; 00:00:12,840<br>现在我们需要决定的一个主要问题是</p><p>6<br>00:00:12,840 --&gt; 00:00:16,059<br>鉴于我们可以控制对照组和实验组的网页浏览量</p><p>7<br>00:00:16,059 --&gt; 00:00:19,940<br>我们必须要确定 为获取统计显著性的结果</p><p>8<br>00:00:19,940 --&gt; 00:00:23,020<br>最能获取统计显著性的结果</p><p>9<br>00:00:23,020 --&gt; 00:00:25,180<br>这称为统计功效</p><p>10<br>00:00:25,180 --&gt; 00:00:28,240<br>关键在于如果我们发现任何有意思的东西</p><p>11<br>00:00:28,240 --&gt; 00:00:32,509<br>我们需要确保足够的功效</p><p>12<br>00:00:32,509 --&gt; 00:00:35,640<br>从而得到高概率的结果 也就是具有统计显著性</p><p>13<br>00:00:36,920 --&gt; 00:00:41,106<br>请谨记 功效与规模</p><p>14<br>00:00:41,106 --&gt; 00:00:41,810<br>呈负面关系</p><p>15<br>00:00:41,810 --&gt; 00:00:45,320<br>你想要探测的改变越小</p><p>16<br>00:00:45,320 --&gt; 00:00:47,880<br>或者是你想要的结果置信度越高</p><p>17<br>00:00:47,880 --&gt; 00:00:51,060<br>你需要运行的实验规模就越大 也就是对照组和实验组需要更多的网页浏览量</p><h3 id="28－页面浏览数如何影响敏感性">28－页面浏览数如何影响敏感性</h3><p>1<br>00:00:00,390 --&gt; 00:00:03,660<br>像 Diane 所说的 在进行实验之前</p><p>2<br>00:00:03,660 --&gt; 00:00:07,060<br>你需要决定采集多少页面浏览量 以得出结论</p><p>3<br>00:00:07,060 --&gt; 00:00:09,900<br>首先来看看你增加样本量时</p><p>4<br>00:00:09,900 --&gt; 00:00:11,190<br>分布会有什么变化</p><p>5<br>00:00:11,190 --&gt; 00:00:14,040<br>如果你采集 1000 个样本 结果就会是这样的</p><p>6<br>00:00:14,040 --&gt; 00:00:18,200<br>两组之间没有真正的差异</p><p>7<br>00:00:18,200 --&gt; 00:00:19,950<br>这是为什么均值等于零的原因</p><p>8<br>00:00:19,950 --&gt; 00:00:23,398<br>如果你测量发现值比这个低 或者比这个高</p><p>9<br>00:00:23,398 --&gt; 00:00:27,260<br>你会拒绝零假设 然后得出结论两者间有差异</p><p>10<br>00:00:27,260 --&gt; 00:00:30,560<br>所以你错误地得出两者间有差异的概率</p><p>11<br>00:00:30,560 --&gt; 00:00:34,076<br>称为 α 为 0.05</p><p>12<br>00:00:34,076 --&gt; 00:00:38,810<br>如果你增加样本量 比如 5000 标准误差会减小</p><p>13<br>00:00:38,810 --&gt; 00:00:42,700<br>结果的分布看上去更窄</p><p>14<br>00:00:42,700 --&gt; 00:00:45,270<br>要保持同样的 α 值</p><p>15<br>00:00:45,270 --&gt; 00:00:47,310<br>就意味着拒绝零假设的临界值接近零</p><p>16<br>00:00:47,310 --&gt; 00:00:50,890<br>如果你决定只采集 1000 的页面浏览量</p><p>17<br>00:00:50,890 --&gt; 00:00:53,330<br>这样你可以更快地得出结论</p><p>18<br>00:00:53,330 --&gt; 00:00:56,910<br>如果没有真正的差异 结果的分布是这样的</p><p>19<br>00:00:56,910 --&gt; 00:00:59,332<br>我们可以看到 α 等于 0.05</p><p>20<br>00:00:59,332 --&gt; 00:01:02,700<br>现在让我们来考虑下如果两者间有差异</p><p>21<br>00:01:02,700 --&gt; 00:01:05,900<br>明确来说 这个差异等于实际显著性</p><p>22<br>00:01:05,900 --&gt; 00:01:06,960<br>为 0.02</p><p>23<br>00:01:06,960 --&gt; 00:01:09,590<br>你不能拒绝零假设</p><p>24<br>00:01:09,590 --&gt; 00:01:13,180<br>然后得出结论 认为没有显著的差异</p><p>25<br>00:01:13,180 --&gt; 00:01:16,100<br>零假设实际上是错误的 然而却没有拒绝零假设的概率</p><p>26<br>00:01:16,100 --&gt; 00:01:21,480<br>称为 β 这个值很高</p><p>27<br>00:01:21,480 --&gt; 00:01:23,050<br>就算是真的有差异</p><p>28<br>00:01:23,050 --&gt; 00:01:25,830<br>很可能也落在这个范围里</p><p>29<br>00:01:25,830 --&gt; 00:01:29,210<br>所以收集少量样本的话 α 比较低</p><p>30<br>00:01:29,210 --&gt; 00:01:32,410<br>也就是说你不太可能进行一个较差的实验</p><p>31<br>00:01:32,410 --&gt; 00:01:37,030<br>但是 β 比较高 也就是说很大几率上</p><p>32<br>00:01:37,030 --&gt; 00:01:39,520<br>你会无法在实验中得到你想要的差异结果</p><p>33<br>00:01:39,520 --&gt; 00:01:42,850<br>β 或者说得到错误结论的概率</p><p>34<br>00:01:42,850 --&gt; 00:01:46,010<br>取决于你的效应有多大</p><p>35<br>00:01:46,010 --&gt; 00:01:49,360<br>对良态的分布例如正态分布来说</p><p>36<br>00:01:49,360 --&gt; 00:01:53,950<br>当变化越来越大 β 会变小</p><p>37<br>00:01:53,950 --&gt; 00:01:57,870<br>所以一般 β 是在实际显著性边界内</p><p>38<br>00:01:57,870 --&gt; 00:02:00,600<br>因为你不在意更小的变化</p><p>39<br>00:02:00,600 --&gt; 00:02:04,720<br>而变化越大 β 值越小 即误差的几率越小</p><p>40<br>00:02:04,720 --&gt; 00:02:09,080<br>大家通常将 1 减去 β 视为实验的敏感性</p><p>41<br>00:02:09,080 --&gt; 00:02:12,600<br>一般说来 在实际显著性界线内</p><p>42<br>00:02:12,600 --&gt; 00:02:14,660<br>你希望实验具有较高的敏感性</p><p>43<br>00:02:14,660 --&gt; 00:02:16,310<br>大家一般选择 80%</p><p>44<br>00:02:16,310 --&gt; 00:02:20,490<br>好了 现在来看看如果采集 5000 个样本 会是什么结果</p><p>45<br>00:02:20,490 --&gt; 00:02:22,830<br>两个分布都更加紧密了</p><p>46<br>00:02:22,830 --&gt; 00:02:25,250<br>α 与之前一样 没有变化</p><p>47<br>00:02:25,250 --&gt; 00:02:27,800<br>但是 这里出现了真正的差异</p><p>48<br>00:02:27,800 --&gt; 00:02:32,240<br>你无法拒接零假设的几率大大减小了</p><p>49<br>00:02:32,240 --&gt; 00:02:34,760<br>也就是说 你更有可能拒绝零假设</p><p>50<br>00:02:34,760 --&gt; 00:02:36,730<br>并得出两者间有差异的结论</p><p>51<br>00:02:36,730 --&gt; 00:02:39,990<br>β 减小了 而效应增强了</p><h3 id="29－计算所需的页面浏览数量">29－计算所需的页面浏览数量</h3><p>1<br>00:00:00,350 --&gt; 00:00:02,870<br>敏感性比较难以计算</p><p>2<br>00:00:02,870 --&gt; 00:00:05,960<br>所以人们会使用不同的技术</p><p>3<br>00:00:05,960 --&gt; 00:00:07,320<br>以确认他们需要多少网页浏览量</p><p>4<br>00:00:07,320 --&gt; 00:00:10,510<br>首先 一些编程语言有自己的内置库</p><p>5<br>00:00:10,510 --&gt; 00:00:11,760<br>可以计算这个</p><p>6<br>00:00:11,760 --&gt; 00:00:15,410<br>你还可以找一些可供查阅的表格</p><p>7<br>00:00:15,410 --&gt; 00:00:17,450<br>也能使用在线计算器</p><p>8<br>00:00:18,670 --&gt; 00:00:21,410<br>在 Audacity 的实验中 我们希望你使用</p><p>9<br>00:00:21,410 --&gt; 00:00:23,910<br>在线计算器 链接见讲师注释</p><p>10<br>00:00:23,910 --&gt; 00:00:24,800<br>现在 在这个计算器中</p><p>11<br>00:00:24,800 --&gt; 00:00:28,010<br>你需要输入一些不同的信息</p><p>12<br>00:00:28,010 --&gt; 00:00:31,500<br>基准转化率 在我们例子中 是指更改之前的预计点击概率</p><p>13<br>00:00:31,500 --&gt; 00:00:35,580<br>而最低的可探测效果</p><p>14<br>00:00:35,580 --&gt; 00:00:38,240<br>就是我们之前一直所说的实际显著性</p><p>15<br>00:00:38,240 --&gt; 00:00:41,100<br>你还需要说明你的实际显著性是</p><p>16<br>00:00:41,100 --&gt; 00:00:43,730<br>绝对或相对的数值变更</p><p>17<br>00:00:43,730 --&gt; 00:00:47,560<br>我们一直使用的是绝对数值变更 所以确保选择这个选项</p><p>18<br>00:00:47,560 --&gt; 00:00:49,520<br>我们会在第三课中进一步讲授两者间的区别</p><p>19<br>00:00:49,520 --&gt; 00:00:52,432<br>最后你还需要输入 1 - β 和 α 值</p><p>20<br>00:00:52,432 --&gt; 00:00:56,441<br>请注意 这个计算器将 1 - β 称为统计功效</p><p>21<br>00:00:56,441 --&gt; 00:00:58,550<br>而不是敏感性</p><p>22<br>00:00:58,550 --&gt; 00:01:01,720<br>在方框中填入</p><p>23<br>00:01:01,720 --&gt; 00:01:03,050<br>实验中每一组需要的页面浏览量</p><p>24<br>00:01:03,050 --&gt; 00:01:04,709<br>还记得在进行变更之前</p><p>25<br>00:01:04,709 --&gt; 00:01:10,240<br>我们收集到了 1000 个独立页面浏览 其中有 100 个进行了点击</p><p>26<br>00:01:10,240 --&gt; 00:01:14,850<br>我们将实际显著性确定为 2% 或 0.02</p><p>27<br>00:01:14,850 --&gt; 00:01:19,710<br>我称之为 dmin 意思是我们在意的最小差异</p><p>28<br>00:01:19,710 --&gt; 00:01:22,710<br>然后 α 为 0.05</p><p>29<br>00:01:22,710 --&gt; 00:01:26,040<br>β 为 0.2 非常标准</p><h3 id="30－计算所需的页面浏览数量">30－计算所需的页面浏览数量</h3><p>1<br>00:00:00,380 --&gt; 00:00:02,340<br>我们的基准转化率是 10%</p><p>2<br>00:00:02,340 --&gt; 00:00:03,940<br>100 除以 1000</p><p>3<br>00:00:03,940 --&gt; 00:00:08,620<br>而最小可探测效果 或者说实际显著性的界线</p><p>4<br>00:00:08,620 --&gt; 00:00:11,540<br>我们确定为 2% 这是绝对数值变更</p><p>5<br>00:00:11,540 --&gt; 00:00:15,840<br>最后 我将1 - β 确定为 80% α 为5%</p><p>6<br>00:00:15,840 --&gt; 00:00:21,850<br>答案是实验中每一组</p><p>7<br>00:00:21,850 --&gt; 00:00:23,380<br>至少需要 3623 的页面浏览量</p><p>8<br>00:00:23,380 --&gt; 00:00:27,210<br>正确答案是 3623</p><h3 id="31－页面浏览数是如何变化的">31－页面浏览数是如何变化的?</h3><p>1<br>00:00:00,400 --&gt; 00:00:02,950<br>现在你已经了解了如何计算实验中所需的</p><p>2<br>00:00:02,950 --&gt; 00:00:03,940<br>页面浏览量</p><p>3<br>00:00:03,940 --&gt; 00:00:07,280<br>请你想一想实验中可能发生的以下变更</p><p>4<br>00:00:07,280 --&gt; 00:00:09,150<br>并决定是否要增加或减少</p><p>5<br>00:00:09,150 --&gt; 00:00:11,860<br>你需要的页面浏览量</p><p>6<br>00:00:11,860 --&gt; 00:00:14,602<br>首先 假设对照组的点击概率变高了</p><p>7<br>00:00:14,602 --&gt; 00:00:17,299<br>但依然低于 50%</p><p>8<br>00:00:17,299 --&gt; 00:00:21,805<br>你是否需要更多或更少的页面浏览量以得到相同的敏感性？</p><p>9<br>00:00:21,805 --&gt; 00:00:25,435<br>第二 假设你决定增加实际显著性</p><p>10<br>00:00:25,435 --&gt; 00:00:27,255<br>我们称为 dmin</p><p>11<br>00:00:27,255 --&gt; 00:00:31,815<br>你不再关心 2% 的变更</p><p>12<br>00:00:31,815 --&gt; 00:00:35,300<br>而是 比如说 通过实验确认 3% 的变更</p><p>13<br>00:00:35,300 --&gt; 00:00:38,340<br>第三 假设我们决定提高置信度</p><p>14<br>00:00:38,340 --&gt; 00:00:40,610<br>也称为 1 - α</p><p>15<br>00:00:40,610 --&gt; 00:00:43,050<br>比如说 我们选择99%的置信度</p><p>16<br>00:00:43,050 --&gt; 00:00:46,020<br>而不是 95%</p><p>17<br>00:00:46,020 --&gt; 00:00:48,870<br>最后 假设你想要更高的敏感性</p><p>18<br>00:00:48,870 --&gt; 00:00:53,590<br>即实际显著性界线内的 1 - β</p><p>19<br>00:00:53,590 --&gt; 00:00:56,720<br>针对这些情况 标出你认为需要增加或减少网页浏览量</p><p>20<br>00:00:56,720 --&gt; 00:00:59,430<br>从而保证一切和之前一致的情况</p><p>21<br>00:00:59,430 --&gt; 00:01:03,010<br>我建议你自己先预计下会发生什么</p><p>22<br>00:01:03,010 --&gt; 00:01:06,640<br>然后试着在在线计算器上改变数字 看看是什么情况</p><p>23<br>00:01:06,640 --&gt; 00:01:09,240<br>如果你不明白为什么这个变更会有这样的影响</p><p>24<br>00:01:09,240 --&gt; 00:01:11,250<br>请观看视频查看解释</p><h3 id="32－页面浏览数是如何变化的？">32－页面浏览数是如何变化的？</h3><p>1<br>00:00:00,390 --&gt; 00:00:03,080<br>要弄明白点击概率</p><p>2<br>00:00:03,080 --&gt; 00:00:04,010<br>对所需页面浏览量数量的影响</p><p>3<br>00:00:04,010 --&gt; 00:00:07,530<br>就要回想之前提到过的 标准误差取决于点击概率</p><p>4<br>00:00:07,530 --&gt; 00:00:10,570<br>标准误差与 p 乘以 1 减 p</p><p>5<br>00:00:10,570 --&gt; 00:00:12,150<br>除以 N 的平方根成正比</p><p>6<br>00:00:12,150 --&gt; 00:00:15,830<br>比如说 如果概率是 0.5 标准误差应该与</p><p>7<br>00:00:15,830 --&gt; 00:00:21,470<br>0.5 乘以 0.5的平方根 即 0.5 成正比</p><p>8<br>00:00:21,470 --&gt; 00:00:24,922<br>而如果概率是 0.1 或 0.9</p><p>9<br>00:00:24,922 --&gt; 00:00:29,060<br>标准误差就与 0.3 成正比</p><p>10<br>00:00:29,060 --&gt; 00:00:33,120<br>结果显示 概率约接近 0.5</p><p>11<br>00:00:33,120 --&gt; 00:00:38,480<br>与极限值比如 0.1 或 0.9 越远 标准误差就会增加</p><p>12<br>00:00:38,480 --&gt; 00:00:40,670<br>所以点击概率增加但不超过 0.5</p><p>13<br>00:00:40,670 --&gt; 00:00:44,180<br>会增加标准误差</p><p>14<br>00:00:44,180 --&gt; 00:00:47,410<br>也就是说我需要增加网页浏览量</p><p>15<br>00:00:47,410 --&gt; 00:00:50,960<br>从而将标准误差降至原水平</p><p>16<br>00:00:50,960 --&gt; 00:00:54,620<br>现在在在线计算器中 我试着增加基准转换率</p><p>17<br>00:00:54,620 --&gt; 00:00:59,360<br>至 20% 样本量上升为约 6000</p><p>18<br>00:00:59,360 --&gt; 00:01:02,040<br>如果你增加实际显著性</p><p>19<br>00:01:02,040 --&gt; 00:01:05,780<br>比如说你不再想探测2%的变更</p><p>20<br>00:01:05,780 --&gt; 00:01:08,730<br>你要探测的是</p><p>21<br>00:01:08,730 --&gt; 00:01:09,850<br>超过 2% 的变更</p><p>22<br>00:01:09,850 --&gt; 00:01:14,390<br>越大的变更越容易探测得到 所以你不需要这么多的页面浏览量</p><p>23<br>00:01:14,390 --&gt; 00:01:17,290<br>我试着将实际显著性增加至 5%</p><p>24<br>00:01:17,290 --&gt; 00:01:22,620<br>所需的样本量减少至每组 1000 的网页浏览量</p><p>25<br>00:01:22,620 --&gt; 00:01:25,860<br>如果你增加置信度 也就是说在拒绝零假设之前</p><p>26<br>00:01:25,860 --&gt; 00:01:28,940<br>你要先进一步确认变更是否有发生</p><p>27<br>00:01:28,940 --&gt; 00:01:31,230<br>也就是说 你变得更为保守</p><p>28<br>00:01:31,230 --&gt; 00:01:34,350<br>你可以通过拒绝零假设达到这个目的</p><p>29<br>00:01:34,350 --&gt; 00:01:36,150<br>但这样会引起敏感性下降</p><p>30<br>00:01:36,150 --&gt; 00:01:38,420<br>如果你想保持相同的敏感性</p><p>31<br>00:01:38,420 --&gt; 00:01:41,250<br>你需要增加采集的页面浏览量</p><p>32<br>00:01:41,250 --&gt; 00:01:45,300<br>我试着通过减小 α 值 增加置信度</p><p>33<br>00:01:45,300 --&gt; 00:01:47,400<br>所需的页面浏览量上升了</p><p>34<br>00:01:47,400 --&gt; 00:01:49,680<br>现在是 1,500 了 而不是 1,000</p><p>35<br>00:01:49,680 --&gt; 00:01:53,420<br>最后 如你之前所见 如果你想增加实验的敏感性</p><p>36<br>00:01:53,420 --&gt; 00:01:57,600<br>你需要采集更多的页面浏览量以收窄分布</p><p>37<br>00:01:57,600 --&gt; 00:02:00,090<br>我试着增加这里的敏感性</p><p>38<br>00:02:00,090 --&gt; 00:02:01,920<br>所需页面浏览量增加了</p><p>39<br>00:02:01,920 --&gt; 00:02:03,729<br>现在是每组 2,000</p><h3 id="33-计算结果">33 - 计算结果</h3><p>1<br>00:00:00,420 --&gt; 00:00:03,300<br>好了 我们已经设计好了实验 并确定了规模</p><p>2<br>00:00:03,300 --&gt; 00:00:07,100<br>现在 我们假设已经完成了实验 然后分析实验的结果</p><p>3<br>00:00:07,100 --&gt; 00:00:11,398<br>假设对照组的总页面浏览量为 10,072</p><p>4<br>00:00:11,398 --&gt; 00:00:14,092<br>实验组为 9,886</p><p>5<br>00:00:14,092 --&gt; 00:00:17,594<br>数字不尽相同</p><p>6<br>00:00:17,594 --&gt; 00:00:18,601<br>因为是随机将用户分配给各小组的</p><p>7<br>00:00:18,601 --&gt; 00:00:23,337<br>在对照组中 用户中有 974 位点击了现在开始按钮</p><p>8<br>00:00:23,337 --&gt; 00:00:26,080<br>而实验组中有 1,242 位</p><p>9<br>00:00:27,420 --&gt; 00:00:31,860<br>所以看上去明显实验组中有更多的人进行了点击</p><p>10<br>00:00:31,860 --&gt; 00:00:34,220<br>但这是否是因为随机变化呢？</p><p>11<br>00:00:34,220 --&gt; 00:00:36,920<br>要回答这个问题 我们需要计算</p><p>12<br>00:00:36,920 --&gt; 00:00:38,200<br>这个差异的置信区间</p><p>13<br>00:00:38,200 --&gt; 00:00:40,820<br>一开始 我要计算合并概率</p><p>14<br>00:00:40,820 --&gt; 00:00:43,370<br>也就是两组的总点击数</p><p>15<br>00:00:43,370 --&gt; 00:00:48,450<br>除以总用户数 结果是约 0.111</p><p>16<br>00:00:48,450 --&gt; 00:00:51,630<br>现在我会使用你之前见过的公式来计算合并标准误差</p><p>17<br>00:00:51,630 --&gt; 00:00:56,459<br>结果是 0.00445</p><p>18<br>00:00:56,459 --&gt; 00:00:58,620<br>现在 请计算预计差异 d? 以及误差幅度 m</p><p>19<br>00:00:58,620 --&gt; 00:01:03,730<br>以完成此次计算</p><p>20<br>00:01:03,730 --&gt; 00:01:07,320<br>在这些方框中写入你的答案 精确至小数点后四位</p><p>21<br>00:01:07,320 --&gt; 00:01:10,880<br>然后将置信区间的上限和下限放入这些方框中</p><p>22<br>00:01:10,880 --&gt; 00:01:12,820<br>同样精确至小数点后四位</p><p>23<br>00:01:12,820 --&gt; 00:01:15,980<br>最后 根据这些结果</p><p>24<br>00:01:15,980 --&gt; 00:01:16,820<br>你是否会发布新版本的现在开始按钮</p><p>25<br>00:01:16,820 --&gt; 00:01:18,300<br>选择是或否</p><p>26<br>00:01:18,300 --&gt; 00:01:22,238<br>别忘记考虑这个变更是否大于实际显著性 2%</p><p>27<br>00:01:22,238 --&gt; 00:01:25,810<br>置信度采用 95%</p><h3 id="34-计算结果-Solution">34 - 计算结果 Solution</h3><p>1<br>00:00:00,360 --&gt; 00:00:04,570<br>我们将预计差异定义为</p><p>2<br>00:00:04,570 --&gt; 00:00:06,460<br>实验概率减去对照概率</p><p>3<br>00:00:06,460 --&gt; 00:00:09,110<br>答案为 0.0289</p><p>4<br>00:00:09,110 --&gt; 00:00:13,222<br>误差幅度等于合并标准误差乘以 1.96</p><p>5<br>00:00:13,222 --&gt; 00:00:16,357<br>1.96 是置信度 95% 的 Z 分数</p><p>6<br>00:00:16,357 --&gt; 00:00:19,202<br>结果是 0.0087</p><p>7<br>00:00:19,202 --&gt; 00:00:23,823<br>置信区间的下限为 d? 减 m</p><p>8<br>00:00:23,823 --&gt; 00:00:26,057<br>结果是 0.0202</p><p>9<br>00:00:26,057 --&gt; 00:00:30,683<br>上限为 d? 加 m 结果是 0.0376</p><p>10<br>00:00:30,683 --&gt; 00:00:33,714<br>从这些结果中我们能得出什么结论？</p><p>11<br>00:00:33,714 --&gt; 00:00:38,272<br>我们可以说 点击概率变更超过2%的几率</p><p>12<br>00:00:38,272 --&gt; 00:00:39,797<br>非常大</p><p>13<br>00:00:39,797 --&gt; 00:00:43,623<br>请记得 我们同时要满足统计显著性与实际显著性</p><p>14<br>00:00:43,623 --&gt; 00:00:45,170<br>这里我们满足了这两个条件</p><p>15<br>00:00:45,170 --&gt; 00:00:48,400<br>2% 是我们的实际显著性水平</p><p>16<br>00:00:48,400 --&gt; 00:00:52,040<br>至少在 95% 的置信度上 我们可以看到很大的改变</p><p>17<br>00:00:53,140 --&gt; 00:00:55,640<br>基于这个结论 我肯定会发布这个新版本</p><h3 id="35－置信区间案例分解">35－置信区间案例分解</h3><p>1<br>00:00:00,420 --&gt; 00:00:04,280<br>现在让我们来看看其他可能出现的结果</p><p>2<br>00:00:04,280 --&gt; 00:00:06,970<br>这里我用这两条蓝色线画出了</p><p>3<br>00:00:06,970 --&gt; 00:00:10,000<br>实际显著性界线 而零就是中间这条黑线</p><p>4<br>00:00:10,000 --&gt; 00:00:14,130<br>我们的点估计 也就是我们之前所说的 d?</p><p>5<br>00:00:14,130 --&gt; 00:00:16,680<br>比实际显著性的界线更大</p><p>6<br>00:00:16,680 --&gt; 00:00:19,250<br>事实上 置信区间的两端</p><p>7<br>00:00:19,250 --&gt; 00:00:21,120<br>都比实际显著性边界更大</p><p>8<br>00:00:21,120 --&gt; 00:00:24,660<br>因此 点击概率的变更</p><p>9<br>00:00:24,660 --&gt; 00:00:28,090<br>实际上很可能超过实际显著性</p><p>10<br>00:00:28,090 --&gt; 00:00:31,400<br>现在让我们看看其它情况下 我们的结果会是怎样</p><p>11<br>00:00:31,400 --&gt; 00:00:34,670<br>并试着对每种情况给出决定建议</p><p>12<br>00:00:34,670 --&gt; 00:00:38,630<br>选择你是否要发布这个变更</p><p>13<br>00:00:38,630 --&gt; 00:00:40,040<br>或者对这些情况</p><p>14<br>00:00:40,040 --&gt; 00:00:44,100<br>运行额外的测试 收集更多的数据</p><p>15<br>00:00:44,100 --&gt; 00:00:47,010<br>第一个情况就是我刚刚说到的</p><p>16<br>00:00:47,010 --&gt; 00:00:48,800<br>我会发布这个变更</p><p>17<br>00:00:48,800 --&gt; 00:00:51,700<br>你应该假设想得到的是点击概率的正面变更</p><p>18<br>00:00:51,700 --&gt; 00:00:55,330<br>不想得到的是负面变更</p><p>19<br>00:00:55,330 --&gt; 00:00:58,440<br>要记得 我们进行 A/B 测试的目的是收集数据</p><p>20<br>00:00:58,440 --&gt; 00:00:59,930<br>做出决定</p><p>21<br>00:00:59,930 --&gt; 00:01:02,850<br>我们在置信区间内计算效能</p><p>22<br>00:01:02,850 --&gt; 00:01:05,760<br>是为了了解我们的结果有多大可能具有</p><p>23<br>00:01:05,760 --&gt; 00:01:07,530<br>可重复性与合理性</p><p>24<br>00:01:07,530 --&gt; 00:01:08,990<br>做出正确的决定</p><p>25<br>00:01:08,990 --&gt; 00:01:11,650<br>因此 针对每个情况选择你认为最好的决定</p><h3 id="36-置信区间案例分解-Solution">36 - 置信区间案例分解 Solution</h3><p>1<br>00:00:00,360 --&gt; 00:00:02,969<br>第二个结果一般称为中性结果</p><p>2<br>00:00:02,969 --&gt; 00:00:05,900<br>因为置信区间包括 0</p><p>3<br>00:00:05,900 --&gt; 00:00:08,590<br>所以没有变更具有统计显著性</p><p>4<br>00:00:08,590 --&gt; 00:00:12,560<br>你也可以确认没有实际显著性的变更</p><p>5<br>00:00:12,560 --&gt; 00:00:15,620<br>所以这个变更不值得发布</p><p>6<br>00:00:15,620 --&gt; 00:00:19,350<br>在第三个案例中 你的结果具有统计显著性</p><p>7<br>00:00:19,350 --&gt; 00:00:22,370<br>你确定存在正面变更</p><p>8<br>00:00:22,370 --&gt; 00:00:23,890<br>但不具有实际显著性</p><p>9<br>00:00:23,890 --&gt; 00:00:27,630<br>事实上 你确信没有实际显著性的变更</p><p>10<br>00:00:27,630 --&gt; 00:00:29,960<br>换句话说 你确认这里有变更</p><p>11<br>00:00:29,960 --&gt; 00:00:32,420<br>但你不在意变化的幅度</p><p>12<br>00:00:32,420 --&gt; 00:00:35,170<br>如果你的团队得到了这样的结果 别急着庆祝</p><p>13<br>00:00:35,170 --&gt; 00:00:38,510<br>同样的 不值得发布这样的变更</p><p>14<br>00:00:38,510 --&gt; 00:00:42,290<br>但如果你的实际显著性界线设置得更低 就可以发布</p><p>15<br>00:00:42,290 --&gt; 00:00:45,320<br>第四个案例是作为分析家</p><p>16<br>00:00:45,320 --&gt; 00:00:47,220<br>最难处理的案例之一</p><p>17<br>00:00:47,220 --&gt; 00:00:50,820<br>一些人称它为中性变更 像第二个案例一样</p><p>18<br>00:00:50,820 --&gt; 00:00:54,130<br>但是这里 置信区间超出了</p><p>19<br>00:00:54,130 --&gt; 00:00:55,440<br>实际显著性的范围</p><p>20<br>00:00:55,440 --&gt; 00:00:59,380<br>如果你进行实验 发现它可能会导致你的用户数量增加 10%</p><p>21<br>00:00:59,380 --&gt; 00:01:03,780<br>或减少 10%</p><p>22<br>00:01:03,780 --&gt; 00:01:06,320<br>你会认为这个变更是中性的么？</p><p>23<br>00:01:06,320 --&gt; 00:01:09,140<br>最好的说法是 你没有足够的功效</p><p>24<br>00:01:09,140 --&gt; 00:01:10,890<br>得出结论</p><p>25<br>00:01:10,890 --&gt; 00:01:13,920<br>如果可能 我们这里建议你</p><p>26<br>00:01:13,920 --&gt; 00:01:15,810<br>采用更大的功效再进行一次测试</p><p>27<br>00:01:15,810 --&gt; 00:01:17,460<br>这又是一个棘手的案例</p><p>28<br>00:01:17,460 --&gt; 00:01:20,670<br>点估计超过了实际显著性</p><p>29<br>00:01:20,670 --&gt; 00:01:24,180<br>也就是说 你可以猜测 这个变更是你关注的变更</p><p>30<br>00:01:24,180 --&gt; 00:01:26,590<br>但是置信区间覆盖了0</p><p>31<br>00:01:26,590 --&gt; 00:01:28,770<br>所以也可能根本没有任何变更</p><p>32<br>00:01:28,770 --&gt; 00:01:31,230<br>你可以假设它是正面结果 然后发布变更</p><p>33<br>00:01:31,230 --&gt; 00:01:33,860<br>即便有可能没有效果</p><p>34<br>00:01:33,860 --&gt; 00:01:36,420<br>使用更大的功效重复测试</p><p>35<br>00:01:36,420 --&gt; 00:01:38,070<br>会让结果更有信服力</p><p>36<br>00:01:38,070 --&gt; 00:01:41,000<br>最后还是一种比较难处理的示例</p><p>37<br>00:01:41,000 --&gt; 00:01:43,880<br>一般情况下 你可以猜测存在一个</p><p>38<br>00:01:43,880 --&gt; 00:01:45,180<br>具有实际显著性的正面变更</p><p>39<br>00:01:45,180 --&gt; 00:01:49,230<br>然而 也有可能你的变更根本不具有实际显著性</p><p>40<br>00:01:49,230 --&gt; 00:01:50,460<br>你该如何决定呢？</p><p>41<br>00:01:50,460 --&gt; 00:01:51,730<br>所以对后面三个案例</p><p>42<br>00:01:51,730 --&gt; 00:01:55,580<br>如果你有时间的话 应该采用更大的功效进行额外的测试</p><p>43<br>00:01:55,580 --&gt; 00:01:58,540<br>但有时候 即便你不确定结果有多真实 或者结果的方向是否正确</p><p>44<br>00:01:58,540 --&gt; 00:02:02,870<br>你也必须要作出决定</p><p>45<br>00:02:02,870 --&gt; 00:02:05,610<br>现在我们会听听 Diane 对这些棘手案例的观点</p><h3 id="37－对不确定数据做出决策">37－对不确定数据做出决策</h3><p>1 00:00:00,370 --&gt; 00:00:03,780<br>Diane 如果出现最后三种情况</p><p>2 00:00:03,780 --&gt; 00:00:06,420<br>但是你没有时间进行新的实验时 你会怎么做？</p><p>3 00:00:06,420 --&gt; 00:00:10,300<br>如果只有前面三种情况的话 生活该有多轻松啊</p><p>4 00:00:10,300 --&gt; 00:00:13,010<br>问题就在于即便我们尽力地</p><p>5 00:00:13,010 --&gt; 00:00:15,540<br>增强了我们的实验</p><p>6 00:00:15,540 --&gt; 00:00:18,150<br>我们也会遇到数据有不确定性的情况</p><p>7 00:00:19,280 --&gt; 00:00:23,550<br>你要做的就是当决策人必须要做出决定时</p><p>8 00:00:23,550 --&gt; 00:00:27,850<br>和他们进行沟通 冒一下险 因为数据是不确定的</p><p>9 00:00:27,850 --&gt; 00:00:31,270<br>他们就必须依赖其他的一些因素 比如战略业务问题</p><p>10 00:00:31,270 --&gt; 00:00:33,460<br>或者数据背后的其他因素</p><h3 id="38-结论">38 - 结论</h3><p>1 00:00:00,470 --&gt; 00:00:03,150<br>恭喜大家完成了本课的学习</p><p>2 00:00:03,150 --&gt; 00:00:07,070<br>你已经学习了在技术领域之前 A/B 测试的历史</p><p>3 00:00:07,070 --&gt; 00:00:10,330<br>以及什么时候 A/B 测试适用</p><p>4 00:00:10,330 --&gt; 00:00:14,090<br>然后我们介绍了本课程中会一直使用的商业示例</p><p>5 00:00:14,090 --&gt; 00:00:17,530<br>并通过简单的过程 从头到尾地完成了 A/B 测试的设置</p><p>6 00:00:17,530 --&gt; 00:00:20,440<br>在示范实验中 你学习了如何提出</p><p>7 00:00:20,440 --&gt; 00:00:22,920<br>并评估可进行测试的假设</p><p>8 00:00:22,920 --&gt; 00:00:26,190<br>包括为评估变更选取指标</p><p>9 00:00:26,190 --&gt; 00:00:30,740<br>并确定指标发生怎样的变化才具有实际显著性</p><p>1000:00:30,740 --&gt; 00:00:32,910<br>我们讨论了实际显著性与统计显著性</p><p>11 00:00:32,910 --&gt; 00:00:37,230<br>之间的差异 以及如何计算二项置信区间</p><p>12 00:00:37,230 --&gt; 00:00:40,960<br>把所有这些结合起来 你能够计算实验的统计功效</p><p>13 00:00:40,960 --&gt; 00:00:45,360<br>并了解功效与规模之间的拉锯关系</p><p>14 00:00:45,360 --&gt; 00:00:48,080<br>最后 你使用这些概念分析实验结果</p><p>15 00:00:48,080 --&gt; 00:00:50,970<br>并学习可以得出什么结论 以及不能得出什么结论</p><p>16 00:00:52,200 --&gt; 00:00:55,290<br>在下一课中 我们会学习在实验中你应该注意哪些点</p><p>17 00:00:55,290 --&gt; 00:00:58,080<br>以保护参与者</p><p>18 00:00:58,080 --&gt; 00:00:58,590<br>到时候见</p><h1>🎯批量修改文件名py</h1><p>将所有.srt文件后缀改成.txt：</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> pathlib <span class="keyword">import</span> Path</span><br><span class="line"></span><br><span class="line">ROOT_DIR = <span class="string">r&#x27;C:\Code\pyProject\pydf\UdacityABtest&#x27;</span>  <span class="comment"># 要处理的根目录</span></span><br><span class="line">OLD_EXT = <span class="string">&#x27;.srt&#x27;</span>  <span class="comment"># 原后缀（必须带点）</span></span><br><span class="line">NEW_EXT = <span class="string">&#x27;.txt&#x27;</span>  <span class="comment"># 新后缀（必须带点）</span></span><br><span class="line">RECURSIVE = <span class="literal">True</span>  <span class="comment"># True=连子目录一起改，False=只改当前目录</span></span><br><span class="line"></span><br><span class="line">old_ext_lower = OLD_EXT.lower()</span><br><span class="line"><span class="keyword">for</span> dirpath, _, filenames <span class="keyword">in</span> os.walk(ROOT_DIR) <span class="keyword">if</span> RECURSIVE <span class="keyword">else</span> [(ROOT_DIR, [], os.listdir(ROOT_DIR))]:</span><br><span class="line">    <span class="keyword">for</span> name <span class="keyword">in</span> filenames:</span><br><span class="line">        <span class="keyword">if</span> name.lower().endswith(old_ext_lower):</span><br><span class="line">            p = Path(dirpath) / name</span><br><span class="line">            new_name = p.stem + NEW_EXT</span><br><span class="line">            p.rename(p.with_name(new_name))</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;renamed: <span class="subst">&#123;p&#125;</span>  -&gt;  <span class="subst">&#123;new_name&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;done!&#x27;</span>)</span><br></pre></td></tr></table></figure><p>将所有.txt文件的文字合并到一个pdf里：</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">import os</span><br><span class="line"><span class="keyword">from</span> pathlib import Path</span><br><span class="line"><span class="keyword">from</span> reportlab.pdfbase import pdfmetrics</span><br><span class="line"><span class="keyword">from</span> reportlab.pdfbase.ttfonts import TTFont</span><br><span class="line"><span class="keyword">from</span> reportlab.lib.pagesizes import A4</span><br><span class="line"><span class="keyword">from</span> reportlab.platypus import SimpleDocTemplate, Paragraph, Spacer</span><br><span class="line"><span class="keyword">from</span> reportlab.lib.styles import getSampleStyleSheet</span><br><span class="line"></span><br><span class="line">ROOT_DIR  <span class="operator">=</span> r<span class="string">&#x27;.&#x27;</span>                 # 含 txt 的根目录</span><br><span class="line"><span class="keyword">RECURSIVE</span> <span class="operator">=</span> <span class="literal">True</span></span><br><span class="line">FONT_NAME <span class="operator">=</span> <span class="string">&#x27;SimSun&#x27;</span></span><br><span class="line">FONT_FILE <span class="operator">=</span> r<span class="string">&#x27;C:\Windows\Fonts\simsun.ttc&#x27;</span>   # Linux<span class="operator">/</span>Mac 按需改</span><br><span class="line">OUTPUT_PDF <span class="operator">=</span> <span class="string">&#x27;merged_all.pdf&#x27;</span>    # 合并后的文件名</span><br><span class="line"></span><br><span class="line"># 注册字体</span><br><span class="line">pdfmetrics.registerFont(TTFont(FONT_NAME, FONT_FILE))</span><br><span class="line">styles <span class="operator">=</span> getSampleStyleSheet()</span><br><span class="line"></span><br><span class="line">title_style <span class="operator">=</span> styles[<span class="string">&#x27;Heading1&#x27;</span>]</span><br><span class="line">title_style.fontName <span class="operator">=</span> FONT_NAME</span><br><span class="line">title_style.fontSize <span class="operator">=</span> <span class="number">16</span></span><br><span class="line">title_style.leading <span class="operator">=</span> <span class="number">20</span></span><br><span class="line"></span><br><span class="line">normal_style <span class="operator">=</span> styles[<span class="string">&#x27;Normal&#x27;</span>]</span><br><span class="line">normal_style.fontName <span class="operator">=</span> FONT_NAME</span><br><span class="line">normal_style.fontSize <span class="operator">=</span> <span class="number">10</span></span><br><span class="line">normal_style.leading <span class="operator">=</span> <span class="number">14</span></span><br><span class="line"></span><br><span class="line">story <span class="operator">=</span> []</span><br><span class="line"></span><br><span class="line"># 按文件名排序，保证顺序一致</span><br><span class="line">txt_files <span class="operator">=</span> []</span><br><span class="line"><span class="keyword">for</span> dirpath, _, files <span class="keyword">in</span> (os.walk(ROOT_DIR) if <span class="keyword">RECURSIVE</span> <span class="keyword">else</span> [(ROOT_DIR, [], os.listdir(ROOT_DIR))]):</span><br><span class="line">    <span class="keyword">for</span> f <span class="keyword">in</span> files:</span><br><span class="line">        if f.<span class="built_in">lower</span>().endswith(<span class="string">&#x27;.txt&#x27;</span>):</span><br><span class="line">            txt_files.append(Path(dirpath) <span class="operator">/</span> f)</span><br><span class="line">txt_files.sort()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> txt_path <span class="keyword">in</span> txt_files:</span><br><span class="line">    # 一级标题：文件名（去掉后缀）</span><br><span class="line">    story.append(Paragraph(txt_path.stem, title_style))</span><br><span class="line">    story.append(Spacer(<span class="number">1</span>, <span class="number">6</span>))</span><br><span class="line"></span><br><span class="line">    # 正文</span><br><span class="line">    <span class="keyword">with</span> txt_path.open(encoding<span class="operator">=</span><span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        <span class="keyword">for</span> line <span class="keyword">in</span> f:</span><br><span class="line">            line <span class="operator">=</span> line.rstrip()</span><br><span class="line">            if line:</span><br><span class="line">                story.append(Paragraph(line, normal_style))</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                story.append(Spacer(<span class="number">1</span>, normal_style.leading))</span><br><span class="line"></span><br><span class="line">    # 每个文件结束后空一行</span><br><span class="line">    story.append(Spacer(<span class="number">1</span>, <span class="number">20</span>))</span><br><span class="line"></span><br><span class="line"># 一次性写 PDF</span><br><span class="line">doc <span class="operator">=</span> SimpleDocTemplate(OUTPUT_PDF, pagesize<span class="operator">=</span>A4,</span><br><span class="line">                        topMargin<span class="operator">=</span><span class="number">72</span>, bottomMargin<span class="operator">=</span><span class="number">36</span>,</span><br><span class="line">                        leftMargin<span class="operator">=</span><span class="number">36</span>, rightMargin<span class="operator">=</span><span class="number">36</span>)</span><br><span class="line">doc.build(story)</span><br><span class="line">print(f<span class="string">&#x27;所有 txt 已合并到 &#123;OUTPUT_PDF&#125;&#x27;</span>)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>大prompt</title>
      <link href="/2026/01/17/%E5%A4%A7prompt/"/>
      <url>/2026/01/17/%E5%A4%A7prompt/</url>
      
        <content type="html"><![CDATA[<h1>课程写作</h1><h2 id="综述">综述</h2><p>基于 【银行信贷违约预测】 场景的【人工智能】【应用】综述（3000 字以上）</p><p>参考提纲</p><p>摘要（≈200 字）</p><p>本文围绕【】任务，系统梳理了【】类公开数据集、【】类主流算法以及当前面临的三大挑战。首先，汇总并对比了【】个常用数据集的关键特征；其次，将现有算法归纳为【】两大类，分别阐述其思想与适用场景；最后，从数据不平衡、可解释性、隐私合规三方面总结研究趋势。结果表明，【】方法在指标上普遍优于【】方法，但【】问题仍待解决。</p><p>关键词（3-5 个，用分号隔开）</p><p><strong><em>*</em>***；*****</strong><em>；</em><em><em>*</em>***；*****</em>**；</p><p>1 引言（≈300 字）</p><p>1.1 研究背景<br>1.2 研究意义<br>1.3 本文结构</p><p>2 数据集综述（≈600 字）</p><p>表 1 常用公开数据集对比（必须出现，三线表）</p><p>表头包含：数据集名称、发布机构、样本量、特征数、类别分布、下载链接</p><p>对表进行描述，例如：</p><p>由表 1 可见，样本量最大可达【】万，特征维度最高为【】维。三类数据集均存在【】问题，其中【】数据集已做平衡处理，适用于【】场景。</p><p>3 算法描述与对比（≈1000 字）</p><p>3.1 传统思路（必填一类，如机器学习 / 规则 / 统计 / 时序模型）</p><p>(1) 方法名称：</p><p>(2) 核心思想：利用【】特征，通过【】策略实现【】目标。</p><p>(3) 适用场景：</p><p>(4) 优缺点：优点【】；缺点【】。</p><p>可插入公式（可选）：（无公式可不写，尽量写公式）</p><p>3.2 新兴思路（必填另一类，可与上表不同）</p><p>(1) 方法名称：</p><p>(2) 核心思想：</p><p>(3) 适用场景：</p><p>(4) 优缺点：</p><p>示意图（可选）：（无图可文字描述网络结构）</p><p>3.3 性能对比</p><p>表 2 汇总了【】篇近五年文献的实验结果。传统方法平均【】指标为【】，新兴方法为【】，提升约【】%。主要原因为【】。</p><p>4 挑战与发展趋势（≈500 字）</p><p>4.1 数据不平衡<br>4.2 可解释性<br>4.3 隐私合规</p><p>5 结论与展望（≈200 字）</p><p>参考文献（≥6 篇，按要求比例）</p><p>（格式遵循 GB/T 7714-2015 标准）</p><p>论文具体要求</p><ol><li>数据集表格：必须列出至少 3 个公开数据集并含 “样本量、特征数、类别分布（含是否平衡）、下载链接” 四项；</li><li>算法公式 / 图片：必须①至少介绍 2 类不同思路（如传统机器学习、深度学习、规则 / 统计 / 图模型 / 时序模型等）；必须②用文字或表格说明核心思想、适用场景、优缺点；</li><li>挑战与趋势：必须覆盖 “数据不平衡、可解释性、隐私合规”3 点；</li><li>参考文献：必须数量≥6 篇（英文≥3、中文核心≥2、政策 / 新闻≥1）；不能出现百科 / CSDN</li><li>结构逻辑：必须覆盖 引言 - 数据集 - 算法 - 挑战 - 结论五部分；</li><li>语言表达：通顺、无大段错别字 / 病句；</li></ol><h2 id="毕业论文">毕业论文</h2><p>参考文献格式要求</p><p>格式遵循 GB/T 7714-2015 标准</p><ol><li>专著（图书）</li></ol><ul><li><p>格式：<code>[序号] 主要责任者. 题名[M]. 出版地:出版者,出版年:页码（任选）.</code></p></li><li><p>示例：</p><p>[1] 刘国钧，陈绍业，王凤翥。图书馆目录 [M]. 北京：高等教育出版社，1957:15-18.</p><p>[2] PIGGOTT T M. The cataloguer’s way through AACR2[M]. London: The Library Association, 1990.</p></li></ul><ol start="2"><li>期刊文章</li></ol><ul><li><p>格式：<code>[序号] 主要责任者. 题名[J]. 刊名,年,卷(期):页码.</code></p></li><li><p>示例：</p><p>[3] 何龄修。读顾城《南明史》[J]. 中国史研究，1998,(3):167-173.</p><p>[4] KANAMORI H. Shaking without quaking[J]. Science, 1998,279(5359):2063-2064.</p></li></ul><ol start="3"><li>会议论文集（析出文献）</li></ol><ul><li><p>格式：<code>[序号] 析出责任者. 析出题名[A]. 原文献责任者. 原文献题名[C]. 出版地:出版者,出版年:析出页码.</code></p></li><li><p>示例：</p><p>[5] 钟文发。非线性规划在可燃毒物配置中的应用 [A]. 赵玮。运筹学的理论与应用 —— 中国运筹学会第五届大会论文集 [C]. 西安：西安电子科技大学出版社，1996:468-471.</p></li></ul><ol start="4"><li>学位论文</li></ol><ul><li><p>格式：<code>[序号] 责任者. 题名[D]. 出版地:培养单位,出版年:页码（任选）.</code></p></li><li><p>示例：</p><p>[6] 孙玉文。汉语变调构词研究 [D]. 北京：北京大学，2000.</p><p>[7] CALMS R B. Infrared spectroscopic studies on solid oxygen[D]. Berkeley: Univ. of California, 1965.</p></li></ul><ol start="5"><li>专利文献</li></ol><ul><li><p>格式：<code>[序号] 专利申请者/所有者. 专利题名[P]. 专利国别:专利号,公告/公开日期.</code></p></li><li><p>示例：</p><p>[8] 姜锡洲。一种温热外敷药制备方案 [P]. 中国专利：881056073, 1989-07-26.</p><p>[9] 西安电子科技大学。光折变自适应光外差探测方法 [P/OL]. 中国专利：01128777.2, 2002-03-06 [2002-05-28]. <a href="http://211.152.9.47/sipoasp/zljs/hyjs-yx-new.asp?recid=01128777.2">http://211.152.9.47/sipoasp/zljs/hyjs-yx-new.asp?recid=01128777.2</a>.</p></li></ul><ol start="6"><li>电子文献（含联机、光盘）</li></ol><ul><li><p>格式：<code>[序号] 责任者. 题名[电子文献类型标识/载体标识]. 出版地:出版者,出版年(更新日期)[引用日期]. 获取和访问路径.</code></p></li><li><p>示例：</p><p>[10] 王明亮。关于中国学术期刊标准化数据库系统工程的进展 [EB/OL]. 1998-08-16 [1998-10-04]. <a href="http://www.cajcd.edu.cn/pub/wml.txt/980810-2.html">http://www.cajcd.edu.cn/pub/wml.txt/980810-2.html</a>.</p><p>[11] TURCOTTE D L. Fractals and chaos in geology and geophysics[M/OL]. New York: Cambridge University Press, 1992[1998-09-23]. <a href="http://www.seg.org/reviews/mccorm30.html">http://www.seg.org/reviews/mccorm30.html</a>.</p></li></ul><p>正文引用标注方法</p><p>采用 <strong>顺序编码制</strong>，国标补充「著者 - 出版年制」（可选），具体要求：</p><ol><li>顺序编码制（核心要求）</li></ol><ul><li>单篇引用：按正文引用顺序标注序号，置于方括号内（如 “…… 相关研究 [1] 表明”）。</li><li>多篇引用：同一处引多篇文献，序号间用 “,” 分隔；连续序号用 “-” 连接（如 “[2,4-6]”）。</li><li>多次引用同一文献：仅标注首次引用的序号，其后加页码（如 “[1]:15-18”）。</li></ul><ol start="2"><li>著者 - 出版年制（国标补充）</li></ol><ul><li>单篇引用：标注 “著者 + 出版年”（如 “张三等 [2020] 提出”），外文标注 “姓 + 出版年”（如 “Crane [1972]”）。</li><li>多次引用：标注 “著者 + 出版年 + 页码”（如 “张三等 [2020:15]”）。</li></ul><h1>Agent</h1><h2 id="readme文档提示词">readme文档提示词</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">为指定的目录生成/更新README.md文件，文件内容需要包含以下部分：</span><br><span class="line"></span><br><span class="line">1. 项目概述</span><br><span class="line">    简要介绍项目的核心功能、主要特性</span><br><span class="line"></span><br><span class="line">2. 技术栈</span><br><span class="line">    按照前端、后端、数据库、开发工具等分类总结技术栈(不需要注明具体版本)</span><br><span class="line"></span><br><span class="line">3. 项目架构</span><br><span class="line">    说明项目的整体架构设计、模块间关系、数据流向</span><br><span class="line"></span><br><span class="line">4. 目录结构</span><br><span class="line">    以目录树形式详细说明各目录和重要文件的用途，突出核心业务逻辑文件</span><br><span class="line"></span><br><span class="line">5. 核心文件说明</span><br><span class="line">    重点介绍以下类型的文件：</span><br><span class="line">    - 项目入口文件和配置文件</span><br><span class="line">    - 核心业务逻辑实现</span><br><span class="line">    - 数据模型和API接口</span><br><span class="line">    - 关键组件和服务模块</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">生成或更新README.md时的具体要求：</span><br><span class="line"></span><br><span class="line">准确性要求：</span><br><span class="line">1. 必须实际阅读文件内容来了解功能，严禁基于文件名猜测</span><br><span class="line">2. 对已存在的README内容进行全面校验，识别并更新过时信息</span><br><span class="line">3. 使用工具验证目录结构的准确性，确保没有遗漏或错误的文件引用</span><br><span class="line">4. 对现有文件重新阅读和分析，因为内容可能已经更新</span><br><span class="line"></span><br><span class="line">内容要求：</span><br><span class="line">5. 使用纯文本（markdown）格式，避免emoji和装饰性符号</span><br><span class="line">6. 内容要既准确又简洁，避免冗余描述</span><br><span class="line">7. 面向不同技术水平的读者，提供必要的背景说明</span><br><span class="line">8. 重点突出项目的独特设计和技术亮点</span><br><span class="line">9. 忽略.venv、dist、node_modules、.git等目录</span><br><span class="line"></span><br><span class="line">结构要求：</span><br><span class="line">10. 保持逻辑清晰的层次结构</span><br><span class="line">11. 确保各部分内容的关联性和完整性</span><br></pre></td></tr></table></figure><p><a href="https://panzhixiang.cn/2025/a-prompt-help-ai-understanding-your-code/">用这个提示词，教会AI理解你的整个项目 | 潘智祥</a></p><h2 id="AGENTS-md"><a href="http://AGENTS.md">AGENTS.md</a></h2><h3 id="时间线发展">时间线发展</h3><blockquote><p>用于定义和管理项目规则的文件的所有历史？</p></blockquote><p>这些文件是AI 编程助手（如 Cursor）中用于定义和管理项目规则的文件，它们的历史演变体现了开发者对规则管理和跨平台协作的需求。</p><p><code>.cursorrules</code>、<code>AGENTS.md</code>、<code>CLAUDE.md</code>、<code>skills</code></p><p>时间线发展</p><ul><li><strong>2024年底-2025年初</strong>：Cursor引入<code>.cursorrules</code>（项目根目录单一文件），用于基本项目级规则控制，与User Rules（全局设置）并存。这是早期对抗AI“幻觉”的解决方案。</li><li><strong>2025年3-4月</strong>（Cursor v0.45-v0.46）：User Rules独立分类，<code>.cursorrules</code>被标记为传统/即将弃用，引入<code>.cursor/rules</code>目录，支持多文件模块化规则（路径限定、自动包含）。</li><li><strong>2025年5-8月</strong>：<a href="http://xn--AMPAGENTS-sj4ox54b4y1bvx0k.md">AMP团队提出AGENTS.md</a>，作为跨平台Markdown标准，统一<code>.cursorrules</code>、<code>.agentrc</code>等，支持OpenAI、Google工具，推动行业规范。</li><li><strong>2025年9月</strong>：Cursor正式弃用<code>.cursorrules</code>，推荐Project Rules + AGENTS.md组合；Claude <a href="http://xn--CodeCLAUDE-rk1qh11o.md">Code推出CLAUDE.md</a>（项目根目录，用户级~/.claude/覆盖）。</li><li><strong>2025年底-2026年</strong>：标准化趋势确立，多工具支持嵌套覆盖（如.local.md不入Git），<code>/init</code>或<code>/Generate</code>命令自动生成。</li></ul><p>完整文件对比</p><table><thead><tr><th style="text-align:left">文件类型</th><th style="text-align:left">引入时间</th><th style="text-align:left">主要工具</th><th style="text-align:left">位置与优先级</th><th style="text-align:left">现状</th></tr></thead><tbody><tr><td style="text-align:left">User Rules</td><td style="text-align:left">2025 Q1</td><td style="text-align:left">Cursor</td><td style="text-align:left">设置（全局）</td><td style="text-align:left">活跃，全局生效</td></tr><tr><td style="text-align:left">.cursorrules</td><td style="text-align:left">2024 Q4</td><td style="text-align:left">Cursor（Legacy）</td><td style="text-align:left">项目根目录</td><td style="text-align:left">弃用，兼容模式</td></tr><tr><td style="text-align:left">.cursor/rules</td><td style="text-align:left">2025 Q2</td><td style="text-align:left">Cursor</td><td style="text-align:left">.cursor/rules（多.mdc文件）</td><td style="text-align:left">主流，模块化推荐</td></tr><tr><td style="text-align:left"><a href="http://AGENTS.md">AGENTS.md</a></td><td style="text-align:left">2025 Q2</td><td style="text-align:left">跨平台</td><td style="text-align:left">项目根目录</td><td style="text-align:left">标准，Markdown简洁</td></tr><tr><td style="text-align:left"><a href="http://CLAUDE.md">CLAUDE.md</a></td><td style="text-align:left">2025 Q4</td><td style="text-align:left">Claude Code</td><td style="text-align:left">项目根 &gt; ~/.claude &gt; .local</td><td style="text-align:left">活跃，项目上下文</td></tr></tbody></table><h2 id="cursorrules">cursorrules</h2><h3 id="core">core</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">---</span><br><span class="line">description: 项目通用规则</span><br><span class="line">globs:</span><br><span class="line">alwaysApply: true</span><br><span class="line">---</span><br><span class="line"></span><br><span class="line"># 项目通用规则</span><br><span class="line"></span><br><span class="line">- 始终使用中文回复用户，包括提问时，但技术专有名词可保留英文（如 API、Python、DTO等）。</span><br><span class="line">- 使用项目既有风格，不引入新风格，包括代码、文档或交互，默认延用项目中已有的格式、缩进、命名习惯。</span><br><span class="line">- 尽可能少地输出内容，仅提供高信息密度回复，禁止无效寒暄、过度铺垫，只输出对当前任务有直接帮助的信息。</span><br><span class="line">- 项目开始时就创建README.md文档，记录产品功能、实现技术栈等，在关键节点及时更新，方便了解项目状态。</span><br><span class="line">- 每次回复结束,在最后一句都“喵”一下</span><br></pre></td></tr></table></figure><p><a href="https://github.com/flyeric0212/cursor-rules">flyeric0212/cursor-rules: 整理和收集来自不同项目的Cursor规则文件，提供多种编程语言和框架的规则支持。</a></p><h2 id="个人规则">个人规则</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1.回答先给结论，再展开说明</span><br><span class="line">2.我给出明确回复后再执行</span><br><span class="line">3.信息不确定时要明确说明</span><br><span class="line">4.表达尽量简洁，用条列结构</span><br><span class="line"></span><br><span class="line">- 始终使用中文回复用户，包括提问时，但技术专有名词可保留英文（如 API、Python、DTO等）。</span><br><span class="line">- 使用项目既有风格，不引入新风格，包括代码、文档或交互，默认延用项目中已有的格式、缩进、命名习惯。</span><br><span class="line">- 尽可能少地输出内容，仅提供高信息密度回复，禁止无效寒暄、过度铺垫，只输出对当前任务有直接帮助的信息。</span><br><span class="line">- 项目开始时就创建README.md文档，记录产品功能、实现技术栈等，在关键节点及时更新，方便了解项目状态。</span><br><span class="line">- 每次回复结束,在最后一句都“喵”一下</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>JD收集</title>
      <link href="/2026/01/15/JD%E6%94%B6%E9%9B%86/"/>
      <url>/2026/01/15/JD%E6%94%B6%E9%9B%86/</url>
      
        <content type="html"><![CDATA[<h1>字节</h1><h2 id="数据分析师-国际支付">数据分析师-国际支付</h2><p>职位描述</p><p>1、负责国际支付业务的数据分析、指标体系建设、业务迭代分析及 AB 实验分析等工作；</p><p>2、通过基础数据建设，能够清晰、完整的刻画国际支付业务的业务现状；</p><p>3、通过专项数据分析形成数据洞察及优化迭代建议，数据驱动国际支付业务发展。</p><p>职位要求</p><p>1、本科及以上学历，统计学、数学、计算机等相关专业；</p><p>2、熟练使用 sql/hive/python/spark 等语言工具进行数据分析工作；</p><p>3、扎实的统计学、数据挖掘等理论和技术基础，熟练掌握因果推断、统计与概率论等数学工具，熟悉聚类分析、关联分析、逻辑回归、决策树等数据挖掘/机器学习模型算法；</p><p>4、有较强的逻辑思维能力，对数据敏感，具备很强的数据分析和解决问题的能力，有较好的产品意识，对产品和数据有独立的思考和洞察，有较强的数据驱动的意识；</p><p>5、具备较强的学习能力，有强烈的求知欲和进取心，主动及时关注学习业界最新技术；</p><p>6、有较强的责任心和 owner 意识，具备良好的沟通表达能力，积极乐观并有良好的团队协作能力；</p><p>7、在支付、金融、信贷等领域有相关的数据工作经验及行业经验者优先。</p><h2 id="数据分析师-用户增长">数据分析师-用户增长</h2><blockquote><p>（User Growth）</p></blockquote><p>岗位职责</p><p>团队介绍：字节跳动用户增长（User Growth）负责抖音、今日头条、番茄小说、剪映等多个产品的用户增长业务，建立行业领先的增长和营销技术，打造极致的用户体验。加入我们，有机会参与亿级用户场景的开发与架构工作，也有机会从数据出发，利用策略和模型为业务带来更大的助力。</p><p>1、负责字节跳动用户行为的理解和建模，帮助业务满足用户需求，促进业务增长；</p><p>2、基于用户数据和业务数据，进行BI分析，探索业务增长机会；</p><p>3、基于用户数据和业务数据，进行数据挖掘，探索对内容、用户、场景的认识。</p><p>岗位要求</p><p>1、2026届获得本科及以上学历，计算机、通信和电子信息科学、数学等相关专业；</p><p>2、扎实的计算机编程能力，C/C++，Java，Python，SQL/HQL均可；</p><p>3、强的业务和数据理解能力；</p><p>4、有过数据治理，数据挖掘，BI，算法等大数据相关项目/实习经验优先。</p><h2 id="数据分析师-用户中台">数据分析师-用户中台</h2><p>岗位职责</p><p>团队介绍：用户中台作为字节跳动核心的基础业务中台，负责字节中国各业务的 IAM 及用户基础产品功能，通过提供包括设备、账号、认证、资料在内的用户基础服务、保护用户安全隐私的能力以及全面理解用户的能力，以支持业务创新及高质量发展。其目标是为字节业务，提供安全完善高效稳定的用户产品解决方案。用户中台深度参与核心业务的用户体系建设，有效连接了用户和业务，推动了业务创新。在研发工作方面，面临复杂业务架构设计、极高安全和质量标准、极致用户体验打造、深度业务能力扩展的机遇和挑战。</p><p>1、负责抖音账号相关业务的数据分析工作，优化抖音账号产品体验、保护用户账号安全、提升业务账号价值；</p><p>2、负责业务指标体系建设，以数据驱动的方式指引业务优化建设，深入了解业务，独立负责和承担若干个抖音账号业务模块的数据分析工作，包括数据指标设计与开发、异动分析、专题分析、自动化工具建设；</p><p>3、了解运用各种数据分析方法，结合抖音业务情况，从海量的数据中自主进行深入的挖掘分析和建议，指导抖音账号能力的建设与迭代，发挥更多数据的价值；</p><p>4、深入探索数据策略，开展深度的数据洞察分析，通过数据策略方式做业务增长，熟练使用A/B实验的方式评估策略效果。</p><p>岗位要求</p><p>1、2026届获得本科及以上学历，数学、统计学、计算机相关专业优先；</p><p>2、熟练使用SQL/Hive等工具；熟悉漏斗分析、维度分析、洞察分析、异动分析等分析方法；</p><p>3、对数据敏感，具备很强的数据分析和解决问题的能力，有较强的数据驱动的意识；</p><p>4、了解AB实验原理，有实验设计与效果分析经验；有较好的产品意识，对产品和数据有独立的思考和洞察；</p><p>5、具备较强的学习能力，有强烈的求知欲和进取心，主动及时关注学习业界最新技术；有较强的责任心和主人翁意识，积极乐观并有良好的团队协作能力；</p><p>6、具备良好的沟通表达能力，严谨细致的逻辑思维能力。</p><h2 id="数据分析师-抖音">数据分析师-抖音</h2><p>岗位职责</p><p>团队介绍：抖音-数据分析部门负责字节跳动旗下不同业务方向的数据分析工作。业务线既涵盖抖音等较为成熟的产品，也包括正在孵化的各种创新项目。在这里，既可以通过数据指导创新业务从0到1，起于垒土；也可以通过分析发现突破的方向、赋能成熟产品持续增长。我们的职责，就是从每天产生的PB级数据中找到最合适的指标和维度、从最真实的业务现象中找到可以优化的洞见，并将我们的发现落地成增长。选择数据分析团队，就是选择了和优秀的人做有挑战的事，成为不可替代的分析师和数据科学专家。</p><p>1、负责抖音业务的数据分析工作，工作内容会涉及到内容、增长、变现、作者生态等多个业务模块；</p><p>2、分析各项影响业务提升与增长的因素、各项业务细节，结合业务目标洞察业务现状及问题，给出可落地的整体的产品/运营优化方案；</p><p>3、与产品/运营/推荐等配合，推进优化方案落地执行，带来业务的实际提升增长；</p><p>4、负责业务上各类A/B实验设计与分析，产品优化效果评估，运营策略或市场活动分析评估，核心指标异动分析，客户端版本效果评估等工作；</p><p>5、围绕业务目标展开专题分析，描述业务现状，洞察问题和机会点，并给出具体的解决方案和推进产品策略有效落地。</p><p>岗位要求</p><p>1、2026届获得本科及以上学历，数学、统计学、计算机相关专业优先；</p><p>2、有视频行业数据分析实习经验、一线产品或运营业务优化经验者优先；</p><p>3、逻辑清晰，对数据敏感，能发掘业务细节和数据之间的联系，并通过数据指标推动优化；</p><p>4、具有良好的团队配合能力，沟通能力；</p><p>5、精通SQL，熟练使用R/Python进行数据分析、挖掘，掌握Tableau等BI工具尤佳；</p><p>6、对内容行业感兴趣，有内容、增长、商业化等方向有深入思考或分析经验者优先。</p><h2 id="数据分析师-番茄小说">数据分析师-番茄小说</h2><p>base深圳</p><p>1、负责字节跳动泛文娱长内容赛道相关业务的数据分析、经营分析工作；</p><p>2、分析各项影响产品提升与增长的因素，结合业务方向，给出可落地的整体产品优化方案；</p><p>3、与产品、运营、研发等配合，推进优化方案落地执行，带来业务的实际提升增长；</p><p>4、负责业务上各类A/B实验设计与分析，产品优化效果、市场活动分析评估等工作；</p><p>5、建设业务分析模型，并不断评估和优化；</p><p>6、与战略、业务团队密切配合，为业务团队提供决策支持，和业务方共同探索业务模式并提供策略设计，分析和落地支持。</p><p>职位要求</p><p>1、2026届获得本科及以上学历，数学、统计学、计算机、软件相关专业优先；</p><p>2、有数据分析、策略分析、经营分析相关实习经验者优先；</p><p>3、逻辑清晰，对数据敏感，能发掘业务细节和数据之间的联系，并通过数据指标推动优化；</p><p>4、对互联网泛文娱领域怀有兴趣，并有所思考；</p><p>5、精通SQL，熟练使用R/Python 进行数据分析、挖掘。</p><h2 id="数据分析师-校招-今日头条">数据分析师(校招)今日头条</h2><p>今日头条公司</p><p>团队介绍：字节跳动Data研发部门，负责公司产品线的推荐、广告、系统架构、大数据和开放平台等技术。</p><p>职位描述</p><p>1、负责分析抖音/今日头条/西瓜视频等相关业务的数据分析工作；</p><p>2、分析各项影响产品提升与增长的因素和各项业务细节，结合业务方向，给出可落地的整体的产品优化方案；</p><p>3、与产品/运营/研发等配合，推进优化方案落地执行，带来业务的实际提升增长；</p><p>4、负责业务上各类A/B实验设计与分析，产品优化效果评估，市场活动分析评估，核心指标异动分析，客户端版本效果评估等工作；</p><p>5、负责业务上特化模型的建设工作。</p><p>职位要求：</p><p>1、2022届获得本科及以上学历，数学、统计学、计算机、商业分析等相关专业；</p><p>2、能快速理解业务，发掘业务细节和数据之间的联系；</p><p>3、对互联网行业充满兴趣，希望长期在互联网行业发展；</p><p>4、有极强的学习能力和好奇心，有互联网行业数据分析相关实习经验者优先。</p><p>26届校招-数据分析师-TikTok-上海</p><p>1、参与TikTok APP用户增长业务指标体系建设，搭建报表体系等监测预警工具，为业务发展提供数据支撑；</p><p>2、支持业务日常分析需要，深入理解业务，通过定性和定量分析清晰说明业务现状，洞察增长问题，提出基于数据驱动的优化建议或解决方案；</p><p>3、与产品研发/数据工程/算法配合，通过严谨分析、AB实验等支持业务策略迭代，量化评估策略效果、成本效率，带动业务指标提升；</p><p>4、Mentor 1对1指导，在支持业务发展中，善于思考、总结，沉淀增长分析方法论与数据效率工具。</p><h2 id="数据分析实习生﹣抖音生活服务">数据分析实习生﹣抖音生活服务</h2><blockquote><p>base地上海的日常实习</p></blockquote><p>1、负责抖音生活服务方向相关的数据分析工作，包括异动归因、BI搭建、专项分析以及其他日常数据分析工作；</p><p>2、梳理业务需求及逻辑，协助资深同学对策略进行定性、定量的分析，帮助业务定位问题或发现机会，参与策略的制定；</p><p>3、参与数据体系建设，业务数据报表的设计＆落地，为业务的发展提供数据能力支撑。</p><h1>韶音</h1><h2 id="26届正式批-数据分析师（国际业务）">26届正式批-数据分析师（国际业务）</h2><p>业务简介：</p><p>Shokz作为全球知名运动耳机品牌，进驻包含美国、加拿大、日本、韩国、新加坡、英国、德国、法国、澳大利亚等超过60多个国家和地区，拥有28000+门店。根据沙利文市场报告显示，Shokz专业运动耳机在运动耳机品类中出货量位居全球第一，2023-2024年蝉联全球运动耳机销量第一。</p><p>部门介绍：</p><p>为加速品牌全球化发展的步伐，韶音科技营销中心内部设立三大业务团队，分别精细化经营<strong>大中华区、北美地区及其他国际业务市场</strong>。国际业务部成立于2013年，团队规模约250人，业务范围覆盖欧洲、亚洲、澳洲、拉美等多个国家。这里是Shokz开疆拓土的前沿阵地！ 在这里，你可以充分发挥跨文化交际能力，深度参与品牌出海，布局全球化的进程，纵横四海，连接世界，在已有的舞台上发挥自己的光彩。</p><p>岗位介绍：</p><p>在该岗位中，你将深入数据海洋（如销售数据、经营数据等），构建核心数据体系，挖掘用户行为与业务增长的关键洞察。通过精准的数据采集、分析与解读，驱动产品优化与营销决策，快速成长为业务增长的核心伙伴。</p><p>岗位职责</p><p>1、数据支持：从数据库中调取业务所需数据（如转化率、ROI、销量、用户行为等），按需求输出报表，满足各部门的数据需求。</p><p>2、可视化看板搭建与维护：针对高复用的数据需求，设计并搭建对应的Dashboard，确保数据的可视化展示，定期维护和优化。</p><p>3、业务分析：根据具体业务需求，开展专题数据分析，撰写详尽的分析报告；与业务负责人合作，制定复盘机制，并定期对业务表现进行复盘（周度/月度）。</p><p>4、目标测算模型搭建：协助业务线负责人制定业务目标测算模型，支持决策制定。</p><p>5、数据建设：根据业务需求进行埋点规划、接口开发、数据底表维护等工作。</p><p>任职要求</p><p>1、本科及以上学历，统计学、数学等理工科类或商科类相关专业优先。</p><p>2、熟练使用Excel、SQL（必须项）等数据分析工具，能熟练使用python、BI（加分项）工具者优先。</p><p>3、具备良好逻辑思维能力和沟通表达能力，能够快速理解并整合业务需求。</p><p>4、具备出色的沟通表达与跨团队协调能力。</p><p>5、有跨境电商运营、商业分析实习经验者优先。</p><h2 id="26届正式批-数据分析师（北美业务）">26届正式批-数据分析师（北美业务）</h2><p>部门介绍：</p><p>北美业务部成立于2011年，团队规模约150人，负责开拓与管理美国、加拿大市场。这里是Shokz征服成熟市场的精锐之师！ 2013年起，我们成功进驻Best Buy（全球最大家用电子产品零售集团）、山姆会员店等商超巨头，布局超万家门店。亚马逊店铺评分4.9，获亚马逊年度光芒品牌奖。近7年营收增长超百倍，攻坚高端，见证奇迹！</p><p>团队文化与发展：</p><p>伴随着公司快速发展，部门也处于团队成员大规模扩招期！在这里，我们相信“君子不器”，我们相信‘“极度坦诚”，我们会为每一位成员量身定制IDP（个人成长计划），我们发自内心的相信每个人都是独一无二的个体，拥有无限的潜能！欢迎加入我们！</p><p>常见Q&amp;A</p><p>Q：面试后多久会有结果？</p><p>A：一般一周左右会有面试结果，如果面试通过将会收到下一轮面试的邀请邮件（如果面试官没有时间则会延迟通知），没有通过则会收到面试结果邮件。</p><p>Q：收到预约面试邀请但是时间不合适怎么办？</p><p>A：收到预约面试邀请时选择”时间不合适“即可，我们会在下一次再发起预约面试邀请。</p><p>Q：岗位是否需要常驻海外？出差情况如何？</p><p>A：目前没有外派需求，主要是根据业务需求进行出差安排，一般一年累计出差时间约2-3个月，一次出差持续2-3周。</p><h1>PDD</h1><h2 id="26届校招PDD跨境数据分析师">26届校招PDD跨境数据分析师</h2><p>1、分析业务数据，通过深度挖掘数据，帮助各部门发现、分析和解决问题、优化产品需求；</p><p>2、监控和跟踪数据异常波动情况，进行探索分析和问题定位；</p><p>3、设计实验方案，评估业务策略的效果，提出改进建议；</p><p>4、负责业务相关日常报表的整理分析，对业务进行阶段性总结归纳；</p><p>5、深入理解业务，发现业务特征和潜在机会，给出有效的行动建议。</p><h1>bilibili</h1><p>1、负责B站游戏商业生态相关业务的数据分析工作，通过分析帮助业务解决问题并实现业务目标；</p><p>2、与产品/运营/研发等配合，推进数据分析在具体业务场景中的应用，找到数据现象背后的成因，输出优化策略，提升游戏业务整体ROI；</p><p>3、设计A/B实验、因果推断模型等数据分析方案，对业务优化和决策结论做验证或推演，提供高效的分析方法；</p><p>4、探索游戏分发的商业广告和联运业务的增长机会点，基于业务模式、竞对研究等角度，为业务方向提供数据决策支持。</p><h1>Shopee</h1><h2 id="数据分析师">数据分析师</h2><p>1.负责中国跨境电商业务数据提取、数据分析、商业洞察等工作，运用数据驱动决策，为业务增长提供支持。</p><p>2.设计并完善数据基建与数据分析框架，为业务团队提供全面、准确的业务指标支持。</p><p>3.充分理解业务逻辑和目标，能够准确把握业务需求，从业务角度出发，识别和拆解问题，通过数据分析提供解决方案，助力业务决策。</p><p>4.与业务团队建立有效的沟通渠道，能够制作清晰的图表与报告，并通过良好的表达与沟通，向业务团队有效传达数据分析结果。</p><p>5.独立负责核心数据分析项目，从问题定义到结果交付，全面负责分析项目，具备一定的项目管理能力。</p><h1>得物</h1><h2 id="电商平台用户运营">电商平台用户运营</h2><blockquote><p>（数据分析方向 12-14K）</p></blockquote><p>①分析货品：结合服装&amp;女装品类特征，分析洞察新老客分层货品特征、及盘点货品清单，及场域特征；</p><p>②活动报名：协同用增、外投团队，内部商家团队，根据用户特性及货品分层，通过权益，拉新活动报名方式带来用户和订单；</p><p>③搭建用户报表、数据分析报表，推动产品迭代。</p><h1>招联</h1><h2 id="贷后策略分析师">贷后策略分析师</h2><p>1、负责逾期客户的运营活动体系的建设，围绕客户旅程的各个环节，制定并设计运营活动和服务流程；</p><p>2、负责逾期客户的专项客群运营策略，深度分析用户行为，制定并优化运营策略及方案；</p><p>3、负责各种运营活动的数据分析工作，满足各类业务观测和决策依据的数据需求；</p><p>4、搭建、管理和优化业务管理相关的系统和数据报表体系。</p><h2 id="数据分析（2026秋招）">数据分析（2026秋招）</h2><p>你将深入了解公司的核心业务场景，并通过信贷全流程分析（获客、审批、额度、定价、贷后管理）、用户运营分析（生命周期价值、行为分析）、活动及渠道效果评估，运用数据分析技能，挖掘数据价值，驱动业务决策优化、促进健康增长。具体职责包括：</p><p>1、基于对业务场景的深刻认知，运用数据分析技术精准定位业务痛点、识别增长机会（如提升转化率、优化客群结构），产出具有业务指导意义的数据分析报告与可视化成果；</p><p>2、结合金融业务目标，参与设计、优化关键业务指标（KPI） 指标体系；搭建自动化数据监控看板（如Tableau, Power BI等），实时跟踪运营效率等核心业务健康度，主动发现异常并预警，为管理层决策提供及时依据；</p><p>3、协同产品、运营等业务团队，将数据分析结论（如用户分群特征、活动ROI）转化为清晰、可落地的业务建议或优化策略，并推动解决方案的实施与效果追踪评估；</p><p>4、支撑借贷转化模型、用户价值模型等金融核心模型/策略的开发、验证、监控与效果分析，利用数据分析评估模型性能及业务影响。</p><p>任职要求：</p><p>1、2026届毕业生，数学、统计学、运筹学、计算机科学、金融工程、经济学等相关专业本科及以上学历；</p><p>2、有金融科技、互联网、银行/咨询公司等相关领域的数据分析实习经历，对金融产品逻辑、用户金融行为有强烈兴趣和扎实认知，能够将数据分析技术与具体金融业务问题紧密结合；</p><p>3、必须熟练掌握复杂SQL查询编写（多表连接、子查询、窗口函数、性能优化等），能高效提取和处理大规模金融业务数据；</p><p>4、精通Python或R其中一种，熟练使用</p><p>Pandas/Numpy（Python）进行数据清洗、分析与建模；了解常用机器学习库（如Scikit-learn，</p><p>Caret) ;</p><p>5、对复杂的数据分析结果（如模型输出、AB测试结果）能形成独立的、数据驱动的业务见解，并能清晰阐述其背后的逻辑与业务含义；</p><p>6、对数据有强烈的好奇心和敏锐度，能使用AI工具从海量数据中主动发现规律、异常、问题与潜在机会。</p><h1>马上消费金融</h1><h2 id="贷后数据分析专家">贷后数据分析专家</h2><p>1、根据公司风险管理要求，结合实际业务现状制定运营策略，并跟踪策略落地情况，持续提出优化方案，完善制度、政策、流程；</p><p>2、持续优化投诉风险和催收相关的监控报表，及时发现和处理风险，并向上级领导汇报；</p><p>3、深入分析催收各维度数据、持续优化运营激励方案，不断提高效率；</p><p>4、参与成本/收益分析，制定优化方案；</p><p>5、推动业务相关系统的优化和建设；</p><p>6、参与业务相关模型的建设和优化。</p><h1>度小满</h1><h2 id="数据分析师（信货）">数据分析师（信货）</h2><p>1.针对代运营业务场景设计数据模型、制定关键数据指标，通过进行数据拉取、加工、分析、与发掘，制定标准化的数据工具及监测体系。</p><p>2.能够基于业务场景，负责代运营业务数据的整理和分析，监控关键业务指标如贷款业务数据、转化数据、vintage风险数据等，将复杂数据转化为易于与理解的图表和报告，支持业务部门数据需求。</p><p>3.做好收益测算与分析，构建和维护收益测算模型，分析不同产品、客群的整体收益表现，评估业务盈利能力，并结合成本收益分析，为业务决策提供支持与依据。</p><p>4.以量化分析方法驱动决策，通过分析多维度数据，识别业务增长点及风险点，推出优化建议，定期生成业务的分析报告。</p><p>资深数据分析师-策略实验方向</p><p>工作内容：</p><p>1.搭建实验科学评估框架，科学评估各类营销活动、策略实验等效果，看清产品/策略效果及潜在机会，提出有效建议，沉淀认知并助力业务不断迭代</p><ol><li>从业务需求出发，迭代优化科学实验（Abtest）框架，联动产研，推进相关的数据产品和体系建设落地</li><li>量化决策建设，各环节业务抽象、数据建设，逐步完善量化决策体系，推动数据化经营决策</li><li>数据体系建设，包括与核心kpi相关的过程指标建设、重点经营环节的数据挖掘，相关工具化的建设与优化</li></ol><p>任职要求：</p><p>1、在国内外主流互联网公司拥有3年及以上数据科学、数据分析或相关领域的工作经验。</p><p>2、熟练掌握SQL、Python、R、SAS 等统计软件者；熟练应用ABtest实验设计及统计分析，有科学评估或平台建设优化经验优先</p><p>3、能深刻理解业务，对数据分析、用户增长、数据化运营有一定了解，设计过业务型数据产品相关工作优先；</p><p>4、自我驱动，有Owner意识，交付能力强，面对复杂情况能够独立工作</p><p>5、结果导向，跨团队与部门的沟通能力强，有较强的团队作意识和能力</p><h2 id="商业分析师-消费信贷">商业分析师-消费信贷</h2><p>1.负责信贷用户全生命周期运营管理，对用户拉新、复购，留存负责；建立完整的信贷运营框架，洞察用户需求，制定经营策略和机制，协同模型、风控、电销企微等，对用户进行分层管理，推动增长目标达成；</p><p>2.能围绕不同场景下用户需求的痛点，落地一系列针对性增长，留存项目，在提升用户LTV的同时持续强化用户心智：</p><p>3.数据照动，能快速建立有效的分析框架，监控业务数据与活动效果，从数据中调察问题，调整相应运营策略；</p><p>4.关注用户体验，对影响用户行为和使用体验方面进行监控，积极有效地推动产品进行持续的优化和改进。</p><p>岗位要求</p><p>1.本科及以上学历，3年以上用户运营经验，对用户增长，运营分析有清晰的方法和思路；</p><p>2.有2年以上信贷行业经验，熟悉信贷产品，有信贷风控策略/用户运营/数据分析经验者优先；</p><p>3.较强的数据分析能力，能够通过对各种运营数据的归纳、分析，发现井解决问题；</p><p>4.有行业视角和创新想法，逻辑清晰，数据敏感，善于沟通，善于解决复杂问题；</p><p>5.掌握基础的的项目管理知识与能力，能够高效完成多项任务。</p><h1>蚂蚁集团</h1><h2 id="商业数据分析专家-国际信贷">商业数据分析专家-国际信贷</h2><blockquote><p>上海/杭州</p></blockquote><p>1.熟悉信贷相关业务，负责各业务条线数据支持、分析、商业测算及预测等工作；</p><p>2.通过数据分析，建立客户全生命周期管理体系，及时提出用户增长及营销策略建议，提升客户转化率与使用率；</p><p>3.负责国际化信贷业务及风险指标设计，业务数据报表需求分析、设计和落地，为业务和管理层决策提供依据；</p><p>4.对业务及风险指标进行监控和分析，建立预警机制，推动业务问题的解决.</p><h1>【面试实战】</h1><ol><li><p>你在搭建多维度指标体系时，是如何确定核心指标的？比如针对高风险用户，为什么选择 “专项额度使用率” 而不是 “额度申请率” 作为核心监控指标？</p><ol><li>从结果、过程、辅助、风险这几个维度拆解</li><li>申请率只能反映用户的<strong>初步兴趣</strong>，但高风险用户可能存在 “申请后闲置” 的情况，使用率才<strong>直接关联</strong>到后续的权益包购买、分期还款等核心业务环节，也就更能体现项目能不能真正激活用户价值。</li></ol></li><li><p>那再追问一下，你在监控 “专项额度使用率” 时，有没有设置预警阈值？如果使用率突然下降，你会优先从哪些维度排查原因？</p><ol><li>先按<strong>用户分层</strong>排查，因为不同分层的用户行为差异可能很大。比如可以先看是新申请额度的用户使用率下降，还是老用户突然不用了；再进一步，新用户可能是触达渠道出了问题（比如引导流程不清晰），老用户可能是权益包吸引力下降，或者还款体验不好。另外，你之前提到过用户画像，有没有考虑过结合 “消费场景” 这个维度？比如<strong>某类高频消费场景</strong>（如家电分期）的使用率下降，可能对应权益包里的相关品类需要调整。</li></ol></li><li><p>请你说说，在数据分析项目里，你是如何确保数据质量的？</p><ol><li>数据使用之前有采集、清洗、验证。比如处理缺失值或异常值</li><li>之前在处理用户行为数据时，发现有部分数据的时间戳格式不一致，导致无法进行后续分析。我通过编写脚本批量校验时间戳格式，将异常数据筛选出来，再联系采集端确认问题原因，修正数据。</li></ol></li><li><p>如果你的数据分析结果和业务方的预期不一致，你会怎么处理？</p><ol><li>首先，和业务方再次沟通，确认双方对业务需求的理解是否一致，比如分析的目标、维度、指标定义等。</li><li>其次，回溯自己的分析过程，检查数据的可靠性和准确性，分析模型是否合理，或者有没有遗漏关键影响因素。</li><li>最后，根据检查结果，要么修正分析过程，要么和业务方一起探讨，看看是否存在业务层面的特殊情况。</li></ol></li><li><p>你常用的数据分析工具是什么？请说说你用其中一个工具解决过的实际业务问题。</p><ol><li>ab实验、因果推断</li><li>当时商城权益包点击率不高，我提出假设：增加满减券+免运费的组合权益，会比单一的满减券更能吸引用户点击。实验设计上，根据过往点击率和预期提升效果，计算出能保证统计显著的样本量，实验周期为7天，排除周末和工作日的消费差异影响。最后实验结果显示</li></ol></li><li><p>在数据分析中，如果遇到数据量特别大，导致分析工具运行缓慢的情况，你会怎么解决？</p><ol><li>数据抽样、优化代码、数据预处理</li><li>我会进行数据抽样，在保证<strong>样本代表性</strong>的前提下，用部分数据做初步分析，确定核心分析方向后再用全量数据验证。</li></ol></li><li><p>请你说说，如何用数据分析帮助业务方制定用户留存策略？</p><ol><li>多维度指标体系、用户分群、转化归因漏斗、流失节点、行为差异、针对性留存策略、AB实验验证</li><li>首先，搭建多维度留存指标体系，包括次日、7 日、30 日留存率，同时按用户来源、画像（如年龄、消费能力）、使用功能等维度拆分指标，明确不同群体的留存差异。其次，用转化归因漏斗分析用户留存路径，比如从首次打开 APP、浏览商品、完成首单到再次复购，找出各环节的流失节点，比如很多用户首单后不再复购，就重点分析首单体验中的问题。然后，对高留存和低留存用户进行分群对比，分析他们的行为差异，比如高留存用户常使用的核心功能、平均使用时长，低留存用户流失前的操作行为。最后，基于这些分析结果，提出针对性留存策略，比如对首单后未复购用户推送专属复购券，对高频使用某功能的用户优化该功能体验，再通过 A/B 实验验证策略效果，持续迭代。这样从指标搭建、问题定位到策略落地，形成完整闭环</li></ol></li><li><p>当你需要向非技术背景的业务方汇报数据分析结果时，你会怎么做来确保他们能理解并接受你的建议？</p><ol><li>避免专业术语、核心结论聚焦、直观图表展示、结合业务解读、具体可落地建议</li></ol></li><li><p>在数据分析项目中，如果你发现数据结果和业务直觉不一致，你会怎么处理？</p><ol><li>检查数据的可靠性、准确性；检查口径、指标定义是否和业务方一致</li><li>忽略了某些关键因素，季节波动性、用户群体变化、或者近期有促销活动等外部影响</li><li>会和业务方沟通，了解他们的直觉是基于什么经验，是否有未考虑到的场景</li><li>最后，要么修正之前的业务认知，要么补充数据维度，直到找到结果不一致的根源。</li></ol></li><li><p>请你描述一个你参与过的最有挑战性的数据分析项目，说说你遇到了什么困难，是怎么解决的，最后结果怎么样？</p></li></ol>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Excel提效</title>
      <link href="/2026/01/15/Excel%E6%8F%90%E6%95%88/"/>
      <url>/2026/01/15/Excel%E6%8F%90%E6%95%88/</url>
      
        <content type="html"><![CDATA[<h2 id="定制工作台Alt1到Alt9">定制工作台Alt1到Alt9</h2><p><img src="./../Excel%E6%8F%90%E6%95%88/file-20251127164556854.png" alt="alt++"><br>【其他命令】-【快速访问工具栏】-自己修改<br><img src="./../Excel%E6%8F%90%E6%95%88/file-20251127164745404.png" alt=""></p><p>财务分享的<br>最值得放在最上面的：</p><ol><li>粘贴类<ol><li>粘贴值</li><li>粘贴链接</li><li>粘贴公式</li></ol></li><li>标记类<ol><li>标记黄色</li><li>标记绿色</li><li>去掉标记</li></ol></li><li>格式类<ol><li>常用格式</li><li>正文/表头</li></ol></li><li>标记类和格式类如何实现–&gt;宏：记录大量操作的功能<ol><li>–&gt;<strong>【录制宏】</strong></li></ol></li><li>其他功能<ol><li>筛选功能</li></ol></li></ol><p>Excel快捷键</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>笔记系统搭建</title>
      <link href="/2025/11/25/%E7%AC%94%E8%AE%B0%E7%B3%BB%E7%BB%9F%E6%90%AD%E5%BB%BA/"/>
      <url>/2025/11/25/%E7%AC%94%E8%AE%B0%E7%B3%BB%E7%BB%9F%E6%90%AD%E5%BB%BA/</url>
      
        <content type="html"><![CDATA[<h1>多个可同步工具</h1><h2 id="Obsidian">Obsidian</h2><p>[Obsidian实现多端同步 | Kkkika](<a href="https://kkkika.github.io/2025/11/22/Obsidian%E5%AE%9E%E7%8E%B0%E5%A4%9A%E7%AB%AF%E5%90%8C%E6%AD%A5/">Obsidian实现多端同步 | Kkkika</a>)</p><h2 id="幕布">幕布</h2><p>幕布在手机上记东西最舒服了，不用自己做同步，而且不用git同步，网页版也不卡，用了一段时间obsidian后，一同步冲突就会很烦。虽然后面研究Git插件的使用后设置为固定时间pull，还有固定时间同步并取消文件停止编辑再同步，解决了同步问题。但是文件编辑还是在typora，而明明弄好了obsidian怎么不直接用obsidian，而是继续用回typora</p><h1>Ob使用</h1><h2 id="样式调整">样式调整</h2><h3 id="typora打开">typora打开</h3><p>因为obsidian没有软换行，而之前用typora写的笔记在obsidian打开就会有多余空行，很难受。</p><p><img src="./../%E7%AC%94%E8%AE%B0%E7%B3%BB%E7%BB%9F%E6%90%AD%E5%BB%BA/image-20260115145836031.png" alt=""></p><p>后来研究之后发现是<strong>换行符</strong>的问题：</p><p><img src="./../%E7%AC%94%E8%AE%B0%E7%B3%BB%E7%BB%9F%E6%90%AD%E5%BB%BA/image-20260220225350499.png" alt="image-20260220225350499"></p><h3 id="附件路径插件">附件路径插件</h3><blockquote><p>下载插件【Custom Attachment Location】</p><p>可自定义文件存储位置</p></blockquote><p>修改自己想要的路径：</p><p>source是根目录，所以附件位置前面不加东西，但是blog识别是按照<code>./../</code>所以url格式要加<code>./../</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$&#123;noteFileName&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">image-$&#123;date:YYYYMMDDHHmmssSSS&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">./../$&#123;noteFileName&#125;/$&#123;generatedAttachmentFileName&#125;</span><br></pre></td></tr></table></figure><p><img src="./../%E7%AC%94%E8%AE%B0%E7%B3%BB%E7%BB%9F%E6%90%AD%E5%BB%BA/image-20251125154641126.png" alt="image-20251125154641126"></p><p>示例：</p><p><img src="./../%E7%AC%94%E8%AE%B0%E7%B3%BB%E7%BB%9F%E6%90%AD%E5%BB%BA/image-20251125154706036.png" alt="image-20251125154706036"></p><p><img src="./../%E7%AC%94%E8%AE%B0%E7%B3%BB%E7%BB%9F%E6%90%AD%E5%BB%BA/image-20251125154736113.png" alt="image-20251125154736113"></p><h3 id="可导出为word-html">可导出为word/html</h3><p>安装插件【Enhancing Export】</p><figure class="highlight http"><table><tr><td class="code"><pre><span class="line">https://github.com/jgm/pandoc/releases</span><br></pre></td></tr></table></figure><h3 id="兼容typora效果">兼容typora效果</h3><h4 id="如何进入开发者">如何进入开发者</h4><p>在Obsidian中按 <strong><code>Ctrl+Shift+I</code></strong>（Windows/Linux）或 <strong><code>Cmd+Option+I</code></strong>（Mac）打开开发者工具</p><h4 id="语法解析">语法解析</h4><blockquote><p>语法分解，代码片段解析</p></blockquote><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.cm-line</span><span class="selector-pseudo">:not</span>(<span class="selector-pseudo">:has</span>(&gt; br<span class="selector-pseudo">:only-child</span>)) + <span class="selector-class">.cm-line</span><span class="selector-pseudo">:has</span>(&gt; br<span class="selector-pseudo">:only-child</span>)</span><br></pre></td></tr></table></figure><ul><li>这是一个<strong>相邻兄弟选择器</strong>（<code>+</code>），选中<strong>两个连续</strong>的 <code>.cm-line</code> 元素</li><li><strong>前半部分</strong>：<code>.cm-line:not(:has(&gt; br:only-child))</code> - <strong>前一个</strong>行</li><li><strong>后半部分</strong>：<code>.cm-line:has(&gt; br:only-child)</code> - <strong>后一个</strong>行</li></ul><table><thead><tr><th style="text-align:left">代码片段</th><th style="text-align:left">含义</th><th style="text-align:left">作用</th></tr></thead><tbody><tr><td style="text-align:left"><code>.cm-line</code></td><td style="text-align:left">类选择器</td><td style="text-align:left">选中所有Obsidian编辑器行</td></tr><tr><td style="text-align:left"><code>:not(...)</code></td><td style="text-align:left">否定伪类</td><td style="text-align:left"><strong>排除</strong>符合括号内条件的元素</td></tr><tr><td style="text-align:left"><code>:has(...)</code></td><td style="text-align:left">关系伪类</td><td style="text-align:left"><strong>必须包含</strong>符合括号内条件的子元素</td></tr><tr><td style="text-align:left"><code>&gt;</code></td><td style="text-align:left">子选择器</td><td style="text-align:left">直接子元素（不是后代）</td></tr><tr><td style="text-align:left"><code>br:only-child</code></td><td style="text-align:left">br标签且是唯一子元素</td><td style="text-align:left">该行<strong>只有</strong>一个<code>&lt;br&gt;</code>元素</td></tr><tr><td style="text-align:left"><code>+</code></td><td style="text-align:left">相邻兄弟选择器</td><td style="text-align:left">选择<strong>紧跟在后的兄弟元素</strong></td></tr></tbody></table><p>反过来不就行了</p><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.cm-line</span><span class="selector-pseudo">:has</span>(&gt; br<span class="selector-pseudo">:only-child</span>) +<span class="selector-class">.cm-line</span><span class="selector-pseudo">:not</span>(<span class="selector-pseudo">:has</span>(&gt; br<span class="selector-pseudo">:only-child</span>)) &#123;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0.2</span>);</span><br><span class="line">    <span class="attribute">margin-block-start</span>: <span class="number">8px</span> <span class="meta">!important</span>;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="CSS实现">CSS实现</h4><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment"> * Obsidian 自定义样式表（适配 Typora 显示标准）</span></span><br><span class="line"><span class="comment"> * 适用场景：Obsidian 编辑模式 + 预览模式</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* ===================== 1. 列表缩进统一处理 ===================== */</span></span><br><span class="line"><span class="comment">/* 编辑模式：列表基础缩进 - 所有层级列表统一基础缩进规则 */</span></span><br><span class="line"><span class="selector-class">.cm-s-obsidian</span> <span class="selector-class">.HyperMD-list-line</span>,</span><br><span class="line"><span class="selector-class">.cm-s-obsidian</span> <span class="selector-class">.HyperMD-list-line-2</span>,</span><br><span class="line"><span class="selector-class">.cm-s-obsidian</span> <span class="selector-class">.HyperMD-list-line-3</span>,</span><br><span class="line"><span class="selector-class">.cm-s-obsidian</span> <span class="selector-class">.HyperMD-list-line-4</span>,</span><br><span class="line"><span class="selector-class">.cm-s-obsidian</span> <span class="selector-class">.HyperMD-list-line-5</span>,</span><br><span class="line"><span class="selector-class">.cm-s-obsidian</span> <span class="selector-class">.HyperMD-list-line-6</span> &#123;</span><br><span class="line">  <span class="attribute">padding-left</span>: <span class="number">2.2em</span> <span class="meta">!important</span>;</span><br><span class="line">  <span class="attribute">text-indent</span>: -<span class="number">2.7em</span> <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 编辑模式：列表嵌套缩进 - 逐级递增嵌套列表的左侧内边距 */</span></span><br><span class="line"><span class="selector-class">.cm-s-obsidian</span> <span class="selector-class">.HyperMD-list-line-2</span> &#123; <span class="attribute">padding-left</span>: <span class="number">3.4em</span> <span class="meta">!important</span>; &#125;</span><br><span class="line"><span class="selector-class">.cm-s-obsidian</span> <span class="selector-class">.HyperMD-list-line-3</span> &#123; <span class="attribute">padding-left</span>: <span class="number">4.6em</span> <span class="meta">!important</span>; &#125;</span><br><span class="line"><span class="selector-class">.cm-s-obsidian</span> <span class="selector-class">.HyperMD-list-line-4</span> &#123; <span class="attribute">padding-left</span>: <span class="number">5.8em</span> <span class="meta">!important</span>; &#125;</span><br><span class="line"><span class="selector-class">.cm-s-obsidian</span> <span class="selector-class">.HyperMD-list-line-5</span> &#123; <span class="attribute">padding-left</span>: <span class="number">7em</span> <span class="meta">!important</span>; &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 列表项上下间距：为列表行添加顶部外边距（提高选择器优先级确保生效） */</span></span><br><span class="line"><span class="selector-tag">body</span> <span class="selector-class">.cm-content</span> <span class="selector-class">.cm-line</span><span class="selector-class">.HyperMD-list-line</span> &#123;</span><br><span class="line">  <span class="attribute">margin-top</span>: <span class="number">0.3em</span> <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* ===================== 2. 换行与空行处理 ===================== */</span></span><br><span class="line"><span class="comment">/* 2.1 严格换行功能（阅读模式段落内换行生效）- 暂注释未启用 */</span></span><br><span class="line"><span class="comment">/* .markdown-reading-view p &#123;</span></span><br><span class="line"><span class="comment">    white-space: pre-line;</span></span><br><span class="line"><span class="comment">&#125; */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 2.2 Enter换行空行处理：隐藏非空行后的单个空行 */</span></span><br><span class="line"><span class="comment">/* 先把非空行上高提高一点 */</span></span><br><span class="line"><span class="selector-class">.cm-line</span><span class="selector-pseudo">:has</span>(&gt; br<span class="selector-pseudo">:only-child</span>) +<span class="selector-class">.cm-line</span><span class="selector-pseudo">:not</span>(<span class="selector-pseudo">:has</span>(&gt; br<span class="selector-pseudo">:only-child</span>)) &#123;</span><br><span class="line">    <span class="attribute">margin-block-start</span>: <span class="number">8px</span> <span class="meta">!important</span>;  </span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.cm-line</span><span class="selector-pseudo">:not</span>(<span class="selector-pseudo">:has</span>(&gt; br<span class="selector-pseudo">:only-child</span>)) + <span class="selector-class">.cm-line</span><span class="selector-pseudo">:has</span>(&gt; br<span class="selector-pseudo">:only-child</span>) &#123;</span><br><span class="line"> <span class="attribute">display</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* 2.3 Enter换行空行处理：仅隐藏连续两个空行中的第二个（保留至少一个空行） */</span></span><br><span class="line"><span class="selector-class">.cm-line</span><span class="selector-pseudo">:has</span>(&gt; br<span class="selector-pseudo">:only-child</span>) + </span><br><span class="line"><span class="selector-class">.cm-line</span><span class="selector-pseudo">:has</span>(&gt; br<span class="selector-pseudo">:only-child</span>)<span class="selector-pseudo">:not</span>(<span class="selector-pseudo">:has</span>(+ <span class="selector-class">.cm-line</span> &gt; br<span class="selector-pseudo">:only-child</span>)) &#123;</span><br><span class="line">  <span class="attribute">display</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 2.4 enter+shift延续行（纯空会被删除） */</span></span><br><span class="line"><span class="selector-class">.cm-line</span><span class="selector-class">.HyperMD-list-line-nobullet</span><span class="selector-pseudo">:not</span>(<span class="selector-pseudo">:has</span>(&gt; <span class="selector-tag">span</span><span class="selector-attr">[class*=<span class="string">&quot;cm-list-&quot;</span>]</span>)) &#123;</span><br><span class="line">  <span class="attribute">display</span>: none <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* ===================== 3. 行间距全局调整 ===================== */</span></span><br><span class="line"><span class="comment">/* 3.1 编辑模式：正文全局行高 */</span></span><br><span class="line"><span class="selector-class">.cm-s-obsidian</span> <span class="selector-class">.cm-line</span> &#123;</span><br><span class="line">  <span class="attribute">line-height</span>: <span class="number">1.6</span> <span class="meta">!important</span>;  <span class="comment">/* 全局行高 */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 3.2 编辑模式：各级标题上下内边距（控制标题与其他内容的间距） */</span></span><br><span class="line"><span class="selector-class">.cm-s-obsidian</span> <span class="selector-class">.cm-header</span> &#123;</span><br><span class="line">  <span class="attribute">padding-top</span>: <span class="number">0.3em</span> <span class="meta">!important</span>;</span><br><span class="line">  <span class="attribute">padding-bottom</span>: <span class="number">0.1em</span> <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* ===================== 4. 图片样式统一（编辑+预览模式） ===================== */</span></span><br><span class="line"><span class="comment">/* vh 说明：视口高度单位，1vh = 1%视口高度，无需依赖父元素高度 */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 4.1 编辑模式：图片容器样式 */</span></span><br><span class="line"><span class="selector-class">.markdown-source-view</span> <span class="selector-class">.cm-content</span> <span class="selector-tag">img</span>,</span><br><span class="line"><span class="selector-class">.markdown-source-view</span> <span class="selector-class">.image-embed</span> <span class="selector-tag">img</span>,</span><br><span class="line"><span class="selector-class">.cm-s-obsidian</span> <span class="selector-class">.cm-widgetBuffer</span> + <span class="selector-tag">img</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: block <span class="meta">!important</span>;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">1.5em</span> auto <span class="meta">!important</span>;</span><br><span class="line">  <span class="attribute">text-align</span>: center <span class="meta">!important</span>;</span><br><span class="line">  <span class="attribute">max-height</span>: <span class="number">40vh</span> <span class="meta">!important</span>;</span><br><span class="line">  <span class="attribute">width</span>: auto <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 4.2 预览/阅读模式：图片容器样式 */</span></span><br><span class="line"><span class="selector-class">.markdown-preview-view</span> <span class="selector-tag">img</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: block <span class="meta">!important</span>;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">1.5em</span> auto <span class="meta">!important</span>;  <span class="comment">/* 上下1.5em，左右auto居中 */</span></span><br><span class="line">  <span class="attribute">max-height</span>: <span class="number">40vh</span> <span class="meta">!important</span>;  <span class="comment">/* 限制最大高度为视口的40% */</span></span><br><span class="line">  <span class="attribute">width</span>: auto <span class="meta">!important</span>;        <span class="comment">/* 保持图片原始宽高比 */</span></span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">3px</span> <span class="meta">!important</span>;  <span class="comment">/* 可选：轻微圆角优化视觉 */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="插件的配置">插件的配置</h2><h3 id="Git插件">Git插件</h3><hr><h3 id="Quiet-Outline插件">Quiet Outline插件</h3><p><strong>常规设置</strong></p><ul><li>默认层级：H2，比较舒服</li><li>自动展开：展开同时折叠剩余标题至设置层级(层级切换器)，这样比较舒服</li></ul><h4 id="一定要">一定要</h4><p>用着用着我突然发现，这个文件老是频繁改动：</p><p><img src="./../%E7%AC%94%E8%AE%B0%E7%B3%BB%E7%BB%9F%E6%90%AD%E5%BB%BA/image-20260221000804655.png" alt="image-20260221000804655"></p><p>我要把它<strong>忽略提交</strong>，详细操作：</p><p>Step1，拉取最新和删除文件：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 先拉取最新的仓库内容（确保本地和远程同步）</span></span><br><span class="line">git pull</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除远程仓库中的目标文件（--cached 表示只删仓库里的，保留本地文件）</span></span><br><span class="line">git <span class="built_in">rm</span> --cached .obsidian/plugins/obsidian-quiet-outline/markdown-states.json</span><br></pre></td></tr></table></figure><p>Step2，忽略提交：</p><p>在仓库的<code>.gitignore</code>文件夹里添加：</p><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">.obsidian/plugins/obsidian-quiet-outline/markdown-states.json</span><br></pre></td></tr></table></figure><p><img src="./../%E7%AC%94%E8%AE%B0%E7%B3%BB%E7%BB%9F%E6%90%AD%E5%BB%BA/image-20260220235450078.png" alt=""></p><p>Step3，推送：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 暂存</span></span><br><span class="line">git add .</span><br><span class="line"></span><br><span class="line"><span class="comment"># 提交删除操作</span></span><br><span class="line">git commit -m <span class="string">&quot;移除不需要追踪的 markdown-states.json 文件&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 推送到远程仓库（完成远程文件删除）</span></span><br><span class="line">git push</span><br></pre></td></tr></table></figure><h1>Ob自制</h1><h2 id="图片url自定义">图片url自定义</h2><ul><li><p>prompt</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">做一个obsidian插件，可以用就行，用最精简的方式实现如下功能：</span><br><span class="line"></span><br><span class="line">批量修改Markdown 内联图片格式，自定义的相对路径</span><br><span class="line">图片附件链接路径![](...)，将附件链接修改成指定自定义格式：如![./../文档文件名/原附件名]()</span><br><span class="line">- 设置里可选择开始执行/保持执行（加监听）</span><br><span class="line">- 设置里可选择附件是移动还是复制</span><br><span class="line">- 设置里可选择制定文件/文件夹</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">帮我的插件写一个readme</span><br><span class="line"></span><br><span class="line">一个完整的插件文档可以包含以下几个部分，你可以根据自己的插件复杂度来取舍：</span><br><span class="line">•封面页：插件名称、一句话介绍、作者和版本号。</span><br><span class="line">•简介：这个插件是做什么的？一句话讲清楚它的核心价值。</span><br><span class="line">• 安装指南：一步步教自己（或别人）如何安装和配置插件，包括所有依赖项。</span><br><span class="line">• 快速上手：用最简单的步骤演示插件最核心的功能，让使用者3分钟内看到效果。</span><br><span class="line">•功能详解：分模块详细介绍每个功能、按钮或配置项的作用。</span><br><span class="line">•配置/自定义：如果插件支持个性化设置，这里要详细说明如何修改配置文件或参数。</span><br><span class="line">•常见问题（FAQ）：预测自己未来可能会遇到的问题，比如“为什么没反应？”、“怎么导出数据？”并给出答案。</span><br><span class="line">•已知问题：诚实地列出插件目前还存在的 bug 或限制。</span><br></pre></td></tr></table></figure></li></ul><h2 id="未引用附件">未引用附件</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">做一个obsidian插件，可以用就行，用最精简的方式实现如下功能：</span><br><span class="line">找出不被markdown引用的本地附件</span><br><span class="line">在查看时可以选择删除</span><br></pre></td></tr></table></figure><h1>Blog</h1><p>快速部署，有exe和bat两种好用的方法，双击就可以运行命令行。</p><p>部署到github，cgd.exe：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">C:\Windows\System32\cmd.exe /k <span class="string">&quot;cd C:\Code\KikaBlog\blog &amp;&amp; hexo c &amp;&amp; hexo g &amp;&amp; hexo d&quot;</span></span><br></pre></td></tr></table></figure><p>备份到gitee，gitee.bat：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line"><span class="built_in">cd</span> /d <span class="string">&quot;C:\Code\KikaBlog\blog&quot;</span></span><br><span class="line">git add -A</span><br><span class="line">git commit -m <span class="string">&quot;update&quot;</span></span><br><span class="line">git push</span><br><span class="line">pause</span><br></pre></td></tr></table></figure><p>把上面两个升级成一个双击即可完成部署和备份，先查环境路径：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">where</span> hexo</span><br><span class="line"><span class="built_in">where</span> git</span><br></pre></td></tr></table></figure><p>Blog.bat：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line">:: 进入博客目录</span><br><span class="line"><span class="built_in">cd</span> /d <span class="string">&quot;C:\Code\KikaBlog\blog&quot;</span></span><br><span class="line"></span><br><span class="line">:: 用绝对路径调用 hexo</span><br><span class="line">call <span class="string">&quot;C:\Users\A\.npm-global\hexo.cmd&quot;</span> clean</span><br><span class="line">call <span class="string">&quot;C:\Users\A\.npm-global\hexo.cmd&quot;</span> generate</span><br><span class="line">call <span class="string">&quot;C:\Users\A\.npm-global\hexo.cmd&quot;</span> deploy</span><br><span class="line"></span><br><span class="line">:: 用绝对路径调用 git</span><br><span class="line">call <span class="string">&quot;C:\Program Files\Git\cmd\git.exe&quot;</span> add -A</span><br><span class="line">call <span class="string">&quot;C:\Program Files\Git\cmd\git.exe&quot;</span> commit -m <span class="string">&quot;update&quot;</span></span><br><span class="line">call <span class="string">&quot;C:\Program Files\Git\cmd\git.exe&quot;</span> push</span><br></pre></td></tr></table></figure><h2 id="Windows-任务计划程序（推荐）">Windows 任务计划程序（推荐）</h2><ol><li>打开&quot;任务计划程序&quot;<ul><li>按 <code>Win + R</code>，输入 <code>taskschd.msc</code></li><li>或搜索&quot;任务计划程序&quot;</li></ul></li><li>创建基本任务：<ul><li>右侧点击&quot;创建基本任务&quot;</li><li>名称：<code>Hexo自动部署</code></li><li>触发器：选择&quot;每天&quot;，设置时间13:00:00</li><li>操作：选择&quot;启动程序&quot;<ul><li>程序或脚本：<code>cmd.exe</code></li><li>参数：<code>/k &quot;cd C:\Code\KikaBlog\blog &amp;&amp; hexo clean &amp;&amp; hexo g &amp;&amp; hexo d&quot;</code></li><li>起始于：<code>C:\Code\KikaBlog\blog</code></li></ul></li></ul></li></ol><p><img src="./../%E7%AC%94%E8%AE%B0%E7%B3%BB%E7%BB%9F%E6%90%AD%E5%BB%BA/image-20260113174429095.png" alt="image-20260113174429095"></p><p><img src="./../%E7%AC%94%E8%AE%B0%E7%B3%BB%E7%BB%9F%E6%90%AD%E5%BB%BA/image-20260113174634453.png" alt="image-20260113174634453"></p>]]></content>
      
      
      
        <tags>
            
            <tag> Obsidian </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Obsidian-Git插件详细配置</title>
      <link href="/2025/11/23/Obsidian-Git%E6%8F%92%E4%BB%B6%E8%AF%A6%E7%BB%86%E9%85%8D%E7%BD%AE/"/>
      <url>/2025/11/23/Obsidian-Git%E6%8F%92%E4%BB%B6%E8%AF%A6%E7%BB%86%E9%85%8D%E7%BD%AE/</url>
      
        <content type="html"><![CDATA[<h1>Git插件</h1><p>中英文对照每一个配置+解释和建议</p><h2 id="核心概念">核心概念</h2><blockquote><p>工作流：<code>Stage all changes → Commit → Pull  → Push</code></p><p><code>sync ≈ 先pull + 再push</code></p></blockquote><h2 id="配置">配置</h2><h3 id="Automatic（自动提交与同步）">Automatic（自动提交与同步）</h3><p>这部分是核心的自动备份设置：</p><ul><li><p><strong>Split timers for automatic commit and sync</strong>：开启后，自动【提交commit】 和 【同步sync】可以设置<strong>不同的时间间隔</strong>（关闭时共用同一个间隔）。</p></li><li><p><strong>Auto commit-and-sync interval (minutes)</strong>：设置每隔 <code>X</code> 分钟执行自动【提交commit】 和 【同步sync】的操作；设为 <code>0</code>（默认值）则禁用该自动功能。</p><p>当前配置：<code>1</code> 分钟（即每 1 分钟自动提交并同步一次）。</p></li><li><p><strong>Auto commit-and-sync after stopping file edits</strong>：要求上一个配置项「Auto commit-and-sync interval」不能为 <code>0</code>。开启后，会在<strong>停止编辑文件 <code>X</code> 分钟后</strong>自动【提交commit】 和 【同步sync】（编辑文件时不会触发，避免冲突）；关闭则完全按固定时间间隔执行，与文件编辑状态无关。<mark>我自己现在还是在typora编辑，所以这个我还是不开启最舒服</mark></p></li><li><p><strong>Auto commit-and-sync after latest commit</strong>：开启后，会把 “最后一次自动提交同步的时间戳” 更新为 “最近一次提交（含手动提交）的时间戳”，从而减少手动提交后自动执行的频率（避免短时间内重复提交）。通俗解释是 “手动提交后，自动备份的闹钟会重置”。）</p></li><li><p><strong>Auto push interval (minutes)</strong>：设置每隔 <code>X</code> 分钟自动推送本地提交到远程仓库；设为 <code>0</code>（默认值）则禁用自动【推送push】，依赖「commit-and-sync」流程处理。</p></li><li><p><strong>Auto pull interval (minutes)</strong>：设置每隔 <code>X</code> 分钟自动从远程仓库拉取最新变更；设为 <code>0</code>（默认值）则禁用自动【拉取pull】。</p></li><li><p><strong>Auto commit-and-sync only staged files</strong>：关闭。自动提交会包含所有修改过的文件，<strong>无需手动暂存</strong>。（开启：自动提交「仅手动暂存的文件」，需要手动选文件）</p></li><li><p><strong>Specify custom commit message on auto commit-and-sync</strong>：关闭。自动提交使用预设消息（下一个配置），不会弹出输入框。（开启后自动提交时会弹出输入框让你写自定义提交信息）</p></li><li><p><strong>Commit message on auto commit-and-sync</strong>：自动提交的预设消息。预设为 <code>vault backup: &#123;&#123;date&#125;&#125;</code>，用日期作为备份标识。</p></li></ul><table><thead><tr><th>配置项</th><th>中文解释</th><th>建议</th></tr></thead><tbody><tr><td><strong>Split timers for automatic commit and sync</strong></td><td>分离定时器：开启后，自动【提交】和【同步】可设置<strong>不同时间间隔</strong></td><td>按需开启</td></tr><tr><td><strong>Auto commit-and-sync interval</strong></td><td>每隔 X 分钟自动执行提交+同步；设为 <code>0</code> 禁用</td><td>单设备 30-60 分钟，多设备 5-10 分钟</td></tr><tr><td><strong>Auto commit-and-sync after stopping file edits</strong></td><td>停止编辑 X 分钟后自动提交同步（编辑时不触发，避免冲突）</td><td>✅ <strong>强烈建议开启</strong></td></tr><tr><td><strong>Auto commit-and-sync after latest commit</strong></td><td>手动提交后重置自动备份计时器，避免短时间内重复提交</td><td>✅ 建议开启<br />避免手动提交后立即触发自动提交</td></tr><tr><td><strong>Auto push interval</strong></td><td>自动推送间隔（分钟），<code>0</code> 表示不单独自动推送</td><td>使用 commit-and-sync 即可</td></tr><tr><td><strong>Auto pull interval</strong></td><td>自动拉取间隔（分钟），<code>0</code> 表示不自动拉取</td><td>多设备建议设置 5-10 分钟</td></tr><tr><td><strong>Auto commit-and-sync only staged files</strong></td><td>仅自动提交已手动暂存的文件</td><td>关闭 = 自动提交所有变更 ✅</td></tr><tr><td><strong>Specify custom commit message on auto commit-and-sync</strong></td><td>自动提交时弹出输入框自定义提交信息</td><td>关闭 = 使用预设模板 ✅</td></tr><tr><td><strong>Commit message on auto commit-and-sync</strong></td><td>自动提交的预设消息模板</td><td>可自定义</td></tr></tbody></table><hr><h3 id="Commit-message（提交信息）">Commit message（提交信息）</h3><p>这部分控制提交记录的格式：</p><ul><li><p><strong>Commit message on manual commit</strong>：手动提交时的预设消息，当前也是 <code>vault backup: &#123;&#123;date&#125;&#125;</code>。<strong>可用占位符</strong>：<code>&#123;&#123;date&#125;&#125;</code>（日期）、<code>&#123;&#123;hostname&#125;&#125;</code>（设备名）、<code>&#123;&#123;numFiles&#125;&#125;</code>（变更文件数量）、<code>&#123;&#123;files&#125;&#125;</code>（变更文件名）。</p></li><li><p><strong>Commit message script</strong>：空，不启用。通过 <code>sh -c</code> 执行一段脚本，<strong>自动生成提交信息</strong>，可以结合 AI 工具（如 ChatGPT）来生成规范的 commit message。</p><p><strong>可用占位符</strong>：<code>&#123;&#123;hostname&#125;&#125;</code>、<code>&#123;&#123;date&#125;&#125;</code>。</p></li><li><p><strong>1763878912000 placeholder format</strong>：</p></li><li><p>定义提交信息中 <code>&#123;&#123;date&#125;&#125;</code> 占位符的日期格式，基于 Moment.js 的语法。当前配置：<code>YYYY-MM-DD HH:mm:ss</code>，这会生成类似 <code>2025-10-08 15:30:00</code> 这样的日期格式。</p></li><li><p><strong>List filenames affected by commit in the commit body</strong>：关闭。提交信息里不会列出具体改动的文件名。</p></li></ul><table><thead><tr><th>配置项</th><th>中文解释</th><th>当前配置</th></tr></thead><tbody><tr><td><strong>Commit message on manual commit</strong></td><td>手动提交时的预设消息</td><td><code>vault backup: &#123;&#123;date&#125;&#125;</code></td></tr><tr><td><strong>Commit message script</strong></td><td>通过脚本自动生成提交信息（可接 AI）</td><td>空（未启用）</td></tr><tr><td><strong>1763878912000 placeholder format</strong></td><td>日期格式（Moment.js 语法）</td><td><code>YYYY-MM-DD HH:mm:ss</code></td></tr><tr><td><strong>List filenames affected by commit in the commit body</strong></td><td>提交信息正文中列出变更的文件名</td><td>关闭</td></tr></tbody></table><hr><h3 id="Pull（拉取设置）">Pull（拉取设置）</h3><blockquote><p><mark>建议都开启</mark></p></blockquote><p>这部分控制从远程仓库拉取更改的行为：</p><ul><li><strong>Merge strategy</strong>：设为 <code>Merge</code>。拉取远程更改时用合并方式，保留提交历史。</li><li><strong>Pull on startup</strong>：开启。Obsidian 启动时会自动拉取远程仓库的最新更改，确保本地笔记是最新的。</li></ul><table><thead><tr><th>配置项</th><th>中文解释</th><th>建议</th></tr></thead><tbody><tr><td><strong>Merge strategy</strong></td><td>合并策略：<code>Merge</code>（合并）或 <code>Rebase</code>（变基）</td><td>✅ 建议 <code>Merge</code>，保留完整历史</td></tr><tr><td><strong>Pull on startup</strong></td><td>Obsidian 启动时自动拉取远程最新更改</td><td>✅ <strong>多设备必开</strong>，防止冲突</td></tr></tbody></table><hr><h3 id="Commit-and-sync（提交同步流程）">Commit-and-sync（提交同步流程）</h3><p>这是插件的核心工作流，默认是「暂存所有→提交→拉取→推送」：</p><ul><li><strong>Push on commit-and-sync</strong>：执行 “提交并同步” 时，是否自动推送本地提交到远程仓库。开启后，同步会包含 “推送” 步骤；关闭则只执行「提交 + 拉取」，不推送，适合你想先验证本地变更再手动推送的场景。</li><li><strong>Pull on commit-and-sync</strong>：执行 “提交并同步” 时，是否先拉取远程的最新变更。开启后，同步会先拉取远程变更，确保本地和远程一致，减少冲突。</li></ul><table><thead><tr><th>配置项</th><th>中文解释</th><th>建议</th></tr></thead><tbody><tr><td><strong>Push on commit-and-sync</strong></td><td>执行同步时自动推送到远程</td><td>✅ 开启，确保备份到云端</td></tr><tr><td><strong>Pull on commit-and-sync</strong></td><td>执行同步时先拉取远程变更</td><td>✅ <strong>必开</strong>，先同步再推送，减少冲突</td></tr></tbody></table><hr><p>**Line author information **</p><ul><li><strong>Show commit authoring information next to each line</strong>：关闭。不在编辑器每行旁显示作者、提交哈希等信息，保持界面简洁。</li></ul><table><thead><tr><th>配置项</th><th>中文解释</th><th>建议</th></tr></thead><tbody><tr><td><strong>Show commit authoring information next to each line</strong></td><td>在每行代码旁显示作者、提交哈希等信息</td><td>关闭 ✅，保持界面简洁，减少性能开销</td></tr></tbody></table><hr><p><strong>History view</strong></p><ul><li><strong>Show Author</strong>：设为 <code>Hide</code>。历史视图里不显示提交作者。</li><li><strong>Show Date</strong>：开启。历史视图里显示提交日期，使用你设置的<code>&#123;&#123;date&#125;&#125;</code> 格式。</li></ul><hr><h3 id="Source-control-view（源码控制视图）">Source control view（源码控制视图）</h3><ul><li><p>Automatically refresh source control view on file changes</p><p>开关已开启：文件内容变化时，自动刷新 Git 源码控制视图。提示在性能较差的设备上可能卡顿，可关闭此选项。</p></li><li><p>Source control view refresh interval</p><p>刷新间隔，700 毫秒，文件变化后等待多久刷新。避免频繁刷新影响性能。</p></li></ul><table><thead><tr><th>配置项</th><th>中文解释</th><th>建议</th></tr></thead><tbody><tr><td><strong>Automatically refresh source control view on file changes</strong></td><td>文件变更时自动刷新 Git 面板</td><td>性能差设备建议关闭</td></tr><tr><td><strong>Source control view refresh interval</strong></td><td>刷新间隔（毫秒）</td><td>性能差设备建议增大到 2000+</td></tr></tbody></table><hr><h3 id="Miscellaneous（杂项设置）">Miscellaneous（杂项设置）</h3><ul><li>Diff view style<br>差异视图样式，当前是 “Split”（分栏）模式。说明说 Split 模式的 diff 是编辑器生成的，不是 Git，好处是可以在视图里编辑文本。</li><li>通知相关开关<ul><li><code>Disable informative notifications</code>：禁用信息性通知（Git 操作的通知）。（避免打扰）</li><li><code>Disable error notifications</code>：禁用所有错误通知，当前为关闭状态。</li><li><code>Hide notifications for no changes</code>：当没有需要提交 / 推送的变更时，隐藏通知，当前为关闭状态。</li></ul></li><li>界面集成开关<ul><li><code>Show status bar</code>：开启状态栏显示，需重启 Obsidian 生效。</li><li><code>File menu integration</code>：开启后，在文件菜单中添加 “暂存”“取消暂存”“添加到 .gitignore” 等 Git 操作选项。</li><li><code>Show branch status bar</code>：开启分支状态栏显示，需重启生效。</li><li><code>Show the count of modified files in the status bar</code>：在状态栏显示修改文件数量，当前为关闭状态。</li></ul></li></ul><table><thead><tr><th>配置项</th><th>中文解释</th><th>当前配置</th><th>建议</th></tr></thead><tbody><tr><td><strong>Diff view style</strong></td><td>差异视图样式：<code>Split</code>（分栏）或 <code>Unified</code>（统一）</td><td><code>Split</code></td><td>Split 支持在 diff 中直接编辑</td></tr><tr><td><strong>Disable informative notifications</strong></td><td>禁用 Git 操作的通知</td><td>关闭</td><td>按需，<mark>避免打扰可开启</mark></td></tr><tr><td><strong>Disable error notifications</strong></td><td>禁用错误通知</td><td>关闭</td><td>建议保持关闭，及时发现问题</td></tr><tr><td><strong>Hide notifications for no changes</strong></td><td>无变更时隐藏通知</td><td>关闭</td><td>开启可减少无意义通知</td></tr><tr><td><strong>Show status bar</strong></td><td>显示 Git 状态栏</td><td>开启</td><td>✅ 建议开启</td></tr><tr><td><strong>File menu integration</strong></td><td>右键文件菜单添加 Git 操作</td><td>开启</td><td>✅ 建议开启，操作便捷</td></tr><tr><td><strong>Show branch status bar</strong></td><td>状态栏显示当前分支</td><td>开启</td><td>需重启生效</td></tr><tr><td><strong>Show the count of modified files in the status bar</strong></td><td>状态栏显示修改文件数量</td><td>关闭</td><td>按需开启</td></tr></tbody></table><hr><h3 id="Commit-author（提交作者信息）">Commit author（提交作者信息）</h3><ul><li><p>Author name for commit</p></li><li><p>Author email for commit</p><p>这两个输入框用于设置 Git 提交时的作者名和邮箱，当前为空，需要你手动填写。</p></li></ul><hr><h3 id="Advanced（高级设置）">Advanced（高级设置）</h3><ul><li><p>Update submodules</p><p>控制是否在 “提交同步” 或 “拉取” 时更新 Git 子模块，说明中提到该功能还有缺失（如冲突文件处理、提交计数等）。</p></li><li><p>路径与环境变量</p><ul><li><code>Custom Git binary path</code>：自定义 Git 可执行文件的路径，默认值为 <code>git</code>（系统默认路径）。</li><li><code>Additional environment variables</code>：添加额外的环境变量（格式为 <code>KEY=VALUE</code>，每行一个），示例为 <code>GIT_DIR=/path/to/git/dir</code>。</li><li><code>Additional PATH environment variable paths</code>：添加额外的系统 PATH 路径，每行一个。</li><li><code>Reload with new environment variables</code>：点击 “Reload” 按钮，用新的环境变量重新加载插件；提示移除旧环境变量需要重启 Obsidian。</li></ul></li><li><p>仓库路径自定义</p><ul><li><code>Custom base path (Git repository path)</code>：设置 Git 仓库相对于 Obsidian Vault 的路径（适用于仓库不在 Vault 根目录的场景）。</li><li><code>Custom Git directory path (Instead of '.git')</code>：自定义 Git 元数据目录的路径（替代默认的 <code>.git</code> 目录），需重启生效。</li></ul></li><li><p><code>Disable on this device</code>：在当前设备禁用该插件，设置不会同步到其他设备，当前为关闭状态。</p></li></ul><hr><h3 id="Support（支持与调试）">Support（支持与调试）</h3><ul><li><strong>Donate</strong>：提供 “Buy me a coffee” 捐赠按钮，支持插件开发者。</li><li><strong>Copy Debug Information</strong>：复制调试信息，用于排查问题。</li><li><strong>Debugging and logging</strong>：提示你可以用快捷键 <code>Ctrl + Shift + I</code> 打开控制台，查看插件的日志信息。</li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> Obsidian </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Obsidian实现多端同步</title>
      <link href="/2025/11/22/Obsidian%E5%AE%9E%E7%8E%B0%E5%A4%9A%E7%AB%AF%E5%90%8C%E6%AD%A5/"/>
      <url>/2025/11/22/Obsidian%E5%AE%9E%E7%8E%B0%E5%A4%9A%E7%AB%AF%E5%90%8C%E6%AD%A5/</url>
      
        <content type="html"><![CDATA[<h1>小白教程|Obsidian实现多端同步</h1><p>提前需要下载的软件：</p><ul><li>Obsidian</li><li>Git（使用GitHub/Gitee同步需要使用git命令）</li><li>Watt Toolkit（在国内使用GitHub同步可能会有网路问题，这个是加速器）</li></ul><h2 id="电脑端">电脑端</h2><p>需要对两个地方进行操作：</p><ol><li>一个电脑的本地文件夹</li><li>一个仓库</li></ol><h3 id="创建文件夹">创建文件夹</h3><p>我选择把文件夹放在【桌面】，文件夹打算叫【vault】。</p><p>首先，打开obsidian，点击【打开本地仓库】选择【vault】文件夹：</p><p><img src="./../Obsidian%E5%AE%9E%E7%8E%B0%E5%A4%9A%E7%AB%AF%E5%90%8C%E6%AD%A5/image-20251125143412387.png" alt="image-20251125143412387"></p><p>现在就可以直接写笔记了，但是还没完成同步，<a href="http://xn--test-k84fuim3rixb579b1lgroj.md">我就先创建一个test.md</a>，假设现在我写了一个笔记：</p><p><img src="./../Obsidian%E5%AE%9E%E7%8E%B0%E5%A4%9A%E7%AB%AF%E5%90%8C%E6%AD%A5/image-20251125143447831.png" alt="image-20251125143447831"></p><p>然后，打开这个文件夹，在根目录下创建【.gitignore】文件：</p><p><img src="./../Obsidian%E5%AE%9E%E7%8E%B0%E5%A4%9A%E7%AB%AF%E5%90%8C%E6%AD%A5/image-20251125144343512.png" alt="image-20251125144343512"></p><p>右键编辑文件，用记事本打开，添加如下两行：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.obsidian/workspace.json</span><br><span class="line">.obsidian/workspace-mobile.json</span><br></pre></td></tr></table></figure><blockquote><p>解释：【.obsidian】文件夹是配置文件夹，要把【workspace.json】文件从git管理的文件里面排除出去，也就是不上传到GitHub上面，这个文件记录了当前工作区的状态，比如打开了哪些笔记，还有当前的页面布局等等，它会被频繁地修改，如果把它上传到git，很容易造成<strong>冲突</strong></p></blockquote><h3 id="创建仓库">创建仓库</h3><p>在GitHub创建仓库：</p><ul><li>只填写[Repository name]，然后点击[Create repository]</li><li>如果不想自己的笔记被别人看，就选择【Private】</li></ul><p><img src="./../Obsidian%E5%AE%9E%E7%8E%B0%E5%A4%9A%E7%AB%AF%E5%90%8C%E6%AD%A5/image-20251125142304630.png" alt="image-20251125142304630"></p><h3 id="第一次推送到仓库">第一次推送到仓库</h3><p>将本地内容首次推送到空的 Git 远程仓库，需按顺序执行以下命令流程。以下是完整操作步骤及注意事项：</p><ol><li><p><strong>初始化本地仓库</strong></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git init</span><br></pre></td></tr></table></figure><ul><li>在项目根目录执行，生成隐藏的.git文件夹</li></ul></li><li><p><strong>添加文件并提交</strong></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git add .</span><br><span class="line">git commit -m <span class="string">&quot;初始化&quot;</span></span><br></pre></td></tr></table></figure><ul><li>必须至少有一次提交，否则推送会失败（Git 不允许推送空分支）。</li></ul></li><li><p><strong>关联远程仓库</strong><br>将&lt;远程仓库URL&gt;<strong>改成自己的</strong></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git remote add origin &lt;远程仓库URL&gt;</span><br></pre></td></tr></table></figure><p>例如：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git remote add origin https://github.com/Kkkika/source.git</span><br></pre></td></tr></table></figure><ul><li><p>验证关联：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git remote -v</span><br></pre></td></tr></table></figure><p>查看 URL 是否正确。</p></li></ul></li><li><p><strong>首次推送并设置上游分支</strong><br><strong>查看分支名</strong>：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git branch -a</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">git push <span class="operator">-</span>u origin master</span><br></pre></td></tr></table></figure></li></ol><p>这个仓库创建的时候忘记截图了，这是我另一个仓库的截图，没有发红报错，有set up字样就是成功：</p><p><img src="./../Obsidian%E5%AE%9E%E7%8E%B0%E5%A4%9A%E7%AB%AF%E5%90%8C%E6%AD%A5/image-20260112223212869.png" alt="image-20260112223212869"></p><h3 id="验证">验证</h3><p>将刚刚创建仓库的页面刷新，看到有文件就是推送成功：</p><p><img src="./../Obsidian%E5%AE%9E%E7%8E%B0%E5%A4%9A%E7%AB%AF%E5%90%8C%E6%AD%A5/image-20251125144701240.png" alt="image-20251125144701240"></p><hr><h2 id="Git插件自动同步">Git插件自动同步</h2><blockquote><p>下载插件【Git】</p></blockquote><p>【设置】–&gt;【第三方插件】–&gt;【关闭安全模式】：</p><p><img src="./../Obsidian%E5%AE%9E%E7%8E%B0%E5%A4%9A%E7%AB%AF%E5%90%8C%E6%AD%A5/image-20251125144910762.png" alt="image-20251125144910762"></p><p>【社区插件市场】–&gt;【浏览】–&gt;搜索【Git】</p><p><img src="./../Obsidian%E5%AE%9E%E7%8E%B0%E5%A4%9A%E7%AB%AF%E5%90%8C%E6%AD%A5/image-20251125145049594.png" alt="image-20251125145049594"></p><p>安装完后点击【启用】–&gt;【选项】：</p><p>可根据自己的需要进行配置，<a href="https://kkkika.github.io/Obsidian-Git%E6%8F%92%E4%BB%B6%E8%AF%A6%E7%BB%86%E9%85%8D%E7%BD%AE/">终极配置指南</a></p><p><img src="./../Obsidian%E5%AE%9E%E7%8E%B0%E5%A4%9A%E7%AB%AF%E5%90%8C%E6%AD%A5/image-20251125145738187.png" alt="image-20251125145738187"></p><h2 id="手机端">手机端</h2><p>手机连接电脑，把文件夹从电脑复制到手机。</p><p>然后</p><p>在手机端找到第三方插件Git的设置，填写三项内容：</p><ol><li>github的用户名</li><li>gitHub的注册邮箱</li><li>github的令牌[[笔记系统搭建#令牌]]</li></ol><p><img src="./../Obsidian%E5%AE%9E%E7%8E%B0%E5%A4%9A%E7%AB%AF%E5%90%8C%E6%AD%A5/image-20251125223433586.png" alt="image-20251125223433586"></p><h3 id="用户名和邮箱">用户名和邮箱</h3><p><img src="./../Obsidian%E5%AE%9E%E7%8E%B0%E5%A4%9A%E7%AB%AF%E5%90%8C%E6%AD%A5/image-20260114114313075.png" alt="image-20260114114313075"></p><h3 id="令牌">令牌</h3><p>Github的token：【Setting】–&gt;【Developer Settings】–&gt;【Personal access tokens (classic)】：</p><p><img src="./../Obsidian%E5%AE%9E%E7%8E%B0%E5%A4%9A%E7%AB%AF%E5%90%8C%E6%AD%A5/image-20260112232500257.png" alt="image-20260112232500257"></p><p><img src="./../Obsidian%E5%AE%9E%E7%8E%B0%E5%A4%9A%E7%AB%AF%E5%90%8C%E6%AD%A5/image-20251125164519074.png" alt="image-20251125164519074"></p><p>命名+有效期+打开repo权限</p><p><img src="./../Obsidian%E5%AE%9E%E7%8E%B0%E5%A4%9A%E7%AB%AF%E5%90%8C%E6%AD%A5/image-20251125164632046.png" alt="image-20251125164632046"></p><h2 id="其他">其他</h2><h3 id="注意事项">注意事项</h3><p>手机和电脑不要同时编辑同一个文件，因为可能产生冲突。如果用git同步文件时，产生了冲突，需要<strong>手动解决</strong>一下。网上有很多教程。</p><h3 id="国内优先Gitee">国内优先Gitee</h3><blockquote><p>GitHub用iPhone没有加速器，根本同步不了，没几天就冲突，改用Gitee试一下</p></blockquote><p>【设置】【私人令牌】</p><p><img src="./../Obsidian%E5%AE%9E%E7%8E%B0%E5%A4%9A%E7%AB%AF%E5%90%8C%E6%AD%A5/image-20260114131159959.png" alt="image-20260114131159959"></p><h3 id="令牌权限对比">令牌权限对比</h3><h4 id="GitHub">GitHub</h4><p>Personal access tokens（个人访问令牌）</p><p>Tokens classic（经典令牌）</p><p>Generate new token classic（生成经典新令牌）</p><p>Full control of private repositories（对私人仓库的完全控制）</p><ul><li><p><strong>repo</strong>: 访问私有仓库的权限。</p></li><li><p><strong>workflow</strong>: 访问 GitHub Actions 工作流的权限。</p></li><li><p><strong>admin:org</strong>: 管理组织的权限（仅限组织所有者）。</p></li><li><p><strong>delete_repo</strong>: 删除仓库的权限。</p></li></ul><h4 id="Gitee">Gitee</h4><ol><li><strong>日常代码操作（拉取 / 推送项目）</strong><ul><li>必选：<code>projects</code>（查看、创建、更新项目，满足代码推拉需求）</li><li>可选：<code>pull_requests</code>（如果需要提交 / 管理 PR）</li></ul></li><li><strong>管理项目问题 / 代码片段</strong><ul><li>若要处理 Issues：加选<code>issues</code></li><li>若要管理代码片段：加选<code>gists</code></li></ul></li></ol><p><strong>不建议勾选的权限（非必要情况）</strong></p><ul><li><p><code>keys</code>（公钥管理）、<code>hook</code>（Webhook 管理）</p></li><li><p><code>groups</code>（组织管理）、<code>enterprises</code>（企业管理）</p></li><li><p><code>emails</code>（邮箱信息查看）</p><p>这些权限涉及账号敏感操作，非必需时不要开放。</p></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> Obsidian </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>有趣</title>
      <link href="/2025/10/31/%E6%9C%89%E8%B6%A3/"/>
      <url>/2025/10/31/%E6%9C%89%E8%B6%A3/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="密码错误，请重新输入" data-whm="认证失败，再试一试">  <script id="hbeData" type="hbeData" data-hmacdigest="d5159087954801b23c73c3762baa17d67c3615c79f7428c854fe6d1cb113ab93">77de38b37639084295c1a76af0e18a1d45a58e556b1ab66ab606eac82fdbbc66f970dd7aee617911efe73578fadea7ddbc2d193c9c09156e2ad2afd4c09451ead509c15cf2b3c59a398e6991e69ff670307e3877e031b5f20afefb2117b5802c251b2546ac9a8009ee0d1443141a24e5352320744a4d7db4a51d219d37a520e4dd06a57116541e500a6f9eff38c811a98ff93e832a12effd18c729f0a3f37dc466b91a1254157a4f4fda950dc1e1d280a7681ac5ae2034cd0bf1f4c44c4240164e7a6ea43c737bb1162cb90acaf1807039ac0efda20c76ca449b7f6df0179c865493a1c6919d4f133fffd5badeb931796c687b75768506a6a0e78c149623a76ad421ec8c94bc69b404d1193640e2f22bc1b19e57de4a734e34123216e68e6406613a67c33e9c469b26294c1fa89462d98879beab4f5a2c55e0e4d22a5b6778c9b3f820a1c50286d048d613e0b40927e46fb2a84db291a7a725652a710aea00485b8bef8c04a4c7069c834fac110ff95973c4457e72e9f26687a554312abc878b0df27609a6e164be34692d16d1d1673f27c399b610073521009cb3ad35ebced4fa2fe0b19bc455d3cc08ba3d8d0208713f6cf87b2c7cde685615d078663f41bb8aa7818ec1b4d1acd6c3a81aba17b53be5894a482623c325a126c3113d093657b70dee92acdce42734491440b6194dc6b3f035cd793a45e8f4f433919598e42336e5e3fab57a2f7de2a98117ecb97e960198d5f19525798736fd18222bdf6d52d7bf3e294f57c8ec3229269e5dc6b667c097a589fc9d9d50807c9f69849b657289a18c3aedf4c73a6866df80ffe05e8170f60eb1006b152e31e0178c35daf5aa386abab622a90504e76dad1aba661fe6d1049f53f8445921422c2fb61b670b5d378cbabeba4463cf3259c8d37a2bf7fbec018199e0b01b21ffc7ffc1f5dc583b4c0fe7c43d816e44055336865b24a5614b161d4be040c9b37b0d4ee1c474ecdc32c42b7fc64c69ecaa0c79fe25eedb59466aca99675793436020704ae87b03cede04d639a6b218aeb8bfc38558b8f4c399914df09f3229a8e3b65e4fb936638e1a6a1ca75f437f08f7759d4b50b96214da4bd5f0c0572cc4677b65b300cef88db4bc54febf2bb77e9582947a469d0fcef5d140be4717d78a89f2c468ff98d0b8a844e2fb24e65190167c5ab8cd7d4350b93da088e7641e0918b10b889114f82fd8494ef1a4f35393d377dec9a0cd01a5e021b39cf59c06549f151e4a6a87716a944c37bc79e76e5db3168805ff631f18ef0991275b760b56f1bb19efd6c7ce8df1e8e1338c402b491cdb03144855ebdcb388ed9995420af743a31eed50ca7e94dff77dc440fe59144cdc3c782c3bc6cc21ba090f7b308e6170015bbfb5f87090ce8b31546379ed01b706f0cda5202032d906b5e7170e7c36a24d2f75afd6a8672dd2272301ecfe0877328897d00f1f3fe8f1b85b0be793efff15909fa9bab39fc559ef084d25b0a8662233e48d0f2f18f0831195c64f27fcf6f4059a19769befa75dd59987957ee65c80937cbeb6e27d5a89ef835089f55b7cfc0054bf89709777d8d40745cc3c8ce61f9f774a8628a8f47578d00a3a60db154776571da36d70441b59c3840b0e4569a3abd3d555db91490bd7f7e40ffc53a88ec0a2772b5babc61f3424e7b7a4ad424f5e595064c68a5bd67dadcef101e1c5f4b83616c325361a77b11f04e9e74f3498ded3201f5194240621feb63ec9d1ed040431ee4e69482a7d925adb7104796039e9b266d070418691b9be9fb790a805689739dc50b28766812641504de4b0a6b57c638b44232fa841fe3b6d0143445d1474a0d422e3d9f8c78d19d5b405ed81e479b7c831d3ef0ccf73d4857e7985b02849ff7f30f986408c26bad5cd2c60178689c978e2174228c1c0b29c80bdf6bad6ea7bc2470851c319b606faf637118d03f5b1c299d2e4983ca77d4f6582173291997011a174e01853fe812221cde85fd4bcd72af782452adc3da22699a81653ad33d3de7a5a8c1341723d0645f91486a440913fdf66248143bc9dc7efb14f3f1be77be93099e9d080aed566f330ec4adcd4b21de9459fe43fda6e25224f098e02f47f23b7cddda0ea802db10685abd0980fe5affff957a40bcf456b8e85f9e5178755bd5117ddf8400503343ec7f556ee7d2c61cadd4bf139b8f5e3c670b86fd9518f602444260eac29d48a7a2e7228cd2e2cadca374e7ba1acfdc557d225df50f14d0fd452cc15396f4144e3a1f0b451ea5f6e0544e5e3e98a35f0adacb373d5d8c527b8a7dd50730728e36eaf54c482c04b56b21c8c6df5e7f1e99fb80ce320419d2e7bf4853dbfa68d29d4fc5e2ee771357a03148b4338c00afbf5b62717657b72ac395124e9b71613b3801e6b7eae03b466f55c0004b4f265548050ff729b04811493aa6f3ea0dfe1352eb5ece2432a4e189be1cd26d94c3df0b2527c1106d84b0cd4574445ba1d246b1c31e5441a292be3f35ee022063957984081cd1d39433915a58f635ff49eeb73f5f9b1f5391177f0d392685b56a38f4283566bf08f9a24f44f5279be5493638d0920e55d58950946335cbb4ec6c1d112965f006d8c0cbc265a330a90ea79d87c51675aa18d1d5b77b1d02fa08b98299eb4b1a14d64fa2811675b85b7cdb37a41be3b41ae6cccb2dd5cde6d7222d9e03458d9106c2ac77eed90939d0a927aaaac2c45d11a5d0464205badc8721699059d72e7204c3e9b4944283c85ad8ea756fae5b4f8b3e8e3dd3b89fdd2b906ace5b09ab5b1c8b0d9d4c206535d1105bb735ba33c28239e8a510745ab0862df0689b1e4bac1d8addffd16b5d678d8df88f3a7f16870b9908a7532068ee970ec209c7a8a7030af2bd22b83f1b4a2481c93b05793d24bb0e4ad73d7c1f095a6c914cdd867de5f19f24ec735a588589d532fd21c2ef4c2af24404d1ecd9a32e4bfb1eccff121798192c1ba86c663f43019282473e3705ac0959f8c895b5df5556c57c5476316aa18cdbcde608cd875ed1511b0ed12d3520a158bc133e3f90b4b303d92960230f10fbac95a55931a6565bd295dd70622c8493f62e50c7f71f10c4af4bf5c5f1d43c32857a1c303ebf7a45f72c15a2193cc0b24683f266418c31fe314a2c158be001bcdb93d7d7dca0037bb42863881b13dac76da1e89a390172ddec1d9193835f92b1beb64a9823078a5497dfabcb834a983bf982174bc1703b596a7f179c1d8cb8b4746f54bf2daf86e6104c38ed0917e8027616671ba7d40257d03feb97ebe638ac31b03a8829f56b217f5c09e7102d10ad3e86178c3c8299c04ee495ea14e5f54556f60e3d9c916241a9aa56f902027f7cb96a388f6a63de08747fda716cd852afcec5f621afd2ae4282739654ebd0390b5268712ee95d8b065f2da7643e676430b90ce150025cf6857cacaceb4466d188883f7b9ff7a8c8d6684024419da14f6af41d430d8479371120ba1459cea856172984dc8ee9d3349fec4556f0d5f780a3a7013c3266d77354b06c5ed92511af9f3dbb445ffb9e11094734c24d969d2ef7e64434192eea8666a6d3bf30ce2870fc5852f6acaccef222cf9314e3b6037121e3443243f57e8c382b4c0d3daf52168ed14769ee498af6b6e72d9988eaa8e6edc21bd046becb7edf5037c5d658c2e50b3c65aafc6094ba8b1298acc920dcae834fce47c2c0a0d4da5530ab636139b6ae7b802913aba5ac0e3722c34c36f9929bbc81616e9830f11c6b53853dcf82090b1012b2400bf1ced02710e0cd124faca2ef13ea35e7c2f2bb3fc2227f723afe481800814b085c9e2f42cee9a995e94e47812f253657225de56d343bc4d1b3880c92e762ee70896fd821572a4a66981ba6fc0533c485337906d3544716953c9019c61f313896a1df4dfaf640c5e0c90ae027dd63d6c7dbae481423c2e33c7add577f4829600d73029666038bc297ee72dcea3431447cbb2f6810d9b2ab168c8cbf08935ec97104f11ce9b03b72d092c2542a10ddcc9b68226ed3b139a309b749c9c4155dcd2a67afecb6700ce4b8f2e2ccce899c33716d9eff0a31330a7e76dcae8a442a640edf25abab568df0f72f65368d2db018f6fe3d8de8658c16a75b4bb71419e6a91a95dba9e5e71ca4eb56c2f7a77775aa483f827b76e06ab976a4b84d376b7f589ab9c3e7cce4df9e9cecc9b16b37b6e59eb47e9b7b6556dde2e41abb0c9356cc31d0d48892320737164b5e59581817ff841a85edd12737adb571944a9fced59f588b97b53da69cfb2617deff7481d5ee64134b8e645a6c9414c3e9098fdc65f9879c90e1bf7173f436f629e931eda3901f5e7ec65343e462d145ff28f82750b60368b85d2d7487801756883fc3a4cfbf49b5469561031e4af69e26f0d9c1b29a49a873a87884d30fbd8a8cfeaa2ad0874a288903c326efaada53be2c69662379c1c97c68039ef0755dda7c8b0468b4fcd0472b82bd16ff96cacf99ace8c27a1f37ea5fe855da068b1794649ad9ecb3420ef5196d6b88ea7b700abeab8063cc68ced0a18aeabbe0b15c091e9d21084045ea03a75c367754efe3ba8e663c8e36dd214611fa1c8320e9627faf5463127776d9f12d4704d3fd10e71105a33ebafd67eeec79b2c62cfaccc7526138b7b33e95a45dc9bbbccd625fee2da4b038cbc4795af62cb0150d5e53ce62c00495dca9408c82b66266f2eedcd8363464ea66414eea809a8a4052638d829804a3322bf9b7d35055fcd8b4be6b6b3cc1650746720ff9b289af4504781ee2189ffcc89459e9ca94a591259f3bebc9a8c7540e9b5efaca08c4872772af12180db86e316b46f591d81ed4074ca24b9c8f44153b3c134016b2dc909ed35d2fd226dc3a50128d678e19c6e96bb48de02405bba41877207396afc94454521bb7e551d5d77072dcda961198a6ddfd1dddd73fd6898137528b6e1d5fb35180bf47889b9832e123069eb1b0a3921b932b8d025f5fafdd5eb7fb4c5008fe758698d8900696f518a84f2eeedd35953e8fa16233ebc9e8598bbd819a8ff0cd06ba15506deb2989dc01d40ad8174d4bf2ca1c3465f186d6cf81fb0f4020f2dcb365547084bec0ea50489d11d61e8aae7fbcc07366c5528ca677aec3524b08f83fe7ccbbfc567169c9fa81b65b5a7d67e6e46611592568d32488610351bcfe918b0ebd1336f4271106c1f474711ff9c82220ea6a65c47c411933d54c9b1b2ccc6d3fc5bd2fe877a8a6e351bb70888a6495d7774b239454317b7b67f03d919a41fe04a4ab58c707c9a97ffc4fe4eb13312fb293f714cb99ba58461e815c4db6f4f5fb994e45f4d959b6bc04a67c1d03969e1d09aedc4a8f30b23b5bae96bae87671d8b55eadf0c9d85df6e8f5a71f7c122653e827df04ba10948b45023e21a3dbd430e4b3c7b9495253a11871c0bb321615082382623a3180eb360422763fca9a10754b0b8b28ec00fadc9dbdc6062cb5003e05a2ed70cc8cbf624a71b72c0bfde95256d79c904a7cab4aec80ce2fc24a474dba52b07bc0d8229f5aa3c882cec81c7cceff13fc21945f552ea14ffae49eef1235328235b7a52ca38f9429aff8dd28a79f6abd3bf7454cb9937a8c6f2ff5e5dbcc6d3b105c5ee04e99d4836415809364f49c11067b50a4e7a2eaa0cfc8945e3a17ef7aeddfcfacab8bea77cfb814e1ad188304d0e8eebeaf57e8d15e448d58508ce9d60188ca172cc7d59de10fa9458ebc8d19d351a8019935a1f7875880a94347dea78dbdcd5296c93607e0ec5ce89e75b5f0bd6c7df79803f9de1aeda034863cefc41b162d4d63a2293568926875de3fb7f95bb16f19f91a7d29e6f81d14cd91f7c3e7b195cb7664fb0763ab0c11afc1c4a36373d5796e939d5582bd6665867b02dbbae785efc0ded5bb417a66f2cf34fafd97d4b9f90f2dc5739b462fbeb3ddcd412557b2e9ed47f71af87dd3e3f2fd93ecf07a835b9886b94fef34f3177c47a63223e2c55bd45a25183d29e12a23c3cddd472d26f406338627aa9b74207f368febca5de928656b47a668ca7cee993e54da80cbbf7bbc10beffd2a849af15be293c5859535a89dcc4e1987eb63cc96e276f566553cd1670a8e0b46a929279ad782b90594f1d3cdc2fd074ba1815825c205ffb4fb548afed869bc467a57deb99a32ec5352b3fb071417c7de70fec2a06b974b8e5c3cb542099963359c56e10f78ef484e573dd0b0ba344406a3ab6939a172f5b74abbe7e40f6c8dd35ff1b486dee5c60214533b6f47ab0bd6da124793641fff918c55d8a412a3aca83a766fc51a3be1ca04d9886b099d082b9baebc78d7659bb86f696ab99af0aac7b3eb52c1e53646b99c498357ed9819b14f2890bbc1f6ebd94049dff3da33170381d68b337a8b4dbdea8eb40c256944041075849ae46d9efc15060dd429c6d46dae4c79b46a7cf5f7a5006c9b374613df1ca692fa650cb9fea7f9fd1152be9ad60acf6fb01c2d4e22f27ae834cdafff42d5574a861fdd8f332fabf547257e62c1030d891b85cc6ad3172bbbd778038c54803f4564eac900a503b91bf1e48794a35611869f3c52ba6e1033c672db2dca2c1f16f3b94c08bd74ef27e5155929e5d43e9995bc55f83e7271e8da9b99593c42f6701627b75d421afcb2480c7d1b180ea753d574df15a24015f8cd8bfd665f17e2605a12fb2c60656443ed9ce60e062218b455025b701535c760e3b36ab61996b85fa125549b177321c71ebde78bc3c3a50fc8c39792c4f8cd75d2ef41d7c43ab2cea30bd85cf2426bae53c3904d52aeb34ccfd47c93fdcf19aeb376e9aa2d8d4836a15c2a01db13e4a6441139ea4103fe7a2de32f107e924d0ba3fb903073167de16bc9718d2484a6965773c579a81803f583e2822e084383feaef42334ecc5fc303432c83f9d559266a0959c718726e5c4d66e13dfc5dc2c643bf6576fd531c350f580d21c63de33e69bfd2ba803636c8404591d0089fb980a732c01dcbf85730659dd6cd68d189108c87d8e5559bedf468998411cc8e995e5747c3769d8682b09778dd31f56024f612aa4a00a2e8a09e9c39a3a2f78f980700b4195d48388873ddb1823522a08eccb0d45956954875640f80448e34058afe6c8ba8aa6835ed66f960892f502f76db00c821342cb44267d80ad1891a84d38ac342d03cbe4ca9af194e9c5f96d845f9d5d329174aa494723383a530b8d75c53027cff65b7334fe57eeee63371e21aac42d21101b0d0ca7614a418ba749273752bbc181a76c1fe2e037284a4c08d56a862eff112aa552c623a2e5f66950c72be513ee429be6d66d5f83c508009564ab955d07399d3bf85a90f701a9f1776392419c23d6451f8de5e25cd257e65f71db96bad462b3acbb426c3fecb066190ed76775b4c54932ecafb0e847a14be17dfefaa1102543e7e211daf7169297ed6a69fb11de3a8880617d61d3e16f2099d3384c03b23cf15f5344d6625dfc58a69acafddeccf411771a26997c1a8a3b431598082519e335c01db7439c0822ce3a4d7ef14ee5b46bb90b11cd1540d8cd42429f0ed3dcc0d3db3962070073a69eeceec5c2cdf12768879db35276a9818c960c89585f765c6e596780b424a25b75382597934eb5632522be7c8994cae8a4c91335af24c1e1d3b0c0caa0c60c542e2922745758a64db0a9bee8539d76e29b66d1fd9a473f3602df894257ad512bf56e7a0a593d2e648a5e162392acaceafd672b9b92225911ea2c7150fa35594e263d4e05e4ebbfe3af91dd2fe11f15eb2766ccc7dd75cb771d8c426445381bb6204238afd08f2695b5d1ae146193393b5d9d57c59eb614659b09da33e921c044aa26f9cd95f35630253c1eeb2beb329fc6d9175cbbaf69887a4c20eb33182a2197c7043ae8460041f69bfb8c1742875b0dbaadb21728d2c346f6a1650e022a31f156bd63bccd66df793430e4d1abd6ce401e998f3428b8dab13ae9d3f03b685aca975afcff24fe0d2cf6221ad60b06a9662142e228f34fc190f6330f28be803eeb9baf84ac96eda786adf3cf5853829aeedea6b44c92f125f885f1a6bcabbe138d95594ea771707f21361e41a33eff046b536816e5c11c7333154693eb951899324341bf1561da15ef8a4f4314f53b96660982daad3a239319ce4790b49f6bb85273e2383c25e93babd24cdfdfcfc5f2006b1cd721917ca7716d37e0f76c8a5e93006a19a69632d337e82195ebafb86e5cd21f5327882af5ce97a0d4cb0ba100356e9d7c0a7a79cf4f4de90c6892ec9ed4d0504258ad72479c66d7cc85ddd5a8dd7a67720a2ff8c77797f7e0f6a37999473f8595a9106771eec7f7df21d682326f6f7371245c4c17be2cb4b782ef63c3b6d23769c493e2138bedf5faa00adf364c66cd601500cad1035698343549f45468a7e2cfc56e871e56825db7fd23d30ffd444c3fab4c6204db00193b74a83ec612c43aa216a79c6ed7f48a34b28ab6f720156b756ebfe1006f7f10c60910bf27b1e7e58918a56ff1ca764e0dd83312cdabc4c2315fde16e1ea94ac517539912034b52c80f1db47731b573427a2df171d0365d787a8152f9d3c318eed05b350d9cb2fcfd8e7b8dcdbdc94a1b6c5bcbb483c284b061714212525e8a5b7c19230928da91b79b59c0a8c5ba7be285fbf492166d1dc1c58314c9fdb7039091102d92389f03736059a4c63e6840651f16f4dc08a5a005db44be1cc944afd48dfbc486634ff918c30472bc24f5d4c01c4debd90dc629c65257720e8521a392105bbe42305925f109fc6ba98712f0e9a8f40ff2b9b85fe0f961cfe5f8cf44f357ccfdd1e6d84ab9661fc8bfa0f3c24fbb8958b8f6c2512e58aa1566bbc77de4aec6644867c94d218497c973b7dff6eabb64fe7a7437ad6bbd9de044a8a1e571b7d76fe01a92f92754abd5aeb68350e4cfde52cf2d08f6bc76b0400f2ae3f0328c8417172aedec6a55e5d3c8e58889ff7f2e7786a64b8b5ccc489d0b706a0d29e4079d5e2cb744c78614edd3cb03fa576aafd5c6323c52890bb1c18fc72a3ddd2a29f3ebfca5532b0b02b1f95f3bb1e5ede1c2378b26a99783526552dff5e7f4ece1d81f44847122633e533c6fb9796ec015c0102cc2523633fc92c714142b3348c72b12653f3845ad43237582fa2fbb26784310fbab05bbcde05ebc7623a295845f69fd2616e87763641fb990b593a33ec01425a9cf05582c270aa2fda1691a13ce5096d6ee6f64f0ff37fe7e6bc74613bdf4f86de1bc339b87e2d4d60cdddf4b4a36706888eedeea703ea402ab0a4e9496d67af7167ef08641c9d3f6bd3a95a1830d3a38ab6074fe99ac2f38d0013fdf8bf4868b92d2ba2b7cf76858011781f26bf4f72a1106d5d3ddb2cca589f89e21e30cd47ffaca467d240c5affb93527f59c7c5e23ced32c56a415c230bdd2981fc368e6f3915fb34b6c75a4b2dd3a096cfc32311f5fd1dcc274045a7ca525c830de50dcee33eff013122a390fff58a7d3d6e38bbeb2c53934a0d2de3d4e4990987a483d701e8341d7276f4cbe7325ef600f70e4cb4a2c05d3f812882ed0f757fed35048e200d9d3b32c50962ed3f71cfe9a7bf99f20648b49cc58af1dabd871d5bbb63143a9e782158014d5ba07f89641f0181a39deb27a1b3c7c2a5837b1161cf39cc752c50afa03e8bf7b0cd41fbf0f76063a311a079da57437582744c8136e098efb532ee6eec693780a4b0e183048d6b7c129ac412a40c7a7b7780dd1a724f34f60e939e1c7917a126ad8bd36cd1505855dee078d24eaf638b13325e952483563ac590ee0a0429c9c5202d6cf658db5f94e54e086f86d7647bea171e6f931486b97c1a4fbbcdaaa96993dde1243988964b150892a95d669deb65935f0213d7cbb3bde81bcc1e8a9b05180ef7ee2f24f21b0279e6396ea4ac248bff63feb2e81dadcdb0552afb00709a601c25c5e107bd5cfd494dde734598984559d6667d1a4a17723b7a56ed2a24447bf56dce49394d3abe6233b9ee7aeae4568cceef17ac5f3d872dc2ae1d333961dd0048b0afef57dd561777756b1d787869c075321178e20b0cf9b72138120fea5cb7c90a478a4027bb2f89ec2693182c3d976b29f27c9a4a26e2bbc224654a627c1ea8f7549c6e55ec69e70dcd55909e3b395e826451e3227c63c401c05fa99793addcfaa0735af7904f0743b80ce6738c33c82af845ea665350142736b422a1d20562da026770a702a9eccd7f1b796a061431a7870ec572dc7f8cee7681b0fd8269752011353630467c29c906f6ca7c9edd78a58792d0116fbf08b3a8678d1e75247da7808cd39ebcc469493fcbae50442d4e4230d3dda66ef0b501e8ca40299c13569c12eb3aac75ffa0964c0dc04f65055563137c3978d57154c5b8d734b7281c6f96a18d09ca8e1954d6844101d797ab574c1a12294ab4f1ae01ae90670add29276e377487c4c8849474572490a855b255876a02845f948a99da06b4f97c4d78cc98f91e1ff7e2aed62dfe5d2fc09bfdf458879a4cabb968611bc6c8ee16cc4901eb52c9e490277279c8863f18d5dcaca6eac004c14ece1532de380b989db2386f3238a06c5b67de0f4d7190f18cb4a70d693c50207eea88d32400879045dc5e2cee255d53afb08b0fb00602728f7a929cc2da747d0d0e6c02e7336f9c7e0adb5e7657035202850e3162d16ae8e25ae5ea1854a70bf2adda27ec267f3b33d642964506716106d9a401f0dd257c2bdeef7e4771d70104c9fd50ec29e30e61de864db7bcce2a1137d1d1fdf86ead7b9aa881f97f397e43dad22810c771942c265e5c305b872a5524162fba822436fd00f9ddd4f196208595f0d38ecc3bb528bc7b910dc9d0051b66676400609f03e4e1b88723723144718563c90c79829b00946b1feb195d01038fe4d555be3ab754da8b80ee20a5d7eae51f468e1cad0c4c96cde1af69c30b78b44f5a37b06ef272a1d86c217834739a9bfba0397e0e5648377bfe6ccbc294bdf1c9cc183ba3e1ee8dad6879e1d44d6a144853e1cfb348df596dce36283e0c1ac5a33845a2de6cb340b34bad48ce3cca6d38b6455272ec27e03c6c6c26f215f4db60b0d53b7b8954215d1f729107193527c0bbf52cde289c75071a3ac356ed20c0fcf8bfbe00b447367992a8a039a472c56913883362b542d923ad00674b0a656f5104058934ebc3fcbcc63475c81111589aad0cabebb5589291980cfdfce84773db9c4a916d9f1d95ca4641ffbbb7b078b233b18687271e38f91a0a130118d10935c53a4cb45bd0a9901365f1b7bec757fd80d96974139204df4467edfee59b4d9b4aa17486090bec464b29fd69484ad3d9b073b2253b568dd96447ebeb8d36c894765a7ddfa6eead9a18dda157a3068f6ea770e66f1b7b6992eef67d57515050aee4d89588567f5b3bf74c6d2ad872a009f94c9adc35dc808944e50db0c0c66294814117a37a24bb8396eb2777b30bf2f31d2e809f83fa215fc9e9add9b5ef7f415d7db073279eb52cea01604017c181ec01351d3752bacab86e3fd2e4374c595280ce1fb84e0e143696a95917c912bcd77d9fe738f275e5e8816ab5c727e1a18126a59f218dd9de251386d5bd8df1f441bb74772aedcb33714c961ce5d2d08a03ae1b11e894bb0170ef4cbb64fc8a619a043ae675c5ff35c6c11cd9d9ee9782e8a814922ddec0305663103e38456190ffaa62399a39cb4ffdfb4712d46c697121295d7a8aee5f5a27eb3998cf9a3823b8f68e8a0d4da780ba917ab4c79fa06b6befe1def9f9636ab2f6816f32e75483bc437437585c02d3b3699f28ab48ded1d8106c99e66fe61c03cf9bfb9ef28bab6d93604dd8040b3f7ecaca7bd793d29a27cd1d1645c29c1d8394f0416c5a82cb8ce65e4cf2b55418d37422be66e394f32696862804825f657f419698c6824c39339b344be2d5f4079704e91998aa7c7d72d356c116dc5f41e6ab923e437d27ae341053ad7ad46883e6e4181896c19b3245e59a3a52a6d7323c4658c751bebf0c459c5b4d4a3bc6a24bfa53b8886e030cf3212dd178c6c5c2094033ac58af372279c18aa8c64f754f6d8b001969af9cdd1cbec45917c6b36d04414afa02779b4e22768618d7b1e23d6f6bd66c62c8306af356d058da7db995817a67a6d4cb6a6c48855cc707bf387cebc2573ff84070806504cfda526f676d86dfcb19077fc30ff7c09e37625285ba0fd8a27d4b1571a722b275e9f4face1fe3ac1cc36cea4d03e4d33995df33e3e40ae9832c272ffbd3244f74152a5ff4865e2b0e227068e13331642cb5074591ecb654bf55dc8afe280b1f79472e4040ad58f48cb6a8d2b51d2675143b24a4cd32e21ee46b9fd31539203fa279a433500bd5433276f2e04d521bb43822ec1d35060d2949836319549cd3458655d528b35ce57f288013656745b9c24b664724ac68f769574db0db1cf4a0fd0664ecf459a5bb6f426e93b27e1d71c76e151dd4c667ca58dce45d90ea27b35258ca48be0cb3ad74e520a2a89a9c896507269d03a24d652187e610a2b06a5608eb2f4b0c00ab5b62b3dcadd57afd936251f1ad4e7537d47625aff793ba7c1474adfaeeb9ac0ab14cce9cd6623d2b148b0e054bc86c4ce8d17217a8bc5725add81db5b02c0515bf805a7cad4adf1f947543d94c865c3fc5e4b5390c866786eb850602016f1ab452001ff374e430e650947bda835417e025cfca9e972059d4ac7b27a607824d01bc3fecbe3d40ddc53fca09dc93537f0a082bb820461589396a3d917113f3eb82ef87ea97cda784af20be6bdd961009b3107ec97846aa42670b5baf2047ca874ee732c2605089fb5f09352f88c612dde536929e5053dfbd4fabddacab5fbac9d7a11f9f633c584f5f8607bc75ab17e3f2128da6235e95c57aa92a787722cf39f60deeb80378b66df509093ed553d12637e6ab0c9d6f772f05f8b57f0ad965439aa313e7ac6bebb670447dd7955c217ae8be38b8711b8f530c3ba7110ab1d6d79804ddc09e579192fcc5094c1d7c3ddabe4636059357a50f53bac7e4187aed4d6ecd7afeeeaef36cef04f1d2287f159801a721579db3b43c37973ddeffc12c300a84547c65aaf818c3aa5b5e8c593d90284b5974deb3e032ac6993ee696c4a64528b4fa36228701e525b8af08498575b32e83f8d6455fa4967eb46432169bc207235ef9bce9c356c843fdf86042b3107c576e622a24341f00970fda03af766da50c8756710576d7481e1f04a190b7ae907bd9cb8ebb199131e7220f377b6f6fbc23ac85205aa02136be2ec2e85cae5e7fbe64ac661ca4630173ad23c3bcbff39867de5d31a5fdea4643ea8c5f026bb3f24cd7fac58725398ab05a4fa7deb9b4df07f265efc7d2da2c1a2d2a8ccccf9d0ad26c624764f7ed595206841d0a403eac9737042989798ff527687c11a8bbe8f8c6023736376f0dd0581b17c6d614ce25e6d91c3e59c63f2713d8a5c4c4299c6d9d2f895f4c52ca790ebe403b1e980f0c33aee28f98cef043ef2ee472a2269e6fe08fb5b30cc4de5cb374d358da60138c56303356a901d9c70d35f94a42f793962ac5e67097d237871313f502f025489323e2c236f909c1ee1fca1240da1942fbf7a9da3c9ab530d99ef8d8429ff7c9673a12001b03343a09b21d36d42a313f3610dc07a8fa840176e12e40e7951863f598631a9656cb1681fe1571886a0d31964c75d88e0394ff78bb7178b37522ec7bf7d5230ecc9b27606c236da0f6b9d268ea7bc9b8b9a19fbde3c4db20bd0d9cb9672d4425da57e0aa5e8b99076764812c6b2883be4bd17008a0dd865acc235f79290bd72fa5abf903952f29af7863f50fac32a0688f9186daa515fc7449661fcbdfd2e4fe5a5f7b6b451027e177eb7965cd56bf8ae2ddfe15e7fab4ba538f27fc9d14619745a6a1ceb35bf88a03f97c080cc767e792dab1e48fcf2f831011e04781623edec2f2c1bec6b4bb21dbcb0235afb9d467320702a8cdf3d847d2c9f24069011667b784bf13a8149be3fb81cf9912b76135a102f2e532a0ee2f3f779fdb2b5f653245eb5f58559626410fe24b8cabd7df8a380837c14f926bf25a7647352f79fe9ba360c25cf91aabb090af780693b024e14f0117110c0819fbb80f37d3a4a547b9f516c58eedf5307fd68e85029a3ffd3ab13fdfcb5659f7220dc8fa7b3ef5f1dfa4b1a4f0e42bddbeb0eae7e07a5b3be6917985142324db559806558a3cf9b1376da68dbcd197e48af0ca8b39837564df5219e3a3f0b0a1112ba415709060e41861834d9036a786787dc7a783956995d2fa942833f04bf56b23074de112ee2d00aacc95154fd1967e3e33db5d3d2353c063c63010ed38d3cfb35d2b6e6c14a319f6e6752f834ac25ae344a3045779cf6bbaf6b338f874c2c525c840066f138046e589cf982ba9b42208f28607681dbcad842c36bb3a4f7618c914ca3ae50a55829e699e24c9bc371bfbc7b30e52759bc4815f9a1a1a0b8cfa7b64dc115d44bd2f9c9aca97c5d29011ca00c589a0034c2c37cdd669bd47397b68457af8e5af634d4333831bc5a3093e731e67b5da4e830580b088b694efc28c3de987ca1084461d5bcf046f9ff61d2fcd2dabb5c77bea12a10e7eefb0ebfd8e90ca39ce49a547ef26ed7b596abf8169ad1af501cb221bb885baa7108fc01dcbdb1d08d5ecaa7a11971cc245a7ef50e57edee803b52010411fb16088f48b04fc7d151ac1e4189c94dcc8de5bb61e1909c7a662ef98c852a</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-blink">      <input class="hbe hbe-input-field hbe-input-field-blink" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-blink" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-blink" data-content="请输入密码">请输入密码</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      
        <tags>
            
            <tag> password </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【数分】理论</title>
      <link href="/2025/10/24/%E3%80%90%E6%95%B0%E5%88%86%E3%80%91%E7%90%86%E8%AE%BA/"/>
      <url>/2025/10/24/%E3%80%90%E6%95%B0%E5%88%86%E3%80%91%E7%90%86%E8%AE%BA/</url>
      
        <content type="html"><![CDATA[<h1>数据分析学完这些就可以面试了</h1><p>1.统计学 2.概率论 3.工具 4.业务题 5.ab实验 6.机器学习</p><blockquote><p>很多想入门数据分析的同学担心自己不是理科出生的，不懂统计学，所以花了大量时间在看统计学网课和统计学书上，包括培训班，花大量时间教你理论知识，其实这些都是浪费时间。</p><p>工作面试不是读书考试，你只要知道工作会哪里用到统计学，面试可能会问哪些就可以了 首先大部分社招是绝对不会考统计学的，只有校招以八股文或者笔试的形式考你，所以如果你是社招转行，统计学基本可以不用看，面试100%不会问。</p><p>大部分工作用到统计学的都是互联网大厂的数分，并且大部分统计学都是服务于ab实验或模型的，所以搞懂统计学本质就是为了做ab实验或者你要验收模型。</p><p>非常喜欢考统计学的几个大厂点名:字节，pdd，滴滴</p></blockquote><h2 id="🍋统计学：">🍋统计学：</h2><h3 id="假设检验的流程？">假设检验的流程？</h3><p>假设检验的标准流程包括六步：</p><p>(1) 提出原假设<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mn>0</mn></mrow><annotation encoding="application/x-tex">H0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mord">0</span></span></span></span>（通常无显著差异）和备择假设<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mn>1</mn></mrow><annotation encoding="application/x-tex">H1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mord">1</span></span></span></span>；</p><p>(2) 选择合适的检验统计量（如t统计量）；</p><p>(3) 设定显著性水平α（如0.05）并确定拒绝域（单尾或双尾）；</p><p>(4) 计算检验统计量和P值；</p><p>(5) 比较P值与α，若P&lt;α则拒绝H0；</p><p>(6) 解释结论并评估实际意义。</p><h3 id="P值的含义？">P值的含义？</h3><p>P值表示在H0为真的前提下，观察到当前样本或更极端结果的概率；P值越小，越有证据拒绝H0。</p><h3 id="什么是显著性检验？">什么是显著性检验？</h3><p>显著性检验即基于P值判断差异是否统计显著的<strong>过程</strong>，通常以α=0.05为阈值，若P&lt;0.05则认为显著。</p><h3 id="两类错误是啥？">两类错误是啥？</h3><p>第一类错误（Type I error）是拒绝真实的H0（假阳性），其概率为α；</p><p>第二类错误（Type II error）是接受虚假的H0（假阴性），其概率为β，检验功效=1-β。</p><p><strong>1.  请解释什么是显著性水平 α、统计功效 1-β？它们分别对应一类错误和二类错误的什么关系？</strong></p><ul><li><strong>显著性水平 α</strong>：是犯 ** 一类错误（弃真错误）** 的最大概率上限，即 “新方案实际无效，但我们误判为有效” 的概率。常用值是 0.05，意味着我们允许有 5% 的概率上线无效方案。</li><li><strong>统计功效 1-β</strong>：是<strong>正确识别有效新方案</strong>的概率，等于 1 减去犯二类错误（取伪错误）的概率 β。常用值是 0.8，意味着如果新方案真的有效，我们有 80% 的概率能检测到这个效果。</li><li>关系：在<strong>样本量和效应量固定</strong>的情况下，α 和 β 呈<strong>此消彼长</strong>的关系 —— 降低 α（比如从 0.05 降到 0.01，减少一类错误），会导致 β 升高（二类错误增加，统计功效下降）；反之亦然。</li></ul><p><strong>2.  为什么行业里默认 α=0.05、1-β=0.8？能不能把 α 设为 0，或者 1-β 设为 1？</strong></p><ul><li><strong>α=0.05 的原因</strong>：这是统计学和互联网行业的<strong>平衡惯例</strong>。如果 α 设得太小（比如 0.01），虽然降低了上线无效方案的风险，但会大幅增加样本量需求；如果 α 设得太大（比如 0.1），则容易 “误把噪音当信号”，频繁上线无用方案。0.05 是 “风险可控” 和 “实验效率” 的平衡点。</li><li><strong>1-β=0.8 的原因</strong>：核心是<strong>成本收益平衡</strong>。统计功效越高（比如 1-β=0.95），所需样本量会指数级增加，实验周期拉长、流量成本上升；而 0.8 的功效意味着 “80% 的概率抓到有效方案”，在大多数业务场景下，这个收益足以覆盖实验成本。</li><li><strong>不能设 α=0 或 1-β=1</strong>：α=0 意味着要求 “绝对不会上线无效方案”，需要无限大的样本量，现实中不可能；1-β=1 意味着 “100% 检测到所有有效方案”，同样需要无限样本量，不符合商业实验的成本逻辑。</li></ul><p><strong>3.  实验结果 “统计显著” 是不是就代表 “业务显著”？二者有什么区别？</strong></p><ul><li><p><strong>不是</strong>，二者是完全不同的概念，面试中必须区分开。</p></li><li><p>统计显著：是统计学结论，指 “实验组和对照组的差异，由随机波动导致的概率小于 α”，只说明 “差异不是偶然的”，但不关心差异的大小是否有商业价值。</p><p>例：你的转化率案例中，若实验显示新方案转化率 10.1%，基准 10%，差异 0.1pp，若样本量足够大，可能达到统计显著，但这个差异对收入几乎没影响。</p></li><li><p><strong>业务显著</strong>：是<strong>业务决策结论</strong>，指 “差异的大小能带来可感知的商业价值”，通常由业务方提前定义（比如 “转化率绝对提升≥2pp 才算有价值”）。</p></li><li><p><strong>关系</strong>：统计显著是业务显著的<strong>必要非充分条件</strong>—— 一个方案要想有业务价值，首先得统计显著；但统计显著的方案，不一定有业务价值。</p></li></ul><h3 id="显著性水平-α、统计功效-1-β">显著性水平 α、统计功效 1-β</h3><p><strong>1.  场景 1：核心支付流程改版（上线后影响全量用户，开发成本高）；场景 2：首页按钮文案修改（成本低，影响范围小）。这两个场景下，你会如何调整 α 和 1-β？为什么？</strong></p><ul><li><strong>场景 1（核心支付流程改版）</strong>：<ul><li>调整策略：<strong>降低 α（比如设为 0.01），适当提高 1-β（比如设为 0.9）</strong>。</li><li>原因：核心功能改版的<strong>一类错误风险极高</strong>—— 若上线无效方案，可能导致用户流失、收入下降，且回滚成本高。因此要严格控制 α，降低 “上线无效方案” 的概率；同时提高统计功效，确保不会错失真正有效的优化方案（毕竟开发成本高，实验机会宝贵）。</li><li>代价：样本量会大幅增加，实验周期拉长，需提前规划流量。</li></ul></li><li><strong>场景 2（首页按钮文案修改）</strong>：<ul><li>调整策略：<strong>维持 α=0.05，或适当提高到 0.1；1-β 维持 0.8 即可</strong>。</li><li>原因：文案修改的<strong>成本低、风险小</strong>，即使误上线无效方案，影响也很小，且容易回滚。因此无需降低 α，避免增加样本量；统计功效 0.8 足够，平衡实验效率和收益。</li></ul></li></ul><p><strong>2.  实验结束后，发现 “统计显著但业务不显著”，你会怎么决策？</strong></p><ul><li>核心决策：<strong>不发布新方案</strong>，但可以记录这个 “微弱正向” 的结果，作为后续迭代的参考。</li><li>具体分析：<ol><li>先确认实验过程无问题：比如分流是否均匀、数据是否有异常（如爬虫、作弊）、指标定义是否一致。</li><li>若实验没问题，“统计显著但业务不显著” 说明新方案的提升幅度太小，不足以覆盖上线成本（比如开发、运维成本）。</li><li>后续动作：可以尝试叠加多个类似的 “微弱正向” 优化（比如同时改文案 + 改颜色），看组合效应是否能达到业务显著；或者放弃这个方向，寻找更大的优化空间。</li></ol></li></ul><p><strong>3.  实验结果 “不统计显著”，你会直接放弃新方案吗？为什么？</strong></p><ul><li><p>不会直接放弃</p><p>，需要分情况分析：</p><ol><li><strong>先看统计功效是否达标</strong>：如果实验的实际样本量没达到目标，导致 1-β 低于预设的 0.8，那么 “不显著” 可能是因为<strong>功效不足</strong>，而非新方案无效。此时应该继续补充样本量，直到功效达标后再判断。</li><li><strong>再看效应量方向</strong>：如果 “不显著” 但实验组指标<strong>正向趋势明显</strong>（比如转化率高 1.8pp，接近 2pp 的目标），可以考虑扩大样本量，或在小流量下继续观测；如果是负向趋势，则直接放弃。</li><li><strong>排除实验干扰因素</strong>：比如分流不均、数据采集故障等，这些问题可能导致 “假阴性” 结果。</li></ol></li></ul><h3 id="什么是置信水平和置信区间？">什么是置信水平和置信区间？</h3><p>置信水平（如95%）表示重复抽样下区间包含真参数的概率；置信区间是基于样本估计总体参数的范围，如均值的95%置信区间为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>x</mi><mo>ˉ</mo></mover><mo>±</mo><mi>t</mi><mo>⋅</mo><mfrac><mi>s</mi><msqrt><mi>n</mi></msqrt></mfrac></mrow><annotation encoding="application/x-tex">\bar{x} \pm t \cdot \frac{s}{\sqrt{n}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">x</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">±</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.2334em;vertical-align:-0.538em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6954em;"><span style="top:-2.6259em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord sqrt mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8059em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mtight" style="padding-left:0.833em;"><span class="mord mathnormal mtight">n</span></span></span><span style="top:-2.7659em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail mtight" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.08em" viewBox="0 0 400000 1080" preserveAspectRatio="xMinYMin slice"><path d="M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2341em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.538em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>。</p><h3 id="t检验、z检验用途以及步骤？">t检验、z检验用途以及步骤？</h3><p>t检验适用于样本小（n&lt;30）或方差未知的正态数据，检验均值差异；</p><p>z检验用于大样本（n≥30）或方差已知。</p><p><strong>通用步骤</strong>（t / z 检验通用）：</p><ol><li>提出原假设 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mn>0</mn></mrow><annotation encoding="application/x-tex">H0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mord">0</span></span></span></span>（如“两个总体均值相等”<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>μ</mi><mn>1</mn><mo>=</mo><mi>μ</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">μ1=μ2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">μ</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">μ</span><span class="mord">2</span></span></span></span>）和备择假设 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mn>1</mn></mrow><annotation encoding="application/x-tex">H1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mord">1</span></span></span></span>。</li><li>选显著性水平 α（如 0.05），确定单尾或双尾。</li><li>选检验统计量（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>=</mo><mfrac><mrow><msub><mover accent="true"><mi>x</mi><mo>ˉ</mo></mover><mn>1</mn></msub><mo>−</mo><msub><mover accent="true"><mi>x</mi><mo>ˉ</mo></mover><mn>2</mn></msub></mrow><mrow><mi>s</mi><msqrt><mrow><mfrac><mn>1</mn><msub><mi>n</mi><mn>1</mn></msub></mfrac><mo>+</mo><mfrac><mn>1</mn><msub><mi>n</mi><mn>2</mn></msub></mfrac></mrow></msqrt></mrow></mfrac></mrow><annotation encoding="application/x-tex">t = \frac{\bar{x}_1 - \bar{x}_2}{s \sqrt{\frac{1}{n_1} + \frac{1}{n_2}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.848em;vertical-align:-1.0296em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8184em;"><span style="top:-2.439em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="mord sqrt mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0729em;"><span class="svg-align" style="top:-3.7143em;"><span class="pstrut" style="height:3.7143em;"></span><span class="mord mtight" style="padding-left:1.4286em;"><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8443em;"><span style="top:-2.656em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3448em;margin-left:0em;margin-right:0.1em;"><span class="pstrut" style="height:2.6444em;"></span><span class="mord mtight">1</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2996em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.2255em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line mtight" style="border-bottom-width:0.049em;"></span></span><span style="top:-3.384em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.558em;"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span><span class="mbin mtight">+</span><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8443em;"><span style="top:-2.656em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3448em;margin-left:0em;margin-right:0.1em;"><span class="pstrut" style="height:2.6444em;"></span><span class="mord mtight">2</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2996em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.2255em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line mtight" style="border-bottom-width:0.049em;"></span></span><span style="top:-3.384em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.558em;"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span><span style="top:-3.0449em;"><span class="pstrut" style="height:3.7143em;"></span><span class="hide-tail mtight" style="min-width:1.02em;height:1.8286em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.8286em" viewBox="0 0 400000 1296" preserveAspectRatio="xMinYMin slice"><path d="M263,681c0.7,0,18,39.7,52,119c34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120c340,-704.7,510.7,-1060.3,512,-1067l0 -0c4.7,-7.3,11,-11,19,-11H40000v40H1012.3s-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232c-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1s-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60zM1001 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.6694em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4101em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord accent mtight"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="mord mathnormal mtight">x</span></span><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord mtight">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mtight"><span class="mord accent mtight"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="mord mathnormal mtight">x</span></span><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord mtight">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.0296em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> 或 z 公式），按公式计算其值。</li><li>查t/z分布临界值或计算 p 值。</li><li>若统计量“更极端”或 p＜α，拒绝 H0，否则不拒绝。</li></ol><h3 id="t检验类型有哪些，其主要目的是？">t检验类型有哪些，其主要目的是？</h3><ul><li>单样本 t 检验：样本均值是否等于某一已知值。</li><li>独立双样本 t 检验：两独立总体均值是否相等（如男/女平均成绩）。</li><li>配对样本 t 检验：前后测、左右手等“同一对象两次测量”的均值差是否为 0。</li><li>多组均值对比通常用方差分析而不是一次次 t 检验（见后文）。</li></ul><p>双样本 t 检验 vs 配对样本 t 检验</p><table><thead><tr><th style="text-align:left">检验</th><th style="text-align:left">场景</th><th style="text-align:left">数据结构</th><th style="text-align:left">本质检验内容</th></tr></thead><tbody><tr><td style="text-align:left">独立双样本 t</td><td style="text-align:left">两个互不相关的样本</td><td style="text-align:left">两列独立观测</td><td style="text-align:left">两总体均值差是否为 0</td></tr><tr><td style="text-align:left">配对样本 t</td><td style="text-align:left">同一对象两次测量</td><td style="text-align:left">对应差值一列</td><td style="text-align:left">“差值均值”是否为 0</td></tr></tbody></table><h3 id="t检验的原理？">t检验的原理？</h3><ul><li>构造“样本均值差 / 其标准误”的比值，令其在 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mn>0</mn></mrow><annotation encoding="application/x-tex">H0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mord">0</span></span></span></span> 成立时服从 t 分布（总体方差未知，用样本方差替代，导致额外不确定性）。</li><li>当该比值绝对值较大，意味着“观察到的差异”远超“随机波动”的合理范围，从而认为均值真的不同。</li></ul><h3 id="卡方检验">卡方检验</h3><p>卡方检验基于<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>χ</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">χ²</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0085em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">χ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span>分布，用于检验分类数据的观测频数与期望频数是否显著差异，或两个分类变量是否独立。</p><p>真实工作中，它常用于A/B测试，如电商广告点击率（CTR）比较不同版本的显著性差异。</p><p>应用条件包括总样本量n≥40且理论频数T≥5，否则需用校正公式或Fisher确切检验。</p><h3 id="卡方分布">卡方分布</h3><p>卡方分布是自由度为正整数的连续概率分布，形状从右偏到近似正态，主要用于卡方检验的临界值计算。</p><p>在工作中，p值通过<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>χ</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">χ²</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0085em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">χ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span>统计量和自由度查表或<strong>软件计算</strong>得出，小于0.05时拒绝原假设。</p><h3 id="卡方检验与t检验的差异">卡方检验与t检验的差异</h3><p>卡方检验针对分类数据（如计数、比例），检验频数分布或独立性；</p><p>t检验针对连续数据，比较均值差异。</p><p>卡方是<strong>非参数方法</strong>，不需正态假设，而<strong>t检验需正态性和方差齐次</strong>；</p><p>工作中，分类变量用卡方，连续变量用t检验。</p><h3 id="方差分析（ANOVA分析）">方差分析（ANOVA分析）</h3><ul><li>检验“多组（≥3）总体均值是否都相等”，原假设为所有组均值相同。</li><li>把总变异拆成“组间变异”和“组内变异”：若组间远大于组内，则认为至少有一组均值不同。</li></ul><p>真实应用包括比较不同教学方法对成绩的影响，或多因素交互作用。</p><p>它<strong>假设</strong>正态分布和方差齐次，p&lt;0.05表示组间差异显著。</p><h3 id="方差分析与t检验的差异">方差分析与t检验的差异</h3><p>t检验仅限两组均值比较，双样本或配对；</p><p>ANOVA扩展到多组，避免多重t检验的I型错误膨胀。</p><p>ANOVA显著后需事后检验（如Tukey）定位差异组；工作中，两组用t检验，三组以上优先ANOVA。</p><h3 id="双样本t检验与配对样本t检验">双样本t检验与配对样本t检验</h3><p>双样本t检验比较独立组（如男vs女）的均值差异，需方差齐次检验；</p><p>配对t检验用于相关样本（如前后测试），计算差值均值。</p><p><strong>双样本</strong>假设独立性，<strong>配对</strong>考虑配对相关性，提高检验功效。</p><h3 id="方差齐次性检验">方差齐次性检验</h3><p>Levene检验或Bartlett检验用于检查多组方差是否相等，原假设为齐次。 若不齐，用Welch ANOVA或非参数检验替代；工作中，先检验方差齐次再选t检验或ANOVA。</p><h3 id="辛普森悖论是啥？（很重要很重要！）">辛普森悖论是啥？（很重要很重要！）</h3><h3 id="回归分析与回归分析中的参数（线性、多元、逻辑回归）与评估指标">回归分析与回归分析中的参数（线性、多元、逻辑回归）与评估指标</h3><h3 id="相关性与因果性">相关性与因果性</h3><h3 id="主成分分析与降维">主成分分析与降维</h3><h3 id="贝叶斯统计">贝叶斯统计</h3><h3 id="判别分析">判别分析</h3><h3 id="因子分析">因子分析</h3><h3 id="多重共线性">多重共线性</h3><h3 id="推断性">推断性</h3><table><thead><tr><th>概念</th><th>解释</th></tr></thead><tbody><tr><td><strong>假设检验的流程</strong></td><td>这是一个系统化的方法，用于判断样本数据是否支持某个关于总体参数的陈述（假设）。<br />标准流程通常包括：1. 建立原假设 (H0) 和备择假设 (Ha)；2. 选择显著性水平 α；3. 选择合适的检验统计量（如Z、t、卡方等) 并确定其抽样分布；4. 计算检验统计量的值；5. 确定P值或临界值；6. 做出决策（拒绝或不拒绝 H0)；7. 得出结论。</td></tr><tr><td><strong>什么是显著性检验</strong></td><td>显著性检验是假设检验的核心。它通过计算观察到的数据（或比观察到的数据更极端的数据）在原假设成立的条件下出现的概率（即P值），来判断该结果是否“统计上显著”，从而决定是否拒绝原假设。</td></tr><tr><td><strong>置信水平和置信区间</strong></td><td><strong>置信水平</strong>（通常用 1−α 表示，如95%）是指：如果重复进行多次抽样和构建置信区间，那么包含真实总体参数的区间的百分比。<br /><strong>置信区间</strong>是一个数值范围，用于估计总体参数的真实值最可能落入的范围。</td></tr><tr><td><strong>相关性与因果性</strong></td><td><strong>相关性</strong>（Correlation）描述两个变量之间是否存在关联关系，即一个变量的变化伴随着另一个变量的变化。<br /><strong>因果性</strong>（Causation）指一个变量的变化直接导致了另一个变量的变化。相关性不等于因果性。</td></tr></tbody></table><h3 id="假设检验">假设检验</h3><table><thead><tr><th>概念</th><th>解释</th></tr></thead><tbody><tr><td><strong>P值的含义</strong></td><td><strong>P值</strong>（Probability Value）是指：在原假设 (H0) 成立的条件下，观察到当前样本结果或比当前样本结果更极端的结果的概率。如果P值非常小（通常小于预设的显著性水平 α，如0.05），则认为观察到的结果不太可能是偶然发生的，从而拒绝原假设。</td></tr><tr><td><strong>两类错误</strong></td><td><strong>第一类错误 (α)</strong>：当原假设 (H0) 实际为真时，错误地拒绝了 H0。<br /><strong>第二类错误 (β)</strong>：当原假设 (H0) 实际为假时，错误地没有拒绝 H0。统计功效（Power）是 1−β，即正确拒绝假的原假设的概率。</td></tr></tbody></table><h3 id="参数检验">参数检验</h3><table><thead><tr><th>检验名称</th><th>用途与步骤</th><th>原理/核心思想</th></tr></thead><tbody><tr><td><strong>Z检验</strong></td><td><strong>用途</strong>：用于检验总体均值（或比例），<strong>前提条件</strong>是总体标准差已知，或者样本量非常大（通常 n&gt;30，此时可近似使用样本标准差代替）。<br /><strong>步骤</strong>：计算Z统计量，查Z分布表或计算P值，进行决策。</td><td>基于标准化正态分布（N(0,1)）来判断样本均值与已知总体均值之间的差异是否显著。</td></tr><tr><td><strong>t检验</strong></td><td><strong>用途</strong>：用于检验一个或两个样本的均值差异，<strong>前提条件</strong>是总体标准差未知，且样本量较小，但总体近似服从正态分布。<br /><strong>步骤</strong>：计算t统计量，查t分布表（自由度df很重要）或计算P值，进行决策。</td><td>基于<strong>t分布</strong>（比标准正态分布更“厚尾”，以应对小样本带来的不确定性）来评估均值差异的显著性。</td></tr><tr><td><strong>t检验类型</strong></td><td><strong>单样本t检验</strong>：比较一个样本的均值与一个已知的（理论）值。<br /><strong>独立/双样本t检验</strong>：比较两个独立样本的均值差异。<br /><strong>配对样本t检验</strong>：比较同一组对象在不同条件下的均值差异（如前后测量）。</td><td>它们的目的是检验不同组或同一组在不同条件下的均值是否存在统计学上的显著差异。</td></tr><tr><td><strong>方差齐次性检验</strong></td><td>在进行双样本t检验（特别是独立样本t检验）之前，需要检验两组数据的方差是否相等。常用的检验方法有<strong>Levene检验</strong>或<strong>F检验</strong>。这是因为t检验的公式会根据方差是否相等而有所不同（是否使用合并方差）。</td><td></td></tr></tbody></table><h3 id="非参数检验">非参数检验</h3><p>（计数数据或分布不确定时使用）</p><table><thead><tr><th>概念</th><th>解释</th></tr></thead><tbody><tr><td><strong>卡方检验</strong></td><td><strong>用途</strong>：主要用于分析<strong>分类数据</strong>（计数数据）。常见形式有：<strong>拟合优度检验</strong>（检验样本分布是否符合某个理论分布）和<strong>独立性检验</strong>（检验两个分类变量之间是否存在关联）。</td></tr><tr><td><strong>卡方分布</strong></td><td><strong>定义</strong>：卡方分布（χ2 分布）是若干个独立标准正态分布变量的平方和的分布。它只取非负值，形状取决于其<strong>自由度</strong>（df）。它在卡方检验中用作检验统计量的理论分布。</td></tr><tr><td><strong>卡方检验与t检验的差异</strong></td><td><strong>t检验</strong>用于比较<strong>连续变量</strong>的均值（需要正态性假设）。<strong>卡方检验</strong>用于分析<strong>分类变量</strong>的频数分布或关联性，不需要正态性假设。</td></tr></tbody></table><h3 id="方差分析（ANOVA）">方差分析（ANOVA）</h3><table><thead><tr><th>概念</th><th>解释</th></tr></thead><tbody><tr><td><strong>方差分析</strong></td><td><strong>用途</strong>：用于比较<strong>三个或更多</strong>样本的均值是否存在显著差异。ANOVA的基本思想是将总变异分解为组间变异和组内变异。</td></tr><tr><td><strong>方差分析与t检验的差异</strong></td><td><strong>t检验</strong>用于比较<strong>两组</strong>均值。ANOVA用于比较<strong>三组及以上</strong>均值。如果只比较两组，ANOVA的结果与t检验是等价的（F=t2，且P值相同）。当比较多组时，ANOVA可以一次性检验所有组均值是否相等，避免了多次进行t检验导致的I类错误累积（多重比较问题）。</td></tr><tr><td><strong>双样本t检验与配对样本t检验</strong></td><td><strong>双样本t检验（独立样本）</strong>：用于比较来自两个<strong>独立</strong>群体的均值（例如，男性与女性的考试分数）。<strong>配对样本t检验</strong>：用于比较来自<strong>同一主体</strong>在不同时间点或不同条件下的测量值（例如，治疗前后的血压）。</td></tr></tbody></table><h3 id="回归分析">回归分析</h3><table><thead><tr><th>概念</th><th>解释</th></tr></thead><tbody><tr><td><strong>回归分析与参数</strong></td><td>回归分析用于研究一个或多个<strong>自变量</strong>（预测变量）如何影响一个<strong>因变量</strong>（响应变量）。<strong>线性回归</strong>：因变量是连续的，关系是线性的 (Y=β0+β1X1+ϵ)。<strong>多元回归</strong>：使用两个或更多的自变量。<strong>逻辑回归</strong>：因变量是<strong>分类的</strong>（如是/否），用于估计事件发生的概率。</td></tr><tr><td><strong>回归分析的评估指标</strong></td><td><strong>R2</strong>（决定系数）：表示自变量能解释因变量变异的百分比。<strong>调整R2</strong>：修正了模型中变量数量对R2的夸大影响。<strong>P值（系数）</strong>：检验每个自变量的系数是否显著不为零。<strong>残差分析</strong>：检查模型假设（如线性、独立性、正态性）是否满足。</td></tr></tbody></table><h3 id="降维与探索性分析方法">降维与探索性分析方法</h3><table><thead><tr><th>概念</th><th>解释</th></tr></thead><tbody><tr><td><strong>主成分分析（PCA）与降维</strong></td><td><strong>目的</strong>：在保持尽可能多信息量的前提下，将高维数据集转换为低维子空间（即主成分）。<strong>降维</strong>：减少变量的数量，同时最大程度保留原始数据中的方差（信息）。PCA是一种线性降维技术。</td></tr><tr><td><strong>因子分析</strong></td><td><strong>用途</strong>：用于探索潜藏的（未直接观测到的）<strong>因子</strong>如何解释观测到的变量之间的相关性。与PCA关注最大化方差不同，因子分析更关注变量之间的<strong>共性</strong>。</td></tr><tr><td><strong>判别分析</strong></td><td><strong>用途</strong>：一种<strong>监督学习</strong>方法，用于根据已知类别的观测数据，建立一个判别函数（或多个函数），用于预测新样本<strong>最有可能</strong>属于哪个类别。它与回归分析的目标相反（回归是预测连续值或概率，判别是分类）。</td></tr><tr><td><strong>多重共线性</strong></td><td><strong>定义</strong>：指在多元回归模型中，两个或多个<strong>自变量</strong>之间存在高度相关性。<strong>后果</strong>：导致回归系数的估计值变得不稳定、难以解释，标准误增大，但模型的整体预测能力可能不受太大影响。</td></tr></tbody></table><h3 id="高级统计概念">高级统计概念</h3><table><thead><tr><th>概念</th><th>解释</th></tr></thead><tbody><tr><td><strong>贝叶斯统计</strong></td><td>一种统计推断方法，它使用<strong>先验信息</strong>（在观察数据之前对参数的信念）和<strong>观测数据</strong>的似然性，通过<strong>贝叶斯定理</strong>来更新和形成<strong>后验概率</strong>分布。它与依赖于固定的（或采样的）总体的频率学派统计学（如假设检验）不同。</td></tr><tr><td><strong>辛普森悖论（Simpson’s Paradox）</strong></td><td>这是一个非常重要的概念，它描述了一种现象：在分组数据中观察到的趋势，在将这些分组数据合并起来分析时却<strong>反转了</strong>。这意味着，当遗漏了一个或多个关键的<strong>混杂变量</strong>时，我们对数据的解释可能会完全错误。在做任何分组比较（如t检验或ANOVA）后，必须警惕是否遗漏了重要的分组因素。</td></tr></tbody></table><h2 id="概率论：">概率论：</h2><p>条件概率（贝叶斯原理） 抽样 大数定律 中心极限定理 区间估计/参数估计 R² 方差分析</p><h2 id="Ab实验：">Ab实验：</h2><h3 id="T检验-vs-Z检验">T检验 vs Z检验</h3><p>公式、使用条件与场景</p><table><thead><tr><th>项目</th><th>T检验</th><th>Z检验</th></tr></thead><tbody><tr><td><strong>适用条件</strong></td><td>总体标准差未知，样本量较小（通常 n&lt;30）</td><td>总体标准差已知，或样本量大（n≥30），可用样本标准差近似总体标准差</td></tr><tr><td><strong>分布假设</strong></td><td>样本来自正态分布或近似正态（小样本时要求高）</td><td>大样本下可依赖中心极限定理</td></tr><tr><td><strong>自由度</strong></td><td>df=n1+n2−2（双样本独立t检验）</td><td>无自由度概念</td></tr><tr><td><strong>实际应用</strong></td><td>更常见于互联网A/B测试（因总体方差未知）</td><td>较少直接使用，除非有历史数据提供精确方差</td></tr><tr><td><strong>A/B测试场景</strong></td><td><strong>最常用</strong>。因为我们只知道实验组和对照组的样本数据，需要用样本方差来估计总体方差。即使样本量很大（n &gt; 30），使用T检验也是安全和标准的做法。</td><td><strong>非常罕见</strong>。在互联网实验中，我们几乎永远无法知道总体的真实方差（比如所有用户的购买行为方差）。</td></tr></tbody></table><blockquote><p>✅ <strong>现代实践中</strong>：即使样本量大，也常用 <strong>t-test</strong>（不假设方差齐性），更稳健。</p></blockquote><p><strong>使用条件</strong>：在A/B测试中，由于总体方差通常未知，T检验更常用；但如果样本量很大，Z检验可作为近似。</p><h3 id="中心极限定理">中心极限定理</h3><p>中心极限定理是A/B测试的统计学基石。</p><ul><li><strong>内容</strong>：无论原始总体是什么分布（如正态分布、泊松分布、二项分布等），只要样本量足够大（通常n ≥ 30），其样本均值的抽样分布会近似于正态分布。</li></ul><p><strong>意义</strong>：</p><ul><li>支持使用 t/z 检验进行假设检验；</li><li>允许对非正态数据（如点击率、停留时长）进行参数检验；</li><li>一般认为 n≥30 可近似满足 CLT，但偏态严重时需更大样本。</li></ul><p><strong>为什么重要？</strong></p><ul><li>A/B测试的很多核心指标（如用户停留时长、购买金额）本身不服从正态分布。</li><li>但根据中心极限定理，我们抽取多次实验（例如，重复实验100次，每次计算一次实验组的平均转化率），这些“平均转化率”的分布会是正态的。</li><li>这使得我们可以使用基于正态分布的检验方法（如Z检验、T检验）来对样本均值进行假设检验和置信区间估计，从而得出可靠的结论。</li></ul><h3 id="两类错误，α-β-的含义">两类错误，α β 的含义</h3><p>在假设检验中（例如，原假设 H0: A和B没有差异），我们可能会犯两种错误。</p><ul><li><p><strong>第一类错误 (Type I Error, α, 阿尔法)</strong></p><ul><li><strong>含义</strong>：原假设为真（A和B确实没差异），但我们错误地拒绝了它（错误地认为B比A好）。</li><li><strong>俗称</strong>：“假阳性”、“冤枉好人”。</li><li><strong>概率</strong>：即<strong>显著性水平</strong>。我们常说的p值小于0.05就拒绝原假设，这里的0.05就是α的犯错概率上限。</li></ul></li><li><p><strong>第二类错误 (Type II Error, β, 贝塔)</strong></p><ul><li><strong>含义</strong>：原假设为假（A和B确实有差异），但我们未能拒绝它（错误地认为它们没差异）。</li><li><strong>俗称</strong>：“假阴性”、“放走坏人”。</li><li><strong>概率</strong>：我们无法像α一样预先设定一个绝对的界限，它受样本量、效应大小和α共同影响。</li></ul></li></ul><h3 id="统计功效">统计功效</h3><p><strong>统计功效（Statistical Power）</strong>：</p><ul><li><strong>公式</strong>：Power=1−β</li><li><strong>含义</strong>：当原假设为假（差异确实存在）时，我们能够正确拒绝原假设的概率。</li><li><strong>俗称</strong>：“检验出真差异的能力”。</li><li><strong>重要性</strong>：高功效意味着实验更有可能检测到一个真实存在的微小的改进。通常我们会将功效目标设定在80%或更高。</li></ul><p><strong>权衡关系</strong>：在其他条件不变时，降低α（更严格，如从0.05到0.01）会增大β，从而降低功效。反之，提高功效通常需要更大的样本量或接受更高的α。</p><h3 id="最小样本量计算">最小样本量计算</h3><p>最小样本量计算是在实验<strong>开始前</strong>进行的关键步骤，目的是确保实验有足够大的统计功效来检测到你关心的最小效应。</p><ul><li><strong>计算所需的核心参数</strong>：<ol><li><strong>显著性水平 (α)</strong>：通常设为0.05。</li><li><strong>统计功效 (1 - β)</strong>：通常设为0.8或0.9。</li><li><strong>基线水平</strong>：例如，当前版本的转化率是10%。</li><li><strong>最小可检测效应</strong>：你认为有商业价值的最小改进幅度。例如，你希望至少能检测到从10%到10.5%（0.5个百分点）的提升。</li></ol></li><li><strong>逻辑</strong>：MDE越小，需要检测的信号就越微弱，因此需要更大的样本量（更多“电量”）来从噪音中分辨出这个信号。</li><li><strong>计算工具</strong>：通常使用在线样本量计算器或编程语言中的统计库（如Python的<code>statsmodels.stats.power</code>）来完成，手动推导公式较为复杂。</li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 使用 statsmodels 计算比例检验的样本量示例</span></span><br><span class="line"><span class="keyword">import</span> statsmodels.stats.power <span class="keyword">as</span> smp</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment"># 参数设置</span></span><br><span class="line">effect_size = smp.proportion_effectsize(prop1=<span class="number">0.10</span>, prop2=<span class="number">0.105</span>) <span class="comment"># 基线10%, MDE 0.5%</span></span><br><span class="line">alpha = <span class="number">0.05</span> <span class="comment"># 显著性水平</span></span><br><span class="line">power = <span class="number">0.80</span> <span class="comment"># 统计功效</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算样本量</span></span><br><span class="line">sample_size = smp.NormalIndPower().solve_power(effect_size=effect_size, alpha=alpha, power=power, alternative=<span class="string">&#x27;two-sided&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;每组所需的最小样本量约为: <span class="subst">&#123;<span class="built_in">int</span>(np.ceil(sample_size))&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> statsmodels.stats.power <span class="keyword">import</span> TTestIndPower</span><br><span class="line"></span><br><span class="line">effect_size = <span class="number">0.1</span>  <span class="comment"># Cohen&#x27;s d</span></span><br><span class="line">alpha = <span class="number">0.05</span></span><br><span class="line">power = <span class="number">0.8</span></span><br><span class="line">ratio = <span class="number">1.0</span>  <span class="comment"># control/treatment size ratio</span></span><br><span class="line"></span><br><span class="line">analysis = TTestIndPower()</span><br><span class="line">sample_size = analysis.solve_power(effect_size=effect_size, power=power, alpha=alpha, ratio=ratio)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;每组所需样本量: <span class="subst">&#123;<span class="built_in">int</span>(sample_size)&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><h3 id="实验周期">实验周期</h3><p>实验周期并非仅由样本量决定，必须综合考虑：</p><ol><li><strong>流量预估</strong>：根据每日活跃用户数和分流比例，计算出达到最小样本量需要多少天。这是最短周期。</li><li><strong>业务周期</strong>：必须覆盖完整的业务周期（通常是<strong>至少一周</strong>），以消除工作日 vs. 周末的用户行为差异。对于某些业务，可能需要覆盖一个月（适应发薪日、账单日等）。</li><li><strong>用户行为周期</strong>：新用户需要时间来学习和适应，老用户需要时间去发现新功能。一些实验效果（尤其是新奇效应）会随时间衰减。因此，实验需要跑足够长（如<strong>2-4周</strong>），待指标稳定后再做结论。</li><li><strong>“新奇效应”</strong>：用户因为一个东西是新的就去点击，但很快就会失去兴趣。为了避免被这种短期效应误导，需要延长实验周期。</li></ol><p><strong>经验法则</strong>：对于大多数互联网产品，一个标准的A/B实验周期<strong>至少为2周</strong>，以确保结果的可靠性。</p><ul><li><strong>基本原则</strong>：<ul><li>覆盖完整用户行为周期（如周周期、月周期）</li><li>避免节假日、大促等异常事件干扰</li><li>至少运行 <strong>1-2 个完整周期</strong>（如两周）</li></ul></li><li><strong>考虑因素</strong>：<ul><li>日活用户数 → 决定达到最小样本量所需时间</li><li>季节性、趋势变化</li><li>新奇效应（Novelty Effect）：初期用户反应强烈，需延长观察期</li></ul></li></ul><blockquote><p>📌 示例：若每天流入5000用户，每组需1万样本 → 至少运行4天，但建议运行2周以消除周内波动。</p></blockquote><h3 id="P值（p-value）">P值（p-value）</h3><p><strong>定义</strong>：在原假设成立的前提下，观察到当前或更极端结果的概率。</p><p><strong>判断规则</strong>：</p><ul><li>p&lt;α（如0.05）→ 拒绝原假设，认为差异显著</li><li>p≥α → 不拒绝原假设</li></ul><p><strong>常见误解</strong>：</p><ul><li>❌ “p=0.05 表示有95%概率H1为真” → 错！这是贝叶斯解释</li><li>✅ 正确理解：如果H0为真，我们有5%概率误判为显著</li><li>P值很小，不代表效应很大，只代表效应不太可能是随机噪音。</li></ul><h3 id="实验不显著问题及扩展">实验不显著问题及扩展</h3><p>当实验结果P值 &gt; 0.05时，我们得到“不显著”的结论。这并不意味着A和B肯定没有差异，而是<strong>我们没有足够的证据证明它们有差异</strong>。</p><p><strong>可能原因：</strong></p><ol><li><strong>效应太小</strong>：真实提升低于MDE</li><li><strong>样本不足</strong>：未达到最小样本量</li><li><strong>方差过大</strong>：指标波动大，信噪比低</li><li><strong>分流不均</strong>：技术问题导致流量分配偏差</li><li><strong>新奇效应/学习曲线</strong>：用户需要时间适应</li><li><strong>长期效应滞后</strong>：短期看不出效果</li></ol><p><strong>扩展分析方法：</strong></p><ul><li><strong>分层分析（Subgroup Analysis）</strong>：按用户属性（新老用户、地域等）查看是否有局部显著</li><li><strong>时间趋势图</strong>：观察指标随时间的变化趋势</li><li><strong>CUPED（方差缩减）</strong>：利用协变量降低方差</li><li><strong>因果森林 / 异质性分析</strong>：识别对哪些用户有效</li></ul><p><strong>问题诊断</strong>：</p><ol><li><strong>评估功效</strong>：实验后的功效是多少？是否因为样本量不够 或 MDE设定过大 导致实验根本“无力”检测出实际存在的效应？</li><li><strong>查看置信区间</strong>：效应大小（如转化率提升）的95%置信区间是什么样的？如果这个区间很宽，说明实验误差很大，结果不精确。如果区间包含了0，甚至包含了有商业意义的值，说明问题更严重。</li><li><strong>检查实验设置</strong>：分流是否正确？数据采集是否完整？是否存在bug？</li></ol><p><strong>后续行动（扩展）</strong>：</p><ol><li><strong>增加样本量</strong>：最直接的方法，延长实验周期或提高流量比例。</li><li><strong>调整MDE</strong>：如果原MDE设得太小，可以适当放宽，重新计算样本量，但这需要与产品经理对齐商业价值。</li><li><strong>分析子群体</strong>：在全用户群不显著，但在某个细分群体（如新用户、特定渠道用户）是否显著？（注意：这会增加多重比较问题，需谨慎对待）。</li><li><strong>采用贝叶斯方法</strong>：贝叶斯A/B测试不依赖于p值，而是直接给出“B优于A的概率”，并提供效应大小的后验分布，对小样本或不显著结果提供更丰富的解读。</li></ol><h3 id="AB实验流程">AB实验流程</h3><ol><li><strong>问题定义</strong>：明确业务目标（如提升转化率）</li><li><strong>提出假设</strong>：H0: 无差异；H1: 有差异</li><li><strong>选择评估指标</strong>：核心指标 + 辅助指标</li><li><strong>计算最小样本量</strong></li><li><strong>设计实验方案</strong>：UI改动、逻辑调整等</li><li><strong>分流设计</strong>：确保随机性、独立性、一致性（见下文）</li><li><strong>上线运行</strong>：监控数据质量、异常</li><li><strong>数据分析</strong>：假设检验、置信区间、效应大小</li><li><strong>结论输出</strong>：是否显著？是否可上线？</li><li><strong>复盘归档</strong>：记录经验教训</li></ol><p>一个标准的A/B实验流程包含以下步骤：</p><ol><li><strong>分析现状与提出假设</strong>：通过数据分析发现问题或机会，提出明确的假设（例如：“简化注册流程将提高新用户注册率”）。</li><li>确定评估指标：<ul><li><strong>核心指标</strong>：直接衡量假设结果的指标（如注册转化率）。</li><li><strong>反向指标/护栏指标</strong>：需要监控以防负面影响的指标（如页面加载速度、用户投诉率）。</li></ul></li><li><strong>实验设计</strong>：计算最小样本量、确定MDE、选择分流方法（用户级/会话级）、设定实验周期。</li><li><strong>开发与上线</strong>：开发实验版本，并部署到A/B测试平台。</li><li>实验运行与监控：<ul><li>启动实验，并运行预定的周期。</li><li>进行<strong>Sanity Check</strong>（合理性检查），如检查A/A实验结果，确保分流和指标计算正常。</li><li>监控核心和护栏指标，防止出现严重的负面效果。</li></ul></li><li><strong>数据分析与解读</strong>：实验结束后，进行统计分析，计算P值、置信区间、效应大小，解读其业务含义。</li><li><strong>决策与沟通</strong>：根据分析结果，决定是全量、迭代还是放弃该改动，并向相关方沟通结论。</li><li><strong>归档与复盘</strong>：整理实验文档，为未来的实验提供参考。</li></ol><h3 id="AB实验评估指标">AB实验评估指标</h3><p><strong>绝对指标 vs 相对指标</strong>：</p><ul><li><strong>绝对指标</strong>：指标本身，如转化率从10%变为11%。</li><li><strong>相对指标</strong>：指标的变化率，如 <code>(11% - 10%) / 10% = 10%</code> 的提升。在报告中常用相对指标，更具冲击力。</li></ul><p><strong>复合指标</strong>：如“人均GMV”、“每会话浏览页数”，是多个基础指标的组合。</p><p><strong>比率指标</strong>：一个指标是另一个指标的分子分母，如CTR = 点击数 / 展示数。这类指标的方差计算复杂，常需要Delta法或Bootstrapping（自助法）。</p><p><strong>选择原则</strong>：</p><ul><li><strong>_SENSITIVE (灵敏度)</strong>：能对实验改动做出反应。</li><li><strong>ROBUST (稳定性)</strong>：不应因随机波动而产生剧烈变化。</li><li><strong>DIRECTLY RELATED (相关性)</strong>：直接关系到业务目标（如北极星指标）。</li></ul><p><strong>分类：</strong></p><ul><li><strong>核心指标（Primary Metric）</strong>：决定实验成败的关键指标（如点击率、GMV）</li><li><strong>辅助指标（Secondary Metrics）</strong>：监控副作用（如页面加载时间、跳出率）</li><li><strong>护栏指标（Guardrail Metrics）</strong>：防止负向影响（如用户投诉率、系统负载）</li></ul><p><strong>设计原则：</strong></p><ul><li>SMART原则（具体、可测、可达成等）</li><li>避免指标膨胀（太多指标增加I类错误风险）</li><li>使用 <strong>复合指标</strong>（如：加权得分 = 0.7×CTR + 0.3×停留时长）</li></ul><h3 id="AB实验分流">AB实验分流</h3><p>分流的目标是确保实验组和对照组在实验开始前是“同质”的，除了实验变量外，其他所有特征（新老用户比例、地域分布、设备类型等）都应尽可能一致。</p><ul><li>用户级分流：<ul><li><strong>方法</strong>：基于用户ID进行分流，一个用户一旦被分到A组，在整个实验期间就永远看到A版本。</li><li><strong>优点</strong>：用户体验一致，可以衡量长期效果。</li><li><strong>缺点</strong>：一个用户可能很长时间才来一次，导致实验需要更长时间才能收集到样本。</li></ul></li><li>会话级/页面级分流：<ul><li><strong>方法</strong>：用户每次访问或每次浏览页面时，都可能被随机分到A或B组。</li><li><strong>优点</strong>：收敛速度快，短时间内能收集更多样本。</li><li><strong>缺点</strong>：用户体验混乱（前后两次访问看到不同版本），无法衡量学习效应和长期影响。</li></ul></li><li><strong>分层数据</strong>：在分流前，可根据某些关键维度（如国家、用户分层）先对用户进行分层，保证每个层内被均匀分到A/B组，这样可以减少组间在这些维度上的随机差异。</li></ul><p><strong>目标</strong>：保证实验组与对照组在统计上可比</p><p><strong>关键要求</strong>：</p><ul><li><strong>随机性</strong>：用户被随机分配</li><li><strong>独立性</strong>：不同实验间互不干扰（通过 <strong>分层分流 + 流量正交</strong> 实现）</li><li><strong>一致性（Stickiness）</strong>：同一用户始终看到同一版本（通过用户ID哈希实现）</li></ul><p><strong>常见技术</strong>：</p><ul><li><p><strong>Hash-based 分流</strong>：<code>hash(user_id) % 100 &lt; 50 → A组</code></p></li><li><p><strong>分层实验平台（如Google’s PlanOut）</strong>：支持多实验并行</p><hr></li><li><p>流量正交是什么</p></li></ul><p>流量正交是 AB 实验中实现<strong>多组实验并行且互不干扰</strong>的核心分流技术。其核心思想是：<strong>通过不同的分流维度将同一批用户打散，使得每个实验层的流量分配相互独立，最终确保实验结果不受其他实验的影响</strong></p><p><strong>与互斥分流的对比</strong></p><table><thead><tr><th>维度</th><th>正交分流</th><th>互斥分流</th></tr></thead><tbody><tr><td>流量关系</td><td>层间复用，每层均使用 100% 流量</td><td>层内分割，各实验共享 100% 流量的一部分</td></tr><tr><td>适用场景</td><td>业务无关的实验并行</td><td>同模块实验或存在干扰的实验</td></tr><tr><td>实验数量</td><td>理论无限</td><td>受流量限制，如每层分配 20% 流量时最多运行 5 个实验</td></tr><tr><td>复杂度</td><td>高（需分层管理 + 多维度分流）</td><td>低（单层内按比例分割）</td></tr></tbody></table><p><strong>常见误区与避坑点</strong></p><p><strong>正交≠完全隔离</strong>正交分流仅保证统计上的独立性，但实际业务中若两个实验存在隐性关联（如同时优化同一页面的不同元素），仍可能相互影响。需结合业务逻辑判断是否适合正交。</p><p><strong>避免过度分层</strong>分层过多会增加系统复杂度，建议根据业务模块的关联性进行合理划分，例如将推荐、搜索、广告划分为不同层，而将同一页面的元素优化放在同一层互斥分流。</p><p><strong>动态调整需谨慎</strong>实验过程中若调整分流策略（如新增实验层），可能导致历史数据失效。建议在实验设计阶段明确分层方案，避免中途变更。</p><h3 id="AA实验">AA实验</h3><p>A/A实验是指让两个完全相同的版本（两个A版本）相互进行测试。</p><ul><li><p>目的：</p><ol><li><strong>校验分流和指标系统</strong>：一个完美的A/A实验，其结果应该是不显著的。如果A/A实验出现了显著结果，说明你的分流系统或数据计算存在问题，必须修复。</li><li><strong>理解基线波动</strong>：通过多次运行A/A实验，可以了解在没有做任何改动时，核心指标的自然波动范围有多大。</li><li><strong>验证统计工具</strong>：理论上，A/A实验的p值应均匀分布在[0, 1]区间，且约有5%的情况下p值会小于0.05。这可以用来验证你的整套统计流程是否可靠。</li></ol></li><li><p><strong>定义</strong>：两组均为原始版本，不施加任何干预</p></li><li><p>目的：</p><ul><li>验证分流系统是否正常（是否随机、无偏差）</li><li>估计系统噪声水平（baseline variance）</li><li>校准p值分布（应均匀分布在[0,1]）</li></ul></li><li><p><strong>预期结果</strong>：p值应在0.05显著性水平下约5%“显著”（即Type I错误率正常）</p></li></ul><blockquote><p>🛠️ 若A/A实验频繁显著 → 分流系统有问题（如用户重叠、数据污染）</p></blockquote><ul><li>AA实验怎么算p值</li></ul><p>AA 实验计算 p 值的核心是：通过统计检验对比两组（A1、A2）同质样本的指标差异，判断差异是否由随机波动导致，核心步骤是 “选检验方法→算统计量→得 p 值”。</p><p>通常以 p&gt;0.05 为标准，说明两组无显著差异，AA 实验通过（样本同质）；若 p≤0.05，可能是样本分配不均、数据异常等问题，需排查。</p><p>AA 实验的核心目的是验证 “两组样本无差异”，所以正常情况下 p 值应大概率接近 0.5（无显著差异）。如果多次算出 p≤0.05，别着急下结论，先排查样本分配是否随机、是否有数据污染、指标计算是否有误等问题。</p><h3 id="方差缩减法">方差缩减法</h3><p>方差缩减法是一种在不增加样本量的前提下，提高统计功效的技术。核心思想是<strong>通过移除一些与结果指标相关但非实验引起的“噪音”，来降低指标的方差</strong>。</p><ul><li>最常用方法：CUPED (Controlled-experiment Using Pre-Experiment Data)<ul><li><strong>原理</strong>：利用用户在实验开始前的历史数据（如实验前1周的购买金额）作为协变量。用户的行为往往是连续的，实验前的表现可以很好地预测实验后的表现。</li><li><strong>做法</strong>：构建一个“调整后”的指标：<code>Y_covadj = Y - (X - X_mean) * Cov(X, Y) / Var(X)</code>，其中Y是实验后指标，X是实验前指标。这个新指标的方差远小于原始Y。</li><li><strong>效果</strong>：方差降低 → 统计功效提高 → 可以用更小的样本量 或 检测到更小的MDE 或 缩短实验周期。</li></ul></li></ul><h2 id="业务题：">业务题：</h2><p>指标体系搭建</p><p>指标异动分析</p><p>活动效果评估</p><p>归因分析</p><p>用户行为分析</p><p>漏斗模型</p><p>路径分析</p><p>人货场模型</p><p>用户分群</p><p>用户画像</p><p>用户留存</p><p>ROI</p><p>LTV测算</p><p>同期群分析</p><p>DID，PSM等因果推断分析的场景</p><h2 id="机器学习模型：">机器学习模型：</h2><p>模型只要掌握原理，模型解读，模型评估，使用场景，优缺点，模型优化数学原理及公式除算法岗位外，了解即可，不需要花费大量时间 1.有监督学习 回归：线性回归、逻辑回归 分类：决策树、随机森林、SVM 2.无监督学习 聚类(Kmeans) 3.时间序列模型 Arima, prophet 以及模型的各类评估指标:auc,ks,lift,psi等 特征工程方法：Woe，iv，特征衍生 各类调参方法，网格，随机，贝叶斯</p><h3 id="Prophet">Prophet</h3><p>Prophet（由 Facebook 开源）</p><h4 id="模型简介">模型简介</h4><ul><li>全称：Prophet（不是缩写，就叫这个）</li><li>开发者：Facebook（Meta）Core Data Science 团队</li><li>类型：时间序列预测模型</li><li>语言：Python / R</li><li>特点：<ul><li>自动处理趋势、季节性、节假日效应</li><li>对缺失值、异常值鲁棒</li><li>可解释性强（趋势、周期、节假日分解图）</li><li>无需大量特征工程，几行代码就能跑</li><li>适合业务人员+数据分析师快速建模</li></ul></li></ul><h4 id="在消费金融中的应用场景">在消费金融中的应用场景</h4><table><thead><tr><th>场景</th><th>示例</th></tr></thead><tbody><tr><td><strong>贷款余额预测</strong></td><td>预测未来30天每日贷款余额</td></tr><tr><td><strong>逾期率趋势预测</strong></td><td>预测未来几个月的M1/M2逾期率</td></tr><tr><td><strong>放款量预测</strong></td><td>预测每日/每周放款笔数或金额</td></tr><tr><td><strong>资金计划</strong></td><td>预测未来现金流，辅助备付金管理</td></tr><tr><td><strong>催收量预测</strong></td><td>预测未来每日进入催收的案件数</td></tr></tbody></table><h4 id="示例代码">示例代码</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> prophet <span class="keyword">import</span> Prophet</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="comment"># 数据格式：ds 列是日期，y 列是数值</span></span><br><span class="line">df = pd.read_csv(<span class="string">&#x27;loan_balance_daily.csv&#x27;</span>)  <span class="comment"># 示例：每日贷款余额</span></span><br><span class="line">df.columns = [<span class="string">&#x27;ds&#x27;</span>, <span class="string">&#x27;y&#x27;</span>]</span><br><span class="line"></span><br><span class="line">model = Prophet()</span><br><span class="line">model.fit(df)</span><br><span class="line"></span><br><span class="line">future = model.make_future_dataframe(periods=<span class="number">30</span>)  <span class="comment"># 预测未来30天</span></span><br><span class="line">forecast = model.predict(future)<span class="comment"># 可视化</span></span><br><span class="line">fig = model.plot(forecast)</span><br></pre></td></tr></table></figure><h4 id="小结：为什么消费金融喜欢用-Prophet？">小结：为什么消费金融喜欢用 Prophet？</h4><table><thead><tr><th>优点</th><th>说明</th></tr></thead><tbody><tr><td><strong>快</strong></td><td>10分钟就能出预测结果</td></tr><tr><td><strong>稳</strong></td><td>对异常值、缺失值不敏感</td></tr><tr><td><strong>白盒</strong></td><td>能解释“为什么涨/跌”</td></tr><tr><td><strong>节假日支持</strong></td><td>自动处理春节、国庆等节假日效应</td></tr></tbody></table><h2 id="分析工具部分：">分析工具部分：</h2><p>1.SQL 表的增删改查、表连接、聚合、日期函数、子查询、窗口函数 场景题：连续登陆，留存率计算，中位数 SQL语句执行顺序 2.Python 基本数据结构：列表/字典/字符串/元组/数组/集合 基本语句:if条件语句/for循环/while循环 基本package:numpy/pandas/sklearn/statsmodel/seaborn</p><p>3.Tableau(没时间就不看） 图表类型(使用场景）、交互式面板、基础的计算函数 4.EXCEL 基本计算函数(sum，count)、数据透视表、VLOOKUP</p><p>这份&quot;工作手机加频测试客群分析报告&quot;中<strong>符合加分红词的内容</strong>：</p><p>✅ 符合加分红词的部分：</p><ol><li><strong>用户画像</strong> ✓</li></ol><ul><li>文档通过&quot;客群、渠道、借贷、触达、登录&quot;等多个维度构建了外呼客户的画像</li><li>这是典型的用户画像工作</li></ul><ol start="2"><li><strong>用户行为分析</strong> ✓</li></ol><ul><li>分析了不同客群在不同时段的外呼接通行为</li><li>挖掘了&quot;下午2-3点外呼效果最好&quot;这类行为规律</li></ul><ol start="3"><li><strong>人群洞察</strong> ✓</li></ol><ul><li>识别了&quot;高意向、T1、A1/A3、有贷、有触达、有登录&quot;等最优客群</li><li>这属于基于数据的人群洞察</li></ul><ol start="4"><li><strong>指标体系</strong> ✓</li></ol><ul><li>建立了接通率、平均通时、通话时长分布等多维度指标</li><li>跨维度的指标对标分析</li></ul><ol start="5"><li><strong>策略优化建议</strong> ✓（接近&quot;策略迭代&quot;）</li></ol><ul><li>基于分析结果给出了最优外呼时段和目标客群的明确建议</li><li>虽然不是&quot;策略落地&quot;，但有策略指导意义</li></ul><p>⚠️ 需要改进的部分：</p><ul><li><strong>缺少因果推断</strong>：没有说明为什么这些客群表现更好</li><li><strong>缺少AB实验</strong>：没有对照组验证</li><li><strong>缺少预测/收益评估</strong>：没有预测潜在提升空间</li></ul><p>工作手机外呼策略优化</p><p>针对高意向客户回访效率低的问题，通过数据驱动<strong>指标体系搭建</strong>，识别驱动通时和转化率的核心因子，并基于<strong>因果推断</strong>框架，构建高ROI的<strong>策略迭代</strong>方案。</p><ol><li>探索分析：按客群分层（渠道、借贷、标签等）计算接通率，所有维度的接通率差异都小于1.75%，但通话时长出现明显分化。将分析拓展到时间维度，我发现在下午2-3点，所有客群的接通率和平均通时均达到峰值</li><li>设计AB实验：为验证时段是否真的是接通率影响主因，观测核心指标并追踪7天内点击、登录、提现，30天内借贷等转化指标。用DID做因果推断，排除名单质量与坐席熟练度等混杂。</li><li>业务贡献：策略全量推出后，接通率提升4.1pp，平均通时+16.4s，借款率+2.3pp，集中投放降低人力成本约15%，T30转化率提升2.2pp</li></ol><p>计算各客群维度的接通率（衡量客户接听难度）和平均通时（衡量客户交互价值）</p>]]></content>
      
      
      
        <tags>
            
            <tag> password </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SQL窗口函数</title>
      <link href="/2025/10/21/SQL%E7%AA%97%E5%8F%A3%E5%87%BD%E6%95%B0/"/>
      <url>/2025/10/21/SQL%E7%AA%97%E5%8F%A3%E5%87%BD%E6%95%B0/</url>
      
        <content type="html"><![CDATA[<ul><li>SQL 窗口函数 有多少</li><li>列出最常用模板加示例</li><li>先 PARTITION → 再 ORDER → 最后 ROWS/RANGE 详细讲解</li><li>详细拆解每一步的含义、作用、执行顺序，以及它们如何共同决定窗口函数的计算结果。</li></ul><p>🍋窗口函数 = 聚合函数 + 保留明细行</p><p>在 SQL 中，窗口函数允许我们对<strong>查询结果集中的每一行</strong>，基于其“窗口”（即一组相关行）进行计算，而<strong>不会将多行聚合成一行</strong>（区别于 GROUP BY）。</p><p>这三个部分（partition、order、rows/range）共同定义了一个“窗口”——即：对当前行而言，哪些其他行会被纳入计算范围。</p><h1>一句话核心</h1><p>一句话：先分组（<code>partition by</code>），再排序（<code>order by</code>），最后定窗口（<code>rows/range</code>），函数只在窗口内算。</p><blockquote><p><code>over</code> 是窗口函数的标志，它定义了函数作用的“窗口范围”。</p></blockquote><ol><li>partition：先分组，各算各的。<em>类似 GROUP BY，但不下沉行</em></li><li>order：组内排队，定先后。</li><li>rows/range：再框定“当前行±几行”参与计算。</li></ol><h2 id="rows-range的语法：">rows/range的语法：</h2><p><code>rows</code> 按“物理行”框范围，<code>range</code> 按“字段值”框范围，写法都是</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">rows</span><span class="operator">/</span><span class="keyword">range</span> <span class="keyword">between</span> 边界<span class="number">1</span> <span class="keyword">and</span> 边界<span class="number">2</span></span><br></pre></td></tr></table></figure><p>起点/终点四选一：</p><ul><li><code>unbounded preceding</code>  分区头</li><li><code>n preceding</code>          前 n 行/值</li><li><code>current row</code>          当前行/值</li><li><code>n following</code>          后 n 行/值</li><li><code>unbounded following</code>  分区尾</li></ul><p>示例：</p><ol><li><p>前两行</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">rows</span> <span class="keyword">between</span> <span class="number">1</span> preceding <span class="keyword">and</span> <span class="keyword">current</span> <span class="type">row</span></span><br></pre></td></tr></table></figure></li><li><p>分区的所有行</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">rows</span> <span class="keyword">between</span> unbounded preceding <span class="keyword">and</span> unbounded following</span><br></pre></td></tr></table></figure></li><li><p>日期往前推一个月</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="type">date</span>,sales,<span class="built_in">sum</span>(sales) <span class="keyword">over</span>(<span class="keyword">order</span> <span class="keyword">by</span> <span class="type">date</span></span><br><span class="line"><span class="keyword">range</span> <span class="keyword">between</span> <span class="type">interval</span> <span class="string">&#x27;1 month&#x27;</span> preceding <span class="keyword">and</span> <span class="keyword">current</span> <span class="type">row</span>) <span class="keyword">as</span> month_cum</span><br><span class="line"><span class="keyword">from</span> sales_data</span><br></pre></td></tr></table></figure></li></ol><ul><li><code>range between interval '1 month' preceding and current row</code></li><li>把日期值落在当前日期往前推 1 个月到当前日期之间的所有行都圈进来。物理行数不固定，只要日期差在 1 个月内就算，哪怕同一日期有 100 行也全部收进窗口。如现在是9.25，前100行刚好是9.1，前200行刚好是8.25，前201行刚好是8.24，那就取前200行</li></ul><h1>窗口函数的函数</h1><ul><li>列出sql窗口函数的所有函数，每个函数用一句话讲清楚它的用途<ul><li>列出 SQL 标准中定义的 全部窗口函数（Window Function），每个函数用一句话概括其核心用途</li><li>给出基于我提供的 5 行样例数据，把 24 个窗口函数全部跑一遍的完整 SQL 与查询结果。为了节省篇幅，所有函数放在一条 SELECT 里，按上面罗列顺序依次命名别名。</li></ul></li><li>写得不够清晰，用起来不够<ul><li>给出一份“直接能抄、一眼能懂”的速查表。 左边是“我此刻想干什么”，右边是“该用哪个窗口函数、怎么写、注意什么”。 所有例子都基于同一张表</li></ul></li><li>没懂/什么意思<ul><li>rows 按“物理行”框范围，range 按“字段值”框范围没懂</li><li>ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING什么意思</li><li>没懂</li><li>还是没懂，拆解语法</li><li>我不会用，教我</li></ul></li><li>给出具体示例</li></ul><h2 id="排序类">排序类</h2><ol><li>row_number()<br>连续唯一序号（1,2,3,4）</li><li>rank()<br>每一行按排序值<strong>赋予名次</strong>，同值同秩，后续名次会跳号。<br>同值同秩：并列时排名相同，后续序号跳过（1,2,2,4）</li><li>dense_rank()<br>同 rank()，但同值同秩后不跳号，名次连续。<br>并列时排名相同，序号连续（1,2,2,3）</li><li>ntile(n)<br>将数据有序地平均分配到指定数量（n）的桶中，并返回所属桶号。</li></ol><p><strong>示例：</strong><code>shop店铺，date日期，sales销售额</code></p><table><thead><tr><th>shop</th><th>date</th><th>sales</th><th>rn</th><th>rnk</th><th>d_rnk</th><th>ntile3</th></tr></thead><tbody><tr><td>A店</td><td>2025/9/1</td><td>100</td><td>1</td><td>7</td><td>6</td><td>3</td></tr><tr><td>A店</td><td>2025/9/2</td><td>200</td><td>2</td><td>5</td><td>4</td><td>2</td></tr><tr><td>A店</td><td>2025/9/3</td><td>300</td><td>3</td><td>3</td><td>2</td><td>1</td></tr><tr><td>A店</td><td>2025/9/4</td><td>400</td><td>4</td><td>1</td><td>1</td><td>1</td></tr><tr><td>B店</td><td>2025/9/1</td><td>150</td><td>1</td><td>6</td><td>5</td><td>3</td></tr><tr><td>B店</td><td>2025/9/2</td><td>250</td><td>2</td><td>4</td><td>3</td><td>2</td></tr><tr><td>B店</td><td>2025/9/3</td><td>400</td><td>3</td><td>1</td><td>1</td><td>1</td></tr></tbody></table><h2 id="取值类（偏移窗口函数）">取值类（偏移窗口函数）</h2><p><strong>速查：</strong></p><ul><li><code>lag</code> 往前看，<code>lead</code> 往后看，<code>first_value</code> 队头，<code>last_value</code> 队尾（可到当前行），<code>nth_value</code> 第 n 个。</li></ul><ol><li>lag(expr, n) 获取当前行之前<strong>第n行</strong>的数据</li><li>lesd(expr, n) 获取当前行之后<strong>第n行</strong>的数据</li><li>first_value(expr) 返回<strong>窗口</strong>内第一行的数据</li><li>first_value(expr) 返回<strong>窗口</strong>内第一行的数据</li><li>nth_value(expr, n) 返回<strong>窗口</strong>内第n行的数据</li></ol><blockquote><p>expr = expression，就是“任何能算出一个值的式子”——列名、常量、函数、加减乘除、case when … 都算。</p></blockquote><p><strong>示例：</strong><code>shop店铺，date日期，sales销售额</code></p><table><thead><tr><th>shop</th><th>date</th><th>sales</th><th>lag1</th><th>lead1</th><th>first_val</th><th>last_val</th><th>nth2</th></tr></thead><tbody><tr><td>A店</td><td>2025/9/1</td><td>100</td><td>null</td><td>200</td><td><strong>100</strong></td><td>400</td><td>200</td></tr><tr><td>A店</td><td>2025/9/2</td><td>200</td><td>100</td><td>300</td><td><strong>100</strong></td><td>400</td><td>200</td></tr><tr><td>A店</td><td>2025/9/3</td><td>300</td><td>200</td><td>400</td><td><strong>100</strong></td><td>400</td><td>200</td></tr><tr><td>A店</td><td>2025/9/4</td><td>400</td><td>300</td><td>null</td><td><strong>100</strong></td><td>400</td><td>200</td></tr><tr><td>B店</td><td>2025/9/1</td><td>150</td><td>null</td><td>250</td><td>150</td><td>400</td><td><strong>250</strong></td></tr><tr><td>B店</td><td>2025/9/2</td><td>250</td><td>150</td><td>400</td><td>150</td><td>400</td><td><strong>250</strong></td></tr><tr><td>B店</td><td>2025/9/3</td><td>400</td><td>250</td><td>null</td><td>150</td><td>400</td><td><strong>250</strong></td></tr></tbody></table><ul><li>以下均按shop分区，按date升序<ul><li><code>lag1</code> ＝ 上一行 sales；首行为 null。</li><li><code>lead1</code> ＝ 下一行 sales；末行为 null。</li><li><code>first_val</code> ＝ 该店第一行 sales（恒 100/150）。</li><li><code>last_val</code> ＝ 该店最后一行 sales（400），因为手动把 frame 拉到整个分区。</li><li><code>nth2</code> ＝ 该店第二行 sales（200/250）。</li></ul></li><li><code>last_value(sales)    over(partition by shop order by date rows between unbounded preceding and unbounded following) as last_val</code>是不是冗余了<ul><li>默认不写 frame 时，<code>last_value</code> 的窗口是 <code>range between unbounded preceding and current row</code> → 只能看到“第一行 → 当前行”，最后一行根本还没出现，因此这句 frame 非冗余，是必需。</li><li>Frame?<br>frame = 窗口帧，就是“在分区内再圈一个小范围”的那一段定义</li></ul></li></ul><h2 id="聚合类（作为窗口函数使用）">聚合类（作为窗口函数使用）</h2><blockquote><p>把 GROUP BY 的聚合结果“摊平”到每一行，还能让它只累加当前行之前、或前后 N 行，而不是一次性全算完。</p></blockquote><ol><li>sum(expr) 计算分区内（或框架内）expr 的累计和。</li><li>avg(expr) 计算分区内（或框架内）expr 的累计平均值。</li><li>count(expr) 统计分区内（或框架内）非 NULL 行数。</li><li>min(expr) 取分区内（或框架内）到当前行的最小值。</li><li>max(expr) 取分区内（或框架内）到当前行的最大值。</li></ol><p><strong>示例：</strong><code>shop店铺，date日期，sales销售额</code></p><table><thead><tr><th>shop</th><th>date</th><th>sales</th><th>run_sum</th><th>run_avg</th><th>run_cnt</th><th>run_min</th><th>run_max</th></tr></thead><tbody><tr><td>A店</td><td>2025/9/1</td><td>100</td><td>100</td><td>100</td><td>1</td><td>100</td><td>100</td></tr><tr><td>A店</td><td>2025/9/2</td><td>200</td><td>300</td><td>150</td><td>2</td><td>100</td><td>200</td></tr><tr><td>A店</td><td>2025/9/3</td><td>300</td><td>600</td><td>200</td><td>3</td><td>100</td><td>300</td></tr><tr><td>A店</td><td>2025/9/4</td><td>400</td><td>1000</td><td>250</td><td>4</td><td>100</td><td>400</td></tr><tr><td>B店</td><td>2025/9/1</td><td>150</td><td>150</td><td>150</td><td>1</td><td>150</td><td>150</td></tr><tr><td>B店</td><td>2025/9/2</td><td>250</td><td>400</td><td>200</td><td>2</td><td>150</td><td>250</td></tr><tr><td>B店</td><td>2025/9/3</td><td>400</td><td>800</td><td>266.7</td><td>3</td><td>150</td><td>400</td></tr><tr><td>B店</td><td>2025/9/4</td><td>null</td><td>800</td><td>266.7</td><td>3</td><td>150</td><td>400</td></tr></tbody></table><p>把这一批结果一眼看懂：</p><ul><li>带 <code>ORDER BY</code> 的那 5 个（run_*）。<br>默认窗口 = 从分区第一行累加到当前行，所以值逐行变大（或保持），就是“店铺内到当天的累计和/均值/行数/最小/最大”。</li></ul><h2 id="统计类">统计类</h2><ol><li>percent_rank() 计算当前行的相对排名（百分比），取值 0～1。公式为：(rank - 1) / (总行数 - 1)</li><li>cume_dist() 计算当前行的累积分布（小于等于当前值的行数占总行数的比例）</li><li>stddev_pop(expr) 计算分区内总体标准差。 衡量数据相对于平均数的离散程度。适用于分析完整总体（而非样本）的波动性</li><li>stddev_samp(expr) 计算分区内样本标准差。 当数据是总体中的一个样本时，使用此函数可得到对总体标准差的无偏估计</li><li>var_pop(expr) 计算分区内总体方差。 标准差的平方，同样反映数据离散程度，但单位是原数据的平方</li><li>var_samp(expr) 计算分区内样本方差。 分母为n-1，是对总体方差的无偏估计。常用于抽样数据</li><li>covar_pop(y, x) 计算分区内两变量的总体协方差。 衡量两个变量的总体协同变化趋势。值为正表示正相关，为负表示负相关</li><li>covar_samp(y, x) 计算分区内两变量的样本协方差。 基于样本数据对总体协方差进行无偏估计</li><li>corr(y, x) 计算分区内两变量的皮尔逊相关系数。 衡量两个变量间的线性相关程度，返回值介于-1（完全负相关）和1（完全正相关）之间，结果已标准化，不受数据原始尺度影响</li><li>regr_*（系列） 用于执行<strong>线性回归分析</strong>。如 regr_slope(斜率)、regr_intercept(截距)、regr_r2(决定系数)等</li></ol><ul><li><strong>PERCENT_RANK()和CUME_DIST()这两个函数，销售额大的数值大还是小？日常使用，用降序还是升序？</strong><ul><li>降序（最常用，看头部好数据）：<ul><li>销售额越高 → 两个函数的值越小（最高销售额对应 PERCENT_RANK=0、CUME_DIST=1 / 总行数）</li><li>解读直觉：值越小 = 表现越好（比如 PERCENT_RANK=0.1 → 比 90% 的对象好；CUME_DIST=0.2 → 高价值数据占 20%）</li></ul></li><li>升序（仅用在看尾部差数据）：<ul><li>销售额越低 → 两个函数的值越小（最低销售额对应 PERCENT_RANK=0、CUME_DIST=1 / 总行数）</li><li>解读直觉：值越小 = 表现越差（比如 PERCENT_RANK=0.1 → 比 90% 的对象差；CUME_DIST=0.3 → 低价值数据占 30%）</li></ul></li></ul></li><li>把这一批结果一眼看懂：<ul><li>不带 <code>ORDER BY</code> 的那 7 个（stddev_pop 及以后）。<br>窗口 = 整个店铺，所以每行拿到的结果一模一样，相当于把 group by 的聚合值“摊平”到每一行。</li></ul></li><li>特殊写法<ul><li><code>COVAR_POP(sales, sales)</code> 退化成总体方差，结果与 <code>VAR_POP(sales)</code> 相同。</li><li><code>CORR(sales, sales)</code> 恒为 1（自己跟自己完全相关）。</li><li><code>REGR_SLOPE(sales, date_epoch)</code> 给出销售额随时间增长的日均斜率（销售额/天），正数表示上涨，负数表示下降。</li></ul></li></ul><h2 id="上面示例的代码">上面示例的代码</h2><h3 id="PostgreSQL语法">PostgreSQL语法</h3><p>原始数据：</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">(<span class="string">&#x27;A店&#x27;</span>,<span class="string">&#x27;2025-09-01&#x27;</span>,<span class="number">100</span>),</span><br><span class="line">(<span class="string">&#x27;A店&#x27;</span>,<span class="string">&#x27;2025-09-02&#x27;</span>,<span class="number">200</span>),</span><br><span class="line">(<span class="string">&#x27;A店&#x27;</span>,<span class="string">&#x27;2025-09-03&#x27;</span>,<span class="number">300</span>),</span><br><span class="line">(<span class="string">&#x27;B店&#x27;</span>,<span class="string">&#x27;2025-09-01&#x27;</span>,<span class="number">150</span>),</span><br><span class="line">(<span class="string">&#x27;B店&#x27;</span>,<span class="string">&#x27;2025-09-02&#x27;</span>,<span class="number">250</span>);</span><br></pre></td></tr></table></figure><p>加了同样销售额400的数据：</p><ol><li><p>排序类+取值类</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create table</span> t(shop text, dt <span class="type">date</span>, sales <span class="type">int</span>);</span><br><span class="line"><span class="keyword">insert into</span> t <span class="keyword">values</span></span><br><span class="line">(<span class="string">&#x27;A店&#x27;</span>,<span class="string">&#x27;2025-09-01&#x27;</span>,<span class="number">100</span>),</span><br><span class="line">(<span class="string">&#x27;A店&#x27;</span>,<span class="string">&#x27;2025-09-02&#x27;</span>,<span class="number">200</span>),</span><br><span class="line">(<span class="string">&#x27;A店&#x27;</span>,<span class="string">&#x27;2025-09-03&#x27;</span>,<span class="number">300</span>),</span><br><span class="line">(<span class="string">&#x27;A店&#x27;</span>,<span class="string">&#x27;2025-09-04&#x27;</span>,<span class="number">400</span>),</span><br><span class="line">(<span class="string">&#x27;B店&#x27;</span>,<span class="string">&#x27;2025-09-01&#x27;</span>,<span class="number">150</span>),</span><br><span class="line">(<span class="string">&#x27;B店&#x27;</span>,<span class="string">&#x27;2025-09-02&#x27;</span>,<span class="number">250</span>),</span><br><span class="line">(<span class="string">&#x27;B店&#x27;</span>,<span class="string">&#x27;2025-09-03&#x27;</span>,<span class="number">400</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span></span><br><span class="line">    shop,dt,sales</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 排序类 */</span></span><br><span class="line">    ,<span class="built_in">row_number</span>()         <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> shop <span class="keyword">order</span> <span class="keyword">by</span> dt) <span class="keyword">as</span> rn</span><br><span class="line">    ,<span class="built_in">rank</span>()               <span class="keyword">over</span>(<span class="keyword">order</span> <span class="keyword">by</span> sales <span class="keyword">DESC</span>) <span class="keyword">as</span> rnk</span><br><span class="line">    ,<span class="built_in">dense_rank</span>()         <span class="keyword">over</span>(<span class="keyword">order</span> <span class="keyword">by</span> sales <span class="keyword">DESC</span>) <span class="keyword">as</span> d_rnk</span><br><span class="line">    ,<span class="built_in">ntile</span>(<span class="number">3</span>)             <span class="keyword">over</span>(<span class="keyword">order</span> <span class="keyword">by</span> sales <span class="keyword">DESC</span>) <span class="keyword">as</span> ntile3</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 取值类 */</span></span><br><span class="line">    ,<span class="built_in">lag</span>(sales,<span class="number">1</span>)         <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> shop <span class="keyword">order</span> <span class="keyword">by</span> dt) <span class="keyword">as</span> lag1</span><br><span class="line">    ,<span class="built_in">lead</span>(sales,<span class="number">1</span>)        <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> shop <span class="keyword">order</span> <span class="keyword">by</span> dt) <span class="keyword">as</span> lead1</span><br><span class="line">    ,<span class="built_in">first_value</span>(sales)   <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> shop <span class="keyword">order</span> <span class="keyword">by</span> dt) <span class="keyword">as</span> first_val</span><br><span class="line">    ,<span class="built_in">last_value</span>(sales)    <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> shop <span class="keyword">order</span> <span class="keyword">by</span> dt <span class="keyword">rows</span> <span class="keyword">between</span> unbounded preceding <span class="keyword">and</span> unbounded following) <span class="keyword">as</span> last_val</span><br><span class="line">    ,<span class="built_in">nth_value</span>(sales,<span class="number">2</span>)   <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> shop <span class="keyword">order</span> <span class="keyword">by</span> dt <span class="keyword">rows</span> <span class="keyword">between</span> unbounded preceding <span class="keyword">and</span> unbounded following) <span class="keyword">as</span> nth2</span><br><span class="line">  </span><br><span class="line"><span class="keyword">from</span>(</span><br><span class="line">    <span class="keyword">select</span> <span class="operator">*</span>,<span class="built_in">extract</span>(epoch <span class="keyword">from</span> dt) <span class="keyword">as</span> date_epoch   <span class="comment">-- 把日期转数值，方便回归</span></span><br><span class="line">    <span class="keyword">from</span> t</span><br><span class="line">) <span class="keyword">as</span> x</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> shop, dt;</span><br></pre></td></tr></table></figure></li><li><p>聚合类</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create table</span> t(shop text, dt <span class="type">date</span>, sales <span class="type">int</span>);</span><br><span class="line"><span class="keyword">insert into</span> t <span class="keyword">values</span></span><br><span class="line">(<span class="string">&#x27;A店&#x27;</span>,<span class="string">&#x27;2025-09-01&#x27;</span>,<span class="number">100</span>),</span><br><span class="line">(<span class="string">&#x27;A店&#x27;</span>,<span class="string">&#x27;2025-09-02&#x27;</span>,<span class="number">200</span>),</span><br><span class="line">(<span class="string">&#x27;A店&#x27;</span>,<span class="string">&#x27;2025-09-03&#x27;</span>,<span class="number">300</span>),</span><br><span class="line">(<span class="string">&#x27;A店&#x27;</span>,<span class="string">&#x27;2025-09-04&#x27;</span>,<span class="number">400</span>),</span><br><span class="line">(<span class="string">&#x27;B店&#x27;</span>,<span class="string">&#x27;2025-09-01&#x27;</span>,<span class="number">150</span>),</span><br><span class="line">(<span class="string">&#x27;B店&#x27;</span>,<span class="string">&#x27;2025-09-02&#x27;</span>,<span class="number">250</span>),</span><br><span class="line">(<span class="string">&#x27;B店&#x27;</span>,<span class="string">&#x27;2025-09-03&#x27;</span>,<span class="number">400</span>),</span><br><span class="line">(<span class="string">&#x27;B店&#x27;</span>,<span class="string">&#x27;2025-09-04&#x27;</span>,<span class="keyword">null</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span></span><br><span class="line">    shop,dt,sales</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 聚合类 */</span></span><br><span class="line">    ,<span class="built_in">sum</span>(sales)           <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> shop <span class="keyword">order</span> <span class="keyword">by</span> dt) <span class="keyword">as</span> run_sum</span><br><span class="line">    ,round(<span class="built_in">avg</span>(sales)     <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> shop <span class="keyword">order</span> <span class="keyword">by</span> dt), <span class="number">1</span>) <span class="keyword">as</span> run_avg</span><br><span class="line">    ,<span class="built_in">count</span>(sales)         <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> shop <span class="keyword">order</span> <span class="keyword">by</span> dt) <span class="keyword">as</span> run_cnt</span><br><span class="line">    ,<span class="built_in">min</span>(sales)           <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> shop <span class="keyword">order</span> <span class="keyword">by</span> dt) <span class="keyword">as</span> run_min</span><br><span class="line">    ,<span class="built_in">max</span>(sales)           <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> shop <span class="keyword">order</span> <span class="keyword">by</span> dt) <span class="keyword">as</span> run_max</span><br><span class="line">  </span><br><span class="line"><span class="keyword">from</span>(</span><br><span class="line">    <span class="keyword">select</span> <span class="operator">*</span>,<span class="built_in">extract</span>(epoch <span class="keyword">from</span> dt) <span class="keyword">as</span> date_epoch   <span class="comment">-- 把日期转数值，方便回归</span></span><br><span class="line">    <span class="keyword">from</span> t</span><br><span class="line">) <span class="keyword">as</span> x</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> shop, dt;</span><br></pre></td></tr></table></figure></li><li><p>统计类</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create table</span> t(shop text, dt <span class="type">date</span>, sales <span class="type">int</span>);</span><br><span class="line"><span class="keyword">insert into</span> t <span class="keyword">values</span></span><br><span class="line">(<span class="string">&#x27;A店&#x27;</span>,<span class="string">&#x27;2025-09-01&#x27;</span>,<span class="number">100</span>),</span><br><span class="line">(<span class="string">&#x27;A店&#x27;</span>,<span class="string">&#x27;2025-09-02&#x27;</span>,<span class="number">200</span>),</span><br><span class="line">(<span class="string">&#x27;A店&#x27;</span>,<span class="string">&#x27;2025-09-03&#x27;</span>,<span class="number">300</span>),</span><br><span class="line">(<span class="string">&#x27;A店&#x27;</span>,<span class="string">&#x27;2025-09-04&#x27;</span>,<span class="number">400</span>),</span><br><span class="line">(<span class="string">&#x27;B店&#x27;</span>,<span class="string">&#x27;2025-09-01&#x27;</span>,<span class="number">150</span>),</span><br><span class="line">(<span class="string">&#x27;B店&#x27;</span>,<span class="string">&#x27;2025-09-02&#x27;</span>,<span class="number">250</span>),</span><br><span class="line">(<span class="string">&#x27;B店&#x27;</span>,<span class="string">&#x27;2025-09-03&#x27;</span>,<span class="number">400</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span></span><br><span class="line">    shop,dt,sales</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 统计类 */</span></span><br><span class="line">    ,<span class="built_in">percent_rank</span>()       <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> shop <span class="keyword">order</span> <span class="keyword">by</span> sales <span class="keyword">DESC</span>) <span class="keyword">as</span> pct_rnk</span><br><span class="line">    ,<span class="built_in">cume_dist</span>()         <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> shop <span class="keyword">order</span> <span class="keyword">by</span> sales) <span class="keyword">as</span> cume_dist</span><br><span class="line">    ,<span class="built_in">stddev_pop</span>(sales)   <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> shop) <span class="keyword">as</span> stddev_pop</span><br><span class="line">    ,<span class="built_in">stddev_samp</span>(sales)  <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> shop) <span class="keyword">as</span> stddev_samp</span><br><span class="line">    ,<span class="built_in">var_pop</span>(sales)      <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> shop) <span class="keyword">as</span> var_pop</span><br><span class="line">    ,<span class="built_in">var_samp</span>(sales)     <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> shop) <span class="keyword">as</span> var_samp</span><br><span class="line">    ,<span class="built_in">corr</span>(sales, date_epoch) <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> shop) <span class="keyword">as</span> corr_coef</span><br><span class="line">    ,<span class="built_in">covar_pop</span>(sales, date_epoch) <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> shop) <span class="keyword">as</span> covar_pop</span><br><span class="line">    ,<span class="built_in">covar_samp</span>(sales, date_epoch) <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> shop) <span class="keyword">as</span> covar_samp</span><br><span class="line">    ,<span class="built_in">regr_slope</span>(sales, date_epoch) <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> shop) <span class="keyword">as</span> regr_slope</span><br><span class="line">    ,<span class="built_in">regr_intercept</span>(sales, date_epoch) <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> shop) <span class="keyword">as</span> regr_intercept</span><br><span class="line">    ,<span class="built_in">regr_r2</span>(sales, date_epoch) <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> shop) <span class="keyword">as</span> regr_r2</span><br><span class="line">  </span><br><span class="line"><span class="keyword">from</span>(</span><br><span class="line">    <span class="keyword">select</span> <span class="operator">*</span>,<span class="built_in">extract</span>(epoch <span class="keyword">from</span> dt) <span class="keyword">as</span> date_epoch   <span class="comment">-- 把日期转数值，方便回归</span></span><br><span class="line">    <span class="keyword">from</span> t</span><br><span class="line">) <span class="keyword">as</span> x</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> shop, dt;</span><br></pre></td></tr></table></figure></li></ol><h3 id="trino语法">trino语法</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> if <span class="keyword">exists</span> t;</span><br><span class="line"><span class="keyword">create table</span> t(shop <span class="type">varchar</span>, dt <span class="type">varchar</span>, sales <span class="type">integer</span>);</span><br><span class="line"><span class="keyword">insert into</span> t <span class="keyword">values</span></span><br><span class="line">(<span class="string">&#x27;A店&#x27;</span>,<span class="string">&#x27;2025-09-01&#x27;</span>,<span class="number">100</span>),</span><br><span class="line">(<span class="string">&#x27;A店&#x27;</span>,<span class="string">&#x27;2025-09-02&#x27;</span>,<span class="number">200</span>),</span><br><span class="line">(<span class="string">&#x27;A店&#x27;</span>,<span class="string">&#x27;2025-09-03&#x27;</span>,<span class="number">300</span>),</span><br><span class="line">(<span class="string">&#x27;A店&#x27;</span>,<span class="string">&#x27;2025-09-04&#x27;</span>,<span class="number">400</span>),</span><br><span class="line">(<span class="string">&#x27;B店&#x27;</span>,<span class="string">&#x27;2025-09-01&#x27;</span>,<span class="number">150</span>),</span><br><span class="line">(<span class="string">&#x27;B店&#x27;</span>,<span class="string">&#x27;2025-09-02&#x27;</span>,<span class="number">250</span>),</span><br><span class="line">(<span class="string">&#x27;B店&#x27;</span>,<span class="string">&#x27;2025-09-03&#x27;</span>,<span class="number">400</span>),</span><br><span class="line">(<span class="string">&#x27;B店&#x27;</span>,<span class="string">&#x27;2025-09-04&#x27;</span>,<span class="keyword">null</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span></span><br><span class="line">    shop,dt,sales</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 聚合类 */</span></span><br><span class="line">    ,<span class="built_in">sum</span>(sales)           <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> shop <span class="keyword">order</span> <span class="keyword">by</span> dt) <span class="keyword">as</span> run_sum</span><br><span class="line">    ,round(<span class="built_in">avg</span>(sales)     <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> shop <span class="keyword">order</span> <span class="keyword">by</span> dt), <span class="number">1</span>) <span class="keyword">as</span> run_avg</span><br><span class="line">    ,<span class="built_in">count</span>(sales)         <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> shop <span class="keyword">order</span> <span class="keyword">by</span> dt) <span class="keyword">as</span> run_cnt</span><br><span class="line">    ,<span class="built_in">min</span>(sales)           <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> shop <span class="keyword">order</span> <span class="keyword">by</span> dt) <span class="keyword">as</span> run_min</span><br><span class="line">    ,<span class="built_in">max</span>(sales)           <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> shop <span class="keyword">order</span> <span class="keyword">by</span> dt) <span class="keyword">as</span> run_max</span><br><span class="line">  </span><br><span class="line"><span class="keyword">from</span>(</span><br><span class="line">    <span class="keyword">select</span> <span class="operator">*</span>,to_unixtime(<span class="built_in">cast</span>(dt <span class="keyword">as</span> <span class="type">timestamp</span> <span class="keyword">with</span> <span class="type">time</span> zone)) <span class="keyword">as</span> date_epoch  <span class="comment">-- 把日期转数值，方便回归</span></span><br><span class="line">    <span class="keyword">from</span> t</span><br><span class="line">) <span class="keyword">as</span> x</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> shop, dt;</span><br></pre></td></tr></table></figure><h1>最常用模板</h1><ol><li><p>累计值</p><ol><li>sum()</li></ol></li><li><p>分组累计（按店铺）</p><ol><li>sum()、partition by</li></ol></li><li><p>移动平均（近2行）</p><ol><li>对每个店，算最近两天平均销售额</li><li>avg()、partition by、row 1 preceding</li><li>历史平均销售额rows between unbounded preceding and 1 preceding</li></ol></li><li><p>环比（上一日）</p><ol><li>lag()先取出上一日数据</li><li>两个字段名的英文来源如下：<ol><li>prev_sales prev 是 <em>previous</em>（之前的）的缩写，sales 即“销售额”，合起来表示“上一条销售额”。</li><li>delta 源自希腊字母 Δ（delta），在数学/编程里习惯用它表示“差值、变化量”，这里即“销售额的变化量”。</li></ol></li></ol></li><li><p>排名/去重（每组只留第一行/取最新的记录/取TOP-N）</p><ol><li>row_number()、partition by、DESC</li></ol></li><li><p>一次性定义多个窗口（省代码）</p><ol><li>over w</li><li>window w as (partition by shop order by dt)</li></ol></li><li><p>范围窗口（近 1 个月）</p><ol><li><p>range between interval ‘1 month’ preceding and current row</p></li><li><p>INTERVAL '1 month’怎么算的</p><ol><li><p>加减一个月先找“同号日”，没有就拉回到目标月最后一天；范围窗口以此算出 闭区间 边界。</p></li><li><pre><code class="language-SQL">SELECT date '2025-01-30' + INTERVAL '1 month';  -- 2025-02-28（2025 非闰年）SELECT date '2024-01-30' + INTERVAL '1 month';  -- 2024-02-29（闰年）SELECT date '2025-03-31' - INTERVAL '1 month';  -- 2025-02-28date/timestamp时间戳同理，时分秒保留SELECT timestamp '2025-01-30 23:59:59' + INTERVAL '1 month';-- 2025-02-28 23:59:59</code></pre></li></ol></li></ol></li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> SQL </tag>
            
            <tag> Postgres </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>快速精通SQL</title>
      <link href="/2025/10/20/%E5%BF%AB%E9%80%9F%E7%B2%BE%E9%80%9ASQL/"/>
      <url>/2025/10/20/%E5%BF%AB%E9%80%9F%E7%B2%BE%E9%80%9ASQL/</url>
      
        <content type="html"><![CDATA[<h1>重点知识</h1><h2 id="SQL执行顺序：">SQL执行顺序：</h2><p>1.<code>FROM</code> &amp; <code>JOIN</code> → 2. <code>WHERE</code> → 3. <code>GROUP BY</code> → 聚合函数 → 4. <code>HAVING</code> → 窗口函数 → 5. <code>SELECT</code> → 6. <code>ORDER BY</code> → 7. <code>LIMIT</code></p><ul><li><strong>FROM 和 JOIN</strong>：确定数据源</li><li><strong>WHERE</strong>：行级过滤</li><li><strong>GROUP BY</strong>：分组</li><li><strong>HAVING</strong>：组级过滤</li><li><strong>SELECT</strong>：选择列、计算窗口函数</li><li><strong>DISTINCT</strong>：去除重复的行</li><li><strong>ORDER BY</strong>：对结果进行排序</li><li><strong>LIMIT/OFFSET/TOP</strong>：限制返回的行数</li></ul><h1>MySQL速记</h1><ul><li>mysql基础语法，要记忆的<ul><li>需要提供一个结构清晰、重点突出、便于记忆的MySQL基础语法总结。内容应该：<ol><li>覆盖最常用的操作（CRUD）</li><li>按照逻辑分类组织</li><li>强调必须记忆的关键点和语法模式</li><li>提供简洁的示例</li><li>标注易错点和注意事项</li><li>适合快速回顾和记忆</li></ol></li></ul></li></ul><h2 id="查询（DQL）">查询（DQL）</h2><h3 id="where条件查询">where条件查询</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">WHERE</span> 字段 <span class="operator">=</span> <span class="operator">/</span> <span class="operator">!=</span> <span class="operator">/</span> <span class="operator">&gt;</span> <span class="operator">/</span> <span class="operator">&lt;</span> <span class="operator">/</span> <span class="operator">&gt;=</span> <span class="operator">/</span> <span class="operator">&lt;=</span> 值</span><br><span class="line"><span class="keyword">WHERE</span> 字段 <span class="keyword">LIKE</span> <span class="string">&#x27;%关键字%&#x27;</span>      <span class="comment">-- 模糊查询</span></span><br><span class="line"><span class="keyword">WHERE</span> 字段 <span class="keyword">IN</span> (值<span class="number">1</span>, 值<span class="number">2</span>)</span><br><span class="line"><span class="keyword">WHERE</span> 字段 <span class="keyword">BETWEEN</span> 值<span class="number">1</span> <span class="keyword">AND</span> 值<span class="number">2</span></span><br><span class="line"><span class="keyword">WHERE</span> 字段 <span class="keyword">IS</span> <span class="keyword">NULL</span>              <span class="comment">-- 不是 =NULL</span></span><br></pre></td></tr></table></figure><h3 id="聚合函数">聚合函数</h3><blockquote><p>（5个必须记住）</p></blockquote><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="built_in">COUNT</span>(<span class="operator">*</span>)    <span class="comment">-- 统计行数（推荐*）</span></span><br><span class="line"><span class="built_in">SUM</span>(字段)    <span class="comment">-- 求和</span></span><br><span class="line"><span class="built_in">AVG</span>(字段)    <span class="comment">-- 平均</span></span><br><span class="line"><span class="built_in">MAX</span>(字段)    <span class="comment">-- 最大</span></span><br><span class="line"><span class="built_in">MIN</span>(字段)    <span class="comment">-- 最小</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">count</span>(<span class="keyword">distinct</span> 字段)  <span class="comment">-- 常用</span></span><br></pre></td></tr></table></figure><h3 id="连接类型">连接类型</h3><blockquote><p>（4种必须掌握）</p></blockquote><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 内连接（最常用）</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> A <span class="keyword">INNER</span> <span class="keyword">JOIN</span> B <span class="keyword">ON</span> A.id <span class="operator">=</span> B.a_id;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 左连接</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> A <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> B <span class="keyword">ON</span> A.id <span class="operator">=</span> B.a_id;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 右连接</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> A <span class="keyword">RIGHT</span> <span class="keyword">JOIN</span> B <span class="keyword">ON</span> A.id <span class="operator">=</span> B.a_id;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 全连接（MySQL不支持，用UNION替代）</span></span><br></pre></td></tr></table></figure><h3 id="子查询">子查询</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> salary <span class="operator">&gt;</span> (<span class="keyword">SELECT</span> <span class="built_in">AVG</span>(salary) <span class="keyword">FROM</span> emp);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- IN子查询</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> dept_id <span class="keyword">IN</span> (<span class="keyword">SELECT</span> id <span class="keyword">FROM</span> dept <span class="keyword">WHERE</span> name<span class="operator">=</span><span class="string">&#x27;研发&#x27;</span>);</span><br></pre></td></tr></table></figure><h3 id="字符串函数">字符串函数</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">concat(str1, str2)          <span class="comment">-- 拼接</span></span><br><span class="line"><span class="built_in">substring</span>(str, <span class="number">1</span>, <span class="number">5</span>)        <span class="comment">-- 截取</span></span><br><span class="line">length(str)                 <span class="comment">-- 长度</span></span><br><span class="line">replace(str, <span class="string">&#x27;旧&#x27;</span>, <span class="string">&#x27;新&#x27;</span>)     <span class="comment">-- 替换</span></span><br></pre></td></tr></table></figure><h3 id="日期函数">日期函数</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">NOW()                       <span class="comment">-- 当前时间</span></span><br><span class="line">date_add(NOW(), <span class="type">INTERVAL</span> <span class="number">1</span> <span class="keyword">DAY</span>)  <span class="comment">-- 加减</span></span><br><span class="line">datediff(date1, date2)      <span class="comment">-- 天数差</span></span><br><span class="line">date_format(NOW(), <span class="string">&#x27;%Y-%m-%d&#x27;</span>)   <span class="comment">-- 格式化</span></span><br></pre></td></tr></table></figure><h3 id="数值函数">数值函数</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">round(<span class="number">3.1415</span>, <span class="number">2</span>)            <span class="comment">-- 四舍五入</span></span><br><span class="line"><span class="built_in">ceil</span>(<span class="number">3.1</span>) <span class="operator">/</span> <span class="built_in">floor</span>(<span class="number">3.9</span>)      <span class="comment">-- 向上/下取整</span></span><br><span class="line"><span class="built_in">abs</span>(<span class="number">-10</span>)                    <span class="comment">-- 绝对值</span></span><br></pre></td></tr></table></figure><h3 id="索引">索引</h3><blockquote><p>（性能优化）</p></blockquote><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> index idx_name <span class="keyword">ON</span> 表名(字段);</span><br><span class="line"><span class="keyword">show</span> index <span class="keyword">from</span> 表名;        <span class="comment">-- 查看索引</span></span><br><span class="line">explain <span class="keyword">select</span> ...;          <span class="comment">-- 分析查询（神器）</span></span><br></pre></td></tr></table></figure><p><strong>记忆口诀</strong>：<code>WHERE/JOIN/ORDER BY 常用字段加索引</code></p><h3 id="规则">规则</h3><table><thead><tr><th>规则</th><th>说明</th></tr></thead><tbody><tr><td>SQL不区分大小写</td><td>但关键字建议大写</td></tr><tr><td>字符串用单引号</td><td><code>'文本'</code> 不是双引号</td></tr><tr><td>注释用 <code>-- </code> 或 <code>/**/</code></td><td><code>-- 单行注释</code></td></tr><tr><td>MySQL函数名不区分大小写</td><td>但统一小写更规范</td></tr><tr><td><code>COUNT(*)&gt;</code>COUNT(字段)</td><td><code>*</code>统计所有行，字段统计非NULL</td></tr><tr><td><code>GROUP BY</code> 后SELECT字段</td><td>要么是分组字段，要么是聚合函数</td></tr></tbody></table><h2 id="基础语法">基础语法</h2><ol><li>查询：<ul><li>Select；Where；Distinct；And；Or</li></ul></li><li>建表、删表、分区：<ul><li>Create table；Drop table；Insert into；Partition by</li></ul></li><li>表连接：<ul><li>常用四类join操作：</li><li>[inner] join；Left join；Right join；Full join</li></ul></li><li>函数：<ul><li>聚合函数；日期函数；数字类函数；字符类函数</li></ul></li><li>嵌套、分组、排序：<ul><li>双重where；Group by；Order by</li></ul></li><li>SQL三范式&amp;注意事项：<ol><li>三范式<ol><li>保证每列的原子性</li><li>每列均与主键相关</li><li>每列均与主键直接相关</li></ol></li><li>注意事项<ol><li>小表拼大表</li><li>先过滤再拼表</li><li>避免过度嵌套</li></ol></li></ol></li></ol><h3 id="查询">查询</h3><p>Select 列名称 from 表名称 where 列 运算符 表名称</p><p>运算符：=, &gt;, &lt;, &gt;=, &lt;=, <strong>&lt;&gt;, !=</strong>, between, like, <strong>in, %, is</strong> <strong>null, is not null</strong></p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">Select</span> <span class="operator">*</span> <span class="keyword">from</span> edw_cdm.dim_trx_loan <span class="keyword">where</span> dt <span class="keyword">in</span> (‘<span class="number">2021</span><span class="number">-02</span><span class="number">-28</span>’,’<span class="number">2021</span><span class="number">-03</span><span class="number">-31</span>’); <span class="comment">--取月末数据</span></span><br><span class="line"><span class="comment">-- dt&lt;=&#x27;2025-09-30&#x27; and cast(dt as date)=last_day_of_month(cast(dt as date))</span></span><br></pre></td></tr></table></figure><ol><li><p>比较运算符（直接比）</p><ul><li><p>适用：数值、日期、字符串的等于 / 不等于 / 大小比较。</p></li><li><p>关键符号：<code>=</code>（等于）、<code>&gt;</code>/<code>&lt;</code>（大于 / 小于）、<code>&gt;=</code>/<code>&lt;=</code>（大于等于 / 小于等于）、<code>&lt;&gt;</code>/<code>!=</code>（不等于）。</p></li></ul></li><li><p>范围运算符（圈范围）</p><ul><li><p><code>between ... and</code>：取连续范围（含边界），如 “score between 80 and 90”。</p></li><li><p><code>in (值1,值2)</code>：取离散值列表，如 “address in (’ 北京 ‘,’ 上海 ')”；加<code>no</code>t则排除。</p></li></ul></li><li><p>模糊匹配（查部分）</p><ul><li><p>仅用于字符串，需搭配<code>%</code>（任意字符）或<code>_</code>（单个字符）。</p></li><li><p>示例：<code>name like '张%'</code>（姓张）、<code>name like '%晓%'</code>（含 “晓” 字）。</p></li></ul></li><li><p>空值判断（判空值）</p><ul><li>不能用<code>=</code>，必须用<code>is null</code>（为空）或<code>is not null</code>（不为空），如 “address is null”。</li></ul></li><li><p>组合逻辑（多条件）</p><ul><li>用<code>and</code>（同时满足）或<code>or</code>（满足一个）组合条件，如 “age&gt;18 AND score&gt;80”。</li></ul></li></ol><h3 id="建表、删表、分区">建表、删表、分区</h3><p>create table 表名称 (列名称1 数据类型, 列名称2 数据类型, 列名称3 数据类型…)</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create table</span> sql_grammar_cust_base</span><br><span class="line">    (cust_id  string  comment  ‘客户号’，<span class="comment">--comment 为添加注释</span></span><br><span class="line">     fst_crd_cls_dt    string  comment  ‘首次授信日期’，</span><br><span class="line">     fst_crd_base_lvl_busiclass  string  comment ‘首次授信业务基础维度’) </span><br><span class="line">partitioned <span class="keyword">by</span> (dt  string  comment ’日期’)；</span><br></pre></td></tr></table></figure><p><code>partitioned by</code><strong>注：分区可以存储更多的数据，并优化查询效率，写代码时注意限制分区字段</strong></p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> if <span class="keyword">exists</span> aaa_tmp;</span><br><span class="line"><span class="keyword">create table</span> aaa_tmp <span class="keyword">as</span></span><br></pre></td></tr></table></figure><h4 id="分区和非分区的区别">分区和非分区的区别</h4><p>逻辑上没有区别，主要区别在于<strong>物理存储</strong>上， hive表的数据以文件形式存储，分区表按照分区列的值分别存储，<strong>一个分区对应一个目录</strong>，非分区表只有一个目录。</p><p>分区的目的是为了提高查询效率和回溯历史状态，具体表现为：</p><ul><li><strong>提高查询效率</strong>。如果没有分区，每次全表扫描，对于数据量大的表查询效率低下，分区表通过限制分区，只需扫描部分分区数据，大大提高查询效率。</li><li><strong>回溯历史状态</strong>。Hive分区表大部分通过增量+全量的方式更新，如果当天的数据出错，可以通过前一天的分区快速修复；通过记录月末快照分区，可以回溯历史状态，可用于分析和定位问题。</li></ul><blockquote><p>100个球，10种颜色，各有10个，编号1-10</p><ul><li>非分区表：所有球装在一个大袋子里</li><li>分区表：每种颜色的球分别装在对应颜色的小袋子里，然后再装到大袋子里</li></ul><p>需求：找出白色3号球</p><ul><li>非分区表：全表扫描，从100个球中找出白色3号球</li><li>分区表：局部扫描，从白</li><li>色小袋子里找，从10个球中找出白色3号球</li></ul></blockquote><h3 id="表连接">表连接</h3><p><img src="./../%E5%BF%AB%E9%80%9F%E7%B2%BE%E9%80%9ASQL/70a34cbd-ad2b-4eae-8a7b-31d8da835f79.png" alt="SQL JOINS"></p><p>✅ <strong>总结记忆口诀</strong>：</p><table><thead><tr><th>join 类型</th><th>返回结果</th></tr></thead><tbody><tr><td>inner join</td><td>两表交集</td></tr><tr><td>left join</td><td>左表全量 + 右表匹配</td></tr><tr><td>right join</td><td>右表全量 + 左表匹配</td></tr><tr><td>full outer join</td><td>两表并集（含所有记录）</td></tr><tr><td>left/right join + where null</td><td>仅返回左/右表独有的记录</td></tr><tr><td>full outer join + where null</td><td>仅返回两表中不匹配的记录（对称差）</td></tr></tbody></table><p>📌 <strong>提示</strong>：</p><ul><li>实际使用中，<code>inner join</code> 最常用。</li><li><code>left join</code> 常用于“主表 + 关联表”的场景（如订单 + 用户信息）。</li><li><code>left join ... where b.key is null</code>（左外连接排除内连接）也常用。</li><li><code>full outer join</code> 在某些分析场景有用，但性能开销较大。</li><li>使用 <code>where ... is null</code> 是筛选“无匹配记录”的关键技巧。</li></ul><p><strong>图中涉及的 JOIN 类型：</strong></p><ol><li><p><strong>left join（左连接）</strong></p><ul><li><p><strong>图示</strong>：红色区域包括 <code>A</code> 的全部 + <code>A ∩ B</code></p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">&lt;</span>select_list<span class="operator">&gt;</span> <span class="keyword">from</span> <span class="keyword">table</span> a <span class="keyword">left</span> <span class="keyword">join</span> <span class="keyword">table</span> b <span class="keyword">on</span> a.key <span class="operator">=</span> b.key</span><br></pre></td></tr></table></figure></li><li><p><strong>含义</strong>：返回左表（tablea）的所有记录，以及右表（tableb）中匹配的记录。如果右表无匹配，则对应字段为 <code>null</code>。</p></li></ul></li><li><p><strong>inner join（内连接）</strong></p><ul><li><p><strong>图示</strong>：仅红色区域为 <code>A ∩ B</code>（交集）</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">&lt;</span>select_list<span class="operator">&gt;</span> <span class="keyword">from</span> <span class="keyword">table</span> a <span class="keyword">inner</span> <span class="keyword">join</span> <span class="keyword">table</span> b <span class="keyword">on</span> a.key <span class="operator">=</span> b.key</span><br></pre></td></tr></table></figure></li><li><p><strong>含义</strong>：只返回两个表中<strong>键值匹配</strong>的记录，即交集部分。</p></li></ul></li><li><p><strong>right join（右连接）</strong></p><ul><li><p><strong>图示</strong>：红色区域包括 <code>B</code> 的全部 + <code>A ∩ B</code></p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">&lt;</span>select_list<span class="operator">&gt;</span> <span class="keyword">from</span> <span class="keyword">table</span> a <span class="keyword">right</span> <span class="keyword">join</span> <span class="keyword">table</span> b <span class="keyword">on</span> a.key <span class="operator">=</span> b.key</span><br></pre></td></tr></table></figure></li><li><p><strong>含义</strong>：返回右表（tableb）的所有记录，以及左表（tablea）中匹配的记录。如果左表无匹配，则对应字段为 <code>null</code>。</p></li></ul></li><li><p><strong>left join … where b.key is</strong> <strong>null（左外连接排除内连接）</strong></p><ul><li><p><strong>图示</strong>：红色区域仅为 <code>A - (A ∩ B)</code>（左表独有部分）</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">&lt;</span>select_list<span class="operator">&gt;</span> <span class="keyword">from</span> <span class="keyword">table</span> a <span class="keyword">left</span> <span class="keyword">join</span> <span class="keyword">table</span> b <span class="keyword">on</span> a.key <span class="operator">=</span> b.key</span><br><span class="line"><span class="keyword">where</span> b.key <span class="keyword">is</span> <span class="keyword">null</span></span><br></pre></td></tr></table></figure></li><li><p><strong>含义</strong>：返回左表中<strong>没有在右表中找到匹配</strong>的记录，常用于查找“孤儿记录”。</p></li></ul></li><li><p><strong>full outer join（全外连接）</strong></p><ul><li><p><strong>图示</strong>：红色区域为 <code>A ∪ B</code>（并集），即两个表的所有记录</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">&lt;</span>select_list<span class="operator">&gt;</span> <span class="keyword">from</span> <span class="keyword">table</span> a <span class="keyword">full</span> <span class="keyword">outer</span> <span class="keyword">join</span> <span class="keyword">table</span> b <span class="keyword">on</span> a.key <span class="operator">=</span> b.key</span><br></pre></td></tr></table></figure></li><li><p><strong>含义</strong>：返回两个表中的所有记录。</p></li><li><p>若某一侧无匹配，则该侧对应字段为 <code>null</code>。</p></li></ul></li><li><p><strong>full outer join … where a.key is</strong> <strong>null</strong> <strong>or b.key is null（全外连接排除内连接）</strong></p><ul><li><p><strong>图示</strong>：红色区域为 <code>(A - B) ∪ (B - A)</code>（对称差集）</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">&lt;</span>select_list<span class="operator">&gt;</span> <span class="keyword">from</span> <span class="keyword">table</span> a <span class="keyword">full</span> <span class="keyword">outer</span> <span class="keyword">join</span> <span class="keyword">table</span> b <span class="keyword">on</span> a.key <span class="operator">=</span> b.key</span><br><span class="line"><span class="keyword">where</span> a.key <span class="keyword">is</span> <span class="keyword">null</span> <span class="keyword">or</span> b.key <span class="keyword">is</span> <span class="keyword">null</span></span><br></pre></td></tr></table></figure></li><li><p><strong>含义</strong>：返回<strong>仅在一个表中存在</strong>的记录，即两个表中不匹配的部分。</p></li></ul></li></ol><h3 id="函数">函数</h3><table><thead><tr><th>聚合函数</th><th>日期函数</th></tr></thead><tbody><tr><td>求和<code>sum()</code> <br />求均值<code>avg()</code> <br />计数<code>count()</code> <br />求最大值<code>max()</code> <br />求最小值<code>min()</code> <br /><strong>注意：null值不包含在计算中</strong> <br />例：人均VS有贷人均是否响应</td><td>返回日期加上指定天数的结果：<code>date_add(date, n)</code> <br />返回日期加上指定月的结果：<code>add_months(date, n)</code> <br />返回两个日期的差：<code>datediff(date1, date2)</code>(备注date1-date2) <br />返回两个日期的月份差：<code>months_between(date1, date2)</code> <br />返回这个月末的日期：<strong><code>last_day(date)</code></strong> <br />例：分区表限制<code>dt=last_day('2025-04-19')</code></td></tr></tbody></table><table><thead><tr><th>数字类函数</th><th>字符类函数</th></tr></thead><tbody><tr><td>求绝对值<code>abs()</code><br />向上取整<code>ceil(n)</code><br />向下取整<code>floor(n)</code><br />四舍五入<code>round(n, len)</code><br />求指数值<code>exp(n)</code><br />求对数值<code>log(n)</code><br />求正弦值<code>sin(n)</code><br />求余弦值<code>cos(n)</code></td><td>求长度<code>length(n)</code><br /><strong>字符串截取<code>substr(s, start, [length])&lt;br /&gt;</code></strong><br />字符串拼接<code>concat(s1, s2)&lt;br /&gt;</code><br />字符串替换<code>replace(S1, s1, S2)&lt;br /&gt;</code><br />切割函数<code>split_part(s,delimiter,field)</code><br />split_part(字段，分隔符，<strong>子串位置（从1开始计数）</strong>)</td></tr></tbody></table><h3 id="嵌套、分组、排序">嵌套、分组、排序</h3><ol><li><p>嵌套</p><p>select * from sql_grammar_cust_base where cust_id in  (select cust_id from sql_grammar_lon_base);  --不加t</p><p>Select * from (select cust_id from sql_grammar_lon_base) t;  --加t</p><ul><li>在 PB 级场景下，建议直接用<code>JOIN</code>替代<code>IN</code>子查询，效率更稳定</li><li>在 SQL 中，<code>JOIN</code>（默认指<code>INNER JOIN</code>，内连接）</li></ul><p>详细解析：</p><ul><li>第一个查询（<code>IN</code>子查询，不加别名）</li></ul><p>特点：</p><p><code>IN</code>子查询不需要别名，因为它作为值列表直接参与条件判断。</p><p>数据库会自动处理子查询结果与外部条件的关联。</p><ul><li>第二个查询（派生表子查询，必须加别名）</li></ul><p>特点：</p><ul><li>该临时表必须指定别名（这里是 <code>t</code>），否则会报语法错误。</li><li>派生表（Derived Table）是完整的临时结果集，必须通过别名引用。</li><li>常用于复杂查询中的中间步骤。</li></ul></li><li><p>分组</p><p>group by</p><p>与聚合函数搭配使用</p><p>聚合函数（如 <code>SUM</code>, <code>AVG</code>, <code>COUNT</code>, <code>MAX</code>, <code>MIN</code>）</p></li><li><p>排序</p></li></ol><p>Select 列 from 表 order by 列 asc/desc</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 按客群随机抽样（招行1w人，生活号2w人，共3w人</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> </span><br><span class="line"><span class="keyword">from</span> (</span><br><span class="line"><span class="keyword">select</span> </span><br><span class="line">cust_id</span><br><span class="line">,lvl1_bus_cls_nm</span><br><span class="line">,<span class="built_in">row_number</span>() <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> lvl1_bus_cls_nm <span class="keyword">order</span> <span class="keyword">by</span> rand()) rn  <span class="comment">-- 按客群分组，随机排序编号</span></span><br><span class="line"><span class="keyword">from</span> sql_grammar_cust_base_lon</span><br><span class="line"> ) t </span><br><span class="line"><span class="keyword">where</span> </span><br><span class="line">(lvl1_bus_cls_nm <span class="operator">=</span> <span class="string">&#x27;招行&#x27;</span> <span class="keyword">and</span> rn <span class="operator">&lt;=</span> <span class="number">10000</span>) <span class="keyword">or</span>      <span class="comment">-- 招行客群取前1w人</span></span><br><span class="line">(lvl1_bus_cls_nm <span class="operator">=</span> <span class="string">&#x27;好期贷生活号&#x27;</span> <span class="keyword">and</span> rn <span class="operator">&lt;=</span> <span class="number">20000</span>);  <span class="comment">-- 生活号客群取前2w人</span></span><br></pre></td></tr></table></figure><ul><li>随机函数差异：<ul><li>MySQL：<code>order by rand()</code></li><li>PostgreSQL：<code>order by random()</code></li><li>SQL Server：<code>order by newid()</code>（生成随机GUID排序）</li><li>Oracle：<code>order by dbms_random.value()</code></li></ul></li><li>潜在问题：<ul><li><code>ORDER BY RAND()</code> 在大数据量时性能极差（需全表扫描并排序）。</li></ul></li><li>性能优化：<ul><li><code>rand()</code> 在大数据量表中效率低（需全表扫描并生成随机数），可先缩小范围再抽样</li></ul></li></ul><table><thead><tr><th>SQL功能</th><th>核心函数/语法</th><th>典型场景</th></tr></thead><tbody><tr><td>按条件随机抽样</td><td>Order by rand() + row_number() + where 筛选</td><td>客群分层抽样、AB测试样本选取</td></tr></tbody></table><h2 id="三范式">三范式</h2><div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">确保每列的原子式</button><button type="button" class="tab">确保表中的每列与主键相关</button><button type="button" class="tab">确保表中的每列与主键直接相关</button></div><div class="tab-contents"><div class="tab-item-content active"><p>每列/每个属性都是不可再分的原子单元/数据单元</p><p>比如：地址这个字段应该被拆分成省份、城市、街道…</p></div><div class="tab-item-content"><p>在一个数据库表中，一个表中只能保存一种数据</p></div><div class="tab-item-content"><p>在一个数据表中，每列应该与主键直接相关，而不是间接相关</p></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><p>注：hive使用的是一种类SQL语言，没有所谓的主键，也不需要满足的标准的SQL三范式，但是在语法上与SQL基本一致</p><h2 id="注意事项">注意事项</h2><table><thead><tr><th><strong>小表拼大表</strong></th><th>我们常用的Left join是从右表找左索引的，左表小的话搜索次数少，效率高</th></tr></thead><tbody><tr><td><strong>先过滤再拼表</strong></td><td>拼表之前先加where限制，筛选出符合条件的子表，减少每个阶段的数据量</td></tr><tr><td><strong>避免过多嵌套</strong></td><td>避免一段代码嵌套太多逻辑，多使用中间表来完成</td></tr></tbody></table><div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">小表拼大表</button><button type="button" class="tab">先过滤再拼表</button><button type="button" class="tab">避免过多嵌套</button></div><div class="tab-contents"><div class="tab-item-content active"><p><strong>我们常用的Left join是从右表找左索引的，左表小的话搜索次数少，效率高</strong></p></div><div class="tab-item-content"><p><strong>拼表之前先加where限制，筛选出符合条件的子表，减少每个阶段的数据量</strong></p></div><div class="tab-item-content"><p><strong>避免一段代码嵌套太多逻辑，多使用中间表来完成</strong></p></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><h2 id="SQL的规范与优化">SQL的规范与优化</h2><h3 id="常见的SQL不规范类型">常见的SQL不规范类型</h3><ol><li><p>全量分区表没有加分区限制</p><ul><li><code>where</code>限制dt，避免不必要的全分区扫描，养成限制分区的好习惯；避免无意义字段的返回，可以有效提升查询效率。</li><li><code>udf.getmaxpar</code> 通常是一个自定义函数（UDF，User-Defined Function），从命名推测其功能可能是 “获取某个参数（Parameter）的最大值”</li><li>避免 <code>SELECT *</code>：只查需要的列</li></ul></li><li><p>笛卡尔积相关</p><ul><li>多表关联时漏写部分关联条件（无 ON 条件）</li><li><strong>规范写法</strong>：明确每两张表之间的关联关系，确保关联条件逻辑正确，必要时通过业务主键（如 user_id、order_id）关联。</li><li>笛卡尔积关联的数据量是N*M，尽量避免使用笛卡尔积关联</li></ul></li><li><p>索引列 / 分区列上使用函数</p><ul><li><strong>不规范表现</strong>：<ul><li>数据库：<code>SELECT * FROM user WHERE SUBSTR(phone, 1, 3) = '138';</code>（phone 为索引列，使用了 SUBSTR 函数）</li><li>数仓：<code>SELECT * FROM dwd_order_di WHERE DATE_FORMAT(dt, 'yyyy-MM') = '2024-01';</code>（dt 为分区列，使用了 DATE_FORMAT 函数）</li></ul></li><li><strong>核心影响</strong>：数据库无法使用 phone 列的索引，数仓无法下推分区过滤，均会触发全表 / 全分区扫描。</li><li><strong>规范写法</strong>：<strong>将函数逻辑转移到等号右侧</strong>：<ul><li>数据库：<code>SELECT * FROM user WHERE phone LIKE '138%';</code></li><li>数仓：<code>SELECT * FROM dwd_order_di WHERE dt BETWEEN '20240101' AND '20240131';</code></li></ul></li></ul></li><li><p>隐式类型转换</p><ul><li><strong>不规范表现</strong>：<code>SELECT * FROM order WHERE order_id = 123456;</code>（order_id 实际为 VARCHAR 类型，传入了数值 123456）</li><li><strong>核心影响</strong>：数据库会对每一行的 order_id 进行<code>CAST(order_id AS INT)</code>转换，导致索引失效，触发全表扫描。</li><li><strong>规范写法</strong>：确保传入的参数类型与表字段类型一致，如 <code>WHERE order_id = '123456';</code></li></ul></li><li><p>相关子查询</p><ul><li><p><strong>外层每一行都触发一次****子查询</strong></p><ul><li><code>SELECT a.user_id, (SELECT b.name FROM user b WHERE b.id = a.user_id) AS user_name FROM order a;</code></li></ul></li><li><p><strong>核心影响</strong>：若外层表有 100 万行，子查询会执行 100 万次，性能极低，相当于 “循环嵌套查询”。</p></li><li><p><strong>用 JOIN 替代相关子查询</strong>，将多次查询转为一次关联查询：</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> a.user_id, b.name <span class="keyword">as</span> user_name </span><br><span class="line"><span class="keyword">from</span> <span class="keyword">order</span> a </span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> <span class="keyword">user</span> b <span class="keyword">on</span> a.user_id <span class="operator">=</span> b.id;</span><br></pre></td></tr></table></figure></li></ul></li></ol><hr><h3 id="SQL优化的技巧">SQL优化的技巧</h3><h4 id="分区限制">分区限制</h4><p>增量分区表添加分区限制，减少扫描的数据量</p><h4 id="先过滤再关联">先过滤再关联</h4><p>核心优化逻辑：减少参与关联的数据集大小，避免大表直接关联导致的性能损耗。</p><p>优化前：</p><p>先关联两张大表，关联后才用where筛选条件，导致关联的数据量极大</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> dt, <span class="built_in">count</span>(<span class="keyword">distinct</span> usr_id) <span class="keyword">as</span> num</span><br><span class="line"><span class="keyword">from</span> (</span><br><span class="line"><span class="comment">-- 先关联两张大表</span></span><br><span class="line">  <span class="keyword">select</span> a.dt, a.usr_id, a.apl_chnl_cd, a.apl_dt, b.apl_cust_typ</span><br><span class="line">  <span class="keyword">from</span> edw.cdm.dwd_cas_apl_aprv_di a</span><br><span class="line">  <span class="keyword">join</span> edw.cdm.dwd_cas_apl_aprv_tag_di b <span class="keyword">on</span> a.apl_nbr <span class="operator">=</span> b.apl_nbr</span><br><span class="line">) c</span><br><span class="line"><span class="comment">-- 关联后才筛选条件，导致关联的数据量极大</span></span><br><span class="line"><span class="keyword">where</span> dt <span class="operator">=</span> <span class="string">&#x27;2020-11-01&#x27;</span></span><br><span class="line"><span class="keyword">and</span> apl_chnl_cd <span class="operator">=</span> <span class="string">&#x27;0APP&#x27;</span></span><br><span class="line"><span class="keyword">and</span> apl_cust_typ <span class="operator">=</span> <span class="string">&#x27;CRT_CUST_FIRST&#x27;</span></span><br><span class="line"><span class="keyword">and</span> apl_dt <span class="operator">&gt;</span> <span class="string">&#x27;1900-01-01&#x27;</span></span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> dt;</span><br></pre></td></tr></table></figure><p>方案1：关联时直接添加过滤条件</p><p>在on时就筛选</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> a.dt, <span class="built_in">count</span>(<span class="keyword">distinct</span> a.usr_id) <span class="keyword">as</span> num</span><br><span class="line"><span class="keyword">from</span> edw_cdm.dwd_cas_apl_aprv_di a</span><br><span class="line"><span class="keyword">join</span> edw_cdm.dwd_cas_apl_aprv_tag_di b</span><br><span class="line"><span class="keyword">on</span> a.apl_nbr <span class="operator">=</span> b.apl_nbr</span><br><span class="line"><span class="keyword">and</span> b.apl_cust_typ <span class="operator">=</span> <span class="string">&#x27;CRT_CUST_FIRST&#x27;</span><span class="comment">-- 右表过滤条件提前到 on 子句</span></span><br><span class="line"><span class="comment">-- 左表过滤条件放在 where 中（或 on 中，视关联类型而定）</span></span><br><span class="line"><span class="keyword">where</span> a.dt <span class="operator">=</span> <span class="string">&#x27;2020-11-01&#x27;</span></span><br><span class="line"><span class="keyword">and</span> a.apl_chnl_cd <span class="operator">=</span> <span class="string">&#x27;0APP&#x27;</span></span><br><span class="line"><span class="keyword">and</span> a.apl_dt <span class="operator">&gt;</span> <span class="string">&#x27;1900-01-01&#x27;</span></span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> a.dt;</span><br></pre></td></tr></table></figure><p>方案2：子查询先过滤单表，再关联（效率更优）</p><p>先分别where筛选需要的数据，再join关联表</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> a.dt, <span class="built_in">count</span>(<span class="keyword">distinct</span> a.usr_id) <span class="keyword">as</span> num</span><br><span class="line"><span class="keyword">from</span> (</span><br><span class="line">  <span class="comment">-- 子查询 1：先过滤左表 a，只保留需要的行</span></span><br><span class="line">  <span class="keyword">select</span> dt, usr_id, apl_nbr</span><br><span class="line">  <span class="keyword">from</span> edw_cdm.dwd_cas_apl_aprv_di</span><br><span class="line">  <span class="keyword">where</span> dt <span class="operator">=</span> <span class="string">&#x27;2020-11-01&#x27;</span></span><br><span class="line">  <span class="keyword">and</span> apl_chnl_cd <span class="operator">=</span> <span class="string">&#x27;0APP&#x27;</span></span><br><span class="line">  <span class="keyword">and</span> apl_dt <span class="operator">&gt;</span> <span class="string">&#x27;1900-01-01&#x27;</span></span><br><span class="line">) a</span><br><span class="line"><span class="keyword">join</span> (</span><br><span class="line">  <span class="comment">-- 子查询 2：先过滤右表 b，只保留需要的行</span></span><br><span class="line">  <span class="keyword">select</span> apl_nbr</span><br><span class="line">  <span class="keyword">from</span> edw_cdm.dwd_cas_apl_aprv_tag_di</span><br><span class="line">  <span class="keyword">where</span> apl_cust_typ <span class="operator">=</span> <span class="string">&#x27;CRT_CUST_FIRST&#x27;</span></span><br><span class="line">) b <span class="keyword">on</span> a.apl_nbr <span class="operator">=</span> b.apl_nbr <span class="comment">-- 小数据集关联，效率高</span></span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> a.dt;</span><br></pre></td></tr></table></figure><h4 id="先过滤再使用复杂函数">先过滤再使用复杂函数</h4><p>优化前：</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> usr_id, pvc</span><br><span class="line"><span class="keyword">from</span> (</span><br><span class="line">    <span class="keyword">select</span></span><br><span class="line">    user_no <span class="keyword">as</span> usr_id</span><br><span class="line">    ,get_json_object(cust_info, <span class="string">&#x27;$.merchantAddress&#x27;</span>) <span class="keyword">as</span> pvc  <span class="comment">-- 复杂 JSON 解析函数</span></span><br><span class="line">    ,<span class="built_in">row_number</span>() <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> user_no <span class="keyword">order</span> <span class="keyword">by</span> create_datetime <span class="keyword">desc</span>) <span class="keyword">as</span> rn  <span class="comment">-- 窗口函数</span></span><br><span class="line">    <span class="keyword">from</span> edw_ods.cas_trx_cst_ext_provide_info</span><br><span class="line">) t1</span><br><span class="line"><span class="keyword">where</span> rn <span class="operator">=</span> <span class="number">1</span>;</span><br></pre></td></tr></table></figure><p>优化后：</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">  usr_id,</span><br><span class="line">  get_json_object(cust_info, <span class="string">&#x27;$.merchantAddress&#x27;</span>) <span class="keyword">as</span> pvc <span class="comment">-- 仅对过滤后的数据执行 JSON 解析</span></span><br><span class="line"><span class="keyword">from</span> (</span><br><span class="line">  <span class="keyword">select</span></span><br><span class="line">    user_no <span class="keyword">as</span> usr_id</span><br><span class="line">    ,cust_info <span class="comment">-- 仅保留原始字段，不提前解析 JSON</span></span><br><span class="line">    ,<span class="built_in">row_number</span>() <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> user_no <span class="keyword">order</span> <span class="keyword">by</span> create_datetime <span class="keyword">desc</span>) <span class="keyword">as</span> rn</span><br><span class="line">  <span class="keyword">from</span> edw_ods.cas_trx_cst_ext_provide_info</span><br><span class="line">) t1</span><br><span class="line"><span class="keyword">where</span> rn<span class="operator">=</span><span class="number">1</span>;</span><br></pre></td></tr></table></figure><h4 id="提前过滤null">提前过滤null</h4><ul><li>JOIN倾斜-大表关联大表</li></ul><p>两个大表关联，如果关联字段包含大量无效值（NULL、空值等）或有大量重复数据，关联之后会导致数据倾斜，数据倾斜的特征是脚本执行过程中长时间卡在99%。</p><ul><li>倾斜值为无效值（NULL，空串等），如果无效值不需要，则直接过滤。</li></ul><p>优化前：</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 申请基表和申请标签表分别有几千万笔案件的客户号为空</span></span><br><span class="line"><span class="keyword">select</span> xxx <span class="keyword">from</span> edw_cdm.dwd_cas_apl_aprv_di a <span class="keyword">join</span> edw_cdm.dwd_cas_apl_aprv_tag_di b <span class="keyword">on</span> a.cust_id<span class="operator">=</span>b.cust_id;</span><br></pre></td></tr></table></figure><p>优化后：</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 过滤无效值</span></span><br><span class="line"><span class="keyword">select</span> xxx </span><br><span class="line"><span class="keyword">from</span>(<span class="keyword">select</span> apl_nbr,cust_id <span class="keyword">from</span> edw_cdm.dwd_cas_apl_aprv_di <span class="keyword">where</span> cust_id<span class="operator">&lt;&gt;</span><span class="string">&#x27;&#x27;</span>) a</span><br><span class="line"><span class="keyword">join</span>(<span class="keyword">select</span> apl_nbr,cust_id <span class="keyword">from</span> edw_cdm.dwd_cas_apl_aprv_tag_di <span class="keyword">where</span> cust_id<span class="operator">&lt;&gt;</span><span class="string">&#x27;&#x27;</span>) b <span class="keyword">on</span> a.cust_id<span class="operator">=</span>b.cust_id;</span><br></pre></td></tr></table></figure><ul><li>倾斜值为无效值（NULL，空串等），如果无效值需要保留，则先对无效值进行随机处理。</li></ul><h4 id="用group-by去重">用<code>group by</code>去重</h4><ul><li>Reduce倾斜-<code>distinct</code></li><li>用<code>group by</code>替代<code>distinct</code>去重</li></ul><p><code>distinct</code>会导致最后只有一个reducer，而<code>group by</code>会分发到不同的reducer上。考虑用<code>group by</code>代替。</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 优化前  用时276s</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(<span class="keyword">distinct</span> cust_id) <span class="keyword">as</span> num </span><br><span class="line"><span class="keyword">from</span> edw_cdm.dwd_cas_apl_aprv_di <span class="keyword">where</span> rsl_flg<span class="operator">=</span><span class="string">&#x27;Y&#x27;</span>;</span><br><span class="line"><span class="comment">-- 优化后 用时93s</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(<span class="number">1</span>) <span class="keyword">as</span> num</span><br><span class="line"><span class="keyword">from</span> (<span class="keyword">select</span> cust_id <span class="keyword">from</span> edw_cdm.dwd_cas_apl_aprv_di <span class="keyword">where</span> rsl_flg<span class="operator">=</span><span class="string">&#x27;Y&#x27;</span> <span class="keyword">group</span> <span class="keyword">by</span> cust_id) t1;</span><br></pre></td></tr></table></figure><hr><h1>刷7大类型SQL题</h1><blockquote><p>题型基本覆盖面试90%的问题！</p></blockquote><ul><li>排序类问题（普通排序，组内排序）</li><li>TOPN 问题</li><li>用户留存、复购率、完播率等计算复合指标问题</li><li>新用户数、用户间隔连续登录天数、最长连续登陆问题</li><li>偏移类求和求平均问题（lag, lead函数）</li><li>行列互转问题</li><li>中位数问题<ul><li>每个问题的相关的函数和语法有哪些，有没有哪些问题这7类没总结的</li><li>对 7 大类型 SQL 面试题，结合 PostgreSQL 语法给出典型例题及答案</li><li>对 7 大类型 SQL 面试题，结合 PostgreSQL 和trino语法分别给出典型例题及答案，用最少的表和字段完成所有示例，关键字用小写，示例要解释语法的使用和用到的函数</li><li>PostgreSQL 和trino语法分别给出答案，关键字用小写</li></ul></li></ul><h2 id="排序类问题（普通排序，组内排序）">排序类问题（普通排序，组内排序）</h2><p><strong>普通排序</strong>：使用<code>order by</code>对查询结果进行排序。<br><strong>组内排序</strong>：使用窗口函数<code>row_number()</code>, <code>rank()</code>, <code>dense_rank()</code>等，在分组内进行排序。<br>配合 <code>PARTITION BY</code>进行分组，<code>ORDER BY</code>在组内排序</p><ul><li>排序函数：row_number(), rank(), dense_rank(), tnile()</li><li>ASC/DESC</li></ul><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="built_in">row_number</span>() <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> region <span class="keyword">order</span> <span class="keyword">by</span> dt)  <span class="comment">-- 连续不重复排名   </span></span><br><span class="line"><span class="built_in">rank</span>() <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> region <span class="keyword">order</span> <span class="keyword">by</span> sales)       <span class="comment">-- 并列排名会跳过后续名次</span></span><br><span class="line"><span class="built_in">dense_rank</span>() <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> region <span class="keyword">order</span> <span class="keyword">by</span> sales) <span class="comment">-- 并列排名不跳名次</span></span><br><span class="line"><span class="built_in">ntile</span>(n) <span class="keyword">over</span>(<span class="keyword">order</span> <span class="keyword">by</span> sales)                       <span class="comment">-- 分组排名</span></span><br></pre></td></tr></table></figure><ul><li><code>ROW_NUMBER()</code>: 连续唯一序号（1,2,3,4）</li><li><code>RANK()</code>: 并列时排名相同，后续序号跳过（1,2,2,4）</li><li><code>DENSE_RANK()</code>: 并列时排名相同，序号连续（1,2,2,3）</li><li><code>NTILE()</code>: 分桶，常用于五分位、十分位等</li></ul><p><strong>例题</strong>：有表1（<code>region</code>地区，<code>dt</code>日期，<code>sales</code>销售额），按地区分组，给每天的销售额按降序排组内名次（允许并列，不跳号）。</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> region</span><br></pre></td></tr></table></figure><h2 id="TOPN-问题">TOPN 问题</h2><p>使用窗口函数或子查询来获取每个组内前N条记录。</p><ul><li>使用<code>row_number()</code>配合where条件</li><li>或者使用<code>limit()</code>（在MySQL/PostgreSQL）或TOP（在SQL Server）等</li></ul><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 使用窗口函数</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span>(</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span></span><br><span class="line">,<span class="built_in">row_number</span>() <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> region <span class="keyword">order</span> <span class="keyword">by</span> <span class="type">date</span> <span class="keyword">DESC</span>) <span class="keyword">as</span> rn</span><br><span class="line"><span class="keyword">from</span> table1</span><br><span class="line">)t</span><br><span class="line"><span class="keyword">where</span> rn<span class="operator">&lt;=</span><span class="number">3</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 使用LIMIT（简单场景）</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> table1</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> <span class="type">date</span> <span class="keyword">DESC</span></span><br><span class="line">limit <span class="number">3</span>;</span><br></pre></td></tr></table></figure><ol><li><p>全局TOPN<br>语法：</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span>(</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span>,<span class="built_in">row_number</span>() <span class="keyword">over</span>(<span class="keyword">order</span> <span class="keyword">by</span> 排序列 <span class="keyword">DESC</span>) <span class="keyword">as</span> rn</span><br><span class="line">    <span class="keyword">from</span> 表名</span><br><span class="line">)t</span><br><span class="line"><span class="keyword">where</span> rn<span class="operator">&lt;=</span>N</span><br><span class="line">;</span><br></pre></td></tr></table></figure><p>示例：取销售额前3的订单</p></li><li><p>分组TOPN<br>语法：</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span>(</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span>,<span class="built_in">row_number</span>() <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> 分组列 <span class="keyword">order</span> <span class="keyword">by</span> 排序列 <span class="keyword">DESC</span>) <span class="keyword">as</span> rn</span><br><span class="line">    <span class="keyword">from</span> 表名</span><br><span class="line">)t</span><br><span class="line"><span class="keyword">where</span> rn<span class="operator">&lt;=</span>N</span><br><span class="line">;</span><br></pre></td></tr></table></figure><p>示例：取每个地区销售额前2的订单</p></li></ol><h2 id="用户留存、复购率、完播率等计算复合指标问题">用户留存、复购率、完播率等计算复合指标问题</h2><p>这类问题通常需要计算比率，例如用户留存率是计算某天新增的用户在后续某天仍然活跃的比例。</p><ul><li>常用日期函数：<code>date_diff()</code>, <code>date_add()</code> 等</li><li>聚合函数：<code>sum(case when ...)</code>, <code>count(distinct ...)</code></li><li>条件表达式：case when, if</li><li>小数保留n位数：<code>round(expr, n)</code></li><li>数据类型转换：<code>cast(expr as decimal)</code></li></ul><p>PostgreSQL</p><ul><li><code>expr + INTERVAL '1 day'</code></li></ul><p>Trino</p><ul><li><code>date_add('day', 1, expr)</code></li></ul><h2 id="新用户数、用户间隔连续登录天数、最长连续登陆问题">新用户数、用户间隔连续登录天数、最长连续登陆问题</h2><ul><li>常用窗口函数：<code>lag()</code>、<code>lead()</code>，用于获取前后行的数据</li><li>日期函数：<code>date_diff()</code>、<code>timestamp_diff()</code>，计算时间间隔</li><li>使用变量或窗口函数来分组连续登录</li></ul><p>PostgreSQL</p><ul><li><code>expr +/- INTERVAL '1 day'</code></li></ul><p>Trino</p><ul><li><code>date_add('day', 1, expr)</code></li></ul><h3 id="抖音电商数据分析笔试SQL题">抖音电商数据分析笔试SQL题</h3><p>1、有一张订单表(order_info)，表结构如下:order_id、goods_id、order_time、order_gmv<br>问题：请统计2024年9月10日这天销量金额前10的商品信息。<br>要求:排名相同的一起作为同排名次序输出<br>2、有一张用户登录表(user_login_log)，表结构如下:uid、login_time<br>问题：请统计2024.9.1之前活跃过，但是9.1之后再也没有活跃过的用户</p><ul><li><p>创建表并帮我填入一些数据</p></li><li><p>解法是最高效率的吗，bp级数据可用不</p></li></ul><ol><li><p>商品销量排名前10：</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 2层子查询</span></span><br><span class="line"><span class="keyword">select</span> </span><br><span class="line">good_id</span><br><span class="line">,order_gmv</span><br><span class="line">,rank</span><br><span class="line"><span class="keyword">from</span>(</span><br><span class="line"><span class="keyword">select</span></span><br><span class="line">    good_id</span><br><span class="line">    ,order_gmv</span><br><span class="line">    ,<span class="built_in">dense_rank</span>() <span class="keyword">over</span>(<span class="keyword">order</span> <span class="keyword">by</span> total_gmv <span class="keyword">desc</span>) <span class="keyword">as</span> rank</span><br><span class="line">    <span class="keyword">from</span>(</span><br><span class="line">    <span class="keyword">select</span></span><br><span class="line">        good_id</span><br><span class="line">        ,<span class="built_in">sum</span>(order_gmv) <span class="keyword">as</span> total_gmv</span><br><span class="line">        <span class="keyword">from</span> order_info</span><br><span class="line">        <span class="keyword">where</span> <span class="built_in">cast</span>(order_time <span class="keyword">as</span> <span class="type">date</span>) <span class="operator">=</span> <span class="string">&#x27;2024-09-10&#x27;</span></span><br><span class="line">        <span class="keyword">group</span> <span class="keyword">by</span> good_id</span><br><span class="line">    ) <span class="keyword">as</span> res</span><br><span class="line">) <span class="keyword">as</span> res</span><br><span class="line"><span class="keyword">where</span> rank <span class="operator">&lt;=</span> <span class="number">10</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 1层子查询</span></span><br><span class="line"><span class="keyword">select</span> </span><br><span class="line">    rank_num, goods_id, total_gmv</span><br><span class="line"><span class="keyword">from</span> (</span><br><span class="line">    <span class="keyword">select</span> </span><br><span class="line">        <span class="built_in">dense_rank</span>() <span class="keyword">over</span> (<span class="keyword">order</span> <span class="keyword">by</span> <span class="built_in">sum</span>(total_gmv) <span class="keyword">desc</span>) <span class="keyword">as</span> rank</span><br><span class="line">        ,goods_id</span><br><span class="line">        ,<span class="built_in">sum</span>(order_gmv) <span class="keyword">as</span> total_gmv</span><br><span class="line">    <span class="keyword">from</span> order_info</span><br><span class="line">    <span class="keyword">where</span> <span class="built_in">cast</span>(order_time <span class="keyword">as</span> <span class="type">date</span>) <span class="operator">=</span> <span class="string">&#x27;2024-09-10&#x27;</span></span><br><span class="line">    <span class="keyword">group</span> <span class="keyword">by</span> goods_id</span><br><span class="line">) t</span><br><span class="line"><span class="keyword">where</span> rank <span class="operator">&lt;=</span> <span class="number">10</span>;</span><br></pre></td></tr></table></figure></li><li><p>用户流失分析：</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 不写CTE</span></span><br><span class="line"><span class="keyword">select</span> </span><br><span class="line">t.uid</span><br><span class="line"><span class="keyword">from</span>(</span><br><span class="line"><span class="keyword">select</span> </span><br><span class="line">    uid</span><br><span class="line">    <span class="keyword">from</span> user_login_log</span><br><span class="line">    <span class="keyword">where</span> login_time <span class="operator">&lt;=</span> <span class="string">&#x27;2024-09-01&#x27;</span></span><br><span class="line">    <span class="keyword">group</span> <span class="keyword">by</span> uid</span><br><span class="line">) <span class="keyword">as</span> t</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span>(</span><br><span class="line"><span class="keyword">select</span> </span><br><span class="line">    uid</span><br><span class="line">    <span class="keyword">from</span> user_login_log</span><br><span class="line">    <span class="keyword">where</span> login_time <span class="operator">&gt;</span> <span class="string">&#x27;2024-09-01&#x27;</span></span><br><span class="line">    <span class="keyword">group</span> <span class="keyword">by</span> uid</span><br><span class="line">)<span class="keyword">as</span> t1 </span><br><span class="line"><span class="keyword">on</span> t.uid<span class="operator">=</span>t1.uid</span><br><span class="line"><span class="keyword">where</span> t1.uid <span class="keyword">is</span> <span class="keyword">null</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 写CTE</span></span><br><span class="line"><span class="keyword">with</span> tmp_before <span class="keyword">as</span>(</span><br><span class="line"><span class="keyword">select</span> uid</span><br><span class="line">    <span class="keyword">from</span> user_login_log</span><br><span class="line">    <span class="keyword">where</span> login_time <span class="operator">&lt;=</span> <span class="string">&#x27;2024-09-01&#x27;</span></span><br><span class="line">    <span class="keyword">group</span> <span class="keyword">by</span> <span class="number">1</span></span><br><span class="line">)</span><br><span class="line">, tmp_after <span class="keyword">as</span>(</span><br><span class="line"><span class="keyword">select</span> uid</span><br><span class="line">    <span class="keyword">from</span> user_login_log</span><br><span class="line">    <span class="keyword">where</span> login_time <span class="operator">&gt;</span> <span class="string">&#x27;2024-09-01&#x27;</span></span><br><span class="line">    <span class="keyword">group</span> <span class="keyword">by</span> <span class="number">1</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">select</span> t.uid</span><br><span class="line"><span class="keyword">from</span> tmp_before t</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> tmp_after t1 <span class="keyword">on</span> t.uid<span class="operator">=</span>t1.uid</span><br><span class="line"><span class="keyword">where</span> t1.uid <span class="keyword">is</span> <span class="keyword">null</span></span><br></pre></td></tr></table></figure></li><li><p>建表测试：</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* PostgreSQL语法 */</span></span><br><span class="line"><span class="comment">-- 创建订单表</span></span><br><span class="line"><span class="keyword">create table</span> order_info (</span><br><span class="line">    order_id <span class="type">int</span> <span class="keyword">primary key</span>,</span><br><span class="line">    goods_id <span class="type">int</span>,</span><br><span class="line">    order_time <span class="type">timestamp</span>,</span><br><span class="line">    order_gmv <span class="type">decimal</span>(<span class="number">10</span>, <span class="number">2</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 插入测试数据（2024年9月10日）</span></span><br><span class="line"><span class="keyword">insert into</span> order_info <span class="keyword">values</span></span><br><span class="line">(<span class="number">1001</span>, <span class="number">101</span>, <span class="string">&#x27;2024-09-10 08:30:00&#x27;</span>, <span class="number">299.99</span>),</span><br><span class="line">(<span class="number">1002</span>, <span class="number">102</span>, <span class="string">&#x27;2024-09-10 09:15:00&#x27;</span>, <span class="number">1500.00</span>),</span><br><span class="line">(<span class="number">1003</span>, <span class="number">103</span>, <span class="string">&#x27;2024-09-10 10:20:00&#x27;</span>, <span class="number">899.50</span>),</span><br><span class="line">(<span class="number">1004</span>, <span class="number">101</span>, <span class="string">&#x27;2024-09-10 10:45:00&#x27;</span>, <span class="number">299.99</span>),</span><br><span class="line">(<span class="number">1005</span>, <span class="number">102</span>, <span class="string">&#x27;2024-09-10 11:00:00&#x27;</span>, <span class="number">1500.00</span>),</span><br><span class="line">(<span class="number">1006</span>, <span class="number">104</span>, <span class="string">&#x27;2024-09-10 11:30:00&#x27;</span>, <span class="number">599.99</span>),</span><br><span class="line">(<span class="number">1007</span>, <span class="number">105</span>, <span class="string">&#x27;2024-09-10 12:00:00&#x27;</span>, <span class="number">2299.00</span>),</span><br><span class="line">(<span class="number">1008</span>, <span class="number">101</span>, <span class="string">&#x27;2024-09-10 12:45:00&#x27;</span>, <span class="number">299.99</span>),</span><br><span class="line">(<span class="number">1009</span>, <span class="number">106</span>, <span class="string">&#x27;2024-09-10 13:20:00&#x27;</span>, <span class="number">450.00</span>),</span><br><span class="line">(<span class="number">1010</span>, <span class="number">102</span>, <span class="string">&#x27;2024-09-10 14:00:00&#x27;</span>, <span class="number">1500.00</span>),</span><br><span class="line">(<span class="number">1011</span>, <span class="number">107</span>, <span class="string">&#x27;2024-09-10 14:30:00&#x27;</span>, <span class="number">3499.99</span>),</span><br><span class="line">(<span class="number">1012</span>, <span class="number">103</span>, <span class="string">&#x27;2024-09-10 15:00:00&#x27;</span>, <span class="number">899.50</span>),</span><br><span class="line">(<span class="number">1013</span>, <span class="number">108</span>, <span class="string">&#x27;2024-09-10 15:45:00&#x27;</span>, <span class="number">199.99</span>),</span><br><span class="line">(<span class="number">1014</span>, <span class="number">105</span>, <span class="string">&#x27;2024-09-10 16:20:00&#x27;</span>, <span class="number">2299.00</span>),</span><br><span class="line">(<span class="number">1015</span>, <span class="number">109</span>, <span class="string">&#x27;2024-09-10 17:00:00&#x27;</span>, <span class="number">799.99</span>),</span><br><span class="line">(<span class="number">1016</span>, <span class="number">101</span>, <span class="string">&#x27;2024-09-10 17:30:00&#x27;</span>, <span class="number">299.99</span>),</span><br><span class="line">(<span class="number">1017</span>, <span class="number">110</span>, <span class="string">&#x27;2024-09-10 18:00:00&#x27;</span>, <span class="number">1099.00</span>),</span><br><span class="line">(<span class="number">1018</span>, <span class="number">102</span>, <span class="string">&#x27;2024-09-10 18:45:00&#x27;</span>, <span class="number">1500.00</span>),</span><br><span class="line">(<span class="number">1019</span>, <span class="number">107</span>, <span class="string">&#x27;2024-09-10 19:20:00&#x27;</span>, <span class="number">3499.99</span>),</span><br><span class="line">(<span class="number">1020</span>, <span class="number">111</span>, <span class="string">&#x27;2024-09-10 20:00:00&#x27;</span>, <span class="number">599.50</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> order_info;</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* PostgreSQL语法 */</span></span><br><span class="line"><span class="comment">-- 创建用户登录表</span></span><br><span class="line"><span class="keyword">create table</span> user_login_log (</span><br><span class="line">    uid <span class="type">int</span>,</span><br><span class="line">    login_time <span class="type">timestamp</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 插入测试数据</span></span><br><span class="line"><span class="comment">-- 用户1001: 9月1日前活跃，之后未活跃（流失用户）</span></span><br><span class="line"><span class="keyword">insert into</span> user_login_log <span class="keyword">values</span></span><br><span class="line">(<span class="number">1001</span>, <span class="string">&#x27;2024-08-25 10:30:00&#x27;</span>),</span><br><span class="line">(<span class="number">1001</span>, <span class="string">&#x27;2024-08-28 14:20:00&#x27;</span>),</span><br><span class="line">(<span class="number">1001</span>, <span class="string">&#x27;2024-08-31 18:45:00&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 用户1002: 9月1日前活跃，之后也活跃（保留用户）</span></span><br><span class="line"><span class="keyword">insert into</span> user_login_log <span class="keyword">values</span></span><br><span class="line">(<span class="number">1002</span>, <span class="string">&#x27;2024-08-20 09:00:00&#x27;</span>),</span><br><span class="line">(<span class="number">1002</span>, <span class="string">&#x27;2024-08-30 15:30:00&#x27;</span>),</span><br><span class="line">(<span class="number">1002</span>, <span class="string">&#x27;2024-09-05 11:20:00&#x27;</span>),</span><br><span class="line">(<span class="number">1002</span>, <span class="string">&#x27;2024-09-15 16:45:00&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 用户1003: 9月1日前活跃，之后未活跃（流失用户）</span></span><br><span class="line"><span class="keyword">insert into</span> user_login_log <span class="keyword">values</span></span><br><span class="line">(<span class="number">1003</span>, <span class="string">&#x27;2024-08-15 10:00:00&#x27;</span>),</span><br><span class="line">(<span class="number">1003</span>, <span class="string">&#x27;2024-08-22 13:30:00&#x27;</span>),</span><br><span class="line">(<span class="number">1003</span>, <span class="string">&#x27;2024-08-29 20:15:00&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 用户1004: 仅在9月1日后活跃（新用户，不符合条件）</span></span><br><span class="line"><span class="keyword">insert into</span> user_login_log <span class="keyword">values</span></span><br><span class="line">(<span class="number">1004</span>, <span class="string">&#x27;2024-09-10 12:00:00&#x27;</span>),</span><br><span class="line">(<span class="number">1004</span>, <span class="string">&#x27;2024-09-18 14:30:00&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 用户1005: 9月1日前活跃，之后也活跃（保留用户）</span></span><br><span class="line"><span class="keyword">insert into</span> user_login_log <span class="keyword">values</span></span><br><span class="line">(<span class="number">1005</span>, <span class="string">&#x27;2024-08-10 08:00:00&#x27;</span>),</span><br><span class="line">(<span class="number">1005</span>, <span class="string">&#x27;2024-08-25 17:45:00&#x27;</span>),</span><br><span class="line">(<span class="number">1005</span>, <span class="string">&#x27;2024-09-08 09:20:00&#x27;</span>),</span><br><span class="line">(<span class="number">1005</span>, <span class="string">&#x27;2024-09-20 19:00:00&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 用户1006: 9月1日前活跃，之后未活跃（流失用户）</span></span><br><span class="line"><span class="keyword">insert into</span> user_login_log <span class="keyword">values</span></span><br><span class="line">(<span class="number">1006</span>, <span class="string">&#x27;2024-08-05 11:30:00&#x27;</span>),</span><br><span class="line">(<span class="number">1006</span>, <span class="string">&#x27;2024-08-31 15:20:00&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 用户1007: 9月1日前活跃，之后未活跃（流失用户）</span></span><br><span class="line"><span class="keyword">insert into</span> user_login_log <span class="keyword">values</span></span><br><span class="line">(<span class="number">1007</span>, <span class="string">&#x27;2024-08-12 10:00:00&#x27;</span>),</span><br><span class="line">(<span class="number">1007</span>, <span class="string">&#x27;2024-08-26 13:15:00&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 用户1008: 仅在9月1日后活跃（新用户）</span></span><br><span class="line"><span class="keyword">insert into</span> user_login_log <span class="keyword">values</span></span><br><span class="line">(<span class="number">1008</span>, <span class="string">&#x27;2024-09-22 11:00:00&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> user_login_log;</span><br></pre></td></tr></table></figure></li></ol><h2 id="偏移类求和求平均问题（lag-lead函数）">偏移类求和求平均问题（lag, lead函数）</h2><ul><li>窗口函数：<code>lag()</code>、<code>lead()</code>, 用于获取前后行的值</li><li>窗口函数：<code>sum()</code>，<code>avg()</code> 等结合rows/range</li></ul><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="built_in">lag</span>(sales,<span class="number">1</span>) <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> region <span class="keyword">order</span> <span class="keyword">by</span> <span class="type">date</span>) <span class="keyword">as</span> prev_sales</span><br><span class="line"><span class="built_in">lead</span>(sales,<span class="number">1</span>) <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> region <span class="keyword">order</span> <span class="keyword">by</span> <span class="type">date</span>) <span class="keyword">as</span> next_sales</span><br><span class="line"><span class="built_in">avg</span>(sales) <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> region <span class="keyword">order</span> <span class="keyword">by</span> <span class="type">date</span> <span class="keyword">rows</span> <span class="keyword">between</span> <span class="number">6</span> preceding <span class="keyword">and</span> <span class="keyword">current</span> <span class="type">row</span>) <span class="keyword">as</span> moving_avg</span><br></pre></td></tr></table></figure><ul><li><strong>rows/range</strong> 窗口帧<ul><li>包括左右区间</li><li><code>unbounded preceding</code>                      分区头</li><li><code>unbounded following</code>                       分区尾</li><li><code>interval '1 month' preceding</code>    前1个月</li><li><code>n preceding </code>                 前n行</li><li><code>current row</code>                   当前行</li><li><code>n following</code>                   后n行</li></ul></li></ul><ol><li><p>分区头到分区尾：</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">rows</span> <span class="keyword">between</span> unbounded preceding <span class="keyword">and</span> unbounded following</span><br></pre></td></tr></table></figure></li><li><p>前n行到当前行</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">rows</span> <span class="keyword">between</span> n preceding <span class="keyword">and</span> <span class="keyword">current</span> <span class="type">row</span></span><br></pre></td></tr></table></figure></li><li><p>当前行到后n行</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">rows</span> <span class="keyword">between</span> <span class="keyword">current</span> <span class="type">row</span> <span class="keyword">and</span> n following</span><br></pre></td></tr></table></figure></li><li><p>前n行到后n行</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">rows</span> <span class="keyword">between</span> n preceding <span class="keyword">and</span> n following</span><br></pre></td></tr></table></figure></li><li><p>分区头到当前行</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">rows</span> <span class="keyword">between</span> unbounded preceding <span class="keyword">and</span> <span class="keyword">current</span> <span class="type">row</span></span><br></pre></td></tr></table></figure></li><li><p>当前行到分区尾</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">rows</span> <span class="keyword">between</span> <span class="keyword">current</span> <span class="type">row</span> <span class="keyword">and</span> unbounded following</span><br></pre></td></tr></table></figure></li><li><p>前一个月到当前行</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">range</span> <span class="keyword">between</span> <span class="type">interval</span> <span class="string">&#x27;1 month&#x27;</span> preceding <span class="keyword">and</span> <span class="keyword">current</span> <span class="type">row</span></span><br></pre></td></tr></table></figure></li><li><p>继续。。。</p></li></ol><ul><li>同比环比<ul><li><code>lag(expr,1)</code>，<code>lag(expr,12)</code></li></ul></li></ul><h2 id="行列互转问题">行列互转问题</h2><ul><li>行转列：使用<code>case when</code>或 <code>pivot</code>（部分数据库支持，如SQL Server）</li><li>列转行：使用<code>union all</code>或 <code>unpivot</code>（部分数据库支持）</li></ul><p><strong>核心概念</strong></p><ul><li><p>行转列：</p><p>将某一列中的唯一值转换为新的列名，并将另一列的值填充到这些新列之下。通常伴随聚合操作。</p><ul><li><em>示例：</em> 将 <code>(年份, 季度, 销售额)</code> 转换为 <code>(年份, Q1销售额, Q2销售额, Q3销售额, Q4销售额)</code>。</li></ul></li><li><p>列转行：</p><p>是行转列的逆操作，将多个列合并成两个列：一个用于存储原列名（键），一个用于存储原列的值（值）。</p><ul><li><em>示例：</em> 将 <code>(年份, Q1销售额, Q2销售额, Q3销售额, Q4销售额)</code> 转换回 <code>(年份, 季度, 销售额)</code>。</li></ul></li></ul><p><img src="./../%E5%BF%AB%E9%80%9F%E7%B2%BE%E9%80%9ASQL/image-20251023164941369.png" alt="image-20251023164941369"></p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* 通用语法？？？ */</span></span><br><span class="line"><span class="keyword">create table</span> t(id <span class="type">int</span>, seller text, product text, amount <span class="type">int</span>);</span><br><span class="line"><span class="keyword">insert into</span> t <span class="keyword">values</span></span><br><span class="line">(<span class="string">&#x27;101&#x27;</span>, <span class="string">&#x27;alice&#x27;</span>,<span class="string">&#x27;dior&#x27;</span>,<span class="number">310</span>),</span><br><span class="line">(<span class="string">&#x27;101&#x27;</span>, <span class="string">&#x27;alice&#x27;</span>,<span class="string">&#x27;lamer&#x27;</span>,<span class="number">285</span>),</span><br><span class="line">(<span class="string">&#x27;101&#x27;</span>, <span class="string">&#x27;alice&#x27;</span>,<span class="string">&#x27;sk2&#x27;</span>,<span class="number">265</span>),</span><br><span class="line">(<span class="string">&#x27;102&#x27;</span>, <span class="string">&#x27;bob&#x27;</span>,<span class="string">&#x27;dior&#x27;</span>,<span class="number">305</span>),</span><br><span class="line">(<span class="string">&#x27;102&#x27;</span>, <span class="string">&#x27;bob&#x27;</span>,<span class="string">&#x27;lamer&#x27;</span>,<span class="number">290</span>),</span><br><span class="line">(<span class="string">&#x27;102&#x27;</span>, <span class="string">&#x27;bob&#x27;</span>,<span class="string">&#x27;sk2&#x27;</span>,<span class="number">280</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span></span><br><span class="line">    id,seller</span><br><span class="line">    ,<span class="built_in">sum</span>(amount) <span class="keyword">filter</span> (<span class="keyword">where</span> product <span class="operator">=</span> <span class="string">&#x27;dior&#x27;</span>)  <span class="keyword">as</span> dior</span><br><span class="line">    ,<span class="built_in">sum</span>(amount) <span class="keyword">filter</span> (<span class="keyword">where</span> product <span class="operator">=</span> <span class="string">&#x27;lamer&#x27;</span>) <span class="keyword">as</span> lamer</span><br><span class="line">    ,<span class="built_in">sum</span>(amount) <span class="keyword">filter</span> (<span class="keyword">where</span> product <span class="operator">=</span> <span class="string">&#x27;sk2&#x27;</span>)   <span class="keyword">as</span> sk2</span><br><span class="line"><span class="keyword">from</span> t</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> <span class="number">1</span>,<span class="number">2</span>;</span><br></pre></td></tr></table></figure><p>PostgreSQL</p><ul><li><code>case when</code></li><li><code>filter</code></li></ul><p>Trino</p><ul><li><code>case when</code></li><li><code>filter</code></li><li><code>count_if</code></li></ul><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* PostgreSQL语法 */</span></span><br><span class="line"><span class="keyword">select</span> dt</span><br><span class="line">,<span class="built_in">sum</span>(<span class="keyword">case</span> <span class="keyword">when</span> shop<span class="operator">=</span><span class="string">&#x27;A店&#x27;</span> <span class="keyword">then</span> <span class="number">1</span> <span class="keyword">else</span> <span class="number">0</span> <span class="keyword">end</span>) <span class="keyword">as</span> shop1</span><br><span class="line">,<span class="built_in">sum</span>(<span class="keyword">case</span> <span class="keyword">when</span> shop<span class="operator">=</span><span class="string">&#x27;B店&#x27;</span> <span class="keyword">then</span> <span class="number">1</span> <span class="keyword">else</span> <span class="number">0</span> <span class="keyword">end</span>) <span class="keyword">as</span> shop2</span><br><span class="line"><span class="keyword">from</span> t</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/* Trino语法 */</span></span><br><span class="line"><span class="keyword">select</span> dt</span><br><span class="line">,count_if(shop<span class="operator">=</span><span class="string">&#x27;A店&#x27;</span>) <span class="keyword">as</span> shop1</span><br><span class="line">,count_if(shop<span class="operator">=</span><span class="string">&#x27;B店&#x27;</span>) <span class="keyword">as</span> shop2</span><br><span class="line"><span class="keyword">from</span> t</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> <span class="number">1</span>;</span><br></pre></td></tr></table></figure><h2 id="中位数问题">中位数问题</h2><ul><li>方法1：使用窗口函数：PERCENTILE_CONT, PERCENTILE_DISC等（部分数据库支持，如PostgreSQL、SQL Server）</li><li>方法2：使用排序和计数的方法</li></ul><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="built_in">percentile_cont</span>(<span class="number">0.5</span>) <span class="keyword">within</span> <span class="keyword">group</span>(<span class="keyword">order</span> <span class="keyword">by</span> score) <span class="keyword">as</span> median</span><br></pre></td></tr></table></figure><p>PostgreSQL</p><ul><li><code>percentile_cont()</code>连续百分位数（推荐）</li><li><code>percentile_disc()</code>离散百分位数</li><li><strong>如何选择？</strong><ul><li>若数据是<strong>连续型</strong>（如价格、时长），且希望百分位结果更精确（允许插值），用 <code>percentile_cont</code>；</li><li>若数据是<strong>离散型</strong>（如评分、数量），或要求结果必须是原始数据中的值，用 <code>percentile_disc</code>。</li></ul></li></ul><p>Trino</p><ul><li><code>approx_percentile()</code></li></ul><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* PostgreSQL语法 */</span></span><br><span class="line"><span class="keyword">select</span></span><br><span class="line"><span class="built_in">percentile_cont</span>(<span class="number">0.5</span>) <span class="keyword">within</span> <span class="keyword">group</span>(<span class="keyword">order</span> <span class="keyword">by</span> sales)</span><br><span class="line">,<span class="built_in">percentile_disc</span>(<span class="number">0.5</span>) <span class="keyword">within</span> <span class="keyword">group</span>(<span class="keyword">order</span> <span class="keyword">by</span> sales)</span><br><span class="line"><span class="keyword">from</span> t;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/* Trino语法 */</span></span><br><span class="line"><span class="comment">-- 基础用法（返回近似值）</span></span><br><span class="line"><span class="keyword">select</span></span><br><span class="line">approx_percentile(sales, <span class="number">0.5</span>)</span><br><span class="line"><span class="keyword">from</span> t;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 按商店分组</span></span><br><span class="line"><span class="keyword">select</span></span><br><span class="line">shop</span><br><span class="line">,approx_percentile(sales, <span class="number">0.5</span>)</span><br><span class="line"><span class="keyword">from</span> t</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 作为窗口函数</span></span><br><span class="line"><span class="keyword">select</span></span><br><span class="line">shop</span><br><span class="line">,approx_percentile(sales, <span class="number">0.5</span>) <span class="keyword">over</span>(partiiton <span class="keyword">by</span> shop)</span><br><span class="line"><span class="keyword">from</span> t;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 多个百分位数</span></span><br><span class="line"><span class="keyword">select</span></span><br><span class="line">approx_percentile(sales, <span class="keyword">array</span>[<span class="number">0.25</span>, <span class="number">0.5</span>, <span class="number">0.75</span>])</span><br><span class="line"><span class="keyword">from</span> t;</span><br></pre></td></tr></table></figure><p>通用解法：</p><p>排序求解</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">with</span> tmp1 <span class="keyword">as</span>(</span><br><span class="line"><span class="keyword">select</span> sales</span><br><span class="line">,<span class="built_in">row_number</span>() <span class="keyword">over</span>(<span class="keyword">order</span> <span class="keyword">by</span> sales) <span class="keyword">as</span> rn</span><br><span class="line">,<span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">over</span>() <span class="keyword">as</span> total_rows</span><br><span class="line"><span class="keyword">from</span> t</span><br><span class="line">)</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">avg</span>(sales) <span class="keyword">as</span> median</span><br><span class="line"><span class="keyword">from</span> tmp1</span><br><span class="line"><span class="keyword">where</span> rn <span class="keyword">in</span>((total_rows<span class="operator">+</span><span class="number">1</span>) div <span class="number">2</span>, (total_rows<span class="operator">+</span><span class="number">2</span>) <span class="operator">/</span> <span class="number">2</span>);</span><br></pre></td></tr></table></figure><ul><li><code>count(*) over() as total_rows</code>  – 窗口函数：全表总行数（不分组）</li><li><code>where rn in((total_rows+1) div 2, (total_rows+2) / 2)</code>我没懂</li></ul><p>​这段条件的核心是 <strong>用一个公式同时适配 “奇数总行数” 和 “偶数总行数”</strong>，不用写 IF/CASE 判断，靠整数除法的特性自动筛选出需要的中间行。咱们用「具体例子」拆解，瞬间就能懂！</p><p><strong>先明确两个前提</strong></p><ul><li><code>rn</code>：按销售额排序后的唯一行号（1、2、3、…、total_rows）；</li><li><code>total_rows</code>：数据集的总行数（比如 5 行、6 行，分别对应奇数、偶数）；</li><li>关键：SQL 里的整数除法（比如 (5+1)/2）会 <strong>自动向下取整</strong>（不用管小数部分）。</li></ul><p><strong>例子 1：总行数是奇数（total_rows=5）</strong></p><p>比如数据排序后行号 <code>rn=1、2、3、4、5</code>，中位数是第 3 行的值。代入公式计算两个位置：</p><ol><li>第一个位置：<code>(5+1)/2 = 3</code>（整数除法，结果 = 3）；</li><li>第二个位置：<code>(5+2)/2 = 3.5</code>（整数除法，向下取整 = 3）；</li></ol><p>所以 <code>rn IN (3, 3)</code> → 实际筛选 <code>rn=3</code> 的行（只 1 行），用 AVG 计算就是它本身（中位数 = 第 3 行的值）。</p><p><strong>例子 2：总行数是偶数（total_rows=6）</strong></p><p>比如数据排序后行号 <code>rn=1、2、3、4、5、6</code>，中位数是第 3 行和第 4 行的平均值。代入公式计算两个位置：</p><ol><li>第一个位置：<code>(6+1)/2 = 3.5</code>（整数除法，向下取整 = 3）；</li><li>第二个位置：<code>(6+2)/2 = 4</code>（整数除法，结果 = 4）；</li></ol><p>所以 <code>rn IN (3, 4)</code> → 筛选出第 3 行和第 4 行，用 AVG 计算就是这两个值的平均（中位数 =（第 3 行 + 第 4 行）/2）。</p><p><strong>一句话总结公式的巧妙之处</strong></p><ul><li>奇数行：两个公式算出来的位置 <strong>相同</strong> → 只取 1 行；</li><li>偶数行：两个公式算出来的位置 <strong>相邻</strong> → 取 2 行；</li></ul><h2 id="其他问题">其他问题</h2><p><code>UNION ALL</code>：合并结果</p><p><strong>自连接 (Self Join)</strong>: 用于比较表内相同记录（例如，查找薪资高于其经理的员工，查找重复记录）。</p><p><strong>字符串处理</strong>: 文本提取、拼接、模式匹配等。</p><p><strong>日期/时间处理</strong>: 复杂的日期计算、跨时区处理、时间窗口聚合等。</p><p><strong>地理空间查询</strong>: 使用 PostGIS 等扩展进行空间数据分析（在 PostgreSQL 中常见）。</p><p><strong>数据倾斜处理</strong>: 在分布式 SQL 引擎（如 Trino）中，如何识别和处理因数据分布不均导致的性能问题。</p><hr><h1>类型转换</h1><h2 id="日期-时间戳→数值">日期/时间戳→数值</h2><p>各数据库的替代写法</p><table><thead><tr><th style="text-align:left">数据库</th><th style="text-align:left">写法</th></tr></thead><tbody><tr><td style="text-align:left"><strong>PostgreSQL</strong></td><td style="text-align:left"><code>extract(epoch from date)</code></td></tr><tr><td style="text-align:left"><strong>Trino</strong></td><td style="text-align:left"><code>to_unixtime(date)</code></td></tr><tr><td style="text-align:left"><strong>MySQL</strong></td><td style="text-align:left"><code>unix_timestamp(date)</code></td></tr><tr><td style="text-align:left"><strong>Hive</strong></td><td style="text-align:left"><code>unix_timestamp(date)</code></td></tr></tbody></table><p>为什么Unix时间戳更适合回归分析</p><ul><li><strong>Unix时间戳</strong>: 每天均匀增加 <code>86400</code> 秒，适合线性回归</li><li><strong>YYYYMMDD格式</strong>: 数字跳跃很大（<code>20250901</code> → <code>20250902</code>），且间隔不均匀</li></ul><h2 id="函数语法">函数语法</h2><p>全部都支持通用标准转换：<code>cast(expr as type)</code></p><table><thead><tr><th style="text-align:left">数据库</th><th style="text-align:left">专用转换函数</th><th>字符串→日期</th><th>日期→字符串</th><th>字符串→整数</th></tr></thead><tbody><tr><td style="text-align:left"><strong>PostgreSQL</strong></td><td style="text-align:left"><code>::</code>操作符</td><td><code>cast(expr as date)</code></td><td><code>cast(expr as text)</code></td><td><code>cast(expr as integer)</code></td></tr><tr><td style="text-align:left"><strong>Trino</strong></td><td style="text-align:left"><code>try_cast()</code></td><td><code>cast(expr as date)</code></td><td><code>cast(expr as varchar)</code></td><td><code>cast(expr as integer)</code></td></tr><tr><td style="text-align:left"><strong>MySQL</strong></td><td style="text-align:left"><code>convert(),cast()</code></td><td><code>cast(expr as date)</code></td><td><code>cast(expr as char)</code></td><td><code>cast(expr as signed)</code></td></tr><tr><td style="text-align:left"><strong>Hive</strong></td><td style="text-align:left">无<code>try_cast</code></td><td><code>cast(expr as date)</code></td><td><code>cast(expr as string)</code></td><td><code>cast(expr as int)</code></td></tr></tbody></table><p>不同数据库中的数据类型转换，数据库类型按照企业级分类</p><table><thead><tr><th style="text-align:left">分类</th><th style="text-align:left">数据库</th><th style="text-align:left">标准CAST</th><th style="text-align:left">推荐/专用转换语法</th><th style="text-align:left">核心特点与注意事项</th></tr></thead><tbody><tr><td style="text-align:left"><strong>🔒 传统OLTP</strong></td><td style="text-align:left"><strong>PostgreSQL</strong></td><td style="text-align:left">✅</td><td style="text-align:left"><code>expr::type</code> <code>to_char(expr)</code> <code>extract(epoch from expr)</code></td><td style="text-align:left"><strong>类型系统最严格</strong>，转换失败直接报错。功能最丰富，支持自定义类型和运算符。</td></tr><tr><td style="text-align:left"></td><td style="text-align:left"><strong>MySQL</strong></td><td style="text-align:left">✅</td><td style="text-align:left"><code>CONVERT(expr, type)</code> <code>DATE_FORMAT(...)</code> <code>CAST(expr as signed)</code></td><td style="text-align:left"><strong>隐式转换宽松</strong>，可能导致意外结果。例如，字符串转数字会截取开头部分。</td></tr><tr><td style="text-align:left"><strong>🚀 大数据OLAP</strong></td><td style="text-align:left"><strong>Trino/Presto</strong></td><td style="text-align:left">✅</td><td style="text-align:left"><strong><code>try_cast(expr as type)</code></strong> <code>to_unixtime(expr)</code> <code>format_datetime(expr)</code></td><td style="text-align:left"><strong>强调稳定性</strong>。<code>try_cast</code>转换失败返回<code>NULL</code>，是ETL任务首选。类型名多用<code>VARCHAR</code>。</td></tr><tr><td style="text-align:left"></td><td style="text-align:left"><strong>Spark SQL</strong></td><td style="text-align:left">✅</td><td style="text-align:left"><code>try_cast(expr as type)</code> (新版本) <code>date_format(...)</code> <code>unix_timestamp(...)</code></td><td style="text-align:left">与Trino理念类似，但函数名更接近Hive。处理脏数据时推荐使用<code>try_cast</code>。</td></tr><tr><td style="text-align:left"></td><td style="text-align:left"><strong>Hive</strong></td><td style="text-align:left">✅</td><td style="text-align:left"><code>unix_timestamp(...)</code> <code>from_unixtime(...)</code> <code>date_format(...)</code></td><td style="text-align:left"><strong>“读时模式”</strong>，转换相对宽松。版本间行为可能有变（如Hive 3时间戳时区处理）。</td></tr><tr><td style="text-align:left"><strong>🌐 云原生HTAP</strong></td><td style="text-align:left"><strong>TiDB</strong></td><td style="text-align:left">✅</td><td style="text-align:left"><code>CONVERT(expr, type)</code> <code>DATE_FORMAT(...)</code></td><td style="text-align:left"><strong>高度兼容MySQL语法</strong>，但作为分布式系统，某些函数（如<code>CONVERT</code>）的行为旨在确保集群一致性。</td></tr><tr><td style="text-align:left"><strong>📈 专用OLAP</strong></td><td style="text-align:left"><strong>ClickHouse</strong></td><td style="text-align:left">✅</td><td style="text-align:left"><strong><code>accurateCast(expr, type)</code></strong> <code>toUnixTimestamp(...)</code> <code>toString(...)</code></td><td style="text-align:left"><strong>类型转换函数家族庞大</strong>。<code>accurateCast</code>更安全（范围检查），<code>cast</code>会尝试尽力转换。</td></tr></tbody></table><h1>其他</h1><h2 id="临时表CTE">临时表CTE</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> if <span class="keyword">exists</span> aaa_tmp;</span><br><span class="line"><span class="keyword">create table</span> aaa_tmp <span class="keyword">as</span></span><br><span class="line"><span class="keyword">with</span> tmp1 <span class="keyword">as</span>(</span><br><span class="line"></span><br><span class="line">),</span><br><span class="line"><span class="keyword">with</span> tmp2 <span class="keyword">as</span>(</span><br><span class="line">)</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t;</span><br></pre></td></tr></table></figure><h2 id="注释">注释</h2><ol><li>单行注释以两个连续的连字符 <code>--</code> 开头</li><li>多行注释以 <code>/*</code> 开头，以 <code>*/</code> 结尾，可跨越多行</li></ol><h2 id="别名">别名</h2><ul><li>什么时候要用别名</li><li>列举所有情况</li><li>哪些情况可以省略as关键字</li></ul><p>在 SQL 中，只要“某个东西”需要被当作一个独立的数据源来引用，就必须给它起别名。</p><p>在标准 SQL 里，别名前的关键字 <code>AS</code> 纯粹是“装饰”，任何场景都可以省。除了“别名本身是关键字或含空格”需要引号包裹以外，<code>AS</code> 写不写随你口味；主流数据库（MySQL、PG、SQL Server、Oracle、SQLite）全部允许省。</p><p>一、必须起别名（省略就报错）</p><table><thead><tr><th>场景</th><th>示例</th><th>不报错的写法</th><th>报错的写法</th></tr></thead><tbody><tr><td>1. 派生表/内联视图</td><td><code>SELECT * FROM (SELECT …) AS a</code></td><td><code>… ) AS a</code></td><td><code>… )</code></td></tr><tr><td>2. 公用表表达式递归部分</td><td><code>WITH RECURSIVE cte(n) AS (SELECT 1 UNION SELECT n+1 FROM cte)</code></td><td>递归部分引用自己 <code>cte</code></td><td>无别名无法递归</td></tr><tr><td>3. 窗口函数计算列</td><td><code>ROW_NUMBER() OVER (…) AS rn</code></td><td><code>… AS rn</code></td><td><code>ROW_NUMBER() OVER(…)</code> 裸写</td></tr><tr><td>4. VALUES 构造的表</td><td><code>SELECT * FROM (VALUES (1),(2)) AS v(col)</code></td><td><code>AS v(col)</code></td><td><code>FROM (VALUES …)</code></td></tr><tr><td>5. LATERAL(横向子查询)</td><td><code>SELECT * FROM t, LATERAL (SELECT …) AS lat</code></td><td><code>AS lat</code></td><td>无别名语法错</td></tr><tr><td>6. JOIN 里的匿名表</td><td><code>… JOIN (SELECT …) AS j ON …</code></td><td><code>AS j</code></td><td><code>JOIN (SELECT …) ON …</code></td></tr><tr><td>7. 多表同名字段</td><td><code>SELECT a.id, b.id FROM ta a JOIN tb b</code></td><td>表别名 <code>a/b</code> 区分</td><td>直接写 <code>id</code> 歧义报错</td></tr></tbody></table><p>二、强烈建议起别名（不会报错，但失去可读性/功能）</p><table><thead><tr><th>场景</th><th>作用</th></tr></thead><tbody><tr><td>8. 任何表达式/计算列</td><td><code>SELECT price*qty AS amount</code> —— 外层或应用代码好引用</td></tr><tr><td>9. 多表连接</td><td><code>FROM user u JOIN order o ON u.id=o.user_id</code> —— 省打字、防歧义</td></tr><tr><td>10. 自连接</td><td><code>FROM employee e JOIN employee m ON e.manager_id=m.id</code> —— 同表不同角色</td></tr><tr><td>11. 聚合函数结果</td><td><code>SELECT SUM(sales) AS total_sales</code> —— 给应用/报表一个稳定列名</td></tr><tr><td>12. 子查询列被外部引用</td><td>外层 <code>WHERE total &gt; 1000</code> 需要内层 <code>SUM(x) AS total</code></td></tr><tr><td>13. 需要排序或分页</td><td><code>ORDER BY rn</code> 需要前面 <code>ROW_NUMBER() OVER … AS rn</code></td></tr><tr><td>14. 导出/BI 工具</td><td>列别名直接变成报表字段名，避免“?column?”、“expr_1”</td></tr></tbody></table><h2 id="VALUES-构造的表"><code>VALUES</code> 构造的表</h2><p>就是：不写真正的物理表，用“手写常量”临时造一张内存表，查询完就消失。 语法核心只有一句：</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">VALUES</span> (row1_col1, row1_col2, ...)</span><br><span class="line">    ,(...)</span><br><span class="line">    ,(...)</span><br></pre></td></tr></table></figure><blockquote><p>前面再加一对括号、起个别名，就能当派生表用。</p></blockquote><p><strong>典型用途</strong></p><ol><li>快速造测试数据，不写 <code>CREATE TABLE</code></li><li>把零散常量拼成结果集，再与其他表 <code>JOIN</code></li><li><code>INSERT INTO</code>时一次性插入多行</li><li>在 <code>WITH</code> 里当 CTE（PostgreSQL / MySQL 8+ 直接跑）:</li></ol><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">WITH</span> region(code, name) <span class="keyword">AS</span> (</span><br><span class="line">    <span class="keyword">VALUES</span> (<span class="string">&#x27;BJ&#x27;</span>,<span class="string">&#x27;北京&#x27;</span>)</span><br><span class="line">    ,(<span class="string">&#x27;SH&#x27;</span>,<span class="string">&#x27;上海&#x27;</span>)</span><br><span class="line">)</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> region;</span><br></pre></td></tr></table></figure><blockquote><p>注意：若表中存在自增列、默认值列或非空约束列，不指定列名时容易因顺序错误导致插入失败，<strong>推荐优先使用 “指定列名” 的方式</strong>。</p></blockquote><p><strong>规则速记</strong></p><ul><li>每行括号里的列数必须相同</li><li>前面整体必须再起别名 <code>AS alias(col1, col2, …)</code>，否则语法报错</li><li>数据只在本次查询生命周期存在，不会落盘</li></ul><blockquote><p><code>alias</code> 指<strong>别名</strong>，即给表、列或表达式起一个临时的简短名称，用于简化查询语句、提高可读性，或避免名称冲突（比如多表关联时列名重复）</p></blockquote><h2 id="格式化风格">格式化风格</h2><ul><li><strong>关键字小写</strong></li><li><strong>字段</strong>分行罗列</li><li><strong>逗号前置</strong>设计便于字段注释，也降低增删字段的出错率</li><li>每个逻辑块（CTE、主查询）独立成块</li><li>层级缩进（CTE、CASE、字段列表都有缩进）</li></ul><h1>刷题</h1><h2 id="Leetcode">Leetcode</h2><h2 id="牛客">牛客</h2><p><a href="https://www.nowcoder.com/practice/126083961ae0415fbde061d7ebbde453?tpId=199&amp;tags=&amp;title=&amp;difficulty=0&amp;judgeStatus=0&amp;rp=0&amp;sourceUrl=%2Fexam%2Fcompany">SQL29 计算用户的平均次日留存率</a></p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">with</span> tmp <span class="keyword">as</span>(</span><br><span class="line">    <span class="keyword">select</span></span><br><span class="line">    device_id</span><br><span class="line">    ,<span class="type">date</span></span><br><span class="line">    <span class="keyword">from</span> question_practice_detail</span><br><span class="line">    <span class="keyword">group</span> <span class="keyword">by</span> <span class="number">1</span>,<span class="number">2</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">select</span></span><br><span class="line"><span class="built_in">count</span>(b.device_id) <span class="operator">/</span> <span class="built_in">count</span>(a.device_id) <span class="keyword">as</span> avg_ret</span><br><span class="line"><span class="keyword">from</span> tmp a</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> tmp b</span><br><span class="line"><span class="keyword">on</span> a.device_id <span class="operator">=</span> b.device_id</span><br><span class="line"><span class="keyword">and</span> a.date <span class="operator">=</span> date_sub(b.date, <span class="type">interval</span> <span class="number">1</span> <span class="keyword">day</span>)</span><br></pre></td></tr></table></figure><ul><li>步骤1：获取每个用户每天的刷题日期（去重）<br>步骤2：通过<strong>自连接</strong>，将每个用户每天的记录与第二天的记录连接起来。<br>步骤3：统计所有的记录数作为分母，统计第二天有记录的记录数作为分子，然后计算比例。</li><li>自连接说的是inner join吗<ul><li>我们通常说自连接（self-join）是指同一个表自己和自己连接，可以使用INNER JOIN，也可以使用LEFT JOIN等</li></ul></li></ul><p><a href="https://www.nowcoder.com/practice/53235096538a456b9220fce120c062b3?tpId=199&amp;tqId=1980673&amp;sourceUrl=%2Fexam%2Fcompany">SQL34 统计复旦用户8月练题情况</a></p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">t1.device_id <span class="keyword">as</span> device_id</span><br><span class="line">,t1.university <span class="keyword">as</span> university</span><br><span class="line">,<span class="built_in">count</span>(t2.question_id) <span class="keyword">as</span> question_cnt</span><br><span class="line">,<span class="built_in">sum</span>(<span class="keyword">case</span> <span class="keyword">when</span> t2.result<span class="operator">=</span><span class="string">&#x27;right&#x27;</span> <span class="keyword">then</span> <span class="number">1</span> <span class="keyword">else</span> <span class="number">0</span> <span class="keyword">end</span>) <span class="keyword">as</span> right_question_cnt</span><br><span class="line"><span class="keyword">from</span> user_profile t1</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> question_practice_detail t2</span><br><span class="line"><span class="keyword">on</span> t1.device_id<span class="operator">=</span>t2.device_id</span><br><span class="line"><span class="keyword">and</span> t2.date <span class="operator">&gt;=</span> <span class="string">&#x27;2021-08-01&#x27;</span></span><br><span class="line"><span class="keyword">and</span> t2.date <span class="operator">&lt;=</span> <span class="string">&#x27;2021-08-31&#x27;</span></span><br><span class="line"><span class="keyword">where</span> t1.university<span class="operator">=</span><span class="string">&#x27;复旦大学&#x27;</span></span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> <span class="number">1</span></span><br></pre></td></tr></table></figure><ul><li>日期在t2<ul><li>join时，在on子句就要过滤！</li><li>如果把日期条件放在<code>where</code>子句中，<code>left join</code>会退化成<code>inner join</code>，无法显示未练习的用户</li></ul></li><li>question_cnt数做了多少题</li><li>right_question_cnt把答对的题标记为1，把这些1相加</li></ul><p><a href="https://www.nowcoder.com/practice/356a64a402864b27a9ab47d0c032756d?tpId=375&amp;tags=&amp;title=&amp;difficulty=0&amp;judgeStatus=0&amp;rp=0&amp;sourceUrl=%2Fexam%2Foj%3FquestionJobId%3D10%26subTabName%3Donline_coding_page"><strong>SQL126</strong> <strong>最畅销的SKU</strong></a></p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">with</span></span><br><span class="line">tmp_latest <span class="keyword">as</span>(</span><br><span class="line">    <span class="keyword">select</span> <span class="built_in">max</span>(snapshot_date) <span class="keyword">as</span> latest_date</span><br><span class="line">    <span class="keyword">from</span> store_stock_</span><br><span class="line">),</span><br><span class="line">tmp_stock <span class="keyword">as</span>(</span><br><span class="line">    <span class="keyword">select</span></span><br><span class="line">        t1.store_id</span><br><span class="line">        ,t1.sku_id</span><br><span class="line">        ,t1.stock_qty</span><br><span class="line">        ,<span class="built_in">coalesce</span>(<span class="built_in">sum</span>(t3.qty), <span class="number">0</span>) <span class="keyword">as</span> last7d_qty</span><br><span class="line">    <span class="keyword">from</span> store_stock_ t1</span><br><span class="line">    <span class="keyword">cross</span> <span class="keyword">join</span> tmp_latest t2  <span class="comment">-- 将基准日期传递给每行数据</span></span><br><span class="line">    <span class="keyword">left</span> <span class="keyword">join</span> sales_daily_ t3   <span class="comment">-- 左连接确保无销量的SKU也能保留</span></span><br><span class="line">        <span class="keyword">on</span> t1.store_id<span class="operator">=</span>t3.store_id </span><br><span class="line">        <span class="keyword">and</span> t1.sku_id<span class="operator">=</span>t3.sku_id</span><br><span class="line">        <span class="keyword">and</span> t3.sale_date <span class="operator">&gt;=</span> date_sub(t2.latest_date, <span class="type">interval</span> <span class="number">6</span> <span class="keyword">day</span>)</span><br><span class="line">    <span class="keyword">where</span> t1.snapshot_date<span class="operator">=</span>t2.latest_date <span class="comment">-- 只取最新快照日的库存量</span></span><br><span class="line">    <span class="keyword">group</span> <span class="keyword">by</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span></span><br><span class="line">),</span><br><span class="line">tmp_analysis <span class="keyword">as</span>(</span><br><span class="line">    <span class="keyword">select</span></span><br><span class="line">        t1.<span class="operator">*</span></span><br><span class="line">        ,round(t1.last7d_qty <span class="operator">/</span> <span class="number">7</span>, <span class="number">2</span>) <span class="keyword">as</span> avg_daily_qty</span><br><span class="line">        ,<span class="built_in">row_number</span>() <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> t1.store_id <span class="keyword">order</span> <span class="keyword">by</span> t1.last7d_qty <span class="keyword">DESC</span>, t1.sku_id <span class="keyword">ASC</span>) <span class="keyword">as</span> rank_in_store</span><br><span class="line">    <span class="keyword">from</span> tmp_stock t1</span><br><span class="line">)</span><br><span class="line"><span class="keyword">select</span></span><br><span class="line">    t1.store_id</span><br><span class="line">    ,t1.store_name</span><br><span class="line">    ,t1.city</span><br><span class="line">    ,t.sku_id</span><br><span class="line">    ,t.last7d_qty</span><br><span class="line">    ,t.avg_daily_qty</span><br><span class="line">    ,t.stock_qty</span><br><span class="line">    ,<span class="keyword">case</span> <span class="keyword">when</span> t.avg_daily_qty<span class="operator">&gt;</span><span class="number">0</span> <span class="keyword">then</span> round(t.stock_qty<span class="operator">/</span>t.avg_daily_qty, <span class="number">1</span>) <span class="keyword">else</span> <span class="keyword">null</span> <span class="keyword">end</span> <span class="keyword">as</span> coverage_days</span><br><span class="line">    ,t.rank_in_store</span><br><span class="line"><span class="keyword">from</span> tmp_analysis t</span><br><span class="line"><span class="keyword">join</span> store_info_ t1 <span class="keyword">on</span> t.store_id<span class="operator">=</span>t1.store_id</span><br><span class="line"><span class="keyword">where</span> t.rank_in_store <span class="operator">&lt;=</span> <span class="number">3</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> store_id, rank_in_store</span><br></pre></td></tr></table></figure><ul><li>统计近7天，包含当天，就是 <code>interval 6 day</code>，很常用：</li></ul><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">with</span></span><br><span class="line">tmp_latest <span class="keyword">as</span>(</span><br><span class="line">    <span class="keyword">select</span> <span class="built_in">max</span>(snapshot_date) <span class="keyword">as</span> latest_date</span><br><span class="line">    <span class="keyword">from</span> store_stock_</span><br><span class="line">),</span><br><span class="line">tmp_stock <span class="keyword">as</span>(</span><br><span class="line">    <span class="keyword">select</span></span><br><span class="line">        字段</span><br><span class="line">    <span class="keyword">from</span> store_stock_ t1</span><br><span class="line">    <span class="keyword">cross</span> <span class="keyword">join</span> tmp_latest t2</span><br><span class="line">    <span class="keyword">where</span> t1.snapshot_date <span class="operator">&gt;=</span> date_sub(t2.latest_date, <span class="type">interval</span> <span class="number">6</span> <span class="keyword">day</span>)</span><br><span class="line">)</span><br></pre></td></tr></table></figure><ul><li><p><code>cross join</code>因为<code>tmp_latest</code>只有一行，性能影响极小</p></li><li><p>思路</p><ul><li>库存表→<code>left join</code>→销量表；另一个是门店主数据（信息表）最后再用</li></ul></li><li><p>因为要筛选窗口函数➕<code>coverage_days</code>是<code>avg_daily_qty</code>的衍生计算</p><ul><li>所以再加一个CTE</li></ul></li></ul><p><a href="https://www.nowcoder.com/practice/07beee54ac62455586016ea1b018d371?tpId=375&amp;tags=&amp;title=&amp;difficulty=0&amp;judgeStatus=0&amp;rp=0&amp;sourceUrl=%2Fexam%2Foj%3FquestionJobId%3D10%26subTabName%3Donline_coding_page"><strong>SQL127</strong> <strong>统计每个班级的关键指标</strong></a></p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">with</span></span><br><span class="line">tmp_enroll <span class="keyword">as</span>(</span><br><span class="line">    <span class="keyword">select</span></span><br><span class="line">        class_id</span><br><span class="line">        ,<span class="built_in">count</span>(<span class="keyword">distinct</span> student_id) <span class="keyword">as</span> learners_enrolled</span><br><span class="line">    <span class="keyword">from</span> course_enroll_</span><br><span class="line">    <span class="keyword">group</span> <span class="keyword">by</span> <span class="number">1</span></span><br><span class="line">),</span><br><span class="line">tmp_logs <span class="keyword">as</span>(</span><br><span class="line">    <span class="keyword">select</span></span><br><span class="line">        class_id</span><br><span class="line">        ,<span class="built_in">count</span>(<span class="keyword">distinct</span> student_id) <span class="keyword">as</span> learners_active_m</span><br><span class="line">        ,<span class="built_in">count</span>(<span class="keyword">distinct</span> <span class="keyword">case</span> <span class="keyword">when</span> finished_flag<span class="operator">=</span><span class="number">1</span> <span class="keyword">then</span> student_id <span class="keyword">end</span>) <span class="keyword">as</span> finishers_m</span><br><span class="line">        ,<span class="built_in">sum</span>(watch_minutes) <span class="keyword">as</span> total_minutes_m</span><br><span class="line">    <span class="keyword">from</span> study_logs_</span><br><span class="line">    <span class="keyword">where</span> log_ts <span class="operator">&gt;=</span> <span class="string">&#x27;2024-08-01&#x27;</span></span><br><span class="line">    <span class="keyword">and</span> log_ts <span class="operator">&lt;</span> <span class="string">&#x27;2024-09-01&#x27;</span></span><br><span class="line">    <span class="keyword">group</span> <span class="keyword">by</span> <span class="number">1</span></span><br><span class="line">),</span><br><span class="line">tmp_all <span class="keyword">as</span>(</span><br><span class="line">    <span class="keyword">select</span></span><br><span class="line">        class_id</span><br><span class="line">        ,course_id</span><br><span class="line">        ,teacher_id</span><br><span class="line">    <span class="keyword">from</span> course_class_</span><br><span class="line">),</span><br><span class="line">tmp <span class="keyword">as</span>(</span><br><span class="line">    <span class="keyword">select</span></span><br><span class="line">        t.class_id</span><br><span class="line">        ,t.course_id</span><br><span class="line">        ,t.teacher_id</span><br><span class="line">        ,t1.learners_enrolled</span><br><span class="line">        ,t2.learners_active_m</span><br><span class="line">        ,t2.finishers_m</span><br><span class="line">        ,<span class="keyword">case</span></span><br><span class="line">            <span class="keyword">when</span> t2.learners_active_m<span class="operator">=</span><span class="number">0</span> <span class="keyword">then</span> <span class="number">0</span></span><br><span class="line">            <span class="keyword">else</span> round(t2.finishers_m<span class="operator">/</span>t2.learners_active_m, <span class="number">2</span>)</span><br><span class="line">        <span class="keyword">end</span> <span class="keyword">as</span> completion_rate</span><br><span class="line">        ,t2.total_minutes_m</span><br><span class="line">        ,<span class="keyword">case</span></span><br><span class="line">            <span class="keyword">when</span> t2.learners_active_m<span class="operator">=</span><span class="number">0</span> <span class="keyword">then</span> <span class="number">0</span></span><br><span class="line">            <span class="keyword">else</span> round(t2.total_minutes_m<span class="operator">/</span>t2.learners_active_m, <span class="number">2</span>)</span><br><span class="line">        <span class="keyword">end</span> <span class="keyword">as</span> avg_minutes_per_active</span><br><span class="line">    <span class="keyword">from</span> tmp_all t</span><br><span class="line">    <span class="keyword">left</span> <span class="keyword">join</span> tmp_enroll t1 <span class="keyword">on</span> t.class_id<span class="operator">=</span>t1.class_id</span><br><span class="line">    <span class="keyword">left</span> <span class="keyword">join</span> tmp_logs t2 <span class="keyword">on</span> t.class_id<span class="operator">=</span>t2.class_id</span><br><span class="line">)</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span></span><br><span class="line">    ,<span class="built_in">rank</span>() <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> course_id <span class="keyword">order</span> <span class="keyword">by</span> avg_minutes_per_active <span class="keyword">DESC</span>) <span class="keyword">as</span> rank_in_course</span><br><span class="line"><span class="keyword">from</span> tmp</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> course_id, rank_in_course, class_id</span><br></pre></td></tr></table></figure><ul><li><p>finishers_m：当月至少完成过1节课的去重人数<code>count(distinct case when finished_flag=1 then student_id end)</code></p><ul><li>表study_logs_</li><li>字段finished_flag 非空（1=本条日志对应课节完成）</li></ul></li><li><p>不要急着写 SQL，先把业务需求翻译成数学公式：</p><table><thead><tr><th style="text-align:left">指标</th><th style="text-align:left">数据来源</th><th style="text-align:left">计算逻辑</th></tr></thead><tbody><tr><td style="text-align:left"><code>learners_enrolled</code></td><td style="text-align:left"><code>course_enroll_</code></td><td style="text-align:left"><code>count(distinct student_id)</code>（全量）</td></tr><tr><td style="text-align:left"><code>learners_active_m</code></td><td style="text-align:left"><code>study_logs_</code></td><td style="text-align:left"><code>count(distinct student_id)</code>（2024-08 日志）</td></tr><tr><td style="text-align:left"><code>finishers_m</code></td><td style="text-align:left"><code>study_logs_</code></td><td style="text-align:left"><code>count(distinct case when finished_flag=1 then student_id end)</code></td></tr><tr><td style="text-align:left"><code>completion_rate</code></td><td style="text-align:left">衍生</td><td style="text-align:left"><code>finishers_m / learners_active_m</code><strong>（防除零）</strong></td></tr><tr><td style="text-align:left"><code>total_minutes_m</code></td><td style="text-align:left"><code>study_logs_</code></td><td style="text-align:left"><code>SUM(watch_minutes)</code></td></tr><tr><td style="text-align:left"><code>avg_minutes_per_active</code></td><td style="text-align:left">衍生</td><td style="text-align:left"><code>total_minutes_m / learners_active_m</code><strong>（防除零）</strong></td></tr><tr><td style="text-align:left"><code>rank_in_course</code></td><td style="text-align:left">衍生</td><td style="text-align:left">同 course 内按 <code>avg_minutes_per_active</code> 降序排名</td></tr></tbody></table><p><strong>关键洞察</strong>：只有 <code>learners_enrolled</code> 依赖报名流水，其余指标都依赖日志表。可以并行计算。</p></li><li><p><strong>独立聚合 → 各算各的</strong>，先CTE让每张表&quot;单独干活&quot;，避免过早 JOIN 导致数据膨胀</p></li><li><p>业务要求&quot;每个班级一行&quot;，即使当月无日志也要输出。因此必须<strong>以班级表为主表</strong>tmp_all</p></li><li><p><strong>“COUNT 不怕空，SUM 会空空”</strong> → <code>coalesce</code> 别漏掉 <code>SUM()</code> 字段</p></li><li><p><strong>“除法先判零”</strong> → 业务零容忍除零错误</p></li></ul><p><a href="https://www.nowcoder.com/practice/5f0155102879494c8707f749156f9af3?tpId=375&amp;tags=&amp;title=&amp;difficulty=0&amp;judgeStatus=0&amp;rp=0&amp;sourceUrl=%2Fexam%2Foj%3FquestionJobId%3D10%26subTabName%3Donline_coding_page"><strong>SQL128</strong> <strong>统计创作者</strong></a></p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">with</span></span><br><span class="line">tmp_latest <span class="keyword">as</span>(</span><br><span class="line">    <span class="keyword">select</span> <span class="built_in">max</span>(publish_ts) <span class="keyword">as</span> latest_ts</span><br><span class="line">    <span class="keyword">from</span> post</span><br><span class="line">),</span><br><span class="line">tmp_post <span class="keyword">as</span>(</span><br><span class="line">    <span class="keyword">select</span></span><br><span class="line">        t1.author_id</span><br><span class="line">        ,<span class="built_in">count</span>(t1.post_id) <span class="keyword">as</span> posts_30d</span><br><span class="line">        ,<span class="built_in">sum</span>(t1.like_cnt) <span class="keyword">as</span> likes_30d</span><br><span class="line">    <span class="keyword">from</span> post t1</span><br><span class="line">    <span class="keyword">cross</span> <span class="keyword">join</span> tmp_latest t2</span><br><span class="line">    <span class="keyword">where</span> t1.publish_ts <span class="operator">&gt;=</span> date_sub(t2.latest_ts, <span class="type">interval</span> <span class="number">29</span> <span class="keyword">day</span>)</span><br><span class="line">    <span class="keyword">group</span> <span class="keyword">by</span> <span class="number">1</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">select</span> </span><br><span class="line">    t.author_id</span><br><span class="line">    ,t.author_name</span><br><span class="line">    ,t1.posts_30d</span><br><span class="line">    ,t1.likes_30d</span><br><span class="line">    ,<span class="keyword">case</span> </span><br><span class="line">        <span class="keyword">when</span> t1.posts_30d <span class="operator">=</span> <span class="number">0</span> <span class="keyword">then</span> <span class="number">0</span></span><br><span class="line">        <span class="keyword">else</span> round(t1.likes_30d<span class="operator">/</span>t1.posts_30d, <span class="number">2</span>)</span><br><span class="line">    <span class="keyword">end</span> <span class="keyword">as</span> avg_likes_30d</span><br><span class="line"><span class="keyword">from</span> author t</span><br><span class="line"><span class="keyword">join</span> tmp_post t1 <span class="keyword">on</span> t.author_id<span class="operator">=</span>t1.author_id</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> </span><br><span class="line">    likes_30d <span class="keyword">DESC</span></span><br><span class="line">    ,posts_30d <span class="keyword">DESC</span></span><br><span class="line">    ,author_id <span class="keyword">ASC</span></span><br><span class="line">limit <span class="number">5</span></span><br></pre></td></tr></table></figure><ul><li><p>步骤</p><ul><li>获取所有帖子中最新的发布时间，作为统计基准日（动态描点）</li><li>统计每位作者在近30天窗口内的发文表现。按作者id分组聚合</li><li>关联作者信息</li></ul></li><li><p>易错点</p><ul><li>avg_likes_30d（发文为 0 时记 0）</li><li>这次把发文为0的也要输出，所以join的时候不用筛</li></ul></li><li><p><mark>很常用的</mark></p></li></ul><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">case</span></span><br><span class="line"><span class="keyword">when</span> 【字段<span class="operator">=</span><span class="number">0</span>】<span class="keyword">then</span> <span class="number">0</span></span><br><span class="line"><span class="keyword">when</span> 【字段 <span class="keyword">is</span> <span class="keyword">null</span>】 <span class="keyword">then</span> <span class="number">0</span></span><br><span class="line"><span class="keyword">else</span> 公式【round(被除数<span class="operator">/</span>除数, <span class="number">2</span>)】</span><br><span class="line"><span class="keyword">end</span> <span class="keyword">as</span> 字段名    </span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">case</span></span><br><span class="line"><span class="keyword">when</span> 条件 <span class="keyword">then</span> <span class="number">0</span></span><br><span class="line"><span class="keyword">else</span> 公式</span><br><span class="line"><span class="keyword">end</span> <span class="keyword">as</span> 字段名</span><br></pre></td></tr></table></figure><ul><li>case子句等价于</li></ul><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">,<span class="built_in">coalesce</span>(round(t1.likes_30d <span class="operator">/</span> <span class="built_in">nullif</span>(t1.posts_30d, <span class="number">0</span>), <span class="number">2</span>), <span class="number">0</span>) <span class="keyword">as</span> avg_likes_30d</span><br></pre></td></tr></table></figure><p><a href="https://www.nowcoder.com/practice/25af5a3296c747f5b01fc589f1568514?tpId=375&amp;tags=&amp;title=&amp;difficulty=0&amp;judgeStatus=0&amp;rp=0&amp;sourceUrl=%2Fexam%2Foj%3FquestionJobId%3D10%26subTabName%3Donline_coding_page"><strong>SQL129</strong> <strong>近7天骑手履约时效看板</strong></a></p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">with</span></span><br><span class="line">tmp_latest <span class="keyword">as</span>(</span><br><span class="line">    <span class="keyword">select</span> <span class="built_in">max</span>(delivered_ts) <span class="keyword">as</span> latest_ts</span><br><span class="line">    <span class="keyword">from</span> parcel</span><br><span class="line">),</span><br><span class="line">tmp_parcel <span class="keyword">as</span>(</span><br><span class="line">    <span class="keyword">select</span></span><br><span class="line">    t1.courier_id</span><br><span class="line">    ,t1.shipped_ts</span><br><span class="line">    ,t1.delivered_ts</span><br><span class="line">    ,t1.promised_minutes</span><br><span class="line">    ,timestampdiff(<span class="keyword">minute</span>, t1.shipped_ts, t1.delivered_ts) <span class="keyword">as</span> delivery_minutes</span><br><span class="line">    ,<span class="keyword">case</span> <span class="keyword">when</span> timestampdiff(<span class="keyword">minute</span>, t1.shipped_ts, t1.delivered_ts) <span class="operator">&lt;=</span> t1.promised_minutes <span class="keyword">then</span> <span class="number">1</span> <span class="keyword">else</span> <span class="number">0</span> <span class="keyword">end</span> <span class="keyword">as</span> is_on_time</span><br><span class="line">    <span class="keyword">from</span> parcel t1</span><br><span class="line">    <span class="keyword">cross</span> <span class="keyword">join</span> tmp_latest t2</span><br><span class="line">    <span class="keyword">where</span> t1.delivered_ts <span class="operator">&gt;=</span> date_sub(t2.latest_ts, <span class="type">interval</span> <span class="number">6</span> <span class="keyword">day</span>)</span><br><span class="line">),</span><br><span class="line">tmp_courier <span class="keyword">as</span>(</span><br><span class="line">    <span class="keyword">select</span></span><br><span class="line">        t1.courier_id</span><br><span class="line">        ,t1.courier_name</span><br><span class="line">        ,t1.city</span><br><span class="line">        ,<span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">as</span> orders_7d</span><br><span class="line">        ,<span class="built_in">sum</span>(t2.is_on_time) <span class="keyword">as</span> on_time_7d</span><br><span class="line">        ,round(<span class="built_in">sum</span>(t2.is_on_time)<span class="operator">/</span><span class="built_in">count</span>(<span class="operator">*</span>), <span class="number">2</span>) <span class="keyword">as</span> on_time_rate</span><br><span class="line">        ,round(<span class="built_in">avg</span>(t2.delivery_minutes), <span class="number">2</span>) <span class="keyword">as</span> avg_minutes_7d</span><br><span class="line">    <span class="keyword">from</span> courier t1</span><br><span class="line">    <span class="keyword">join</span> tmp_parcel t2 <span class="keyword">on</span> t1.courier_id<span class="operator">=</span>t2.courier_id</span><br><span class="line">    <span class="keyword">group</span> <span class="keyword">by</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">select</span></span><br><span class="line">    courier_id</span><br><span class="line">    ,courier_name</span><br><span class="line">    ,city</span><br><span class="line">    ,orders_7d</span><br><span class="line">    ,on_time_7d</span><br><span class="line">    ,on_time_rate</span><br><span class="line">    ,avg_minutes_7d</span><br><span class="line">    ,<span class="built_in">rank</span>() <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> city <span class="keyword">order</span> <span class="keyword">by</span> on_time_rate <span class="keyword">DESC</span>,avg_minutes_7d <span class="keyword">ASC</span>) <span class="keyword">as</span> rank_in_city</span><br><span class="line"><span class="keyword">from</span> tmp_courier</span><br><span class="line"><span class="keyword">where</span> orders_7d <span class="operator">&gt;</span> <span class="number">0</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> city,rank_in_city,courier_id</span><br></pre></td></tr></table></figure><ul><li>步骤</li><li>获取最新送达时间作为基准日</li><li>过滤近7天包裹，计算每单配送时长和是否准时</li><li>按骑手聚合统计近7天指标</li><li>计算排名并输出最终结果</li><li>易错点：<ul><li>尽量把聚合和窗口函数用CTE分开</li></ul></li><li><code>where orders_7d &gt; 0</code><ul><li>这道题可过滤也可不过滤，但是现实情况下我们关注的都是有真实履约行为的骑手，没订单的骑手没有分析价值</li><li>不对，我已经做了筛选：由于 <code>tmp_courier</code> 使用的是 <strong><code>INNER JOIN</code></strong>，本身就只返回有订单的快递员。</li></ul></li></ul><p><a href="https://www.nowcoder.com/practice/d5693e529a514ed390f097d395ad481d?tpId=375&amp;tags=&amp;title=&amp;difficulty=0&amp;judgeStatus=0&amp;rp=0&amp;sourceUrl=%2Fexam%2Foj%3FquestionJobId%3D10%26subTabName%3Donline_coding_page">SQL130 目标月份的品类销售简报</a></p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">with</span> tmp_orders <span class="keyword">as</span>(</span><br><span class="line">    <span class="keyword">select</span> order_id,buyer_id</span><br><span class="line">    <span class="keyword">from</span> orders</span><br><span class="line">    <span class="keyword">where</span> order_date <span class="operator">&gt;=</span> <span class="string">&#x27;2024-08-01&#x27;</span> </span><br><span class="line">    <span class="keyword">and</span> order_date <span class="operator">&lt;=</span> <span class="string">&#x27;2024-08-31&#x27;</span></span><br><span class="line"></span><br><span class="line">),</span><br><span class="line">tmp <span class="keyword">as</span>(</span><br><span class="line">    <span class="keyword">select</span> </span><br><span class="line">        t3.category <span class="keyword">as</span> category</span><br><span class="line">        ,<span class="built_in">count</span>(<span class="keyword">distinct</span> t1.order_id) <span class="keyword">as</span> orders_cnt</span><br><span class="line">        ,<span class="built_in">count</span>(<span class="keyword">distinct</span> t1.buyer_id) <span class="keyword">as</span> buyers_cnt</span><br><span class="line">        ,<span class="built_in">sum</span>(t2.qty) <span class="keyword">as</span> items_qty</span><br><span class="line">        ,<span class="built_in">sum</span>(t2.qty<span class="operator">*</span>t3.price) <span class="keyword">as</span> revenue</span><br><span class="line">    <span class="keyword">from</span> tmp_orders t1</span><br><span class="line">    <span class="keyword">join</span> order_items t2 <span class="keyword">on</span> t1.order_id<span class="operator">=</span>t2.order_id</span><br><span class="line">    <span class="keyword">join</span> product t3 <span class="keyword">on</span> t2.product_id<span class="operator">=</span>t3.product_id</span><br><span class="line">    <span class="keyword">group</span> <span class="keyword">by</span> <span class="number">1</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span></span><br><span class="line">    ,round(revenue<span class="operator">/</span>orders_cnt, <span class="number">2</span>) <span class="keyword">as</span> avg_order_value</span><br><span class="line">    ,<span class="built_in">rank</span>() <span class="keyword">over</span>(<span class="keyword">order</span> <span class="keyword">by</span> revenue <span class="keyword">DESC</span>, orders_cnt <span class="keyword">DESC</span>, category) <span class="keyword">as</span> rank_by_revenue</span><br><span class="line"><span class="keyword">from</span> tmp</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> revenue <span class="keyword">DESC</span>, orders_cnt <span class="keyword">DESC</span>, category</span><br></pre></td></tr></table></figure><ul><li><p>商品、订单、订单明细三张表，订单表才是主键的源头</p></li><li><p>为什么用join而不是left join？</p><ul><li>因为我们要统计的是 <strong>“实际产生了销售”</strong> 的品类，没有销售的品类不应该出现在报表里。</li></ul></li><li><p>为什么要将聚合和窗口函数分开？</p><ul><li><p>错误场景复现（您的原始SQL）</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    category,</span><br><span class="line">    <span class="built_in">COUNT</span>(<span class="keyword">DISTINCT</span> order_id) <span class="keyword">AS</span> orders_cnt,  <span class="comment">-- ① 分组后计算</span></span><br><span class="line">    <span class="built_in">SUM</span>(qty <span class="operator">*</span> price) <span class="keyword">AS</span> revenue,</span><br><span class="line">    ROUND(<span class="built_in">SUM</span>(qty <span class="operator">*</span> price) <span class="operator">/</span> <span class="built_in">COUNT</span>(<span class="keyword">DISTINCT</span> order_id), <span class="number">2</span>) <span class="keyword">AS</span> avg_order_value,  <span class="comment">-- ② 使用①的结果</span></span><br><span class="line">    <span class="built_in">RANK</span>() <span class="keyword">OVER</span> (</span><br><span class="line">        <span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="built_in">SUM</span>(qty <span class="operator">*</span> price) <span class="keyword">DESC</span>, </span><br><span class="line">                 <span class="built_in">COUNT</span>(<span class="keyword">DISTINCT</span> order_id) <span class="keyword">DESC</span>,  <span class="comment">-- ③ 窗口函数的ORDER BY也包含COUNT(DISTINCT)</span></span><br><span class="line">                 category</span><br><span class="line">    ) <span class="keyword">AS</span> rank_by_revenue</span><br><span class="line"><span class="keyword">FROM</span> ...</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> category;</span><br></pre></td></tr></table></figure><p><strong>优化器Bug发生在</strong>：</p><ul><li>步骤③的 <code>COUNT(DISTINCT order_id)</code> 会被缓存</li><li>步骤②的 <code>COUNT(DISTINCT order_id)</code> <strong>错误地引用了步骤③的缓存值</strong></li><li>而步骤③的 <code>COUNT(DISTINCT order_id)</code> 是<strong>窗口函数级别的聚合</strong>（非分组后）</li></ul></li></ul></li><li><p>步骤</p><ul><li><strong>筛选目标月份的订单</strong>（<code>orders</code> 表）。</li><li>把订单明细、商品信息<strong>关联</strong>起来，得到每条订单明细（join）</li><li>按品类聚合，再用窗口函数</li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> 专精训练 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SQL </tag>
            
            <tag> PostgreSQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>大文档</title>
      <link href="/2025/09/24/%E5%A4%A7%E6%96%87%E6%A1%A3/"/>
      <url>/2025/09/24/%E5%A4%A7%E6%96%87%E6%A1%A3/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="密码错误，请重新输入" data-whm="认证失败，再试一试">  <script id="hbeData" type="hbeData" data-hmacdigest="c28c48524de4cadaba9d34eca6de78134005670411d3a207a3fe662c185ffe34">98b9bce3395e8307c58744c12688842404ba42d2a18bef45e12087b4ccf7cd90c6263110e03476a0d1390db8ecebcb8b2e0e1711e949cf33ee0ec569fcac8f2d95f7602ccde1cda8b2ec9de833494777fcd348a42c48dbed0491dedd2fe225bec998ecaf2c93d8d0cd83ad28903bc2526082239dd9e475e014cb8f03d39c84bc6db57d4cfdaec5f9bd3b7c9949f63138c45851118692978396ee9f7036b6785bd18b3d295261055355ed67959143600f71c472f518bbdab8d0bcd37c7b12eecf6a8793dc488df04276a8b9ed199b70f6277135e2d9c098e6e16e32349e4437552c851ebb50dacf77e11a355a419415353df817b785acb1832010d73c3d82c27ae25c46e5da244744e1da871b0df9d93111bd7cb3e96ce7b807413f44695bbf52bd438cc05ed6ed3fecc33e92041a814ffeaf25d35df21978817ae6b4270a0852e03e7f11bb834a9e515440dfbfce880cc384596897cb7303e91e8199f7097f7ce9f1ff131cea87092b6cc12c7586c8f0541dd2c17d585594afebff2d2ad222dd5002a703d74dfbe6668e9cab40245b8a50971968091550e35658cda46e057ce24eea58c8554ce0c6b081d758153fc9f68f8d149e5132edcda45d1932ff47e98ac97d7b2745abc99e2962c958dbd353aa45eb245251a15d0d23a844c7e31fa750e8cec03bfcd8751867a071d15c986d593c0ac3ed0e7a78fdb1a2cab76e7e5611d9cb74e11ab448bb91574a9319f6c3c555de2fb6853f81052ad6739e309473ee035fff0e1f94115a29184a07beb7f3e67dc6c1aeecef94b1cd9920fb19cd71c134875541b55b6652efe35e5ddc0cceb6653b9ae30afc4423fbcea31ecfa9b9ff0b288d878e26d855419537eefb52803471b849744928a7c8b70a7575d50f6ae975fa5acdf9a5ba6bd7dc6392973be50aff7904fed19bfe7cf908b8a8ad46879f53f26eec7cc056d7f4b48ed84fd4ae73807daa3b635a581e5a7e9f00c0e5167d7545e2a80267019da147f5b446e67b808bad458b8590eb7b4bf4a5010418ba2a279ba1f655ec601f7e8dc9686f4ad0f445d7e2ac195d304a66d2068975550e5adfd89311bd2fd9c542c7abc2b441785a5290bd0bcdbe31bf17cfc4a8d94287e0e491a6d5f6a92a357c1ba31473cdfb27eff20e6f411ee9907cc2613ebf9f1b48dc3be9ed37c3391fa85c5ceb48424b5bdcf2657bfb6b42cf6aceafbff12d918cc6535947ce672f5ef273783c99fb1045e44a699c4f4d52d3a05886e32381bfe4c2773a703ac9f46a51cc12441234df0a1b8cf3d5cfacbd8de2a425c5fdfceef15b49352436b2af4b9c593868f6fded4df41fdd9b8c3800f5a39b7126702f76ccd05a22e4f829ab9070e5c82aec79e0a2bd7ae1f42efdd3815f3ce625c501ae0302104bc8eb49646b199c11f9d7dea2b7f6070633b58bbcad5af60264dc49efd8063446be7abafb2ea459000aa7128d25f8c2118a8c9699647f2a516126265b2b794e9fd67e479d739ae9054bc58eef620e8fd3a294b5ff95739884013d7fba9857cc038b5cf2fa5a6b767fb32ac41841bdb9d57a7187a433fc2414a25926f02ce593f64fb07469fa6909b3342efa090f585697a3f19885801b1c3da98f367c67347cc677d122073b63306779944b771f3da9d4e144ed50c4bc4f0563310069f61b955bb1f26b6bf83b3aca7d27dae9b84dc3ecc31b25175390f7072e17604da262edd32832dceb2af0f26bd533ff9a613237e8f5910a0726687e690855cdccee378a3e269403dc9d1e587d72efbb4cae7b226d8ec6392ab16e686d93b7176087285f3ef9ad6f525d71f2eb02982bea605e9b952ba2ca5c65d9f1046e0344d29a8bcf3d1b9b1990ec3571ca11596358af9a0d4b1cf14b30eb0a78aa93bf512a335174069463df9edb8a23195465f52def4366ef347d6ec67cb8a49b2e9c806494bdb45854533c3b665520984d01e63e798aa4bb2c6df2346d26a33bcc0e9df95d8a03e3712b86188b7ab6d4fbca9e4f149048d8076cacbe681d85e4a035251b08c1f62b355a3faabcdb8ac91dc099fd9ec9af377b6535dcd691c126450f489dc44bb51e78d3cfdc78d061bbe2d588dbbf2c9951ca6dace09dfc02ff0bd797cc589c895199aefca21edbce0fa4a87b23e79527e8e28a1e9e03471342496828a034aaf8bab5bf9bfb91c191ecf02210d8e8303c8d0d8cc31e3601c51f3ae505b5533d135abf84594fbeba2977121e644ac1ff4dffc3104c4bcb7a6f247d9b54953114897e7e5b48681d8828f4f2338901b71866f4217fef24b6e694f58b7366397c58c0638ab3a751d97a12fa3930013a70011828b984c7b9360367423a77cdf9f2964326089c0a6f97341b792d513277f687707dfcd8c4e955af2dbcfb0f31049f44adfe0ee955f7439a6aa381c4602c820750ab6b609905528eafecdea8114f98eb4ed36450b5cd3d6839341ba00b5a577a6424e25bd3fad8c24df7b5762fb4b8be58ad723306ef80df45c96cc36bc3dab95a8a58583fb477f710eb286298cd27c318c227e7f7b570fa7ca44688230959f4492354695dc3645e589ddb7f91b8442d94c06e237d1e4a2c00fbae91f3b99eac207c5a9bc4592c38498f900afd62ff7b1d3ebe58d8c7ed3c2a5165eb6cdc9f18b77f3e424f66abafc7cb8e9159f0f3327a780783fa26ff89e9248033a6b200b173f8a7b794dd7ba52c6c43427d036f35580404c03d76d1ca65313538f70614364efc6d20546b1c1980879e37abacff0aba99f18aec8cd9436503d53174137921ab7626258b4759127f5d307e6716047105c5679ba193f22f82cf2252ca9108f4408da63b64f7fe6c73d263f17fbc72bd1a0d2e3a9890fec418e0985a83e2afbb407790b646e6c0cb39e5292b4bd45c63a5e70f5920843c0b9c0d4fc0f1a105adf2fdb6dff6903fc7b413317daef6847c05439a30e1b81405ec7b8467a14ff4cfd3d15ec3de62c34ca8fb07fd540f4ff42ed737971950cc854cbdbff5535abb7a2a988d01ca2513e57e13e388760d733948c399b8b26ab55f64f38c898c91b28b57e997e373bd374d1d84465be9807f4ad0f1c54d7ff4119651c5ee0fe5138ca8b14ab1f1ba699787b4b305c480e4c6de5ee1e8f476ee9df9ed46063bca7d7f0289aad4b5e3d7a1c0a8bb64ae57bfaf5f0db2ce6f5179897f6752d830d87940f2f8ab9dcb993194a2c1cf54a3f402cbc33aa8fbf16b44128d8f92b8a485e32d14e470307790d98bbd7d4f56af34202e14f2673a7fa08e0f1954a8ffdf670d990f91cb6255a25532ef2dc8c8a80e7a800bf2eeebfcf933f1aed3a9c7f947cade9269903be9ee4ea7d6d190e3b1eb79ab016add8388d5be3ba577777907e9a57ae0a7951f264c48bce44651eb94a35fb01c325667271e7865387aca26caa440df745dba32a256681717d9e8bae9e42e5044e488c2cf32336ed70303d21ac2ba44ecb3930c0b00ed61f574e91c9e5760631b4c478140fd08b672c89efe29fe487957a1b7485899eac9af05aa4cabed2cd54905f074635534fe0d5d8db905ca22889064a026c948695f40380ceda9ad301b4d956ad4accae6f538c549a18b84335ff66b2685f737f15dd1121e2f73a8dc91d44c6ccd50fcad866b4fcef8bdd405962b8ad93004f92c2c2c5df41f33ab4e775e4723f9abf8bc35eb6fee76cc576329934d46535b2f9e6e115dbe7aa916ae73a56b57432b95ee83f68e56bc385646abd996bfb7775ea3be8860b4826a63d878bbf80ca5fabd37db46687c4f94ca020d52584ce7077bf0c21c3c2ae24023e5af391538a7e3e9aa37c6803c4247a1bbb6b0ba2df4340cec72e15a35a44943f2aa4a1e92b5abc5f68dc5f3fe9f971668d3c692d0541b857323a73dc0245fed20f28945bcaa0b71e718a32186077aefc5695b2f5b864c8dce1245803a670b337d74c223d687af057a4491e8b3756025894aa58581bb9c330242b4ab27f2c8af42f2c91a7e02d909f9dd10ad12db9fbf77a2caa29733c5910c3df6d205007dbdbefe5c6e18dd102715e6b05d27d48e6da4f891d9dee529b030bb6eaf1aa2bd16ec6af4c80b6a31f73a2952f4335a584a3f4c16d13e1d3161bf35af0ab21b1e23c0adf841e8d428300ebae96bbf6d2a5fe99b83a073e10a723bffa4f52abfb0ec71918c9339b554ebcdc0a2b9cf508acbd8d7e1a07ee9d2556403463ec9629c9d6bc0e929076f741bb3637f52f9b1707b3db571585955fab5bb93102561afc8d7586ecff1da36ddedc7ddabebee47f2ec7e5e4d177ac1d8df944e6fb96d2ced5fccf46317f1f8e421874720200a82f6a26338842c5200f8cc4f14d48fac030a8f7dd777f0aa98338b969ff667ee47902584994e24abf079f6bc7f02592f583e22fe9a169ef7df984eca507c9d9d41ad038377e4cf5623c4beb870fe421dd6d30c6b4999a4abab8e11bc450116297a437875352f665eb176f6ff6a88617df0ed63f9e5bd9244cc6e88b3dd1245d0886b0b8ee1e03d4d16054e1e3d399490d68dd5fcf7253a25611783a90163dd16a12274dcf477727cbf8375c85c2b272cc70405a634d3c505b82e0f96f2f15bf09ade61f8cd4541b1c93930eb86af04a095bd7f1b506a575ac454e5cd3e1f2a51aaa991413693cfa08b0fb2e6a36917ba045f3a830c72b7282e929cf4a9319d076f8cfc3f163baf01acb1128e1ab2388280861ab9835c569cb3f24d80eabf4433482ec57f88a73949b82b17dfce2a3a227026e082976f2dcdce3ac325640613582a5063e8c324f02f36e7554ac3787a8bd5b68846bc4b8c46fee25c39e96e98eae8e96222c65cbe2e19921c98a1d4cbc21ed27d0a305dbed17a1ebe896be27cb2ca55c48159671600c721628e00ec12c592db2e362fc4d93cc4317ac1e37ed19af2b53deaf9d3a9e1365aee62458a485de1cff474375ad76100a61f202b61aa5be591c49c84f36976c07add784984547944c29a757dfb021707ff5296bac2620623ecd148a54d90963e442e1e50b8f5f1e309afc3bf1b179f60b1ab990b4c029be4274d1a9822658c554ded90e179fd67254e317506846d7ac69b22c9c75ffa223fe0a17c076adf6a2f6fabddd14ab2612cc26f5fe981b82dfe82301eaff57253e01c31a47f71b8531a20558380c81ece965d7ef82440d5db95f450e391c662be8f62b971233141d5aa917a672cfba5e30c9b59017f8511a7787074a81b5b728eff7c1a871880a3a3dfd98a2aac530b71308f869b547e93a674991e963327c86396cc1110fbdfa6b11566078883bab3d7363e0614ef477cddb7e51ef1b962ed70eeb2dba90d809455d4ca27f578d6e93f57fcd84e36df717dd05b8706bb0108a7a449d792c63d1da1e3f9397c8ec4fcf84f1d4f2b0c04c3333383fde9272c0c5b48cf3b6fc813bde487b6d4e0ee17410d3e590ac63aced1e8c28954fdbe7cfe7af33262380450aa5087e40894f80b9fa4337992bba7f771f2ffa5a7f9a8e0847732242a774741bda0c1cb298707fb4136090122576d0c78e99efa003b5817ca9f3c2bcd0895a89e86d7277587ce39592042eec93e1c1744d4dca316a20da55df90d31f65de09ae3c26eb2ed3003837b72a6c263353c0f17f1d4bac1232fb3603ab762d8cfed53e1d6024385a87fbe8417f1f517be3e4d2753d1ae5877a4afb4e39f7b1c1dea47fcf787f97eb98f86773dd05f3ffd2469a571f4c92cb632702867a0ea678bbacc348eec37b379a2d55428c10b16d683398340d211f2f4b976b7f984c5ad25931e97a355826c4b95ef4b380c121a54fca5b84a80eff64c100858f18f1efb595ccf86cd760b1c9dca01c1578fae5334d60af4a9dce6d8e60ca48aee268291cb934083fa8f442b1ce894636c722934855da150bf34965acc59f106cc9d11b0aa3c6f155603ae39133a18ac1afc8a7e371ba98ed616e84c6f3d615f4f6466142c91d6384c7f0d5f5e8d1a99a75f437a8827f9c1d6aa1463ab502ac92cc08e1034e43d12747368a06b09232d0fbaf94cc35cd8be36846d9f745758de6c2d3b7997f329a0cffb7b625849b9a8c50c3f6be75daa15a8526fb22c04d7b562ce61933c2dff6feec4b2bc7d5c36c259d5cf125e08104ffd710de38590ccb10ea111100be4969a17bd3ac036e32dfed5404b71cd79b597c6e929dcd61f39ad22649a1bb9a882272a7f70dfeb0730988807bf9c14e41f8bbb34fa5937dd3be97cf99ddbbd0e6cebe37d8f919b5ddc7341acf3d09e1a582e51ede88dd81b1b78989a21afafa3c449a3890e9dbbba192da41be97298a1c0cf71064c78fa1e7997e3b4aeaae28c66df314157b12201e25b0aa166d1301611b35fd9b20258207bbcae39fa623e68128dd5670f0f5dbab4b306cad1e95fa8e8b9c8c448f5ae17f70f0b58ac40265fb8f084f91515ae1ab356c93aa08049f357709c19faaca746383a1042ee1f06e7ee2d608462da023f5d06da7c26138230c7be79af2256783f2bbcf8c74101023822f98983d144255a08e59947a853afda72760f9fb5ce47d5f3727ba37ce9ef15adce95ba3cca5d1576b99d8f594149defb4c1453881f09188920e1df43589f579096f2a6c82bbb791e1fb1ceb94d79ba2de0ce51763b85fecd44601d7cf57f9402af8f3352da44d0e998090fa9d1cac0204f1fcf187578f3b2267974fd15a095f1ab009ace2a7f1b9c38c7acb134d94be5189504dc4f59ccc3a44c34b2dc188a1f505c203c9441a0c6719585bdb10e87e996b24ccd093661db031468a6e6ecf3cee17dd776d45907961e56105edacaa880f304dfebe9eaa79c16f641dce7cf4c5626d21ce43151dd6e57bd02aebf805b142703cca8d61bdff2d2dcee54a54b6d358d150cee55b064d3c6c3bea2b5a4cf393a4fb05fee8407df6e99421633c66531c761de8b94e9fa76298bb97e6139a75353a6bf68087637c8edaa10303c46cba5ffbe52bc466f01866feb6f7a22625efd2b302194d1aaef3f71c0b3c15f07f675ecb5d82e0a6030b215e1ac30f494ffdf3c8f2fb464c9f02685aa818a4b312724386127e3db43b20e8f7af075cd9421442fe46e0dc523bd46d945e6ce0e046fdd4f68046aeb8b9aa01001757a29159ab242ac3f644c357428e555dddf939dfd7156c5665f6384c8a023a6b3c034166dee0a14434246024be626c78f2ea910756baa708e1208339432eac1a0a5c046ba24926b2eec684a0fbbb03755fe901e15a4839f566ba47bdaa4e0c2107ba5ba46ba3446615f9de738c22823c3998ba6131166fe3bee58dcd93bca046ed25503abd917961d1ee8ee85b97d32c6dfb21d13b617ba6d26358c279beb48534a7d7cc5240bf75a8828bf31b9132337f2521ec6b1589eb615e788f4596688ff7a90e7b4710bed78eaa19f033b53bb7e17c875871fb494d1da83a0627aa2be69aa5aa841f4044b06cdb809b7824bb4a31af308d5bc87f8d0fd9c4e528d65d2ab42d07f04d7a71ad928ff93c18e786725843efce2a46c090b65d5d561128b3a4a6ef0540382a1f4f66ed11733e46cd55554e5f7b0d9e0f17ad48a8bfff356c5d877cb05a7fc73b2bbba0e397bbd557eede40f04e9f8f41ea2b8e64b0924df822286eb91c2791960cf2df79cc015e7015370f7e2240efdc71cf3b591e8ce61940c5640ac4cbe3cf5a008a8e758cfd5e499e3fec30401ad10108e0c95690fc221d2ca7aa8d4166c81571a19412da2a48542ac929dd3c7633cbfcd81220bcbf0784c328e66c33c3b0f0f6bd515f7c554334e48e0615e6414f6d2f3554edffe6cb8dcf815394f880de37a0582be0af4ccf91a0547e595b264822ac8624a77a36be9b2cb5ffe94183b95dd323407498b0b1ef0f12b9465fdd1e5481f7073596ff563879ab3271b6d7a072ec8fe0d5956eb6fcb0342bb14abec2d2ae85b03f87efbf215c41adb6cfe9b22c5bce7581d6bf3d5b711ad78664ea8cf853672efba3cbd96a361f91f6c6486fa2408932ed91c4b046493ebda5229ccffa3d9cc8aa991dbf025926f14406361d65e17ab1d9820331b5b2f2f08e2a4b11dafc7785b5db2d26a4374428d741d52254b2058d026e82c831289fca5afa1d656af402dbebe14d46065c4b4bd6aec00374723449b5ddd4a366716a415f7ae35c5bcd9ed630375a10313327541c0eab1bb98ed65ee3eed979e9d76779298d09fe1f4836f4f5735239bfb32397ab2762f6c342976c79818e62f5256f76f3aa89e3a4b769b07f9c8ab9c95c1584ea7d1c1922afca628eb62bc705ef0d06aa5a26ae1891d1ba86b9fb25386ff7710cf3852c882917dd77b450df40fdcbfb52d3dd6878ba16bc4b037ba7967faa3860e0270606faed87aa79b136d708ffaf51ce930f0e7ed596bb580efb3ac04fa5a1c289aaf84dff6940a03bcb8cf63de9b1845c0a809e1c4530b862c62e508b80408dd8882cc9d24739e97c73db13dc4eb421b19fbf3c312aeea9f34aace48503466872c80c4a57a47072d54c8aa419b7a09032c6d8dfe75e8a569c3668718f6fc38ccd79cc262f08f5c52ecb3113405be65b76991a9a2faccae30e5a006a76d38eb5d84af4e7fe724c30bd371a15d9231971da01a1babf3ea82e000939e26c9c687cbd08785fb7d7b3fa3e802ac64f459b35320b83dc1fb18703d1e4724c12534fbccd000dce2376107244b7dfed4490c5a300b7ba63a7588fd03efbc11a214e8c03e39c1b0f102d1a71a0d4b7c6f1c0c56eb85001023f0416ecbc42e869cb5d8128e678d51d9152d8f4a753d1f5bd2d47d4906348e9fe5ec0c878d04e0354d931ce60935ba9ee908ad191b2ee0390292b20440a642dce3c39b0d01efd016df1299bc34728a46b434e6f734c811339f5fe647c676fdab5fcdea00e21bec2db9a64554fc139f8b4dc24163590ead5ac6a197a51d4cf4c70f7a0462a1b177eaace45c61ec3c3e636de8fb3eef2e2847568abf674390a0a7310e6e5bd2ca8d3dbbfc3db5e9ea51b59f6f51ab079555954340d678c927bbf49d94ef1880fd1d2c2435825f7d74790e8588ea8068425ee55c768c631d5a44c0c1ff4124cf54812c43dc36c103e9a66a0043dc38083f72bc97915309e2b0dc944117c7884be95dbb635c2cd68ea45a753d3d3b43218d0993f59179b276e0b053bced0e35371173141c88311967d775ab856bc5d6d433c46d9615752b6ca755fb04491ad085a58e2e8631d2c123ecb1c5b0c2a9243b3957bf089fd80c26ec7098e5cffe34a7824230068e02241ea980d20f134209d62c0196a0702780a302fe73cfd42f0be59b4718a138441059d7981a16e64bdbdc413594f8a8df259efb230eba6a72304eba568fc0e3cd789084dc2ab32c4c4fed9835769346863dde45d50157b5f37b2d4555c9db9b80b42a842ff1c7b3c943d15b01114739e44214ccb2203aef026fb34bd5170ccf27bf96b1d48b99b619bc555521b1d51dd80f836e1e62d8193292e6be2676c3b640f95868b914c3aa66b28aa40862899ec4303688327bda77f98bf29adc3a5668f316c7aae7e5c4b16f1f443d13f1a8f5f300e65304531c0bd37ae8aff29f668e3677c25caed3c7890b7ae4718eef678158bda325484122bb8c22d6e6c0d496aaa659dd1f835869b4a6fb52b5b0e3d85d394b5505d8accfb71a8ff93511f3c71f3cf65fceacd72574a1f154774aaf52a1bf427aa39390b4960a458e7d9591593b27b1ee368adb087a1af7dcccb443d9665e7b5f48fc3c1073fa0db70c84f6df6db0bdbb9b3695472122b250ee8574569836c69ec8c4cc1eca2186de30059ff39a54376f8f62b233ad091b100878f87f97d0fbb1829fdbb0734199ad16517b8e52cb9741e5faa690b09d547134e556d7da1402dd1dcf25c79102b3e2da39b068d09479b397d6e7468bea85b97ed1e9494178f195edb8d388ed4359bc1229b2285b7c58542b84685e2718ad3f090a8908a435d650eca61da60a3da32234d797e4fb266789659151fca56104f630ebb838fd80cd4f9c035cdc75a2416cc919042f849ec62d3042c4f54fc68ea32bcf7926783d769aebf6e1b42935942797bf445c650740624e0b114f340b8cca2b6f392c7eea6f2d060229505b9d6df5906fd65715434f931768a07cc52b7d68b380eb05276d277f146cafe41a2f32437eb3040196d67933d1da37c8c4219b78ec342a2f7a3c04beb73bfe7e35fc89142575a0f17cd674e474e5afca7d43cbe90995b9e24415b459d53292855eefe07da105454648b5d7a5ed60d68aa21d1c856b3c72c73726c54dfe94a0e8c3a45e3825e6048b7710a59df69dff2c601b7d884fe5c9fd7eb8f74a404e1134613c02943e16d2c70c29dec75fb13acec9c98c2955869fa930b1438fd8a048cf4904c50b74df3ec9e89c9fa83a787792ac3573f9f763c96f543aa50f690019f75e3ce14e08a43c7a0e59c8e8e95a17d0dc86700b4a5da35e13c439d451066aad4052f12d5372ab04fa263328000478ea2ca7ad10b129f23ddbd2a60e820ddfe4d21d37bdcc75ce0256ee7498382baa17ec12dc65747c7a2a2bf7c7106daa8536d6c4051960d9b144134c25ccc1a3d93c8e3f7d394cf0a8a77ab35a0c8cb58fab54b4bf2530def331d85f7fe1529ccc4630a95ea0ef7c27a4d28d017b4fc3d5e97bab540da7a98a597d41cccec027bf166c09e16176ee390728f6fb876c0e7e05887c101f7664f54c98a3bacb621339f6d13e89521b7947ff4f2cbe992b0e54c7b097425b38f8d7d8eee645b87176b68d1a02b3420081a142ffc758fd5c582dfe0a6a002a5f72c60f6344ecc129dbd55bb1d90b49739218c4ff6d509b4eccf787225b578d0f4b5bf9618331a038ccf33514f952836bb71c6017abac06dc4118b5baa16f1802919c8bf685edee2a9cd467d55abc98709fa398f59bc1bd956438f1156aff12069044e0bb6fb1b9588886f9b60685b0d97c07b7e39ef4b9bc4a7e7787aa84fe414453d29ae2ef45fbf8db3804e018ea8c58da1cffb209e4cd2f1cb3df4b4724b805c8c9a57d460ad6f9303f13e953bef2038408f49d9125722a2d6f923bef7de6172fb7b934576d474d16507ca0f7e02ecdfd178eb53dfa21dc29f057509b1c3d377ff98e6d19e28929fce7992f7e9b358b3ce3aa952429854d1734cb0cc4f1f3315a25a63b157d0dae06eedd07e8809f55e9479c4024f7016eb10ba87cf631f75a3c8ba59f358ab52ce79a1231c647fa89b2eccfb91c77ba93344ceba358f1306f388b6f6799a14aacc0b48b7d3953f9017c56fe96450f4da31d5a29fabd2415ab60edde621e989e6d26435ebc0b02abb19a222734c118af13511e096a03c14b9561e178ed3cfcde6f2da37a24524831951c40a15bad029b4ba9177b7e9844e21166b4865089ad0779773cde5b49e092cfb1e97a3874b555fc75e9fc5c333c9fb286aaecb1713560d497e575586890829335018a519a913ffb868567cd931e6835a500a03e01d53fe74135bf396dd46efb038178529bb9c55ac22423fa649dcb8670aa8d104b0ae1120e704e4672fbc1d0ced8683bc5c2510ed6c0091d576553690d799ce621fa6cd79dd9998300c3411bdf9e660b2ed5e32b2019a2901d01c08473c96acf7d00d1942ef14a304a2528f94af53820f4df61067d011ed35228bebbca3ffdd2134899d1efe547d14a78c707cc208ab4417714062b822e494d272ef8769b7d9c2ff59756adb91a02ed4cba8416e4b2b158768cd860596a61b621818b33d5b4a6ff96afb0641bf21dd177f219b365ad25d96b37e2e2c0a613bf46a18b5c73065375bcfe830330312da154569fddd3d27629fe01841f17eb3bcea50b2ceb6e46692e539f8e9b416fb9ab7a0415a17dcf99a4a23f2b2f22432ba4db7fb96c2e8463ea64b9a331e42f240888b0e644bda85972466c5c20e1e8e91ffdb369473c7f8eae32b8c7019876d75f1ab67b22b1f2f3b2ac2733102dd2a5ae476ec547da2607f9a246d17a45fecf50b4bf11a6878aef539980449b6f2dc12a600d7a9e00a0e3ddae69a5f8765e1bf6ea1df3b1a1bd87162d69f82a00e58fe0c2e55e7f1831aedcb6c5ce761e79b9090e50b5c083fa13932f915a3c839fbedb3cdc11f10b53827ca4d7386b731c95f2917c3fd728b1ec8b211e2616a04d0f1ebca5d34149a00aa00e3d67c8c507566bf13e5902d09397a0a8f18cd345e3c6b87fa88049280a31ec7105a8beeb64616092c986c1840508ed03040d4548ec2fbb8ba5cabfbddbadbc0c7ee5b4a3b0b3cda2ca6dc723b5799c5c3c5f208160112da480673b33a1438bd8a98241713ba21631062329b566e5ba70af09bf9f2704188979249d42d2f232db91deb35b6bc6451e1eb2c2af4dc3f6aa440e332ed966f046b7b7738b48aa28bb30c7f69afc74840a1f1b07865243a0c61eefdf5d4ab124125577440e416d3e0fb0f1c22d757ed3f4cd24bbc7a613b8217ffea7ade7aae5d258c89c2f8b5ffed5a13072dd0cd1703b36a1cc786afa723acd29ee712e5812caa09f36c6e9cf2ac57720fc90e223682ad3c716397a6630bb8259b5db816cc1e86d0c7d62e7f6b08187c8fb96adff4036cbf47d6dbb286f311524224d43d0416065b001b9038358c5ed6c69ede702d00585fce3a3143e252389fcf7edc5ee04a70fb8e0f5197e69cd8ba55d76e62751f0da43035958da31c9918ce261586e17f402206e8bb42c62f6dae69a8151deb21f444fcd9fe11f1aefccc4fceb2566d53c7d09ed5265f28ac888fdc15cd11049272a16b4e07066425704d44e13012262fb16b53c6fbcebe740190fe565dea39df43fabcd771313ae25cdd7fe919c925c1aba16c9313f27a8d5d077c77702346149bb5f5b35ad8fb3d53bcfa4ecd68afced28a6e4b4d93856debdc35c49907825611e483c78b7f15a72fd1763e71586d1626bdd9ccee987878374e12de07aa5f90cf2f1e9300765f7d99d77b1357e069d279ff6c6a9c72870fe346e140453a2b1b514713d34983a65ada938702005accc82fbdbcda90e43b78acfba04b4dced38ae3795a28b49830876fbfeec28b6b0413075ce73fb02f5b5a23f1c0770a9f58b93195463db19c4aea3c581d59d1d7cafedf1dfbb50fd508dd356410a220d3ae862f1265778059f82a89917480d4a8f35b08e60a05802b578816f82e72abd9ea7569829f29f5d94ae32507da9b15823cf60485d67489d355354b2c72d3f3eab5576b2d4f20d95b966219bd49dc8c12dbe1dce246d190d8e4994f7c32edcc9ef1950940c1aae5dd799d3e3ca7499f1eec46655d2a84e5fb07d1adebc832070e517ed06eff431cf807b6c31fb66969729729e7eccbf7d05d1156560c114ac5b24db8fc62e55c3f42d0bd3d2c8201d873548074e7edd63cbe2d88ec4862a52380cae53236c961670fb65d98afb87fb38844038fc8f98fb2b999356770ae569e2fdbdf8ecff5e9a190dfdd25ccb0b3b124c188dc1b6883fbe3aee36461e336ea0a95834531ffde2064be16aa5e2c1c972f3dadd814f444899fb2698c81b0f0cf0adbc728b73284abfec3ad8b31ae555f4843c16ebdd8ee61beb60769531e0ea21284aeae9a1efe3ae0588e1e5a3dfb85ee3eda766f458e4423b7feab3c9053a6a215ab4236f786c033d483560cfdc5918317b30601d147694c740fccd1a4a88bd9de755d1fc07f56b3dba97f417bb86e438066d036d7aac31b56c61681b54591f533dc712ebecf05fffdbe3ddc2e1a135e41d5435ff0e6564546c172bfdfcfa331ff475cc97075891be525fcd1570a861d99bd7d9bf244d060e67905e56eac6128d3f63985ad6b0cdb86bdd7c520836e168773ffd18ca71449056dfad4fac37ae57f8023fd9ab18da2b2f48b4cfc3627555f8848088f2369f80a8084fa2bea586ef41bf95ec85ea0c0987023481a4aa6d01904c3b373e32b32804ea39a58826bf5163fdb2374eed200bd87eee3d8b8a44e8d776551816dafbd7a0dcce9389b032e5545f0d598c0dde3145239cdb2d7daa4028f1ebff7f673737586e611205c68081688e032754e1a682debad4a020c6445eac1119ac8b4c56ca31af804b0050233e5b56873943773be860846af9f11ad2c6c4251025e76d95c13f7fca37cf5e48867094f443d120ee36d04bae088f538516faae19b8c269d822828030a3198ca24e2b18bcc162e4f19c9cabf478327c70b4d731f720b999c178f0ffa747f7316081dfe3a38794c02dd72bfcfdc940aa8dbad2ed5dafbc3891e54a17333d01a50fa85ff768f0b2a0de7d73810a8268e7ac0b494c07565684214674a0cb07e434718248ea6bb67b65a3a8e617018a377473cd0a0c088ddc95b6d50755ad73ec58286b1a790fe74e9b848d59c7def827fde0facceda94b8b8dc666ae572d04ac5683b52ec2a36b893c9359e82ce52a299b982d344fe36dc6d51082031b8a57043388f6bfb5b33a05feb7d1f24d27ecacad19b514ad760ed2891580b7c6fc95d16c79f51e216c41f3b31c90e520341ff1d0e4804408ebb12816ba784d850a0db3beac915dd048c66a13944b165807b0f32e2fc157e4f3b781891e9ce1509ef9c9299a41489376938bd4ad98c428b2288517d6b2b7c38d3562cce7ca02cc23b32e9952d7cdbf2c535f62fe95a9800ded0564c67ad9e8e457e7cf92a6e564d1eae55420cf08af6c39c5304d3cf6dac2030d247c32c462241990d1f9d2c392c206d35163b17a664116482cb09c9e4e75663196f86f7e1c56ddd68cf7e9da7756c60c10c37c8ad9463cbc989cbd8dbfaa15c38aecedfbaa190b58f70e192a6306aaed4eab75036ec66bb7d2382c748ddfb4789f150afd421033e1d9f44e563f7491b88fb1a8db9b060b6529da8dee331c0d963df997a2015ca51b1b991d87beb4043491a82b7bba8e9638184071919f77e83899b3d798cf935f99acdd35900f6a5fb3c5ca145007e71875177c56e838b3e59f5a187006ade0a817201e047111534889d0e38458421fcaa34c2140fc93c1b8d4a3956b147b5920a0e0ab640b82d08b331bc10db54f7acd4f3125ee0885d4d9da1801bea84b597f2dece2a4785fcc1a2032ba698d4d20516d90735a42179ffce86c5cb657eca904e201f678059e9a46cf812124daaacd44eea2b5c9f7deb17beac092f7cd74f8e3458ccd59a02c671cc4850dd700cd272f93850cd682650c898534c31e931f04201a6def30f7b5235aad1a823359be569f27e9068ec60852afc0dfac346221354d0210ec91ba235624b9534c04d4d2fe7c4cc5e3499696a166dbaeaef7abd42efd26870551712ed845f7613cf06b583995806c497535099b0063e5d742a1513145181a4e3d2552a28cd2bd2f1fe218a099e3584d8a6d6ac17d22e5063d60b897d2d2affe97ca24dacecd8c4865f25d2ee986bc8d519de6e0c7c6cf0add2f5938b7b8d7e1560ae61b8a0d2913e5ceb638f2069a945955d1b21542b8e7be31cc2cdfc5c8f21f9fde7988e42c6f9e1c1dcc838fd52bf8b5ce4c7db4fc018b942e3ff83e81e78c43b76b6ed25f074521a90c72e6fb14e7192d582dd21f0c0e9d4eedd34f6b5a2b19dfb2115052cd9bcadc398c289b109dcec337f5aaed442ba02bda673bfa6021231e3a2e29497bb12687866a3405c3b6d9b6397d57fdbf839a06273370ddc371a5c5ca5e2eb02cf876d09ac3385622e8453b664abd118aec24902e9f6e4150058b39da720b7eeca27d14158fdbabb5172fdd6fd262189a7ab30dffe50d46f9afc9457947d203ea7edc5b185785acc8f90c8129aef0eb201d01af5883beed07057453ae9fddd01e48be9e329e668f8317eed729e01c7d297b20325adeb94ce24c5dbe97353e5456f57ff6ceb019d90b75e58d8c0c313cc3c7ec3a9efd23e50ae3d107990344434667a82bbd451586a8020b26ac63b19f2a0115cc663b2dc822b24cb3bbbfa7d1c55f94942b16e7e325b8c8e491bd1b0f52a7039c518fb18771f47ae5b8414d66eb5780cfeb4eb1b5115f7232cd93eaf9f01fbffbb83a198745a94f51501db345d42e997b891a4f020843272700e2d9802b4e1c5f82a58a9dc110c58cd476b702d6a812e877c8feab84cd7800826cf5039e1cc8f64ccc404404380a1035f3a37587bb5347ab882248e76cc3c12bb549492190e9d5cf7b35b0c397700e98f82aae810f8950304a4b4a6f5640bf972434542401b5f8ba9cd46e23c7664f1b216a96b9872d8a5353e1bac0c8b98f35ab3b98a56a59b6aea8d91c4dc4c90cbbfa3340da2eb6908dc189d82e8d5e700357b4967625d3f810a2e6be784044cf36a905963641a7929279daf612c0f710e9136200ea0204205f866206002ae774598de36fdf8f2985710b2c31ecd8c739e83318870355f850465f5c23899157c1153381b0baf499bfe82f7341b23b22a9f21fffe377f1fb551f9a1dd0b147e2b5b3605045e3ecf5c11616b5482bad65712c750630d5c3c14aeeb53be4e4ff11f2ddb99322c14c916ced8c9a285cd4a9d3c0a215c05097b2c817e4d784c4f46499a71272298ae9ec7107f2c8b5b91bc537ed7408bfbfdbb28b0369be331b4e41ec4ac57a74ed8bfc3b7da891f12ee85a9b6fa27896d750f74a7a2594b78bcc66425914eaa10fd64aa29aac2f889a6982d3e63189e1832997d9d782de5f295d110a18532a62b19e023f9c30c007f2db289cc08bfbefbdf4260863e0146dcbb257eb1e48ee50abb63512d94d3cc614bf512b940929bef6de4c96de0ec34430916b2d530d7888532b6def17b1718016c1efaf029380c668bd94b82013bcfa1c44a3822a1aa443c154cbd3fba53c49d8ff76352c1afdaaa04a6f3ebfeced3a8062cb2ba75d4227e625265f7912c3c562ed7e53222e813d931efda49f6eb7ecbcecdd0fcd86c2256f2dceb5a62391c644a2c0dee789d0707eea82db96e462e971b89e07d1cd863c138eb0276b0935473947e06de78e0d37e81517a2490a1c1cefb006cc77a82586195c022bc520964a43083c18676d4e88fe7394dd304f09cd668e1df31aae0e724e58e373745da209221d0663b3994d71899d75458daa022a5d4165b1d2aa9f360b8ec73f6733c7a4658bc45d0798bbb71eb08d0c0b7a653b5eb22b13a2b3958c859b795a99bf13dfc69ee4c8929799d72631ddb5f1c142e28d11eeb8e442991d4a56de74695a3e74125eb8a0ee84f88b75296ccf4067d7d5827377337ebfc2a186e2c051bee3bb175e6a97542f2bf397354f0ebabc7fa16c2ae268bf7dba2da621899044471cd5548deb411032568350d12b832292ea7d5f06eb004e4fff67b1bc94cc845d3b4c7d998ec2e16cf75cd5f37031943951095271582bf9c477f9585df3b256a31aa6f02c38fa196ff35a81c4b3f29b582762788ae71b2399c3fa2ea3cbda57223720e957fc0e0c1fffb917d3c5adb5c1917c5fd1260c64aa06ea3a7f9e5eb24c529fb39eaf210d57c9c60ee9a9b85fe4c0082de5d34322917ad9524799d66ce2570226be0df1810ccb67aff293fad5840fc18d2a81b1fdf81d63c1a03d95f6ab72bf495a9b89f03401dfc9f1b4b097cd3587ecca820ac9bda66246a63e3ac21085f4d6c505fbdf6517dd4b555cd93e09543dc93b6872ee86fc8ef6a62b71c5693dc6fed05196538214257193aac16931ecd2381b2c5d43e82eaf1898cf30df0900f29819ae03b42ecb29286759af9ada8805ce1c6f8717e8292fce7508eb3988ea5e11b117ffac56af0164f40af1df132183eacb6ec01518b5b442219289f532032f5ad9e46fa00c5e669cde085d06fa25479e7839c4ca2f5ead7ac4e942780c03a48251efdc762986e1ac653072f1558398670d81fabd84f0f2aede64e370b295701dba25d64e1ada2046b8fa796650bee74ad38efc5ddf78781b1a65abda4a5e837e9073d16efcee63fb8fead8d16c9295942b99efa3966c3b2519768853b96dde93cce4a405601a0be23ca286c2fda5c2f97e27081f63036a29e2aa4f168e88a0ee8e6eeaeff5d27dc796cac4ec7ba921130208adf5368e92440bdf8d8f34f232d690e619431b6b41cc359a7d5763e76a4de5d4024c506d9decac8f8b88d153fd9bae49e737efc376a229cba9c8fffea29f320c198ae9485f0f0aa63ccc9af841d57f0100128d6e57131f57fd926b70086a36b2283c048f0a20bc6b7de46fc07bf0dc0baf54e91ba9433393215398503456205fd19406c34e0baae3bb6e88dc35255aa0fcae1446a98c4cff3ce494fe6b9ab345ff49b1fed61a999e8d931deece976b184993d23b7d6f43c772bea93cd6259fb3a7a70be56486a5431e1ca1f024bf6fc606d829c29dbfb6fd22187209f4598ac8fa6f98d7485cbcc120bff5f878e7b69f2e1d36663ab48269a5ce9061383d622a06a13d108dbb848cf3b49067ac59703d7d38b7af88cfdc9106f594d253918a873d9954d42a67f54367f9ea7baf7df022086d3044772e2f35c7f86582cbf0a6c93fd5ba62cd16217cf6633d5f42b229452c63c9910e4c8ca23f5da38bcaaa9240b7352fcb11a00c8831eca3b450a3ab8ef3125221b9e0ace8fe1d2778ca47a555ee83764e2d3714da564d0777d95b0694242f6d3e19ef669affab353fbf4c251775535b595b4a1cf75e9ab0bc2c43a7e691a342f9f2a7d38bede17fea98783cf7102b49cc6f0cabc95afc231ad46f0ff6af971b3f9275b36431af999e198248c245fda36aebe4dfa2c844e76d16f08d217cd19a8f5d7cbb1cc08cd75b0607c996283efddc922d897c4d01f01740a37ad6576bbe6c1647ca64e561b3e148391a3664bfe69942f2444d6f3de068ce2924686cc3af5291ea9a3baa656aea27fa9d5d31de35e447e4a9ae9c56561ebea35bc82e5cad8d02d53bf7729550ae1a171f9c6367d37e290046fc3b781871e51455a3820ee91771f948489157a1bdf6da7af1cd449a4be0f84fbfa7f7a51d3127ba2e3737475fc245eba2ac3cd50bacb98dbd22f6b4cb22c314774a39ed560bcc9014c3a576f89cb2c4e9f4ac4759dadb928fc167833b97d35543376a5b1660e75d42982079d98964f6a119957a2208e598abe45b0213d12a113cb95cea9cb51d4fea4fcaea259380485a7210be5e5d5e56c80fb92c942ee68e71fe5ca7c00718e6cd5142861819266ab6bc637a0ca1054a558539061a92968616bd569d9f196c0e81b04be6d539aa37c1a94cbe9ca2128f6465c87cd4b905b4c873e785ae8fa9ce998aa23a56eae3969740d5f651a28085f7ce84a02e3696b48a58627cb37adb729f8a7bccd24050f75f73b7fde90dbf287c50597207b91eb1585de6657f2589e93a0deb93a847063e1c1980f31c911b6360749f686b98e1d16854f385fd15f57d623ce46d66f29ce34fcbcae4f04f678e081b3cc3512a0e9b4d07cf70fbda44a9d8e27ed56f69fd63653e6d8e80591029cd9da1a770cbc81dd229ef3ab982c4ec013c7628e6f6c41281674131c0764732a2904e525c2fea09b6e591602639add6569853a94fcfa2a8ec743f270747ee2ed2f2e45344d0bd513950155a13e3cd0fe2b726efca4edc44e12e12ae7d89ebfeb63d07888999c42a13f4a9eda7b9c1060e0fdbb5c1d5fe6c14edb77a356cb043b6537052536e97ad29828841c1e15c63e69372f05308acbe6c5ef1842cb7a7b4a42f9eaef3210050695a65a8f2dcbd339ac387573f47e8c99ba2b673a802198fdc9a387bdf568615a10f6139dab58f992806e88c7b419e9aae3bb56571ec196b7ed16c54dacddbf3a4d2c93084bcd10a5b42a5fe8a395a5fdd761560905b6cb16c49a5860fc08b6bdcc5391f4eb25eed57d8d85bf23b228789eb294d1375983d5a46d2ac16aaf49d4991299057995e4b3d22df934082fab05186110d24524d2423b62f677129d23fc2dbfc9b8040ab6747307c81067cb2f3797bce436902013397f32325a516a797035fb76c17df5c5bdf2ed5fd0a97a7222fa27f43a3b4d1371b32f466c1ca0418cb1c7940bd84b0327ffe397f93f8362dcec20dbf90352f1ffaa4e054f315e742f241846911295987d08b2142c104706f141a4333d3c4c78b8737d8bffdaa8660d71e99aa50063559cf7ebda998043d8b036bc701ed610ddf52b2e39b7a293779fd2bde0506bab2464901553bbb79bff7395d12f59ff53afd1a3ec07501d382dccbea93b24ba73257e96f17eafc2542e3cb166e7f71cc5280d7a2091c9e11c5f98e5009b9f2715694aadc7a44251deeb548e80ca53f7a5b965e445853561a773807f1be46a6f326c19eba94fc2520ceb5a1e11f2b934466dd086db2040216bbb830bc2904d2314836a3480614ede3f10e2ff2192c058311d049dc883972784d6279b4e43e5bc5723cd9628d5a5182d65e6bf982d9900ee11d95a4f4bf36bdcb7dedb40aaa2ff21d676d419705755d1eed61cfa0749783372de986cfa4335155e262fa4ce856374dbd011ab90f1cbc0fcba2b6d9d1c5daf8509666e15a6852372f2a6fb946a8f51ae61fb08e7aafb60f463420d5a7fdbf3e3864691fe7caf9c083194644e73428e14b2925b44fdcbb99efdcb4498ea2f4f0eb3c3660b99d35623f92c460f1a49681ef1556ff0670ca57b16d296b1afc82b192f089b039f3cebd6678497213815d240fcd1e15c8db253400840660e16b2ba2cc3b77f5af57a91c6f7f7ac862eb9628846aee2b9811b2ce032633739c6cce3f815fe8b49d1f57ffe20ec801637a68b2099ec5fc8e764ca47527d72d8210f13a616833f8c5a438c4f244f1d4cd85e2e856f994c749efd284e3deb4c74400bf66665f27790468fff0fa0c33d60759706bcdc5c2c96955e316b5f4a2ca0fa7552355c48609da5047639ec276a6d7fb99237f7cec0c96ba7086b7e9ae1952b228e3a86d4983d8eb2c02e7c55c61ded15e6d6c4b7c3b3b7de4359de1c98c9373c9113e17346a58a7ad396ddc0413c3b3cf3d51516ca560fc8543e39f282bfb7d68bc168e86e93c2be0fc67f1a6df75d0d8227adb8891e422bea9a8ae438cbf204df9ad621efe49d878f894dbd683b2de1b33517fdd1db0a7eb7eeeba18f4178947b1ba9f0c000a5206c9a252aa9e46e0677ab83fcd6219a5dfdae80b4bd80cbfdd81bf07e2d5cbe5db712f244ec588a47a117e0c849603eb7263fd1ca5a2c75d1a14db2058518596d3efb9fc05332cc1a758ec7168cbee83f5746a0dde6fa0eba0349cf572ecd1bb18a820e36aaffdf93b9ec1e8ca1691c2b181f81f39f361ac6d7520ed33f04cc618ce62276cb34973a63f6c39ec5d99030b666e48ab54ff5d8a36d87357b9493596511979f315891310bc2f9446a6408b670d029058040dae5729d4bd335cbd3127a332d1efdb2576bbe258934f42857d2bb7158fd4d046fd03519ca1778f8bb7528094c4a072124c37d13cdfbb191eccc72072e6621e8583afa9cb3bf33088d62960bc38bb873ca31ec7f5744f917e5dc7124c903056f98871c56e2aa927b253b510274d2630723c538a3f80778c62631d7f9533902316cbd5028ef23086ce0ddff868ef432fa20527c2b56fa59160ee90e1e570c8289c573231d2a0039c51fe3a7f87518f88c4010e9997675a3eb0144800da1f3f2fa8b553b79711faf477357fd037010a305b33f81d97999a59b4eea56f32a47b58576a3b48a27d05b6cd2dccf5e6f8146031b426ed7020aa9bc07a485117727455ecb0f80adaa03571c88bf7e293d9e282fbaab40bc8535a6814f338beb5be04734d8fbf842a3c43ecb2ff5681da40e0040ba34732a362e41377af842e48f087dc1b1001744f486c600ab5a956b96f2c7030df64d33fd3827ff817a5f1e87ee24aeeb2d963b181437938af5ae63779068483f3c0c69f2aa795ff3f881a67abea46c3726d02347eaf1a8322f0ccc42066fceda01217f7823171d0a1e3f6226cdb2f7470385ffbe0231e0b80ef03dcf85265a4da007c0039821c14bafcafd126f3932a46397824e06b22a1969fdb68bf40344e367dd62d45e9ed3570838efb3665e845c2214038c27630380ef8520ca3a53aa85834b13f99525487f643bbec7e289589b6859201a5a46c62624c3a231f822fbd8215c2663ff4313d8bbde1ef220705c45630eb3235f6c72aa0e164203f62b6765d9b7c93f58cd146ec271331c7c125503dffc164d3cb4207f503268342e70250b7f0b56b3f22f218b6d1947ea39cb20dce81721025150942d0d496714e2f12468cd937c9be6115f0616a71202511794ff628d08dbf6334ec138cc7bba24c267a0fbf35c1a30ab65ebeb12547c25754f7eafeebfcdbdd34203ed232e0fd8728c76a80d1f1746010e3c5259ea8a3f2c42b86ef7d7fbdca97638a824386d338798e872fa1d60454420701238bdc6cd4d5b98002a7bc1f99a7803f49030189cd5316e676e3402308d496d46314124d7e65ee81bdf69dedcb0f6512018ce37173f8f542b92921fc4b354999076d971d521afec5e05ff499dea786b82f3cfaf61a7cf39447aad3f1fe89c07c0a396d55d47da05cf0776db2f914d6cd19dc3a4bba61873cc6775ea2174bf2851b3b3341bdcee4cc0130d0ea6d6c13ef207963f7df0d1b489e0b6dee234e37eefcb849fd8871057dddb41f13679f54624c5881559f3ffb53dc6715391dad38ee5753745bec53c469e06346bb716b8c524b5e2757d4fb76e3df0b7be0f26b06d2e0cf3b9fd34fd781d71801a3b74865a2f367fd22e5a96c16b0b342be52becd9329b5970eab43d09204b72be40fa892ad480cbe70d453e746efd4abe12c15e50cc9807cd20f6cbd82d7354e8ef61d55cb7acb6a824e0729f4ccb3ac687bc1e5a7e78a5ece9bcdc33c61bcf8d6774950fe19e9b79b7d640f8abba5d2d89361de153324463bdc7a94f271c85bacd1e3f9eb58ba9c3b124e1c90e84469fd039fe40df8a003dcd34c4c34f6d26c0c743c102b4ea785998ab0c9c1de531d2ea2b7e8a5b0b665819fb042f81cdcbef52385c3f78f09ed68b5f72cc578c770c0e9b62da993e13b2031b070c17cbd9cc0d1428d4af51eb9a1de1166c32cf8b9be55dcd7054a8deb14c1dd02c562e504149b9e756e45b877d6df662d51e111fafef2cfde8d448f4df9ba59658f2eca54a9dd5fdb267f710d9e44effc0b8b3a582c0fbc95f43fbb0d9ef349abe0978f65ba3fd2bff3f376f5b7d000aad418ce775b3b442341084b48f2fb7db2006098cc51ade0806007661475c91817a4166d7b429e8f63bdf8e39fd338799f7f297dd16a5e19f3e2587f6fed4ed288cc19869dbe4c4906235fbdf7d0355a3cf49eef9ee90c1759c93b8eedee451d1b585adf07a6ba8d61f1b82dca59e815b3f6b2865aea05daf4aba6809c0fb8672e2f05525a632b8eef473f6bd6fb9b70ba558a3c0448f8f7e81dfd1aaf8ad0b6943f97a3a77d75900a76becc7be67ce36314f6e391e1349953a5f11e9d203ea566b27f1d74dc7399a8ea92b2537a6fb731dcca9ef76ad0ba7fa69b00f58db203a69fa25776ad2b4494f7b19ccf753a59c527b8abc45ed7386996c51ecb3be4402dd9c8f4fedca59832adfc93e2d65d252581ffebc48bfef4d4a84e1f9ec551f1b4f2c6412fed43e1c3697bdb1c2fab388e0f5826e1e050f732fe7435dcd3c93f8ed4c8afa5d16aafc32768e9a00c70a13656154eaefccc56d3992bdd498405e68282992b5aa141830d65396d8e4d6ff7f59cb45610b10c297772766d0fb9e55e5cb443fdd02bbadb2a374c541c266cb734b1fd7c1b839352c24493d48f7eaebbb466000183564ded5d5850191b8a227ce74a8cc9a9a3ab0e52ce99d74bc7653274c342c6f60aed70d93e3165d903e9fb4fd08bb926e51318650335857b67eae0abef520eec142b7b89961cb5be5c75dc0a414ce2130029b9f7df1c49a8c3f9ac28ac367703c33f7ca745dfbec3f5b9a01d0562862931e902224134d97abbfa9295b6bae64df2f188e2ad306473148031bc0ba8eeb531136cbb45c5016847e399446af6acfe82f749f47cc2b0d950bc1213596a5cb8e83faa7023602de615acb7c5f68fc9f00267b98c3306f6bdae9fa2b5554a19aab25daaf7d751c5b86d4af727503c2e52ffd4ee9cd0989c77561a91965a0d85e78ec69726120f1988bd65c08b1e1e439208585592ce3a2c3f86c6c2a0f75dcabc0b71f0f7014bb3808264c199eea6e487b4163b98dbee9d8c4c7ea043538a242c3cdf038e98ebaa1d3b09b8099ccb6bb3cee6ad7ed1c6acb2770a6cea104a6efda5335ee1aee51adbcbe56502db70b9c475734f79f0fa862920f865f972aad1954fb5707b686602cbe9d7935db10f8f92a287b7708f14eac50e85c88b61c51c906fd41f67791d3163eb16d004fe37d5527e8b469875944f6f8f51a73c64607e5fac0490e1b537e24dda45ee5acf0d371181eb103c6049d330a6a48ab1925503963e3ce8ddcd1746f6eaf63654c21b34a1b66bcbc79e5e9a198681cff6a1e8303a4707bfd63224b6eaa1bbe07fcf02b39ddd1edd7addf0ebeef0583cbd593ccb1684bfcf7a685786bf0ad75c7c6a9a7c8343f65e172533823dc122098faa8f81010bd763148e3c07f4e2c7429cf400b77faddd20625b0ff652799af663e6d1f9ef1068e368d2c10ad2f0f7d3c93b47ffe0f5e39d8050f97f28c9f467dfb83640f81e33417ca635a8fe74c37588867b2789c87b78f727b78ef429355e79b23e88ac0aaa2ec032d45380b913ff892687abb572f344f7d8fce3ee9463f037388faceb30a0ff073e19c932ef33a899c537f0fcc24dfef3d96c998997c676987958dd7abc770f7a04cb259c09cb0a1986841ee168d264f7c651ad32cc2e526a57649022933c01c070e3d6fe7eca0c55e6b47e397178a9f194f890457e25d9f9dbbd7c5ab72e4ebba6d405b9a7915d043811351bba4336e15583f181cc3b1da49dc7217ac2e3911982087ea97ee3dcce6a6f6318158c833d6847e468fcad853c55b11ce2645d797929634e4a578e3ff6666cafc4f459dafd0ef34cd9d050b017047624bb5c50bf0f88e4d693c786a0536451e5720f8b1a846707be17981ee62f3f8570abb0460e236fa4d15cf47f7cb1116c859a4cb630556ee8bac66e54cb2c42521d47e2b46e4b095eee2d7503bd15f56615c21bc689014df367e49fdcc1b8220a2e251eba2728dc3f4c1592f36302ae1ef99e2b84ec83ff69134782d83072634555b4cf4562a1983a5dcfd8c23a3e980b9110f740f5c060a3a459f1ca6f6d3a5bf88b61b6f12a416ce555e6f7d9b4e16d8947ac8f45280185da497d87909165a02d0b268592de87b1b7792b0506dc3e8a8b484957673e19fecbc96e644cb529a15a354a7bcfcfb4af8fab25aeff0852afa3736a17754a665a91758bedf85fa79c4da85405d24c3ccfedc57a9adb73334d03e3890147611558c9474d75343e66e9cf3c95eeff7b317b868d325a171e9126dd96990cd30df286c4b520c45217a38764852ac7c7f2e6eff7bcc9bf2d047949475c3d518e3ed49813187ce6aac6a59faf312cffdec9ffc6acb7b0274eac4728790c4491b7a2b338838c1f258515503057a05f54853e92dd945ddf76ccafa4f8d2eedd11f34e1202c1ef8e19935e1a70eeaf65f02e423d84b84d8145865033c7486a17797978a997d08876e446cc0ac390cb841c6f0494a16ad7b9b266761ee75ad104e66a092c83b142de16f13dd946eb4e2f88c4e91347f32126fa0ae6b8d1a593aaeed5e0bb45a0b1f2a035a9b070a030eed30ce722ccd5407836832fcd4428f370e66d934a444a532d7180f369bbd351311b32c7ac2940943f1eb2094bd5ce73f601cec3b0c62a98c3fc5a37b273b78fd2fb3e4bc3cadf9d1898f77a1277ab2e5be058fb6b6cc62db4d81d54d78f54ad09fc7a83af720fac607ba63e47fcd6dec428ec3cf746887a69ff1b7b7bfb8b1b9aaa06d20228f5fd3d54eee2b6a6c7d838f6b67fe03ba3ab7e0d2f53f9f9a1d1817f6842322f589717958aeb0f3acef16114370c1b29e369845629e333cc48aae1f6ca2f6e337c791a1abcde7cdc72c434f4d6c90d00f54ffde5b256cf3c2910c2f9d665e7ac3bf125ab4ec68709bba4e59866ccea82a581a3fcbe5bfb64e0c8c8394e57466cc2b4307ae588727f2696b6a92fabb19885b8f991849dcaab13f2d44dceac32a95b81a6a9f5d35b888d0c6850fd10f9d0af342d64914d91a555a6479e607098afb35a1b7c4f55d20244be88efd752ec0b52fddd4f233aba7132ea1c34710b51d0dad81edd1436701e96c69d3f133c40c67851eb278a36997e276537615c4be58b4d4ca8238c740b5b4cbe298217cd4db9cc2400f900cd46f9f0fcd4dfce5ef6b9c5ad0b6b4b430fe1338325983d64c9665d81f8e6f4a62fb895d40fab9b8dbd1fdac81d1aade8e919c608fb242c2be61885a73dafab994307354f08e635524a24fd0425a68ea8e29a2f59f7f24c879f1c0762e9242323b08769c06da1a1f1c06b2f8cfb8407fe9638504b8abb05b56031841513dcfd9f028e2a15d2a72eeb09e35499dd373e26a865607ca78558a323f9b60a9440b8be961d1306771e3d3648bc7c23e18a59de17c9e8567d005410895fa4ec525bfbbd487cda5127dc8771efd14806d514b35d2cbff25f0ea8b32f7da296771c6ee3a64bb9bec1e293806901e056b6a603a6a85a9e6d587eb8903b7f0fbec7db2ac3b35300617b6952b5255747ae7464fe0423c13f4fd29c482e2bde6dd09eeb2ac1005997b5be49c808e035f18a7a2a9b7fef193fcde8cee3ebd6e4737c7549bf1d5ca54d2b92850a17c7e1f3fcb443a445f98dc4e7105e27398a93537640e38f54233f63c32ec32e40bb435bfae2963de1be902a117be05b9e9f7375b72a3ea1673e1862ff9e8e9e446f223788e7f1e3d73eea22caa76542093c8bffc223ce71def63fd385ca2e4e7a4233b2f142cd5aab39204c69c85ffebc4be34e9be4366b34ad4a358352d14a5630f0d76ec754949abd07c9b46e39816d6f86802ce333564608a89305c209eb22c83ebe30ec059d453bd5f39d3da3a4bd1001f355005879f709d15a1391c4ca8f41a200cc36889f9f349cda17e51c5c2a2ad94e7d90fa274a672fe3b09cce4023e2b622bed9d9dfe7662c5631bb0fe59632bdbb1c8d97ea4c292ef625eebbc8d2f734e4d53f98a4514d44a21571acf266fd9ed94c52e4a50a612b61be65d5ffdf14e31ecf3d501da8b58c9906dec24c0e7ebbc55a8d8482e5aa385b1941f9c6d6a1c93b95e3bb4a157ee9775e4e84d48683b23aa3cea0127373b68e66aa88f17e46b90708ea5a9686e49360dd7cd4e9133da195b40600e8988816985515f8e61dd9eb82047a998c31ef0a08aa80b7c8cea9de7d75fc5874d74aee50663df6669629bb1cc6541242553c4a35dc85c71da7463e8ff3c82eb0549adccae5c69a2419d6e221882942f59ab81b559f2724014aed2f21c8e2d52dce954dac16ec954bed546a5ddbeecacf969e1564dcab4b1abf26b441705f103e4fb160935aa872008b3abf5c6d882bf5ea61d13015b863af516ed40c6b1c6a35e6e9bdc4e1be63b7fef64f8ef3850ba076fd20e454342e3a891415d1ebb7d2f44b1c423f08988e1ccc4d90c73fdd7a4e0318a5e48f474e14009ae5149a2d39aa4b55e7b9f93640dab94fef1639d825851117b2468f63d10599d2f2d6622681734ee826d1dbf8d781e3117a517f8da4e7d886d71bd3c582cafeb9441d6194c1eaee2f702d79a99ba829301e6bd4eaeb505376700e9e589f97433c86d8096ba595e54bdc9ef0ba2044d2ab8c2d8278816195e554929da939cd1f8f4fed8d2752c5966c6e2f82852dcf8500a2ef6998f222e869a904765659419ffa22de9fe1c265f910f4704d46396323629001a42e486629170e392ab3672e4e2034909ec1acfb5bccb1768963deea508361939118a29c9d15652c1892f6836bff3a6fb570c35d8440abc648e26335821d0008f154c1b97b67959fbdca36259f4333ecf452480edd6ecbc542503db5fbe9b6781e899c0d3a7bca26c9ce0d8be2bc5becc11ac7fceabb2c15697b4bc46163f8c591cc64f17f2b60c6eef198b4678ffa1a58a531a25a23547c24216d519fdc438993ee15543ce5066d41386f488ebf4af07f69f02fe64cdaf321dafa7ed4e51c3ee9aff35bd0d2d60a65306a4c120221e3a10a1c07aa6b38ec7c71221954e3c5928b8f758167727e0e1eb5ada182b4b58f08cef56ba9fdceaa6c7afd20e4e412b5d69cc7783d1a370a8a78d82e6d309e9ae903c17c149ece3fa54bd8448a4955c179eb94062de31cf9eda6e0ee596bb2ba17014a0b3dd1c9fc5c3ae101c1b7a59d5ebe672963bf8d6172bee90c45075c82b7dffab2aa1e5f7c73475ffca7cd332ae594ecc2c75ef2703138ed985747fa8393754e86cf7c429427c17ce64b425032b08e88693798ba8a9b5a8a32a193ee619547d31b8ef2aa81c303cacd8a2528426bda8fe9fc051aaaedaf9be35bee1a253f64b252263781d50fddf44f791cb4a16cc33910f2a5ff7ff1ff4fcdb6ae2ca34d37df1af60153f8952839adbaf11606d0a70baa3c187b466d8b7aa4c617343890590860041f78a9a345fb9743f6c29e58541b37197fa1d4cda643498a67223cc4cb9830cc13bb9b43f6c8aad0584f52ac684fba26ecb646caf33dc0b3e7f169d81a08868b09fac25eeaf6508ea79ba50b7d81d8d1595de029958848260403b74235c1649e5b16c092af331f3923dc980ab0483399c19a735db291e957be547a7486c6a14645021a29618089bca1c1cf4621101b3ed69d77f87372442b783980bf55befc4eabba8d971136bd3b26681bf2e6eb8ffe4a7acc6a0a791bb636adee59088906c571cec7b25808b4d18143d7fc58e6e50182fa7dc71e967adf13d3113de286cfff1603c377698818120e4a9346aa038ecd6ac9223d6ada8ba34b7a84e9e6ea2fa796b8362cad8322d0940ac0eb2e165b2c2465b0cc09e3c10dca43bc38a6b7fee6b16f6a2c46672e667d3fe97d9ad145c2812ec1aec9653b704650ae5d3686b40a468fc3c085731794d678be4f82c3f3d9442c5ca7a0b72ac6664e548edfbd315851863a5b9383f1736a358865c8b1e22c2d68067ba5e7e9d75a4ab9dfa6dd1c6bdbb48b9d1325f4823d5501b17c46822627c59a8bb1c0e53279cc383aa01bf10365b49c91fc177942f5be6f53a9e6e6dbfa8fc0d2ce3beb9e2044b4a9ccc566b155aeb314ec1dcbe245d0eaa4b83dbe46899a72890211551f2695882d46d33eb11de60598f8b959432efe9e39abb522ef3d97d54dc7bd6b6b0930effefd37f1c800e46c0a6819fd71851ea834cf797bf5915a410e13deeb393fdc0bcc240af7d8663b03e938455f83504c75d113d5bf9df1811db3f3099313212c04822e2cfe3b154db3668c2c7cc72d41f2e80daf33c7f7f8c094bce4fb05637f3cfd4b64429c907e4236535a6c1bd21b1744aa025218c63add6331d7a2de4cecf4aed39b570788b2fa69416ddd8be975ea39d06c8bf7dcaf1a03fb5d32b22254c4e1f5a49f7f8f6db11c543f10be941217cf534e3a986b20d4ed2e75ba313714e5081d94af7605c72e117f34de9eeb40b2dd2e0500793231389493c9da7ee6b535280e01b4c865a87d0e7c538ad078f0efd198e1c572b4e7fccb56a6a0750ac64bba2f31eeac3f1bc4add5ce52914fdc656615027b1993bd419922fe402456ed7981eff9348918f3a25862d618c2082f8d4699752aee80ba6032c3d346ac9bc650d1e3a73c92edb34ff2a699de102548536eb1be0f39ca063c731c8b</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-blink">      <input class="hbe hbe-input-field hbe-input-field-blink" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-blink" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-blink" data-content="请输入密码">请输入密码</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      
        <tags>
            
            <tag> password </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SQL子查询</title>
      <link href="/2025/09/23/SQL%E5%AD%90%E6%9F%A5%E8%AF%A2/"/>
      <url>/2025/09/23/SQL%E5%AD%90%E6%9F%A5%E8%AF%A2/</url>
      
        <content type="html"><![CDATA[<h2 id="🍋子查询的初步使用">🍋子查询的初步使用</h2><ul><li>企业常用的子查询示例？</li><li>有哪些必须用子查询的情况，有哪些常见的改join/with提高性能的例子？</li><li>Hash Join、Semi Join、宽表、FilterProject、SemiJoin 、HashBuilder这些词什么意思</li></ul><p>下面把“<strong>必须用子查询</strong>”和“<strong>可以改 JOIN / WITH 提速</strong>”这两种场景一次性拆开讲透。</p><p>每条都给出 <strong>Trino（Presto）语法示例</strong>，并注明 <strong>为什么必须/可以改写</strong></p><h3 id="一、4-种“必须用子查询”的场景">一、4 种“<strong>必须</strong>用子查询”的场景</h3><p>（改写 JOIN 会<strong>语义错误</strong>或<strong>更慢</strong>）</p><table><thead><tr><th style="text-align:left">场景</th><th style="text-align:left">必须用子查询的原因</th><th style="text-align:left">Trino 示例</th></tr></thead><tbody><tr><td style="text-align:left">1. 聚合后回查原表（“找高于部门平均”）</td><td style="text-align:left">聚合值与明细行<strong>逐行比较</strong>，JOIN 先聚合再回查=自己和自己连，只能用相关子查询或窗口函数</td><td style="text-align:left">SELECT * FROM employee e WHERE <code>salary &gt;</code> (SELECT <code>AVG(salary)</code> FROM employee WHERE dept=e.dept)</td></tr><tr><td style="text-align:left">2. EXISTS / NOT EXISTS</td><td style="text-align:left">语义是“<strong>有无匹配</strong>”，JOIN 会<strong>放大行数</strong>；NOT IN 对 NULL 敏感</td><td style="text-align:left">SELECT * FROM customer c WHERE NOT <code>EXISTS</code> (<code>SELECT 1</code> FROM orders o WHERE o.customer_id=<a href="http://c.id">c.id</a>)</td></tr><tr><td style="text-align:left">3. 行号/ Top-N 子查询（每组取最新 1 条）</td><td style="text-align:left">需要<strong>先排序再过滤</strong>，JOIN 写不出“每组”限制</td><td style="text-align:left">SELECT * FROM (SELECT *, row_number() OVER (PARTITION BY user_id ORDER BY login_dt DESC) rn FROM login_log) t <code>WHERE rn=1</code></td></tr><tr><td style="text-align:left">4. 测量数据质量（重复主键、空值率）</td><td style="text-align:left">只关心<strong>统计结果</strong>，不需要展开明细；JOIN 会强行拉明细</td><td style="text-align:left">SELECT order_id, COUNT() FROM orders GROUP BY order_id <code>HAVING COUNT()&gt;1</code></td></tr></tbody></table><h3 id="二、6-个“常见可改写”例子">二、6 个“<strong>常见可改写</strong>”例子</h3><p>（子查询 → JOIN / WITH，<strong>性能 2-10 倍</strong>提升）</p><h4 id="1-相关子查询-→-JOIN">1. 相关子查询 → JOIN</h4><p><strong>原写法（慢）</strong></p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> emp_id, emp_name,</span><br><span class="line">       (<span class="keyword">SELECT</span> dept_name <span class="keyword">FROM</span> department d <span class="keyword">WHERE</span> d.dept_id <span class="operator">=</span> e.dept_id) <span class="keyword">AS</span> dept_name</span><br><span class="line"><span class="keyword">FROM</span> employee e;</span><br></pre></td></tr></table></figure><p><strong>改写（快）</strong></p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> e.emp_id, e.emp_name, d.dept_name</span><br><span class="line"><span class="keyword">FROM</span> employee e</span><br><span class="line"><span class="keyword">JOIN</span> department d <span class="keyword">ON</span> d.dept_id <span class="operator">=</span> e.dept_id;</span><br></pre></td></tr></table></figure><p><strong>提速点</strong>：把 <strong>每行一次索引回表</strong> 改成 <strong>一次 Hash Join</strong>。</p><hr><h4 id="2-相关聚合子查询-→-WITH-JOIN">2. 相关聚合子查询 → WITH + JOIN</h4><p><strong>原写法（O(N²)）</strong></p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> emp_id, salary,</span><br><span class="line">       salary <span class="operator">-</span> (<span class="keyword">SELECT</span> <span class="built_in">AVG</span>(salary) <span class="keyword">FROM</span> employee <span class="keyword">WHERE</span> dept_id <span class="operator">=</span> e.dept_id) <span class="keyword">AS</span> diff</span><br><span class="line"><span class="keyword">FROM</span> employee e;</span><br></pre></td></tr></table></figure><p><strong>改写（O(N)）</strong></p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">WITH</span> dept_avg <span class="keyword">AS</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> dept_id, <span class="built_in">AVG</span>(salary) <span class="keyword">AS</span> avg_salary</span><br><span class="line">    <span class="keyword">FROM</span> employee</span><br><span class="line">    <span class="keyword">GROUP</span> <span class="keyword">BY</span> dept_id</span><br><span class="line">)</span><br><span class="line"><span class="keyword">SELECT</span> e.emp_id, e.salary, e.salary <span class="operator">-</span> d.avg_salary <span class="keyword">AS</span> diff</span><br><span class="line"><span class="keyword">FROM</span> employee e</span><br><span class="line"><span class="keyword">JOIN</span> dept_avg d <span class="keyword">ON</span> d.dept_id <span class="operator">=</span> e.dept_id;</span><br></pre></td></tr></table></figure><p><strong>提速点</strong>：聚合只算一次，复用结果。</p><hr><h4 id="3-IN-子查询-→-Semi-Join">3. IN (子查询) → Semi Join</h4><p><strong>原写法</strong></p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> customer</span><br><span class="line"><span class="keyword">WHERE</span> customer_id <span class="keyword">IN</span> (<span class="keyword">SELECT</span> customer_id <span class="keyword">FROM</span> orders <span class="keyword">WHERE</span> order_amt <span class="operator">&gt;</span> <span class="number">10000</span>);</span><br></pre></td></tr></table></figure><p><strong>改写（Trino 自动做，也可显式写）</strong></p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> c.<span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> customer c</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">EXISTS</span> (<span class="keyword">SELECT</span> <span class="number">1</span> <span class="keyword">FROM</span> orders o <span class="keyword">WHERE</span> o.customer_id <span class="operator">=</span> c.customer_id <span class="keyword">AND</span> o.order_amt <span class="operator">&gt;</span> <span class="number">10000</span>);</span><br></pre></td></tr></table></figure><p><strong>提速点</strong>：Semi Join 可在 <strong>Hash Build 阶段</strong>直接过滤，<strong>不放大右表</strong>。</p><hr><h4 id="4-子查询当“临时宽表”-→-WITH-展开后多次复用">4. 子查询当“临时宽表” → WITH 展开后多次复用</h4><p><strong>场景</strong>：同一张中间结果要被<strong>选两次</strong></p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">WITH</span> high_val_customer <span class="keyword">AS</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> customer_id, <span class="built_in">SUM</span>(order_amt) <span class="keyword">AS</span> total</span><br><span class="line">    <span class="keyword">FROM</span> orders</span><br><span class="line">    <span class="keyword">GROUP</span> <span class="keyword">BY</span> customer_id</span><br><span class="line">    <span class="keyword">HAVING</span> <span class="built_in">SUM</span>(order_amt) <span class="operator">&gt;</span> <span class="number">100000</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">SELECT</span> h.customer_id, h.total, a.address</span><br><span class="line"><span class="keyword">FROM</span> high_val_customer h</span><br><span class="line"><span class="keyword">JOIN</span> address a <span class="keyword">ON</span> a.customer_id <span class="operator">=</span> h.customer_id;</span><br></pre></td></tr></table></figure><p><strong>提速点</strong>：只扫描一次 <code>orders</code>，<strong>CTE 结果默认物化</strong>（Trino 358+ 支持 <strong>CTE Reuse</strong>）。</p><hr><h4 id="5-多层嵌套子查询-→-一步-JOIN">5. 多层嵌套子查询 → 一步 JOIN</h4><p><strong>原写法</strong></p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> sku s</span><br><span class="line"><span class="keyword">WHERE</span> category_id <span class="operator">=</span> (<span class="keyword">SELECT</span> category_id <span class="keyword">FROM</span> category <span class="keyword">WHERE</span> category_name <span class="operator">=</span> <span class="string">&#x27;手机&#x27;</span>)</span><br><span class="line">  <span class="keyword">AND</span> brand_id    <span class="operator">=</span> (<span class="keyword">SELECT</span> brand_id   <span class="keyword">FROM</span> brand    <span class="keyword">WHERE</span> brand_name    <span class="operator">=</span> <span class="string">&#x27;华为&#x27;</span>);</span><br></pre></td></tr></table></figure><p><strong>改写</strong></p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> s.<span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> sku s</span><br><span class="line"><span class="keyword">JOIN</span> category c <span class="keyword">ON</span> c.category_id <span class="operator">=</span> s.category_id <span class="keyword">AND</span> c.category_name <span class="operator">=</span> <span class="string">&#x27;手机&#x27;</span></span><br><span class="line"><span class="keyword">JOIN</span> brand    b <span class="keyword">ON</span> b.brand_id    <span class="operator">=</span> s.brand_id    <span class="keyword">AND</span> b.brand_name    <span class="operator">=</span> <span class="string">&#x27;华为&#x27;</span>;</span><br></pre></td></tr></table></figure><p><strong>提速点</strong>：两次相关子查询 → <strong>一次多表 Hash Join</strong>，且可以利用 <strong>复合索引</strong>。</p><hr><h4 id="6-子查询里再子查询-→-扁平化-JOIN-窗口函数">6. 子查询里再子查询 → 扁平化 JOIN + 窗口函数</h4><p><strong>原写法</strong></p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> <span class="operator">*</span>, (<span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">FROM</span> orders o <span class="keyword">WHERE</span> o.customer_id <span class="operator">=</span> c.customer_id) <span class="keyword">AS</span> cnt</span><br><span class="line">    <span class="keyword">FROM</span> customer c</span><br><span class="line">) t</span><br><span class="line"><span class="keyword">WHERE</span> cnt <span class="operator">&gt;=</span> <span class="number">5</span>;</span><br></pre></td></tr></table></figure><p><strong>改写</strong></p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> c.<span class="operator">*</span>, t.cnt</span><br><span class="line"><span class="keyword">FROM</span> customer c</span><br><span class="line"><span class="keyword">JOIN</span> (<span class="keyword">SELECT</span> customer_id, <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">AS</span> cnt <span class="keyword">FROM</span> orders <span class="keyword">GROUP</span> <span class="keyword">BY</span> customer_id) t</span><br><span class="line">  <span class="keyword">ON</span> t.customer_id <span class="operator">=</span> c.customer_id</span><br><span class="line"><span class="keyword">WHERE</span> t.cnt <span class="operator">&gt;=</span> <span class="number">5</span>;</span><br></pre></td></tr></table></figure><p><strong>提速点</strong>：把 <strong>相关子查询</strong> 变成 <strong>非相关聚合</strong>，再 <strong>Hash Join</strong>。</p><h3 id="三、1-张决策表，10-秒判断“能不能改”">三、1 张决策表，10 秒判断“能不能改”</h3><table><thead><tr><th style="text-align:left">检查项</th><th style="text-align:left">子查询必须保留</th><th style="text-align:left">可改写 JOIN/WITH</th></tr></thead><tbody><tr><td style="text-align:left">是否 EXISTS / NOT EXISTS</td><td style="text-align:left">✅</td><td style="text-align:left">❌</td></tr><tr><td style="text-align:left">是否“聚合后回查明细”</td><td style="text-align:left">✅（或改窗口）</td><td style="text-align:left">❌</td></tr><tr><td style="text-align:left">是否“每组 Top-N”</td><td style="text-align:left">✅（需窗口）</td><td style="text-align:left">❌</td></tr><tr><td style="text-align:left">是否只拿聚合指标</td><td style="text-align:left">❌</td><td style="text-align:left">✅（先 WITH 聚合）</td></tr><tr><td style="text-align:left">是否相关子查询且<strong>无聚合</strong></td><td style="text-align:left">❌</td><td style="text-align:left">✅（直接 JOIN）</td></tr><tr><td style="text-align:left">是否 IN (子查询)</td><td style="text-align:left">❌</td><td style="text-align:left">✅（Semi Join）</td></tr></tbody></table><h3 id="四、小结口诀">四、小结口诀</h3><blockquote><p><strong>“聚合回查、存在性、Top-N 必须子查；其余一律拉出来做 JOIN/WITH。”</strong></p></blockquote><p>拿不准执行计划时，<strong>EXPLAIN (TYPE DISTRIBUTED)</strong> 看有没有 <strong>FilterProject+SemiJoin</strong> 或 <strong>HashBuilder</strong> 即可。</p><h3 id="高频黑话">高频黑话</h3><ol><li>Hash Join（哈希连接）</li></ol><ul><li><p><strong>定义</strong>：把两表里<strong>连接键</strong>先算成哈希表，再一次性“对号入座”做等值匹配。</p></li><li><p><strong>类比</strong>：老师拿两张名单，先给 A 班每人发一个“学号-座位号”小纸条（建哈希表），再让 B 班学生按纸条找座位，<strong>O(1) 定位</strong>。</p></li><li><p><strong>Trino 计划里</strong>：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">└─ InnerJoin[hash = (user_id)]  </span><br><span class="line">   ├─ Scan[user_id, …]  ←  Build 端（通常选小表）  </span><br><span class="line">   └─ Scan[user_id, …]  ←  Probe 端</span><br></pre></td></tr></table></figure></li></ul><ol start="2"><li>Semi Join（半连接）</li></ol><ul><li><p><strong>定义</strong>：只关心<strong>左表记录是否在右表存在匹配</strong>，<strong>不返回右表列</strong>，也<strong>不去重左表</strong>。</p></li><li><p><strong>类比</strong>：安检门只看你是否在“黑名单”里，<strong>查到就拦下</strong>，不会把黑名单详细信息打印出来。</p></li><li><p><strong>Trino 自动把</strong> <code>EXISTS / IN (子查询)</code> <strong>改写成</strong> <code>SemiJoin</code>：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">└─ SemiJoin[hash = (user_id)]  </span><br><span class="line">   ├─ Scan…  ← 左表（旅客）  </span><br><span class="line">   └─ Scan…  ← 右表（黑名单）</span><br></pre></td></tr></table></figure></li></ul><ol start="3"><li>HashBuilder（哈希建造者）</li></ol><ul><li><strong>定义</strong>：Trino 执行计划里的一个<strong>运行时算子</strong>，负责把 Build 端数据<strong>全部读进内存</strong>并建成哈希表。</li><li><strong>类比</strong>：安检人员先把黑名单<strong>一次性录入扫描枪</strong>（HashBuilder），后面每过来一个旅客就<strong>扫一下枪</strong>（Probe）。</li><li><strong>计划关键字</strong>：<code>HashBuilder[hash = (key)]</code> 常出现在 <code>SemiJoin</code> 或 <code>HashJoin</code> 的<strong>右分支</strong>。</li></ul><ol start="4"><li>FilterProject（过滤+投影）</li></ol><ul><li><p><strong>定义</strong>：Trino 里最轻量的算子，<strong>先过滤行</strong>（Filter）<strong>再裁剪列</strong>（Project），无 I/O 开销。</p></li><li><p><strong>类比</strong>：超市收银台：先把你购物车里的<strong>过期商品扔掉</strong>（Filter），再把<strong>不需要的小票副联撕掉</strong>（Project）。</p></li><li><p><strong>计划示例</strong>：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">└─ FilterProject[predicate = (status = &#x27;PAID&#x27;)]  </span><br><span class="line">   └─ Scan…</span><br></pre></td></tr></table></figure></li></ul><ol start="5"><li>宽表（Wide Table）</li></ol><ul><li><strong>定义</strong>：把<strong>多张维度表字段冗余到一张事实表</strong>里，减少 Join，牺牲存储换查询速度。</li><li><strong>类比</strong>：原本要点 5 份外卖（5 张表 Join），现在直接买一份“全家桶”（宽表），<strong>一口吃到所有菜</strong>。</li><li><strong>在 Trino 里</strong>：宽表通常以 <strong>Hive/Iceberg Parquet/ORC</strong> 形式存在，<strong>列式存储 + 分区</strong>，配合 <strong>列裁剪</strong> 扫描极快。</li></ul><ol start="6"><li>总结</li></ol><table><thead><tr><th>术语</th><th>口诀</th></tr></thead><tbody><tr><td>Hash Join</td><td>小表先变哈希，大表逐行探。</td></tr><tr><td>Semi Join</td><td>只问“有没有”，不拿右表数据。</td></tr><tr><td>HashBuilder</td><td>造哈希表的阶段，看右支。</td></tr><tr><td>FilterProject</td><td>先过滤行，再裁剪列。</td></tr><tr><td>宽表</td><td>把字段先拼好，省掉 Join。</td></tr></tbody></table><h2 id="🍋子查询其他">🍋子查询其他</h2><h4 id="LATERAL横向子查询">LATERAL横向子查询</h4><ul><li>横向子查询是什么</li><li>这效率很不高吧</li><li>那我为什么不用普通 JOIN</li><li>ON true什么意思</li></ul><p>“横向子查询”是 LATERAL子查询 的直译，也有人叫 横向派生表、横向连接。 它的核心作用只有一句话：</p><blockquote><p>让右侧的子查询能够引用左侧已经列出的表/别名，实现“逐行计算”。</p></blockquote><ol><li>出现位置 只能出现在 <code>FROM</code> 或 <code>JOIN</code> 子句里，且前面必须带关键字 <code>LATERAL</code>（PostgreSQL、SQL Server、Oracle、MySQL 8.0+ 都支持）。</li><li>与普通子查询的区别</li></ol><table><thead><tr><th>普通派生表</th><th>LATERAL 子查询</th></tr></thead><tbody><tr><td>先整体算出结果，再拿给外层用</td><td>对外层每一行都重新计算一次</td></tr><tr><td>内部看不到外层的任何列</td><td>内部可以直接引用外层“左边”已经出现的列</td></tr></tbody></table><ul><li>一眼看懂例子<ul><li>需求：对每笔订单，找出“该客户”历史订单里金额最高的那一条。</li><li>orders订单表</li></ul></li></ul><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> o.<span class="operator">*</span>, top.<span class="operator">*</span><span class="keyword">FROM</span> orders <span class="keyword">AS</span> o</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> <span class="keyword">LATERAL</span> (<span class="keyword">SELECT</span> <span class="operator">*</span><span class="keyword">FROM</span> orders o2</span><br><span class="line">    <span class="keyword">WHERE</span> o2.customer_id <span class="operator">=</span> o.customer_id      <span class="comment">-- 直接用到外层 o 的列</span></span><br><span class="line">    <span class="keyword">ORDER</span> <span class="keyword">BY</span> o2.amount <span class="keyword">DESC</span></span><br><span class="line">    LIMIT <span class="number">1</span></span><br><span class="line">) <span class="keyword">AS</span> top <span class="keyword">ON</span> <span class="literal">true</span>;</span><br></pre></td></tr></table></figure><p>典型场景速记</p><ol><li>每组/每行求 Top-N、累积、相邻行、行列转换</li><li>把“相关子查询”改写成 JOIN 形式，方便利用索引、避免重复扫描</li><li>需要“行级函数”效果，又不想写存储过程</li></ol><h2 id="🍋子查询的时候用-EXISTS-还是-IN">🍋子查询的时候用 EXISTS 还是 IN</h2><p>简单来说：<strong>大多数情况下建议优先使用 <code>EXISTS</code>，因为它通常有更好的性能表现，并且能更自然地处理 <code>NULL</code> 值。</strong></p><h3 id="1-核心区别">1. 核心区别</h3><ul><li><strong><code>IN</code>：</strong> 先执行子查询，将结果集存在内存中，然后对外部查询进行遍历，检查外部表的值是否在子查询的结果集中。</li><li><strong><code>EXISTS</code>：</strong> 对外部查询进行遍历，对每一行数据都执行一次子查询，如果子查询返回任何记录，则放入结果集（<strong>不关心子查询返回的具体内容，只关心是否有返回行</strong>）。</li></ul><h3 id="2-性能对比">2. 性能对比</h3><ul><li><p><strong>当子查询表大，外部表小时（<code>EXISTS</code> 胜出）：</strong><br>如果子查询返回的数据量很大，使用 <code>IN</code> 可能会消耗较多内存和临时表空间。<code>EXISTS</code> 因为是一种<strong>半连接</strong>机制，通常可以利用索引更快地找到匹配项。</p></li><li><p><strong>当子查询表小，外部表大时（不一定）：</strong><br>如果子查询很小，<code>IN</code> 可能会更快（因为子查询只需要执行一次）。<code>EXISTS</code> 需要对外部表进行全表扫描，但如果外部表的关联字段有索引，<code>EXISTS</code> 依然很快。</p></li><li><p><strong>现代数据库的优化：</strong></p><p>在 <strong>MySQL 8.0+</strong>、<strong>PostgreSQL</strong>、<strong>SQL Server</strong> 等现代数据库中，优化器通常会自动将 <code>IN</code> 转换为 <code>SEMI JOIN</code> 或类似 <code>EXISTS</code> 的执行计划，两者性能差异已不大。</p><p><strong>但注意</strong>：当子查询<strong>无法使用索引</strong>时，手动选择仍然重要。</p></li></ul><h3 id="3-NOT-IN-与-NOT-EXISTS（巨大差异）">3. NOT IN 与 NOT EXISTS（巨大差异）</h3><ul><li><strong><code>NOT IN</code> 有风险：</strong><br>如果子查询的结果中<strong>包含任何一个 <code>NULL</code></strong>，<code>NOT IN</code> 会返回<strong>空集</strong>（因为 <code>id NOT IN (1, 2, NULL)</code> 等价于 <code>id != 1 AND id != 2 AND id != NULL</code>，而 <code>id != NULL</code> 永远是未知的）。<br><strong>因此，如果使用 <code>NOT IN</code>，必须确保子查询的结果集剔除掉 <code>NULL</code> 值。</strong></li><li><strong><code>NOT EXISTS</code> 很安全：</strong><br>不受 <code>NULL</code> 影响，只要子查询没找到匹配行，就返回真。</li></ul><h3 id="4-使用建议">4. 使用建议</h3><h4 id="1-优先使用-EXISTS-的场景">1. <strong>优先使用 EXISTS 的场景</strong></h4><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 检查存在性（相关子查询）</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> A </span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">EXISTS</span> (<span class="keyword">SELECT</span> <span class="number">1</span> <span class="keyword">FROM</span> B <span class="keyword">WHERE</span> B.id <span class="operator">=</span> A.id);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 优势：找到第一个匹配就停止，不会全表扫描B</span></span><br></pre></td></tr></table></figure><ul><li>子查询表 <strong>B 很大</strong>，主查询表 <strong>A 较小</strong></li><li>需要判断&quot;是否存在&quot;而非获取具体值</li><li>如果做反查询（找不存在的数据），<strong>除非能100%确定子查询结果不含 NULL，否则请直接使用 <code>NOT EXISTS</code></strong>。</li></ul><h4 id="2-优先使用-IN-的场景">2. <strong>优先使用 IN 的场景</strong></h4><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">--  固定小集合查询</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> A </span><br><span class="line"><span class="keyword">WHERE</span> id <span class="keyword">IN</span> (<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">--  子查询结果很小且确定</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> A </span><br><span class="line"><span class="keyword">WHERE</span> id <span class="keyword">IN</span> (<span class="keyword">SELECT</span> id <span class="keyword">FROM</span> B <span class="keyword">WHERE</span> status <span class="operator">=</span> <span class="string">&#x27;active&#x27;</span> LIMIT <span class="number">10</span>);</span><br></pre></td></tr></table></figure><ul><li>子查询结果集 <strong>很小且确定</strong>（如常量列表）</li><li>需要匹配具体值列表</li></ul><h4 id="3-避免使用的场景">3. <strong>避免使用的场景</strong></h4><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- ❌ IN + 子查询含 NULL（返回空结果）</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> A <span class="keyword">WHERE</span> id <span class="keyword">IN</span> (<span class="keyword">SELECT</span> id <span class="keyword">FROM</span> B); <span class="comment">-- B.id 含 NULL</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- ❌ IN + 子查询结果集巨大（性能差）</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> A <span class="keyword">WHERE</span> id <span class="keyword">IN</span> (<span class="keyword">SELECT</span> id <span class="keyword">FROM</span> B); <span class="comment">-- B 有百万行</span></span><br></pre></td></tr></table></figure><h3 id="5-最佳实践总结">5. 最佳实践总结</h3><table><thead><tr><th>场景</th><th>推荐</th><th>原因</th></tr></thead><tbody><tr><td>判断存在性</td><td><code>EXISTS</code></td><td>短路求值，性能稳定</td></tr><tr><td>小值列表</td><td><code>IN</code></td><td>简洁高效</td></tr><tr><td>子查询可能含 NULL</td><td><code>EXISTS</code> 或 <code>IN + NOT NULL</code> 过滤</td><td>避免逻辑错误</td></tr><tr><td>两表都很大</td><td><code>EXISTS</code> 或 <code>JOIN</code></td><td>优化器更易生成高效计划</td></tr></tbody></table><p><strong>一句话原则</strong>：不确定时，用 <code>EXISTS</code> 更安全；确定子查询结果很小，用 <code>IN</code> 更简洁。</p>]]></content>
      
      
      
        <tags>
            
            <tag> SQL </tag>
            
            <tag> Trino </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SQL窗口函数速查表</title>
      <link href="/2025/09/23/SQL%E7%AA%97%E5%8F%A3%E5%87%BD%E6%95%B0%E9%80%9F%E6%9F%A5%E8%A1%A8/"/>
      <url>/2025/09/23/SQL%E7%AA%97%E5%8F%A3%E5%87%BD%E6%95%B0%E9%80%9F%E6%9F%A5%E8%A1%A8/</url>
      
        <content type="html"><![CDATA[<h3 id="一、排名与分布分析类（核心用：给数据-“排位置、看占比”）">一、排名与分布分析类（核心用：给数据 “排位置、看占比”）</h3><p>专门用于确定数据在整体 / 分区中的相对位置、排名顺序或分布比例，是最常用的窗口函数类型。</p><ol><li><strong>ROW_NUMBER()</strong>：给分区内每行贴唯一连续序号，同值也不重复（如 “给每天的订单按时间排 1、2、3 号”）。</li><li><strong>RANK()</strong>：按排序值排名，同值同名次，后续名次跳号（如 “成绩并列第 1，下一名直接第 3”）。</li><li><strong>DENSE_RANK()</strong>：按排序值排名，同值同名次，后续名次不跳号（如 “成绩并列第 1，下一名仍第 2”）。</li><li><strong>PERCENT_RANK()</strong>：返回相对百分位排名（公式：(名次 - 1)/(总行数 - 1)），范围 0~1，体现 “比多少数据好 / 差”。</li><li><strong>CUME_DIST()</strong>：返回 “≤当前值的行数 / 总行数”，范围 0~1，体现 “当前值及以下数据的占比”。</li><li><strong>NTILE(n)</strong>：将分区数据均匀分成 n 个 “桶”，返回每行所属桶号（如 “把员工绩效分成 3 组，标 1/2/3 桶”）。</li></ol><h3 id="二、相邻数据取值类（核心用：“跨行取数”，比当前行前-后-特定位置的值）">二、相邻数据取值类（核心用：“跨行取数”，比当前行前 / 后 / 特定位置的值）</h3><p>专门用于获取分区内 “非当前行” 的数据，无需手动关联表，直接跨行提取目标位置的值。</p><ol><li><strong>LAG(expr [,offset [,default]])</strong>：取当前行 “往上数 offset 行” 的 expr 值，无对应行返回 default（如 “取前 1 天的销售额，无则返回 0”）。</li><li><strong>LEAD(expr [,offset [,default]])</strong>：取当前行 “往下数 offset 行” 的 expr 值，无对应行返回 default（如 “取后 1 天的销售额，无则返回 0”）。</li><li><strong>FIRST_VALUE(expr)</strong>：取分区内按排序规则的 “第一行” expr 值（如 “取店铺本月第一天的销售额”）。</li><li><strong>LAST_VALUE(expr)</strong>：取分区内 “到当前行为止” 的最后一行 expr 值（需注意窗口框架，默认到当前行，非全分区）。</li><li><strong>NTH_VALUE(expr, n)</strong>：取分区内排序后的 “第 n 行” expr 值，无第 n 行则返回 NULL（如 “取店铺本月第 2 天的销售额”）。</li></ol><h3 id="三、窗口聚合计算类（核心用：“累计-整体统计”，在分区内做聚合，不压缩行数）">三、窗口聚合计算类（核心用：“累计 / 整体统计”，在分区内做聚合，不压缩行数）</h3><p>将普通聚合函数（SUM/AVG 等）改造为窗口模式，不合并行，每行都能显示聚合结果（累计或全分区）。</p><h4 id="1-基础累计-局部聚合（支持按顺序累计，默认-“从第一行到当前行”）">1. 基础累计 / 局部聚合（支持按顺序累计，默认 “从第一行到当前行”）</h4><ul><li><strong>SUM(expr)</strong>：计算分区内到当前行的 expr 累计和（如 “按日期累计店铺销售额”）。</li><li><strong>AVG(expr)</strong>：计算分区内到当前行的 expr 累计平均值（如 “按日期累计店铺日均销售额”）。</li><li><strong>COUNT(expr)</strong>：统计分区内到当前行的非 NULL 行数（如 “按日期累计店铺营业天数”）。</li><li><strong>MIN(expr)</strong>：取分区内到当前行的 expr 最小值（如 “按日期记录店铺截至当天的最低销售额”）。</li><li><strong>MAX(expr)</strong>：取分区内到当前行的 expr 最大值（如 “按日期记录店铺截至当天的最高销售额”）。</li></ul><h4 id="2-全分区统计（不累计，直接计算整个分区的统计量，每行结果相同）">2. 全分区统计（不累计，直接计算整个分区的统计量，每行结果相同）</h4><ul><li><strong>STDDEV_POP(expr)</strong>：计算分区内 expr 的 “总体标准差”（用全部数据计算，分母为总行数）。</li><li><strong>STDDEV_SAMP(expr)</strong>：计算分区内 expr 的 “样本标准差”（用样本数据计算，分母为总行数 - 1）。</li><li><strong>VAR_POP(expr)</strong>：计算分区内 expr 的 “总体方差”（总体标准差的平方）。</li><li><strong>VAR_SAMP(expr)</strong>：计算分区内 expr 的 “样本方差”（样本标准差的平方）。</li></ul><h3 id="四、多变量关联分析类（核心用：“分析两个变量的关系”，如相关性、回归）">四、多变量关联分析类（核心用：“分析两个变量的关系”，如相关性、回归）</h3><p>专门用于分析分区内两个变量（如 “销售额” 与 “日期”、“广告投入” 与 “销量”）的关联程度或回归规律。</p><ol><li><p><strong>COVAR_POP(y, x)</strong>：计算 y 和 x 的 “总体协方差”，体现两变量的整体联动方向（正 / 负相关趋势）。</p></li><li><p><strong>COVAR_SAMP(y, x)</strong>：计算 y 和 x 的 “样本协方差”，基于样本数据体现两变量的联动方向。</p></li><li><p><strong>CORR(y, x)</strong>：计算 y 和 x 的 “皮尔逊相关系数”，范围 - 1~1，直接体现关联强度（1 = 完全正相关，-1 = 完全负相关）。</p></li><li><p>REGR_* 系列</p><p>：一次线性回归专用函数，如：</p><ul><li><strong>REGR_SLOPE(y, x)</strong>：计算 y 对 x 的回归斜率（如 “销售额随日期变化的每日增长幅度”）。</li><li><strong>REGR_INTERCEPT(y, x)</strong>：计算回归截距（如 “回归公式的初始值”）。</li><li><strong>REGR_R2(y, x)</strong>：计算决定系数 R²，体现回归模型的拟合优度（越接近 1 拟合越好）。</li><li><strong>REGR_COUNT(y, x)</strong>：统计 y 和 x 均非空的行数（回归分析的有效数据量）</li></ul></li></ol><h3 id="五、窗口函数常见错误与避坑指南">五、窗口函数常见错误与避坑指南</h3><p>窗口函数功能强大但细节复杂，实际使用中容易因理解框架范围、分区逻辑或排序规则导致结果不符合预期。以下是最常见的错误类型及解决方案：</p><h4 id="1-LAST-VALUE-结果不符合预期（最容易踩的坑）">1.<code>LAST_VALUE()</code> 结果不符合预期（最容易踩的坑）</h4><p><strong>错误表现：</strong></p><p>使用 <code>LAST_VALUE()</code> 时，返回的不是分区内最后一行的值，而是当前行或靠前位置的值。</p><p><strong>错误原因：</strong></p><p>窗口函数默认框架是 <code>RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW</code>（从第一行到当前行），而非全分区。例如：</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 错误示例：想取全分区最后一行，却返回当前行及之前的最后一行</span></span><br><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">  shop, <span class="type">date</span>, sales,</span><br><span class="line">  <span class="built_in">LAST_VALUE</span>(sales) <span class="keyword">OVER</span> (<span class="keyword">PARTITION</span> <span class="keyword">BY</span> shop <span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="type">date</span>) <span class="keyword">AS</span> last_sales</span><br><span class="line"><span class="keyword">FROM</span> t;</span><br></pre></td></tr></table></figure><p><strong>解决方案：</strong></p><p>显式指定全分区框架 <code>ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING</code>：</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">  shop, <span class="type">date</span>, sales,</span><br><span class="line">  <span class="built_in">LAST_VALUE</span>(sales) <span class="keyword">OVER</span> (</span><br><span class="line">    <span class="keyword">PARTITION</span> <span class="keyword">BY</span> shop </span><br><span class="line">    <span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="type">date</span></span><br><span class="line">    <span class="keyword">ROWS</span> <span class="keyword">BETWEEN</span> UNBOUNDED PRECEDING <span class="keyword">AND</span> UNBOUNDED FOLLOWING</span><br><span class="line">  ) <span class="keyword">AS</span> last_sales  <span class="comment">-- 正确返回分区内最后一行</span></span><br><span class="line"><span class="keyword">FROM</span> t;</span><br></pre></td></tr></table></figure><h2 id="二、遗漏-PARTITION-BY-导致全局计算">二、遗漏 <code>PARTITION BY</code> 导致全局计算</h2><h3 id="错误表现：">错误表现：</h3><p>希望按分组（如店铺）单独计算窗口函数，结果却变成了所有数据的全局计算。</p><h3 id="错误原因：">错误原因：</h3><p>忘记添加 <code>PARTITION BY</code>，函数默认对全表数据进行计算。例如：</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 错误示例：想按店铺计算累计销售额，却计算了所有店铺的总和</span></span><br><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">  shop, <span class="type">date</span>, sales,</span><br><span class="line">  <span class="built_in">SUM</span>(sales) <span class="keyword">OVER</span> (<span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="type">date</span>) <span class="keyword">AS</span> running_sum  <span class="comment">-- 缺少 PARTITION BY shop</span></span><br><span class="line"><span class="keyword">FROM</span> t;</span><br></pre></td></tr></table></figure><h3 id="解决方案：">解决方案：</h3><p>明确添加 <code>PARTITION BY</code> 定义分组：</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">  shop, <span class="type">date</span>, sales,</span><br><span class="line">  <span class="built_in">SUM</span>(sales) <span class="keyword">OVER</span> (<span class="keyword">PARTITION</span> <span class="keyword">BY</span> shop <span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="type">date</span>) <span class="keyword">AS</span> running_sum  <span class="comment">-- 正确按店铺分组</span></span><br><span class="line"><span class="keyword">FROM</span> t;</span><br></pre></td></tr></table></figure><h2 id="三、ORDER-BY-排序方向错误影响结果">三、<code>ORDER BY</code> 排序方向错误影响结果</h2><h3 id="错误表现：-2">错误表现：</h3><p><code>PERCENT_RANK()</code>/<code>CUME_DIST()</code> 等排名函数的值与预期相反（如最大值的百分比反而大）。</p><h3 id="错误原因：-2">错误原因：</h3><p>排序方向与分析目标不符。例如：</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 错误示例：想让销售额越高，PERCENT_RANK() 越小，却用了升序</span></span><br><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">  shop, sales,</span><br><span class="line">  <span class="built_in">PERCENT_RANK</span>() <span class="keyword">OVER</span> (<span class="keyword">ORDER</span> <span class="keyword">BY</span> sales <span class="keyword">ASC</span>) <span class="keyword">AS</span> pct_rnk  <span class="comment">-- 升序导致最大值的百分比为1</span></span><br><span class="line"><span class="keyword">FROM</span> t;</span><br></pre></td></tr></table></figure><h3 id="解决方案：-2">解决方案：</h3><p>根据业务目标选择排序方向（通常分析 “头部数据” 用 <code>DESC</code>）：</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">  shop, sales,</span><br><span class="line">  <span class="built_in">PERCENT_RANK</span>() <span class="keyword">OVER</span> (<span class="keyword">ORDER</span> <span class="keyword">BY</span> sales <span class="keyword">DESC</span>) <span class="keyword">AS</span> pct_rnk  <span class="comment">-- 降序让最大值的百分比为0</span></span><br><span class="line"><span class="keyword">FROM</span> t;</span><br></pre></td></tr></table></figure><h2 id="四、RANK-与-DENSE-RANK-混淆导致排名错误">四、<code>RANK()</code> 与 <code>DENSE_RANK()</code> 混淆导致排名错误</h2><h3 id="错误表现：-3">错误表现：</h3><p>需要连续排名时用了 <code>RANK()</code>（出现跳号），或需要保留名次空位时用了 <code>DENSE_RANK()</code>（连续编号）。</p><h3 id="错误示例：">错误示例：</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 若想统计“第2名”包含并列情况但不跳号，却用了 RANK()</span></span><br><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">  sales,</span><br><span class="line">  <span class="built_in">RANK</span>() <span class="keyword">OVER</span> (<span class="keyword">ORDER</span> <span class="keyword">BY</span> sales <span class="keyword">DESC</span>) <span class="keyword">AS</span> rnk  <span class="comment">-- 若前2名并列，下一名会是3（跳号）</span></span><br><span class="line"><span class="keyword">FROM</span> t;</span><br></pre></td></tr></table></figure><h3 id="解决方案：-3">解决方案：</h3><ul><li>需跳号（如比赛排名，允许第 1 名并列后直接第 3 名）→ 用 <code>RANK()</code></li><li>需连续（如筛选前 3 名，包含并列且不跳号）→ 用 <code>DENSE_RANK()</code></li></ul><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">  sales,</span><br><span class="line">  <span class="built_in">DENSE_RANK</span>() <span class="keyword">OVER</span> (<span class="keyword">ORDER</span> <span class="keyword">BY</span> sales <span class="keyword">DESC</span>) <span class="keyword">AS</span> dense_rnk  <span class="comment">-- 并列第1后，下一名是2（不跳号）</span></span><br><span class="line"><span class="keyword">FROM</span> t;</span><br></pre></td></tr></table></figure><h2 id="五、窗口聚合函数的-“累计”-与-“全量”-混淆">五、窗口聚合函数的 “累计” 与 “全量” 混淆</h2><h3 id="错误表现：-4">错误表现：</h3><p>使用 <code>SUM()</code>/<code>AVG()</code> 时，希望得到全分区的总量，却返回了累计值。</p><h3 id="错误原因：-3">错误原因：</h3><p><code>ORDER BY</code> 会触发 “累计计算”（从第一行到当前行），省略 <code>ORDER BY</code> 则返回全分区聚合结果。例如：</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 错误示例：想获取店铺总销售额，却因加了 ORDER BY 变成累计值</span></span><br><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">  shop, <span class="type">date</span>, sales,</span><br><span class="line">  <span class="built_in">SUM</span>(sales) <span class="keyword">OVER</span> (<span class="keyword">PARTITION</span> <span class="keyword">BY</span> shop <span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="type">date</span>) <span class="keyword">AS</span> total_sales  <span class="comment">-- 累计值，非总量</span></span><br><span class="line"><span class="keyword">FROM</span> t;</span><br></pre></td></tr></table></figure><h3 id="解决方案：-4">解决方案：</h3><ul><li>需累计值 → 保留 <code>ORDER BY</code>（默认从第一行到当前行）</li><li>需全分区总量 → 省略 <code>ORDER BY</code></li></ul><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">  shop, <span class="type">date</span>, sales,</span><br><span class="line">  <span class="built_in">SUM</span>(sales) <span class="keyword">OVER</span> (<span class="keyword">PARTITION</span> <span class="keyword">BY</span> shop) <span class="keyword">AS</span> total_sales  <span class="comment">-- 正确返回店铺总销售额</span></span><br><span class="line"><span class="keyword">FROM</span> t;</span><br></pre></td></tr></table></figure><h2 id="六、LAG-LEAD-越界处理缺失">六、<code>LAG()</code>/<code>LEAD()</code> 越界处理缺失</h2><h3 id="错误表现：-5">错误表现：</h3><p>第一行用 <code>LAG()</code> 或最后一行用 <code>LEAD()</code> 时，返回 <code>NULL</code> 导致后续计算错误。</p><h3 id="错误原因：-4">错误原因：</h3><p>未指定越界时的默认值，函数默认返回 <code>NULL</code>。例如：</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 错误示例：第一行的 LAG() 返回 NULL，可能导致计算失败</span></span><br><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">  shop, <span class="type">date</span>, sales,</span><br><span class="line">  sales <span class="operator">-</span> <span class="built_in">LAG</span>(sales) <span class="keyword">OVER</span> (<span class="keyword">PARTITION</span> <span class="keyword">BY</span> shop <span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="type">date</span>) <span class="keyword">AS</span> diff  <span class="comment">-- 第一行 diff 为 NULL</span></span><br><span class="line"><span class="keyword">FROM</span> t;</span><br></pre></td></tr></table></figure><h3 id="解决方案：-5">解决方案：</h3><p>显式指定 <code>default</code> 参数（如 0 或其他合理值）：</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">  shop, <span class="type">date</span>, sales,</span><br><span class="line">  sales <span class="operator">-</span> <span class="built_in">LAG</span>(sales, <span class="number">1</span>, <span class="number">0</span>) <span class="keyword">OVER</span> (<span class="keyword">PARTITION</span> <span class="keyword">BY</span> shop <span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="type">date</span>) <span class="keyword">AS</span> diff  <span class="comment">-- 越界返回0</span></span><br><span class="line"><span class="keyword">FROM</span> t;</span><br></pre></td></tr></table></figure><h2 id="七、NTILE-n-数据分配不均时的误解">七、<code>NTILE(n)</code> 数据分配不均时的误解</h2><h3 id="错误表现：-6">错误表现：</h3><p>期望 <code>NTILE(n)</code> 严格均分数据，实际某些桶的行数多 1（如 7 行数据分 3 桶，结果为 3、2、2）。</p><h3 id="错误原因：-5">错误原因：</h3><p><code>NTILE(n)</code> 会优先向前几个桶分配多余的行（总行数不能被 n 整除时），保证分配尽可能均匀而非绝对均分。</p><h3 id="解决方案：-6">解决方案：</h3><ul><li>接受合理偏差（函数设计如此）</li><li>若需严格均分，可先过滤数据使总行数为 n 的倍数，或自定义逻辑：</li></ul><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 替代方案：用 ROW_NUMBER() 手动分配，确保前m个桶多1行</span></span><br><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">  <span class="operator">*</span>,</span><br><span class="line">  (<span class="built_in">ROW_NUMBER</span>() <span class="keyword">OVER</span> (<span class="keyword">ORDER</span> <span class="keyword">BY</span> sales) <span class="operator">-</span> <span class="number">1</span>) <span class="operator">%</span> <span class="number">3</span> <span class="operator">+</span> <span class="number">1</span> <span class="keyword">AS</span> custom_ntile</span><br><span class="line"><span class="keyword">FROM</span> t;</span><br></pre></td></tr></table></figure><h2 id="避坑总结：3-个核心检查点">避坑总结：3 个核心检查点</h2><ol><li><strong>框架范围</strong>：<code>LAST_VALUE()</code> 必须显式指定全分区框架，其他函数注意默认框架是否符合需求。</li><li><strong>分区与排序</strong>：是否遗漏 <code>PARTITION BY</code>（导致全局计算），<code>ORDER BY</code> 方向是否与业务目标一致。</li><li><strong>边界处理</strong>：<code>LAG()</code>/<code>LEAD()</code> 显式指定默认值，<code>RANK()</code> 与 <code>DENSE_RANK()</code> 根据排名规则选择。</li></ol>]]></content>
      
      
      <categories>
          
          <category> 技术速查 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Markdown常用</title>
      <link href="/2025/04/12/Markdown%E5%B8%B8%E7%94%A8/"/>
      <url>/2025/04/12/Markdown%E5%B8%B8%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<p>Markdown中使用表格</p><p>Markdown中使用表格</p><p>博客文章 Front-matter的Markdown使用</p><p>如果有文章（例如：转载文章）不需要显示版权，可以在文章 Front-matter 单独设置</p><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">copyright:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure><p>从Butterfly3.0.0开始，支持对单独文章设置版权信息，可以在文章 Front-matter 单独设置</p><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">copyright<span class="emphasis">_author: xxxx</span></span><br><span class="line"><span class="emphasis">copyright_</span>author<span class="emphasis">_href: https://xxxxxx.com</span></span><br><span class="line"><span class="emphasis">copyright_</span>url: https://xxxxxx.com</span><br><span class="line">copyright<span class="emphasis">_info: 此文章版权归 xxxxx 所有，如有转载，请注明来自原作者</span></span><br></pre></td></tr></table></figure><h1>注意</h1><h2 id="代码块不要在列表中">代码块不要在列表中</h2><p><mark>代码块不能是列表项</mark>，否则会乱码！！！</p><p><img src="./../Markdown%E5%B8%B8%E7%94%A8/image-20260120103943108.png" alt="image-20260120103943108"></p><p>可以用enter+shift使得代码块不属于列表又可以完成缩进：</p><p><img src="./../Markdown%E5%B8%B8%E7%94%A8/image-20260120104429726.png" alt="image-20260120104429726"></p><h2 id="使用Mermaid画图">使用Mermaid画图</h2><p>Markdown中可以绘制流程图、序列图、饼图、甘特图和类图等图形。</p><h3 id="Mermaid代码的语法"><strong>Mermaid代码的语法</strong></h3><p>Mermaid代码通常放在一个代码块中，代码块的语法如下：</p><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line"><span class="code">```mermaid</span></span><br><span class="line"><span class="code">[Mermaid代码]</span></span><br><span class="line"><span class="code">```</span></span><br></pre></td></tr></table></figure><p>使用方法：在 Markdown 中，敲击三个后写下mermaid回车即可。</p><p>展示如下图：</p><p><img src="./../Markdown%E5%B8%B8%E7%94%A8/image-20250904101750820.png" alt="展示图"></p><h3 id="流程图graph">流程图graph</h3><p>流程图用于展示流程步骤和关系，支持多种布局方向。</p><p><strong>语法说明</strong>：</p><ul><li><code>graph [方向]</code>：定义图表方向（<code>LR</code> 左右，<code>TB</code> 上下，<code>RL</code> 右左，<code>BT</code> 下上）</li><li>节点表示：<code>id[文本]</code>（默认矩形）、<code>id(文本)</code>（圆角矩形）、<code>id&#123;文本&#125;</code>（菱形）、<code>id((文本))</code>（圆形）等</li><li>连接线：<code>--&gt;</code>（实线箭头）、<code>---</code>（实线无箭头）、<code>-.-&gt;</code>（虚线箭头）等，可添加标签（<code>--&gt;|标签|</code>）</li></ul><p><strong>示例</strong>：</p><pre><code class="highlight mermaid">graph TD    A[开始] --&gt; B&#123;是或否&#125;    B --&gt;|是| C[执行任务]    B --&gt;|否| D[结束]    C --&gt; D</code></pre><pre><code class="highlight mermaid">graph LR    产品[产品]    产品 --&gt;|m| 构成&#123;构成&#125;    构成 --&gt;|n| 零件[零件]    零件 --&gt;|n| 存储&#123;存储&#125;    零件 --&gt;|n| 消耗&#123;消耗&#125; --&gt;|m| 材料    存储 --&gt;|1| 仓库[仓库]        产品号((产品号)) --- 产品    产品名((产品名)) --- 产品    预算((预算)) --- 产品    零件数((零件数)) --- 构成    零件号((零件号)) --- 零件    零件名((零件名)) --- 零件    存储量((存储量)) --- 存储    仓库 --- 仓库号((仓库号))    仓库 --- 面积((面积))    仓库 --- 库管员((库管员))    消耗 --- 存储量    材料 --- 材料号((材料号))    材料 --- 材料名((材料名))    材料 --- 单位((单位))    材料 --- 单价((单价))</code></pre><h3 id="流程图进阶">流程图进阶</h3><p><strong>参数说明：</strong></p><ul><li><code>fill</code>        背景色</li><li><code>stroke</code>      边框色</li><li><code>stroke-width</code> 边框粗细</li><li><code>color</code>       文字颜色</li><li><code>opacity</code>     透明度 0–1</li><li><code>rx/ry</code>       圆角半径</li></ul><p><strong>示例：</strong></p><pre><code class="highlight mermaid">graph TD    A[开始] --&gt; B&#123;是或否&#125;    B --&gt;|是| C[执行任务]    B --&gt;|否| D[结束]    C --&gt; D%% 直接给节点填色、描边、改字色style A fill:#d73027,stroke:#333,stroke-width:2px,color:#fffstyle B fill:#fc8d59,stroke:#333,stroke-width:2pxstyle C fill:#fee08b,stroke:#333,stroke-width:2pxstyle D fill:#91bfdb,stroke:#333,stroke-width:2px</code></pre><h3 id="序列图sequenceDiagram">序列图sequenceDiagram</h3><p>展示对象之间的交互时序，常用于系统交互流程。</p><p><strong>语法说明</strong>：</p><ul><li><code>participant 参与者</code>：定义参与对象</li><li>消息传递：<code>A-&gt;B: 消息内容</code>（实线箭头）、<code>A--&gt;B: 消息内容</code>（虚线箭头，如返回）</li><li>激活状态：<code>activate A</code>（激活对象，显示生命线）、<code>deactivate A</code>（取消激活）</li></ul><p><strong>示例</strong>：</p><pre><code class="highlight mermaid">sequenceDiagram    participant A    participant B    A-&gt;&gt;B: 发送消息    B-&gt;&gt;A: 回复消息</code></pre><h3 id="饼图Pie">饼图Pie</h3><p>展示数据占比关系。</p><p><strong>语法说明</strong>：</p><ul><li><code>pie</code> 开头</li><li><code>title 标题</code></li><li><code>标签: 数值</code> 定义各部分</li></ul><p><strong>示例</strong>：</p><pre><code class="highlight mermaid">pie    title 网站用户来源    &quot;直接访问&quot; : 30    &quot;搜索引擎&quot; : 50    &quot;外部链接&quot; : 15    &quot;其他&quot; : 5</code></pre><h3 id="甘特图gantt">甘特图gantt</h3><p>用于项目进度规划，展示任务时间安排。</p><p><strong>语法说明</strong>：</p><ul><li><code>dateFormat</code>：日期格式（如 <code>YYYY-MM-DD</code>）</li><li><code>section 模块名</code>：分组任务</li><li>任务格式：<code>任务名 : 状态, 任务ID, 开始日期, 结束日期</code>（状态可选 <code>done</code>/<code>active</code> 等）</li></ul><p><strong>示例</strong>：</p><pre><code class="highlight mermaid">gantt    dateFormat  YYYY-MM-DD    section 现有任务    已完成任务           :done,    des1, 2025-01-06,2025-01-08    进行中任务           :active,  des2, 2025-01-09, 3d    待办任务             :         des3, after des2, 5d    section 新增任务    新任务1              :         des4, after des3, 5d    新任务2              :         des5, after des4, 5d</code></pre><h3 id="思维导图mindmap">思维导图mindmap</h3><p><strong>语法说明</strong>：</p><ul><li>根节点（中心主题）用 <code>root((内容))</code> 定义（<code>(( ))</code> 是固定格式，确保居中显示）</li><li>分支层级通过<strong>空格缩进</strong>区分（建议用 2-4 个空格，同一层级缩进一致）：<ul><li>无缩进：一级分支（直接从根节点延伸）</li><li>缩进 2-4 空格：二级分支（从一级分支延伸）</li><li>缩进更多：三级、四级分支（以此类推）</li><li>不支持 Tab 键，建议用 2-4 个空格统一缩进，否则会导致层级混乱</li><li>分支层级建议不超过 4 级</li></ul></li></ul><pre><code class="highlight mermaid">mindmap  root((技能check list))    硬性      编程技能: SQL、Python/R、Excel      统计学知识        假设检验: 参数检验、非参数检验、置信区间        数据分布、相关性、贝叶斯等        大数定律、中心极限定理等      建模知识        数据处理方法: 连续/离散数据、样本不平衡        聚类: K-means、DBSCAN等        回归        分类        时间序列分析: AMAR、ARIMA、prophet等        transformer、bert      因果推断        辛普森悖论        ATE、ATT、CATE、HTE        IV、DID、PSM、RDD、DRL、DML、Uplift Model、Casual forest等      数据解读&amp;本质提炼      报告撰写&amp;数据展示    业务      常见方法: 维度下钻分析、归因分析、路径分析、触点分析、用户画像分析; 其他（RFM、生命周期等）      业务分析问题        指标体系搭建        实验分析        问题归因        专项分析: 机会点、价值论证      业务理解    软性      商业sense      听信息      拆解信息      汇报信息      抗压能力      时间管理</code></pre><h3 id="思维导图实现2">思维导图实现2</h3><p><code>graph LR</code>（左右布局）+ 分支分组</p><pre><code class="highlight mermaid">graph LR    %% 根节点（居中，作为核心）    Root[&quot;🎯 技能check list&quot;]        %% 左侧分支：硬性技能（向左展开，层级清晰）    Root --&gt; Hard[&quot;🔧 硬性技能&quot;]    Hard --&gt; Code[&quot;编程技能&quot;]    Code --&gt; code[SQL、Python/R、Excel]        Hard --&gt; Stat[&quot;统计学知识&quot;]    Stat --&gt;|1| Test[假设检验]    Test --&gt; Param[参数检验]    Test --&gt; NonParam[非参数检验]    Test --&gt; CI[置信区间]    Stat --&gt;|2| Dist[数据分布、相关性、贝叶斯等]    Stat --&gt;|3| Law[大数定律、中心极限定理等]        Hard --&gt; Model[&quot;建模知识&quot;]    Model --&gt;|1| Process[数据处理方法]    Process --&gt; Cont[连续/离散数据]    Process --&gt; Imb[样本不平衡]    Model --&gt; Cluster[聚类]    Model --&gt; Reg[回归]    Model --&gt; Class[分类]    Model --&gt; TS[时间序列分析]    Cluster --&gt; cluster[K-means、DBSCAN等]    TS --&gt; ARIMA[AMAR、ARIMA、Prophet等]    TS --&gt; Trans[Transformer、BERT]        Hard --&gt; Causal[&quot;因果推断&quot;]    Causal --&gt; Simp[辛普森悖论]    Causal --&gt; Metric[ATE、ATT、CATE、HTE]    Causal --&gt; Method[先掌握：IV、DID、PSM、RDD]    Method --&gt; method[DRL、DML、Uplift Model、Casual forest等]        Hard --&gt; Ana[数据解读&amp;提炼]    Hard --&gt; Rep[报告撰写&amp;展示]        %% 右侧分支1：业务技能（向右展开）    Root --&gt; Bus[&quot;💼 业务技能&quot;]    Bus --&gt; Meth[&quot;常见分析方法&quot;]    Meth --&gt; Drill[维度下钻分析]    Meth --&gt; Reason[归因分析]    Meth --&gt; Path[路径分析]    Meth --&gt; Touch[触点分析]    Meth --&gt; Portrait[用户画像分析]    Meth --&gt; MethOthers[还有一些别的：RFM、生命周期等]        Bus --&gt; Prob[&quot;业务分析问题&quot;]    Prob --&gt; Ind[指标体系搭建]    Prob --&gt; Exp[实验分析]    Prob --&gt; Attr[问题归因]    Prob --&gt; Spec[专项分析]    Spec --&gt; spec[机会点、价值论证]        Bus --&gt; Under[业务理解]        %% 右侧分支2：软性技能（与业务技能并列，更舒展）    Root --&gt; Soft[&quot;🌟 软性技能&quot;]    Soft --&gt; Sense[商业sense]    Soft --&gt; Listen[信息倾听]    Soft --&gt; Split[信息拆解]    Soft --&gt; ReportExp[汇报表达]    Soft --&gt; Stress[抗压能力]    Soft --&gt; Time[时间管理]        %% 样式优化：颜色+边框，区分度拉满    classDef rootColor fill:#fff3e0,stroke:#ff9800,stroke-width:2px,font-weight:bold    classDef hardColor fill:#e8f5e8,stroke:#4caf50,stroke-width:1px    classDef busColor fill:#e3f2fd,stroke:#2196f3,stroke-width:1px    classDef softColor fill:#fce4ec,stroke:#e91e63,stroke-width:1px        class Root rootColor    class Hard,Code,code,Stat,Test,Param,NonParam,CI,Dist,Law,Model,Process,Cont,Imb,Cluster,cluster,Reg,Class,TS,ARIMA,Trans,Causal,Simp,Metric,Method,method,Ana,Rep hardColor    class Bus,Meth,Drill,Reason,Path,Touch,Portrait,MethOthers,Prob,Ind,Exp,Attr,Spec,spec,Under busColor    class Soft,Sense,Listen,Split,ReportExp,Stress,Time softColor</code></pre><h1>使用 Markdown 编写文档用什么软件</h1><ol><li><p>Typora<br>核心优势：所见即所得（WYSIWYG）界面，实时渲染 Markdown 语法，支持表格、代码块、数学公式（LaTeX）、任务列表等。<br>导出能力：直接导出为 PDF、HTML、Word、ePub 等格式，适合生成报告或电子书。<br>价格：买断制 89 元人民币，支持 Windows/macOS/Linux。<br>适用场景：个人写作、技术文档、学术论文。</p></li><li><p>VS Code + 插件<br>核心优势：代码编辑器的强大扩展性，通过插件支持 Markdown 语法高亮、实时预览、TOC 生成。<br>插件：<br>Markdown All in One：快捷键和格式转换工具。<br>Markdown PDF：一键导出 PDF（需安装 LaTeX 环境）。<br>适用场景：开发者、技术文档撰写者。<br>缺点：不能通过剪切板粘图，需要手动上传图片。这是我特别常用的一个功能，所以需要一个更好的软件。</p></li><li><p>MarkText<br>核心优势：开源免费，支持实时预览、多主题切换（如 Material Dark）、三种编辑模式（源码 / 打字机 / 专注）。<br>特色功能：直接粘贴图片到文档，支持数学公式（KaTeX）和 Mermaid 图表。<br>导出能力：导出 HTML 和 PDF，适合轻量级文档。<br>适用场景：学生、自由职业者、开源项目贡献者。<br>缺点：现在好像没人维护了，最新版本还是v0.17.1。</p></li></ol>]]></content>
      
      
      <categories>
          
          <category> 常用命令 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Markdown </tag>
            
            <tag> Typora </tag>
            
            <tag> Hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Git常用</title>
      <link href="/2025/04/11/Git%E5%B8%B8%E7%94%A8/"/>
      <url>/2025/04/11/Git%E5%B8%B8%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<hr><h1>Git命令</h1><h2 id="专业名词（黑话）">专业名词（黑话）</h2><ol><li><p><strong>Git 工作流</strong></p><pre><code class="highlight mermaid">graph LR    A[关联工作区] -- git add --&gt; B[暂存区]    B -- git commit --&gt; C[本地仓库]    C -- git push --&gt; E[远程仓库]</code></pre></li><li><p><strong>工作区文件</strong>：本地文件夹的文件。<br>在 Git 版本控制中，<strong>工作区文件</strong>指的是你在本地电脑上直接编辑、修改的项目文件，也就是你能在操作系统的文件夹里看到的那些文件（比如文档、代码、图片等）。</p><p>简单说，工作区（Working Directory）就是你克隆或创建项目后，在本地电脑上存放项目文件的那个文件夹，而这个文件夹里的所有文件（包括子文件夹里的文件）都可以称为 “工作区文件”。</p></li><li><p><strong>暂存区：</strong><br>在 Git 版本控制中，<strong>暂存区（Staging Area）</strong> 是一个介于「工作区」和「本地仓库」之间的临时存储区域，也被称为「索引（Index）」。它的核心作用是：<strong>临时存放你想要提交到本地仓库的修改</strong>，让你可以先 “预览” 哪些修改会被纳入下一次提交，再统一提交到仓库</p><p><strong>为什么需要暂存区？</strong></p><p>想象一个场景：你同时修改了项目中的 3 个文件（A、B、C），但其中只有 A 和 B 的修改是完整的，C 的修改还没完成。这时候你想先提交 A 和 B 的修改，而暂时忽略 C—— 暂存区就是用来解决这个问题的：你可以先把 A 和 B 放入暂存区，然后只提交暂存区的内容，C 仍然留在工作区继续修改。</p></li><li><p><strong>工作区文件的状态：</strong></p><ol><li><strong>未跟踪（Untracked）</strong>：新创建的文件，还没被 Git 记录（Git 不知道它的存在）；</li><li>已跟踪（Tracked）：已被 Git 记录的文件，包括：<ul><li>未修改（Unmodified）：和 Git 最后一次记录的版本一致；</li><li>已修改（Modified）：被编辑过，但还没存入暂存区；</li><li>已暂存（Staged）：修改后被添加到暂存区（通过 <code>git add</code> 命令），等待提交到本地仓库。</li></ul></li></ol></li><li><p>**子模块：**嵌套仓库<br>在 Git 中，<strong>子模块（Submodule）</strong> 是一种特殊功能，用于在一个 Git 仓库（称为 “主项目”）中嵌入另一个独立的 Git 仓库（称为 “子模块项目”），同时保持两个仓库的独立性。</p></li><li><p>done</p></li></ol><h2 id="Git-版本控制工具中常用的命令">Git 版本控制工具中常用的命令</h2><h3 id="选项">选项</h3><h4 id="1-初始化与克隆">1. 初始化与克隆</h4><table><thead><tr><th style="text-align:left">命令</th><th style="text-align:left">常用选项</th><th style="text-align:left">说明</th></tr></thead><tbody><tr><td style="text-align:left"><code>git init</code></td><td style="text-align:left">-</td><td style="text-align:left">初始化本地仓库</td></tr><tr><td style="text-align:left"><code>git clone &lt;url&gt;</code></td><td style="text-align:left"><code>-b &lt;branch&gt;</code></td><td style="text-align:left">克隆仓库，<code>-b</code>指定分支</td></tr></tbody></table><h4 id="2-文件操作">2. 文件操作</h4><table><thead><tr><th style="text-align:left">命令</th><th style="text-align:left">常用选项</th><th style="text-align:left">说明</th></tr></thead><tbody><tr><td style="text-align:left"><code>git add &lt;file&gt;</code></td><td style="text-align:left"><code>.</code> <code>-p</code> <code>--all</code></td><td style="text-align:left">暂存文件，<code>.</code>全部，<code>-p</code>交互式</td></tr><tr><td style="text-align:left"><code>git rm &lt;file&gt;</code></td><td style="text-align:left"><code>--cached</code></td><td style="text-align:left">删除文件，<code>--cached</code>仅停止跟踪</td></tr><tr><td style="text-align:left"><code>git mv &lt;old&gt; &lt;new&gt;</code></td><td style="text-align:left">-</td><td style="text-align:left">重命名文件</td></tr></tbody></table><h4 id="3-提交">3. 提交</h4><p><code>git commit</code> 命令的主要常用选项有：</p><table><thead><tr><th style="text-align:left">选项</th><th style="text-align:left">全称</th><th style="text-align:left">作用</th></tr></thead><tbody><tr><td style="text-align:left"><code>-a</code></td><td style="text-align:left"><code>--all</code></td><td style="text-align:left"><strong>自动暂存所有已跟踪文件的修改和删除</strong>，跳过 <code>git add</code></td></tr><tr><td style="text-align:left"><code>-m</code></td><td style="text-align:left"><code>--message</code></td><td style="text-align:left">指定提交信息，如 <code>git commit -m &quot;修复bug&quot;</code></td></tr><tr><td style="text-align:left"><code>-am</code></td><td style="text-align:left"><code>--all --message</code></td><td style="text-align:left"><strong><code>-a</code> + <code>-m</code> 组合</strong>，最常用</td></tr><tr><td style="text-align:left"><code>--amend</code></td><td style="text-align:left"><code>--amend</code></td><td style="text-align:left">用于<strong>修改最近一次提交</strong>，不创建新提交</td></tr></tbody></table><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">rm</span> README.md             <span class="comment"># 先解决冲突</span></span><br><span class="line">git commit -am <span class="string">&quot;删除冲突文件&quot;</span>  <span class="comment"># 一条命令搞定提交</span></span><br><span class="line">git push                     <span class="comment"># 推送到Gitee</span></span><br></pre></td></tr></table></figure><h4 id="4-分支管理">4. 分支管理</h4><table><thead><tr><th style="text-align:left">命令</th><th style="text-align:left">常用选项</th><th style="text-align:left">说明</th></tr></thead><tbody><tr><td style="text-align:left"><code>git branch</code></td><td style="text-align:left"><code>-a</code> <code>-r</code> <code>-d</code></td><td style="text-align:left">查看/创建/删除分支，<code>-a</code>所有分支</td></tr><tr><td style="text-align:left"><code>git checkout</code></td><td style="text-align:left"><code>-b</code></td><td style="text-align:left">切换分支，<code>-b</code>创建+切换</td></tr><tr><td style="text-align:left"><code>git merge &lt;branch&gt;</code></td><td style="text-align:left"><code>--no-ff</code></td><td style="text-align:left">合并分支</td></tr><tr><td style="text-align:left"><code>git rebase &lt;branch&gt;</code></td><td style="text-align:left">-</td><td style="text-align:left">变基（提交线性化）</td></tr></tbody></table><h4 id="5-远程操作">5. 远程操作</h4><table><thead><tr><th style="text-align:left">命令</th><th style="text-align:left">常用选项</th><th style="text-align:left">说明</th></tr></thead><tbody><tr><td style="text-align:left"><code>git remote</code></td><td style="text-align:left"><code>-v</code> <code>add</code></td><td style="text-align:left">管理远程仓库</td></tr><tr><td style="text-align:left"><code>git pull</code></td><td style="text-align:left"><code>--rebase</code></td><td style="text-align:left">拉取+合并，<code>--rebase</code>干净历史</td></tr><tr><td style="text-align:left"><code>git push</code></td><td style="text-align:left"><code>-u</code> <code>--force</code> <code>--all</code></td><td style="text-align:left">推送，<code>-u</code>设置上游，<code>--force</code>强制推送</td></tr><tr><td style="text-align:left"><code>git fetch</code></td><td style="text-align:left">-</td><td style="text-align:left">只拉取不合并</td></tr></tbody></table><h4 id="6-查看">6. 查看</h4><table><thead><tr><th style="text-align:left">命令</th><th style="text-align:left">常用选项</th><th style="text-align:left">说明</th></tr></thead><tbody><tr><td style="text-align:left"><code>git status</code></td><td style="text-align:left">-s</td><td style="text-align:left">查看状态，<code>-s</code>简洁版</td></tr><tr><td style="text-align:left"><code>git log</code></td><td style="text-align:left"><code>--oneline</code> <code>--graph</code></td><td style="text-align:left">查看提交历史</td></tr><tr><td style="text-align:left"><code>git diff</code></td><td style="text-align:left"><code>--cached</code></td><td style="text-align:left">对比差异</td></tr><tr><td style="text-align:left"><code>git show &lt;commit&gt;</code></td><td style="text-align:left">-</td><td style="text-align:left">查看具体提交</td></tr></tbody></table><h4 id="7-撤销与重置">7. 撤销与重置</h4><table><thead><tr><th style="text-align:left">命令</th><th style="text-align:left">常用选项</th><th style="text-align:left">说明</th></tr></thead><tbody><tr><td style="text-align:left"><code>git reset</code></td><td style="text-align:left"><code>--hard</code> <code>--soft</code></td><td style="text-align:left">重置到指定提交</td></tr><tr><td style="text-align:left"><code>git revert &lt;commit&gt;</code></td><td style="text-align:left">-</td><td style="text-align:left">创建反向提交（安全撤销）</td></tr><tr><td style="text-align:left"><code>git checkout -- &lt;file&gt;</code></td><td style="text-align:left">-</td><td style="text-align:left">恢复文件到上次提交</td></tr></tbody></table><p><strong>总数</strong>：Git 每个命令都有 20-50 个选项，但<strong>实际开发只用上述 80% 最常用选项</strong>就够了。</p><h3 id="git-clone"><code>git clone</code></h3><p>：“下载” 远程项目到本地；</p><p><strong>作用</strong>：从远程仓库（比如 GitHub、GitLab 等）复制一个完整的项目到本地电脑。<br>它会将远程仓库的所有文件、分支、提交历史等完整下载到本地，并自动创建一个与远程仓库同名的文件夹，同时初始化本地 Git 仓库，关联到远程仓库。</p><p><strong>示例</strong>：</p><p>克隆远程仓库到当前目录（生成与仓库同名的文件夹）：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> &lt;远程仓库地址&gt;</span><br><span class="line"><span class="comment"># 示例：克隆 GitHub 上的仓库</span></span><br><span class="line">git <span class="built_in">clone</span> https://github.com/Kkkika/Kkkika.github.io.git</span><br></pre></td></tr></table></figure><ul><li><p><strong>自定义文件夹名称</strong>（不使用仓库默认名称）：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> &lt;远程仓库地址&gt; &lt;本地目录名&gt;</span><br><span class="line"><span class="comment"># 示例：克隆到名为 &quot;my-project&quot; 的文件夹</span></span><br><span class="line">git <span class="built_in">clone</span> https://github.com/Kkkika/Kkkika.github.io.git my-project</span><br></pre></td></tr></table></figure></li><li><p><strong>只克隆指定分支</strong>（默认克隆所有分支，此参数可节省时间）：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> -b &lt;分支名&gt; --single-branch &lt;远程仓库地址&gt;</span><br><span class="line"><span class="comment"># 示例：只克隆远程的 dev 分支</span></span><br><span class="line">git <span class="built_in">clone</span> -b dev --single-branch https://github.com/username/repo-name.git</span><br></pre></td></tr></table></figure></li><li><p><strong>浅克隆</strong>（只获取最近的 N 次提交，适合大型仓库，加快克隆速度）：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> --depth &lt;次数&gt; &lt;远程仓库地址&gt;</span><br><span class="line"><span class="comment"># 示例：只获取最近 10 次提交</span></span><br><span class="line">git <span class="built_in">clone</span> --depth 10 https://github.com/username/repo-name.git</span><br></pre></td></tr></table></figure></li><li><p><strong>克隆时包含子模块</strong>（如果项目包含子模块，需用此参数才能完整克隆）：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> --recursive &lt;远程仓库地址&gt;</span><br><span class="line"><span class="comment"># 若已克隆但子模块未下载，可补拉：git submodule update --init --recursive</span></span><br></pre></td></tr></table></figure></li></ul><h3 id="git-branch"><code>git branch</code></h3><p>：“管理” 本地分支（查看、创建、删除）；</p><p><strong>作用</strong>：用于管理本地分支（分支可以理解为项目的 “并行开发线”，方便多人协作或功能隔离）。</p><p>常用用法：</p><h4 id="1-查看分支">1. 查看分支</h4><ul><li><p>不带参数：查看本地所有分支（当前分支前有 <code>*</code> 标记）：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git branch</span><br></pre></td></tr></table></figure></li><li><p>查看本地 + 远程所有分支（远程分支以 <code>remotes/origin/</code> 开头）：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git branch -a</span><br></pre></td></tr></table></figure></li><li><p>查看远程分支（仅远程，不包含本地）：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git branch -r</span><br></pre></td></tr></table></figure></li><li><p>查看分支关联的远程分支（多人协作时常用，确认本地分支对应哪个远程分支）：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git branch -vv</span><br><span class="line"><span class="comment"># 输出示例：* main  a1b2c3d [origin/main] 提交说明</span></span><br></pre></td></tr></table></figure></li></ul><h4 id="2-创建分支">2. 创建分支</h4><ul><li><p>基于当前分支创建新分支（创建后仍在当前分支，需手动切换）：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git branch &lt;新分支名&gt;</span><br><span class="line"><span class="comment"># 示例：基于当前分支创建 feature/payment 分支</span></span><br><span class="line">git branch feature/payment</span><br></pre></td></tr></table></figure></li></ul><h4 id="3-删除分支">3. 删除分支</h4><ul><li><p>删除本地分支（需确保分支已合并，否则会提示错误）：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git branch -d &lt;分支名&gt;</span><br><span class="line"><span class="comment"># 示例：删除已合并的 old-branch</span></span><br><span class="line">git branch -d old-branch</span><br></pre></td></tr></table></figure></li><li><p>强制删除未合并的分支（危险！未合并的修改会丢失）：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git branch -D &lt;分支名&gt;</span><br><span class="line"><span class="comment"># 示例：强制删除未合并的 test-branch</span></span><br><span class="line">git branch -D test-branch</span><br></pre></td></tr></table></figure></li></ul><h4 id="4-重命名分支">4. 重命名分支</h4><ul><li><p>重命名当前所在分支：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git branch -m &lt;新分支名&gt;</span><br><span class="line"><span class="comment"># 示例：将当前分支重命名为 bugfix/login</span></span><br><span class="line">git branch -m bugfix/login</span><br></pre></td></tr></table></figure></li><li><p>重命名指定分支（无需切换到该分支）：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git branch -m &lt;旧分支名&gt; &lt;新分支名&gt;</span><br><span class="line"><span class="comment"># 示例：将 feature/old 重命名为 feature/new</span></span><br><span class="line">git branch -m feature/old feature/new</span><br></pre></td></tr></table></figure></li><li><p>带分支名：创建新分支（但不会自动切换到新分支）。</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git branch feature-login  <span class="comment"># 创建名为 feature-login 的新分支</span></span><br></pre></td></tr></table></figure></li><li><p><code>-d</code> 参数：删除指定分支（删除前需确保该分支的修改已合并，否则用 <code>-D</code> 强制删除）。</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git branch -d old-branch  <span class="comment"># 删除 old-branch 分支</span></span><br></pre></td></tr></table></figure></li></ul><h3 id="git-checkout"><code>git checkout</code></h3><p>：“切换” 分支或 “恢复” 文件。</p><p><strong>作用</strong>：主要用于 “切换分支” 或 “恢复工作区文件”（Git 2.23+ 后推荐用 <code>git switch</code> 切换分支，功能更清晰，但 <code>checkout</code> 仍广泛使用）。</p><p>常用用法：</p><ul><li><p>切换到已存在的分支：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git checkout dev  <span class="comment"># 切换到 dev 分支</span></span><br></pre></td></tr></table></figure></li><li><p>创建并立即切换到新分支（相当于 <code>git branch 新分支名</code> + <code>git checkout 新分支名</code> 的简写）：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git checkout -b dev  <span class="comment"># 创建并切换到 dev 分支</span></span><br></pre></td></tr></table></figure></li><li><p>恢复工作区的某个文件到最近一次提交的状态（丢弃本地修改）：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git checkout -- README.md  <span class="comment"># 把 README.md 恢复到最近提交的版本</span></span><br></pre></td></tr></table></figure></li></ul><h2 id="git冲突">git冲突</h2><ul><li>git冲突会出现哪些情况，分别怎么解决</li></ul><p>Git冲突主要出现在合并（merge）或拉取（pull）时，两个分支对同一文件做了不兼容修改。</p><h2 id="常见冲突类型">常见冲突类型</h2><p><strong>1. 内容冲突（最常见）</strong><br>两个分支修改同一文件的同一行：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">text&lt;&lt;&lt;&lt;&lt;&lt;&lt; <span class="string">HEAD</span></span><br><span class="line"><span class="string">你本地的代码</span></span><br><span class="line"><span class="string">=======</span></span><br><span class="line"><span class="string">远程的代码  </span></span><br><span class="line"><span class="string">&gt;&gt;&gt;&gt;&gt;&gt;&gt; origin/master</span></span><br></pre></td></tr></table></figure><p><strong>解决</strong>：编辑文件删除标记符 <code>&lt;&lt;&lt;&lt;&lt;&lt;&lt; ======= &gt;&gt;&gt;&gt;&gt;&gt;&gt;</code>，保留需要的代码，然后 <code>git add 文件名 git commit</code></p><p><strong>2. modify/delete 冲突</strong>（你现在的类型）<br>一个分支修改了文件，另一个分支删除了文件：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">text</span><br><span class="line">git status 显示：deleted by them: README.md</span><br></pre></td></tr></table></figure><p><strong>解决</strong>：</p><ul><li>想删除：<code>git rm README.md</code></li><li>想保留：<code>git checkout --ours/--theirs README.md</code> 或 <code>git add README.md</code></li></ul><p><strong>3. 文件名冲突</strong><br>两个分支重命名同一文件为不同名字，或修改文件名。</p><p><strong>解决</strong>：选择保留哪个文件名，用 <code>git mv</code> 重命名。</p><h2 id="通用解决流程">通用解决流程</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">bash1. git status          <span class="comment"># 查看哪些文件冲突</span></span><br><span class="line">2. 编辑冲突文件        <span class="comment"># 手动解决内容冲突</span></span><br><span class="line">3. git add/rm 文件名   <span class="comment"># 标记冲突已解决</span></span><br><span class="line">4. git commit          <span class="comment"># 提交合并结果</span></span><br><span class="line">5. git push            <span class="comment"># 推送到远程</span></span><br></pre></td></tr></table></figure><h2 id="紧急退出">紧急退出</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">bash</span><br><span class="line">git merge --</span><br><span class="line">abort      <span class="comment"># 放弃这次合并，回到之前状态</span></span><br></pre></td></tr></table></figure><h2 id="分支管理">分支管理</h2><h3 id="常用命令">常用命令</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 查看分支</span></span><br><span class="line">git branch          <span class="comment"># 本地分支</span></span><br><span class="line">git branch -r       <span class="comment"># 远程分支</span></span><br><span class="line">git branch -a       <span class="comment"># 所有分支</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建分支</span></span><br><span class="line">git branch &lt;分支名&gt;                 <span class="comment"># 创建但不切换</span></span><br><span class="line">git checkout -b &lt;分支名&gt;            <span class="comment"># 创建并切换</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 切换分支</span></span><br><span class="line">git checkout &lt;分支名&gt;</span><br><span class="line">git switch &lt;分支名&gt;                <span class="comment"># Git 2.23+</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 合并分支</span></span><br><span class="line">git merge &lt;分支名&gt;                  <span class="comment"># 将指定分支合并到当前分支</span></span><br><span class="line">git merge --no-ff &lt;分支名&gt;          <span class="comment"># 非快进合并，保留分支历史</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除分支</span></span><br><span class="line">git branch -d &lt;分支名&gt;              <span class="comment"># 删除已合并的分支</span></span><br><span class="line">git branch -D &lt;分支名&gt;              <span class="comment"># 强制删除未合并分支</span></span><br><span class="line">git push origin --delete &lt;分支名&gt;   <span class="comment"># 删除远程分支</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 拉取远程分支并创建本地分支</span></span><br><span class="line">git checkout -b &lt;本地分支名&gt; origin/&lt;远程分支名&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 分支重命名</span></span><br><span class="line">git branch -m &lt;新分支名&gt;            <span class="comment"># 重命名当前分支</span></span><br><span class="line">git branch -m &lt;旧分支名&gt; &lt;新分支名&gt;  <span class="comment"># 重命名指定分支</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看分支图</span></span><br><span class="line">git <span class="built_in">log</span> --oneline --graph --all</span><br></pre></td></tr></table></figure><h3 id="Git-Flow">Git Flow</h3><blockquote><p>（经典企业级策略）</p></blockquote><p><strong>分支结构：</strong></p><ul><li><code>main/master</code> - 主分支，生产环境代码</li><li><code>develop</code> - 开发分支，集成所有功能</li><li><code>feature/*</code> - 功能分支，从 develop 拉出</li><li><code>release/*</code> - 发布分支，从 develop 拉出</li><li><code>hotfix/*</code> - 热修复分支，从 main 拉出</li></ul><h3 id="GitHub-Flow">GitHub Flow</h3><blockquote><p>（简化流程）</p></blockquote><p><strong>适用于持续交付：</strong></p><ul><li>只有一个长期分支：<code>main</code></li><li>所有功能都在单独分支开发</li><li>通过 Pull Request 合并</li></ul><h3 id="GitLab-Flow">GitLab Flow</h3><blockquote><p>（环境分支策略）</p></blockquote><p><strong>分支结构：</strong></p><ul><li><code>main</code> → <code>pre-production</code> → <code>production</code></li><li>代码按环境流动</li></ul><h1>GitHub中clone指定Commits</h1><p>（Github中怎么找回历史版本；GitHub历史版本恢复指南；GitHub中下载指定版本；Github查看项目的历史版本，并实现版本的回滚）</p><blockquote><p>假设：我想下载<a href="https://github.com/Kkkika/Kkkika.github.io">Kkkika/Kkkika.github.io</a>仓库master分支的第一次提交</p></blockquote><p>首先进入仓库后，点击【Commits】<strong>获取历史版本的提交哈希值</strong></p><p><img src="./../Git%E5%B8%B8%E7%94%A8/image-20260131132104678.png" alt="image-20260131132104678"></p><p>时间拉到最前，找到第一次提交，点击【复制】按钮</p><p><img src="./../Git%E5%B8%B8%E7%94%A8/image-20260131132104679.png" alt="image-20260131132104679"></p><h3 id="克隆后创建新分支">克隆后创建新分支</h3><p>如果你想在特定提交的基础上进行一些修改或实验，最好创建一个新分支。</p><p>新建一个文件夹来存放代码，注意路径不要有中文：</p><p>C:\Code\githubclone</p><p>然后打开cmd</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> C:\Code\githubclone</span><br></pre></td></tr></table></figure><ol><li><p><strong>克隆仓库并进入目录</strong></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/Kkkika/Kkkika.github.io.git</span><br><span class="line"><span class="built_in">cd</span> Kkkika.github.io</span><br></pre></td></tr></table></figure></li><li><p><strong>基于特定提交创建并切换到一个新分支</strong>：这可以避免“分离头指针”状态。</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git branch my-new-branch cc09550ac7db24e987f6f2130da2ee1564191b12</span><br><span class="line">git checkout my-new-branch</span><br></pre></td></tr></table></figure><p>或者更简洁地用一条命令：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git checkout -b my-new-branch cc09550ac7db24e987f6f2130da2ee1564191b12</span><br></pre></td></tr></table></figure><p>这样，你就在一个名为 <code>my-new-branch</code> 的分支上工作，这个分支的起点就是你指定的那个提交。</p></li></ol><h3 id="浅克隆（如果只想快速获取）">浅克隆（如果只想快速获取）</h3><p>如果你只关心最新的一部分提交，或者仓库很大想加快克隆速度，可以考虑浅克隆。</p><ol><li><p><strong>浅克隆仓库</strong>（例如只克隆最近 10 个提交）：</p><p>bash</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> --depth 10 https://github.com/Kkkika/Kkkika.github.io.git</span><br><span class="line"><span class="built_in">cd</span> Kkkika.github.io</span><br></pre></td></tr></table></figure><p><code>--depth 10</code> 参数表示只克隆最近10次提交的历史。你需要确保你想要的提交（<code>cc09550...</code>）在这最近的10次提交之内。</p></li><li><p><strong>然后切换到你想要的提交</strong>：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git checkout cc09550ac7db24e987f6f2130da2ee1564191b12</span><br></pre></td></tr></table></figure></li></ol><h3 id="重要提示">重要提示</h3><ul><li><strong>关于 <code>-b</code> 参数</strong>：<code>-b</code> 在 <code>git clone</code> 中用于指定分支或标签，不能直接用于提交哈希5。</li><li><strong>“分离头指针”状态</strong>：直接 <code>git checkout &lt;commit-hash&gt;</code> 会进入此状态。在此状态下进行更改并提交后，如果不创建分支指向这些新提交，它们可能会被 Git 的垃圾回收机制清除10。如果计划基于该提交进行修改，请务必创建新分支。</li><li><strong>获取正确的提交哈希</strong>：确保你复制的提交哈希是正确的且存在于远程仓库中。你可以通过 GitHub 网站的提交历史页面来查看和确认提交哈希。</li></ul><h3 id="如何选择方法？">如何选择方法？</h3><p>为了更清晰地选择，可以参考下面的流程：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git checkout</span><br></pre></td></tr></table></figure><pre><code class="highlight mermaid">graph LR    A[需求：克隆特定提交] --&gt; B&#123;完整历史？&#125;    B -- 是 --&gt; C[克隆仓库&lt;br&gt;checkout 提交]    B -- 否 --&gt; D[浅克隆&lt;br&gt;checkout 提交]    C --&gt; E&#123;需修改？&#125;    D --&gt; F&#123;需修改？&#125;    E -- 是 --&gt; G[创建分支]    E -- 否 --&gt; H[分离头指针]    F -- 是 --&gt; G    F -- 否 --&gt; H</code></pre><h3 id="可能遇到的问题">可能遇到的问题</h3><ol><li>网络问题<ol><li><img src="./../Git%E5%B8%B8%E7%94%A8/image-20260131132104680.png" alt="image-20260131132104680"></li><li>关闭梯子</li><li>打开加速器</li></ol></li><li></li></ol><h1>Gitee</h1><h2 id="git推送">git推送</h2><h3 id="新建项目">新建项目</h3><blockquote><p>新建项目，关联工作区</p></blockquote><p>首先，<strong>新建仓库</strong></p><p><img src="./../Git%E5%B8%B8%E7%94%A8/image-20260131132104669.png" alt="示例"></p><p>上传到仓库的文件夹需要命名为blog：</p><p><img src="./../Git%E5%B8%B8%E7%94%A8/image-20260131132104670.png" alt="上传到仓库的文件夹"></p><p>将本地内容<strong>首次</strong>推送到空的 Git 远程仓库，需按顺序执行以下命令流程。</p><p>以下是完整操作步骤及注意事项：</p><ol><li><p><strong>初始化本地仓库</strong></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git init</span><br></pre></td></tr></table></figure><ul><li>在项目根目录执行，生成隐藏的.git文件夹</li></ul></li><li><p><strong>添加文件并提交</strong></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git add .              <span class="comment"># 添加所有文件到暂存区</span></span><br><span class="line">git commit -m <span class="string">&quot;Initial commit&quot;</span>  <span class="comment"># 提交到本地仓库</span></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git add .</span><br><span class="line">git commit -m <span class="string">&quot;Initial commit&quot;</span></span><br></pre></td></tr></table></figure><ul><li>必须至少有一次提交，否则推送会失败（Git 不允许推送空分支）。</li></ul></li><li><p><strong>关联远程仓库</strong></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git remote add origin &lt;远程仓库URL&gt;</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git remote add origin </span><br></pre></td></tr></table></figure><ul><li><p>验证关联：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git remote -v</span><br></pre></td></tr></table></figure><p>查看 URL 是否正确。</p></li></ul></li><li><p><strong>首次推送并设置上游分支</strong></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git push -u origin master</span><br></pre></td></tr></table></figure><ul><li><p>分支名为 master</p></li><li><p>-u（或–set-upstream）参数：</p><ul><li><p>建立本地分支与远程分支的追踪关系。</p></li><li><p>后续推送只需</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git pull</span><br><span class="line">git add .</span><br><span class="line">git commit -m <span class="string">&quot;update&quot;</span></span><br><span class="line">git push</span><br></pre></td></tr></table></figure><p>无需指定分支。</p></li></ul></li></ul></li></ol><h4 id="示例">示例</h4><p>在任何IDE的终端或者cmd中运行命令行都可以</p><p>在Cursor中打开终端：</p><p><img src="./../Git%E5%B8%B8%E7%94%A8/image-20260131132104673.png" alt="在Cursor中打开终端"></p><p>确保路径最后的文件夹和仓库同名：</p><p><img src="./../Git%E5%B8%B8%E7%94%A8/image-20260131132104674.png" alt="仓库名是blog文件夹名是blog"></p><p>所有用到的命令：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git init</span><br><span class="line">git add .</span><br><span class="line">git commit -m <span class="string">&quot;Initial commit&quot;</span></span><br><span class="line">git remote add origin https://gitee.com/kika00/blog.git</span><br><span class="line">git remote -v</span><br><span class="line">git push -u origin master</span><br></pre></td></tr></table></figure><p>成功推送：</p><p><img src="./../Git%E5%B8%B8%E7%94%A8/image-20260131132104675.png" alt="成功推送"></p><p>后续推送用到的三个命令：</p><p><img src="./../Git%E5%B8%B8%E7%94%A8/image-20260131132104677.png" alt="改完 → git add -A → git commit -m &quot;说人话&quot; → git push"></p><h3 id="克隆现有仓库">克隆现有仓库</h3><blockquote><p>克隆现有仓库，建立工作区</p></blockquote><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 克隆远程仓库（自动建立所有关联）</span></span><br><span class="line">git <span class="built_in">clone</span> &lt;远程仓库URL&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 克隆后，工作区已经与远程关联</span></span><br><span class="line"><span class="built_in">cd</span> 项目目录</span><br><span class="line">git status  <span class="comment"># 查看状态</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 常用命令 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Github </tag>
            
            <tag> Gitee </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>pic</title>
      <link href="/2025/04/11/pic/"/>
      <url>/2025/04/11/pic/</url>
      
        <content type="html"><![CDATA[<p>文章路径：<code>C:\Code\KikaBlog\blog\source\_posts</code></p><p>（疑问：为什么source和_posts之间的斜杠显示的时候会被隐藏？）</p><h1>1 【./】</h1><p>【typora可 博客不可】</p><p>实际路径在<code>C:\Code\KikaBlog\blog\source\_posts</code></p><p><img src="./test1.png" alt="./test1.png"></p><p>但是如果我复制图片到<code>C:\Code\KikaBlog\blog\source</code>的时候，博客上就可以正常显示，而图片路径还是./</p><p><img src="./../pic/test1-2.png" alt="./../pic/test1-2.png"></p><p>也就是说把图片放在<code>C:\Code\KikaBlog\blog\source</code>上用路径./和./…/是等价的；还有就是_posts文件夹是进不去的，这个文件夹只能放<code>.md</code></p><h1>2【./…/】</h1><p>【都可！typora可 博客可】</p><p>实际路径在<code>C:\Code\KikaBlog\blog\source</code></p><p><img src="./../test2.png" alt="./../test2.png"></p><p>缺点：图片文件挤在同一个文件夹，不方便管理</p><h1>3【./${filename}】</h1><p>【typora可 博客不可】</p><p>实际路径在<code>C:\Code\KikaBlog\blog\source\_posts\pic</code></p><p><img src="./pic/test3.png" alt="./pic/test3.png"></p><p>为什么不行？这样管理分类最有秩序了，在_posts中搜索文章名，还可以直接搜到文章存放图片的文件夹。啊啊啊啊</p><h1>4【./…/${filename}】</h1><p>【都可！typora可 博客可】</p><p>实际路径在<code>C:\Code\KikaBlog\blog\source\pic</code></p><p><img src="./../pic/test4.png" alt="./../pic/test4.png"></p><h1>结论</h1><p>第2种和第4种在Typora写文章时可以看到图片，并且GitHub搭建的博客网站上也能正常显示图片。</p><p>第2种是把图片统一放在博客文件夹下的source里；</p><p>第4种则在source文件夹中创建一个与文章名同名的文件夹存放图片，个人更喜欢第4种存放方式。而且【./…/${filename}】格式，笔记不管是放在发布文章文件夹 <code>_posts</code>还是草稿文章文件夹 <code>_drafts</code>，图片不用移动。</p><h1>pdf</h1><p><a href="/PDF/test.pdf">test.pdf</a></p><p>粘贴的时候是<code>..\PDF\test.pdf</code>，<strong>目标是</strong><code>/PDF/test.pdf</code>我不想手动改，有没有代码自动化这个流程的方法</p><p>要在粘贴的时候就转换，是不是要改typora</p><p>在 Typora 用户目录创建 <code>plugins/</code> 文件夹，新建<code>pdf-path-fix</code></p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;pdf-path-fix&#x27;</span>,</span><br><span class="line">  <span class="attr">onPaste</span>: <span class="keyword">function</span>(<span class="params">event, context</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> text = context.<span class="property">content</span>;</span><br><span class="line">    <span class="comment">// 只处理 ..\PDF\xxx.pdf → /PDF/xxx.pdf</span></span><br><span class="line">    text = text.<span class="title function_">replace</span>(<span class="regexp">/\\.\\\\PDF\\\\([^\&quot;\&#x27;&gt;\s]+\\.pdf)/g</span>, <span class="string">&#x27;/PDF/$1&#x27;</span>);</span><br><span class="line">    context.<span class="property">content</span> = text;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>自定义插件，typora粘贴的时候是<code>..\PDF\test.pdf</code>，目标是<code>/PDF/test.pdf</code></p><h1>双链</h1><p>[[笔记系统搭建#Ob使用]]</p><p><img src="%E5%A4%A7%E6%96%87%E6%A1%A3#%E7%94%9F%E6%B4%BB%E5%B8%B8%E8%AF%86#%E7%9C%8B%E6%88%BF%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9" alt="1"></p>]]></content>
      
      
      <categories>
          
          <category> blog </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Git-下载安装配置-图文超详细教程-手把手教你-小白</title>
      <link href="/2025/03/19/Git-%E4%B8%8B%E8%BD%BD%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE-%E5%9B%BE%E6%96%87%E8%B6%85%E8%AF%A6%E7%BB%86%E6%95%99%E7%A8%8B-%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0-%E5%B0%8F%E7%99%BD/"/>
      <url>/2025/03/19/Git-%E4%B8%8B%E8%BD%BD%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE-%E5%9B%BE%E6%96%87%E8%B6%85%E8%AF%A6%E7%BB%86%E6%95%99%E7%A8%8B-%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0-%E5%B0%8F%E7%99%BD/</url>
      
        <content type="html"><![CDATA[<h1>安装</h1><ul><li>先选择自己的系统安装，安装后，一定要配置全局！</li></ul><h3 id="一、Windows-系统安装-Git（演示）"><strong>一、Windows 系统安装 Git（演示）</strong></h3><h4 id="步骤-1：下载安装包"><strong>步骤 1：下载安装包</strong></h4><ol><li>访问 <a href="https://git-scm.com/">Git 官网</a>。<img src="./../Git-%E4%B8%8B%E8%BD%BD%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE-%E5%9B%BE%E6%96%87%E8%B6%85%E8%AF%A6%E7%BB%86%E6%95%99%E7%A8%8B-%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0-%E5%B0%8F%E7%99%BD/a4248de7f9394581af534221344cdf09.png" alt="img"></li><li>点击 <strong>Download for Windows</strong>，下载最新版安装包（如 <code>Git-2.47.1.2-64-bit.exe</code>）。<img src="./../Git-%E4%B8%8B%E8%BD%BD%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE-%E5%9B%BE%E6%96%87%E8%B6%85%E8%AF%A6%E7%BB%86%E6%95%99%E7%A8%8B-%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0-%E5%B0%8F%E7%99%BD/4d9024ff371c419189bb1c4e74cc7bd1.png" alt="img"></li></ol><hr><h4 id="步骤-2：运行安装程序"><strong>步骤 2：运行安装程序</strong></h4><ol><li><strong>双击安装包</strong>，启动安装向导。<img src="./../Git-%E4%B8%8B%E8%BD%BD%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE-%E5%9B%BE%E6%96%87%E8%B6%85%E8%AF%A6%E7%BB%86%E6%95%99%E7%A8%8B-%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0-%E5%B0%8F%E7%99%BD/e363379c28324ce8a36d5763dd3f6449.png" alt="img"></li><li><strong>关键配置选项</strong>（按顺序设置）：<ul><li><strong>安装路径</strong>：默认路径为 <code>C:\Program Files\Git\</code>，建议保持默认。<ul><li><em>注意</em>：路径中不要包含中文或空格。<img src="./../Git-%E4%B8%8B%E8%BD%BD%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE-%E5%9B%BE%E6%96%87%E8%B6%85%E8%AF%A6%E7%BB%86%E6%95%99%E7%A8%8B-%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0-%E5%B0%8F%E7%99%BD/6f8034d84faf450b8a52fffd0beffbd1.png" alt="img"></li></ul></li><li><strong>选择组件</strong>：<ul><li><strong>桌面图标</strong>：在桌面上放一个图标，方便你快速打开 Git。</li><li><strong>Windows 文件夹集成</strong>：<ul><li><strong>在这里打开 Git 命令行</strong>：在文件夹里右键点击，可以直接打开命令行工具。</li><li><strong>在这里打开 Git 图形界面</strong>：在文件夹里右键点击，可以直接打开图形界面工具。</li></ul></li><li><strong>大文件支持</strong>：帮助你处理大文件的版本控制。</li><li><strong>关联 Git 配置文件</strong>：让文本编辑器自动打开 Git 的配置文件。</li><li><strong>关联 Shell 脚本文件</strong>：让 Shell 脚本文件可以用命令行工具运行。</li><li><strong>检查更新</strong>：每天检查是否有 Git 的新版本。</li><li><strong>添加 Git 命令行配置到 Windows 命令行工具</strong>：在 Windows 命令行工具中添加 Git 命令行的配置。</li><li><strong>Scalar 插件</strong>：一个帮助管理大项目的插件。<img src="./../Git-%E4%B8%8B%E8%BD%BD%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE-%E5%9B%BE%E6%96%87%E8%B6%85%E8%AF%A6%E7%BB%86%E6%95%99%E7%A8%8B-%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0-%E5%B0%8F%E7%99%BD/f9aaac7461b74fc7994dba8183270e6d.png" alt="img"></li></ul></li><li>开始菜单中的名称，直接next<img src="./../Git-%E4%B8%8B%E8%BD%BD%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE-%E5%9B%BE%E6%96%87%E8%B6%85%E8%AF%A6%E7%BB%86%E6%95%99%E7%A8%8B-%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0-%E5%B0%8F%E7%99%BD/0d727f92ce9345b29de475b98aea2df5.png" alt="img"></li><li><strong>默认编辑器</strong>：<ul><li>一般建议选择 <code>Use Visual Studio Code as Git's default editor</code>（推荐）或其他编辑器（如 Notepad++）。</li><li>这里选择直接next，默认Vim即可<img src="./../Git-%E4%B8%8B%E8%BD%BD%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE-%E5%9B%BE%E6%96%87%E8%B6%85%E8%AF%A6%E7%BB%86%E6%95%99%E7%A8%8B-%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0-%E5%B0%8F%E7%99%BD/735f598164294aff8db499c3bfd954be.png" alt="img"></li></ul></li><li><strong>初始分支的名称</strong><ul><li>在创建新仓库时希望 Git 使用什么名称作为初始分支。</li><li><strong>Let Git decide</strong>：让 Git 使用它的默认分支名称（目前是“master”）。未来 Git 计划更改这个默认名称，使其更具包容性。</li><li><strong>Override the default branch name for new repositories</strong>：覆盖默认分支名称，你可以指定一个新的名称。许多团队已经将默认分支名称更改为“main”、“trunk”或“development”等。这个设置不会影响已经存在的仓库。</li><li>简单来说，你可以选择让 Git 自己决定初始分支的名称，或者你可以自己指定一个名称，比如“main”。</li><li>点击“Next”进入下一个界面<img src="./../Git-%E4%B8%8B%E8%BD%BD%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE-%E5%9B%BE%E6%96%87%E8%B6%85%E8%AF%A6%E7%BB%86%E6%95%99%E7%A8%8B-%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0-%E5%B0%8F%E7%99%BD/c751b4c74eb3438fb9e0e61fe183f768.png" alt="img"></li></ul></li><li><strong>调整 PATH 环境变量</strong>：<ul><li>选择 <code>Git from the command line and also from 3rd-party software</code>（确保全局可用）。<img src="./../Git-%E4%B8%8B%E8%BD%BD%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE-%E5%9B%BE%E6%96%87%E8%B6%85%E8%AF%A6%E7%BB%86%E6%95%99%E7%A8%8B-%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0-%E5%B0%8F%E7%99%BD/17f184900097431792a6f544683baf88.png" alt="img"></li></ul></li><li><strong>选择SSH可执行文件，next</strong><img src="./../Git-%E4%B8%8B%E8%BD%BD%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE-%E5%9B%BE%E6%96%87%E8%B6%85%E8%AF%A6%E7%BB%86%E6%95%99%E7%A8%8B-%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0-%E5%B0%8F%E7%99%BD/5720d31b040f4a38a35038fd9bcf23ee.png" alt="img"></li><li><strong>选择HTTPS后端传输，next</strong><img src="./../Git-%E4%B8%8B%E8%BD%BD%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE-%E5%9B%BE%E6%96%87%E8%B6%85%E8%AF%A6%E7%BB%86%E6%95%99%E7%A8%8B-%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0-%E5%B0%8F%E7%99%BD/c1baec6613b24e05a71c3282d8875343.png" alt="img"></li><li><strong>换行符处理</strong>：<ul><li>选择 <code>Checkout Windows-style, commit Unix-style line endings</code>（避免跨平台换行符冲突）。<img src="./../Git-%E4%B8%8B%E8%BD%BD%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE-%E5%9B%BE%E6%96%87%E8%B6%85%E8%AF%A6%E7%BB%86%E6%95%99%E7%A8%8B-%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0-%E5%B0%8F%E7%99%BD/8bd801c6530d4ebe9b9fbb01a660d9d3.png" alt="img"></li></ul></li><li><strong>终端模拟器</strong>：<ul><li>选择 <code>Use MinTTY (the default terminal of MSYS2)</code>（Git Bash 的默认终端）。<img src="./../Git-%E4%B8%8B%E8%BD%BD%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE-%E5%9B%BE%E6%96%87%E8%B6%85%E8%AF%A6%E7%BB%86%E6%95%99%E7%A8%8B-%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0-%E5%B0%8F%E7%99%BD/929cb6e75908407eba42b2ab13537d6c.png" alt="img"></li></ul></li><li><strong>其他选项</strong>：保持默认设置。<img src="./../Git-%E4%B8%8B%E8%BD%BD%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE-%E5%9B%BE%E6%96%87%E8%B6%85%E8%AF%A6%E7%BB%86%E6%95%99%E7%A8%8B-%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0-%E5%B0%8F%E7%99%BD/06284825029540ca98b7c797021fa538.png" alt="img"></li></ul></li><li>点击 <strong>Finish</strong> 完成安装。<img src="./../Git-%E4%B8%8B%E8%BD%BD%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE-%E5%9B%BE%E6%96%87%E8%B6%85%E8%AF%A6%E7%BB%86%E6%95%99%E7%A8%8B-%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0-%E5%B0%8F%E7%99%BD/6a9ea59ee5404a309c27c51dc9270b8b.png" alt="img"></li></ol><p>这个界面表示 Git 已经安装完成。</p><ol><li><strong>Launch Git Bash</strong>：勾选这个选项可以在安装完成后直接启动 Git Bash。</li><li><strong>View Release Notes</strong>：勾选这个选项可以查看发行说明。</li></ol><hr><h4 id="步骤-3：验证安装"><strong>步骤 3：验证安装</strong></h4><ol><li><p>打开 <strong>Git Bash</strong>（桌面右键或开始菜单）。</p></li><li><p>输入以下命令：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git --version</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p><ul><li>显示版本号（如 <code>git version 2.47.1.windows.2</code>）即安装成功。<img src="./../Git-%E4%B8%8B%E8%BD%BD%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE-%E5%9B%BE%E6%96%87%E8%B6%85%E8%AF%A6%E7%BB%86%E6%95%99%E7%A8%8B-%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0-%E5%B0%8F%E7%99%BD/a304cc0e6c99400985477494902a0cb2.png" alt="img"></li></ul></li></ol><hr><h3 id="二、macOS-系统（不演示）"><strong>二、macOS 系统（不演示）</strong></h3><h4 id="步骤-1：通过-Homebrew-安装（推荐）"><strong>步骤 1：通过 Homebrew 安装（推荐）</strong></h4><ol><li><p><strong>安装 Homebrew</strong>（若未安装）：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/bin/bash -c &quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)&quot;</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p></li><li><p><strong>通过 Homebrew 安装 Git</strong>：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">brew install git</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p></li></ol><h4 id="步骤-2：通过官方安装包"><strong>步骤 2：通过官方安装包</strong></h4><ol><li>访问 <a href="https://git-scm.com/download/mac">Git 官网</a>，下载 <code>.dmg</code> 安装包。</li><li>双击安装包，按提示完成安装。</li></ol><hr><h4 id="步骤-3：验证安装-2"><strong>步骤 3：验证安装</strong></h4><ol><li><p>打开终端（Terminal）。</p></li><li><p>输入：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git --version</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p><ul><li>显示版本号即成功。</li></ul></li></ol><hr><h3 id="三、Linux-系统（不演示）"><strong>三、Linux 系统（不演示）</strong></h3><h4 id="步骤-1：通过包管理器安装"><strong>步骤 1：通过包管理器安装</strong></h4><ol><li><p><strong>Debian/Ubuntu</strong>：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo apt update &amp;&amp; sudo apt install git</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p></li><li><p><strong>CentOS/Fedora</strong>：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo yum install git        # CentOS</span><br><span class="line">sudo dnf install git        # Fedora</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p></li></ol><h4 id="步骤-2：验证安装"><strong>步骤 2：验证安装</strong></h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git --version</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p><hr><h1>安装后配置==（所有系统必做）==</h1><h2 id="步骤-1：设置全局用户名和邮箱"><strong>步骤 1：设置全局用户名和邮箱</strong></h2><ol><li><p>打开终端（Windows 用 Git Bash）。</p></li><li><p>输入以下命令（替换为你的信息）：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git config --global user.name &quot;Your Name&quot;</span><br><span class="line">git config --global user.email &quot;your.email@example.com&quot;</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p><ul><li><em>作用</em>：提交代码时标识作者身份，必须与代码托管平台（如 GitHub）的注册邮箱一致。</li></ul></li></ol><h2 id="步骤-2：检查配置"><strong>步骤 2：检查配置</strong></h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git config --list</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p><ul><li>确认输出中包含 <code>user.name</code> 和 <code>user.email</code> 的配置。</li></ul><hr><h1><strong>注意事项总结</strong></h1><ol><li><p><strong>换行符问题</strong>：</p><ul><li><p>Windows 用户务必选择 <code>Checkout Windows-style, commit Unix-style</code>，避免跨平台协作时文件换行符混乱。</p></li><li><p>手动修正命令：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git config --global core.autocrlf true</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p></li></ul></li><li><p><strong>SSH 密钥配置（推荐）</strong>：</p><ul><li><p>生成 SSH 密钥并添加到 GitHub/GitLab：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ssh-keygen -t ed25519 -C &quot;your.email@example.com&quot;</span><br><span class="line">cat ~/.ssh/id_ed25519.pub</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p></li><li><p>将公钥粘贴到代码托管平台的 <strong>SSH Keys</strong> 设置中。</p></li></ul></li><li><p><strong>代理配置（如需）</strong>：</p><ul><li><p>若需通过代理访问网络：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git config --global http.proxy http://proxy.example.com:8080</span><br><span class="line">git config --global https.proxy https://proxy.example.com:8080</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p></li></ul></li><li><p><strong>路径与权限</strong>：</p><ul><li>安装路径避免中文或空格（如 <code>C:\Program Files\Git</code> 是安全的）。</li><li>不要以管理员身份运行 Git，除非必要。</li></ul></li></ol><hr><h1><strong>首次使用测试</strong></h1><ol><li><p><strong>创建本地仓库</strong>：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mkdir my-project &amp;&amp; cd my-project</span><br><span class="line">git init</span><br><span class="line">echo &quot;# Hello Git&quot; &gt; README.md</span><br><span class="line">git add README.md</span><br><span class="line">git commit -m &quot;Initial commit&quot;</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p></li><li><p><strong>推送至远程仓库</strong>（需提前在 GitHub 等平台创建仓库）：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git remote add origin https://github.com/your-username/your-repo.git</span><br><span class="line">git push -u origin main</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p></li></ol><hr><h1><strong>常见问题解决</strong></h1><ul><li><strong>安装失败或命令未找到</strong>：<br>检查环境变量是否包含 Git 的安装路径（默认路径为 <code>C:\Program Files\Git\cmd</code>）。</li><li><strong>Git GUI 无法启动</strong>：<br>尝试重新安装并勾选所有默认组件。</li><li><strong>提交时提示邮箱无效</strong>：<br>检查 <code>user.email</code> 配置是否与代码托管平台注册邮箱一致。</li></ul>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>github.com响应时间太长？？</title>
      <link href="/2025/03/17/github.com%E5%93%8D%E5%BA%94%E6%97%B6%E9%97%B4%E5%A4%AA%E9%95%BF%EF%BC%9F/"/>
      <url>/2025/03/17/github.com%E5%93%8D%E5%BA%94%E6%97%B6%E9%97%B4%E5%A4%AA%E9%95%BF%EF%BC%9F/</url>
      
        <content type="html"><![CDATA[<h2 id="一、GitHub访问太慢？加载不出来">一、GitHub访问太慢？加载不出来</h2><p><img src="./../github.com%E5%93%8D%E5%BA%94%E6%97%B6%E9%97%B4%E5%A4%AA%E9%95%BF%EF%BC%9F/0717bae4b3f842eaa96d772c7fe1f82b.png" alt="img"></p><p>​    显示 <strong>“嗯… 无法访问此页面”，提示 “github.com响应时间太长？”</strong>，错误代码为 <code>ERR_CONNECTION_TIMED_OUT</code>，表明浏览器尝试连接 GitHub 服务器时超时。这是<strong>国内</strong>开发者每天的日常。</p><p>加速神器Watt Toolkit(原Steam++)：</p><p>​    <strong>Watt Toolkit（原 Steam++）</strong>，这个从游戏社区杀出来的开源神器，用「本地反代 + 智能路由」的组合拳，让 GitHub 的请求速度提升 10 倍以上。2025 年最新版不仅支持 GitHub、GitLab、Huggingface 等 12 个开发者刚需平台，更将安装门槛降至「一键傻瓜式」，真正实现 “技术无国界，代码无障碍”。</p><h2 id="二、最新安装指南：3-分钟搞定">二、最新安装指南：3 分钟搞定</h2><p>零门槛解锁极速访问：</p><h3 id="下载方式（推荐-Gitee-镜像，速度快-3-倍）">下载方式（推荐 Gitee 镜像，速度快 3 倍）</h3><ol><li><p>官网直达：<a href="https://steampp.net/">Watt Toolkit</a>（点击「下载」）<img src="./../github.com%E5%93%8D%E5%BA%94%E6%97%B6%E9%97%B4%E5%A4%AA%E9%95%BF%EF%BC%9F/2907df0fc0c748fea04c7742fe3a9c85.png" alt="img"></p></li><li><p>备用通道：Gitee 镜像站（<a href="https://gitee.com/rmbgame/SteamTools/releases/tag/3.0.0-rc.15%EF%BC%89%EF%BC%8C%E9%80%89%E6%8B%A9%60v3.0.0%E6%AD%A3%E5%BC%8F%E7%89%88%60">https://gitee.com/rmbgame/SteamTools/releases/tag/3.0.0-rc.15），选择`v3.0.0正式版`</a></p><p>（2025 年 2 月更新）</p><p><img src="./../github.com%E5%93%8D%E5%BA%94%E6%97%B6%E9%97%B4%E5%A4%AA%E9%95%BF%EF%BC%9F/72b19133c4794f39b2cdb508393e81dd.png" alt="img"></p><p>我的电脑是win11所以选择:<img src="./../github.com%E5%93%8D%E5%BA%94%E6%97%B6%E9%97%B4%E5%A4%AA%E9%95%BF%EF%BC%9F/a1b4d5efdeae48e18fd9445b1bb220fb.png" alt="img"></p></li><li><p>微软商店：搜索 “Watt Toolkit”，适合 Win11 用户（自动更新更省心）</p></li></ol><h3 id="安装步骤（Windows-为例）">安装步骤（Windows 为例）</h3><ol><li>双击安装包，选择「自定义安装」<img src="./../github.com%E5%93%8D%E5%BA%94%E6%97%B6%E9%97%B4%E5%A4%AA%E9%95%BF%EF%BC%9F/f378e585595b488780e147e57215ad79.png" alt="img"></li><li>取消勾选「开机自启」（开发者可根据需求保留）</li><li>安装完成后，桌面会生成绿色齿轮图标，右键「以管理员身份运行」（首次需权限）<img src="./../github.com%E5%93%8D%E5%BA%94%E6%97%B6%E9%97%B4%E5%A4%AA%E9%95%BF%EF%BC%9F/97b08bff7ae5441d92696b39379840bc.png" alt="img"></li></ol><h2 id="三、实战教程：5-步解锁丝滑体验">三、实战教程：5 步解锁丝滑体验</h2><h3 id="❶-基础加速：GitHub-秒开">❶ 基础加速：GitHub 秒开</h3><ol><li>打开软件，左侧勾选「GitHub」「Huggingface」「公共 CDN」（建议全选）<img src="./../github.com%E5%93%8D%E5%BA%94%E6%97%B6%E9%97%B4%E5%A4%AA%E9%95%BF%EF%BC%9F/33fde126e58e4c0687b1a9874b3e7dda.png" alt="img"></li><li>点击「一键加速」，等待右下角出现「加速成功」提示（约 5 秒）</li><li><strong>成功在国内网络下流畅打开<a href="https://github.com/">GitHub</a></strong></li></ol><h3 id="❷-高级玩法：本地令牌-脚本增强">❷ 高级玩法：本地令牌 + 脚本增强</h3><ol><li>点击「本地令牌」→「导入 Steam 令牌」（支持手机 APP 扫码）</li><li>开启「脚本配置」→勾选「GitHub 增强」，自动显示仓库的历史贡献者图谱</li><li>「网络诊断」功能：一键检测当前 IP 的 GitHub 节点延迟，推荐延迟＜150ms 的节点</li></ol><h3 id="❸-常见问题解决方案">❸ 常见问题解决方案</h3><ul><li><strong>443 端口冲突</strong>（虚拟机用户常见）：打开 VMware→「编辑」→「首选项」→关闭「共享虚拟机」</li><li><strong>加速失效</strong>：点击「网络修复」→自动重置 Hosts 和代理（实测 95% 修复率）</li><li><strong>杀毒软件拦截</strong>：将安装目录加入白名单（路径含 “Steam++” 的文件夹）</li></ul><h2 id="四、高频问题全解（2025-版更新）">四、高频问题全解（2025 版更新）</h2><h4 id="1-加速后仍无法访问-GitHub？">1. <strong>加速后仍无法访问 GitHub？</strong></h4><ul><li>检查系统时间是否与北京时间同步（时区错误导致 SSL 验证失败）</li><li>更新至最新版本：官网每月发布稳定性补丁</li></ul><h4 id="2-企业网络限制如何突破？">2. <strong>企业网络限制如何突破？</strong></h4><ul><li>双工具联用：配合 Xbox 下载助手实现双重代理</li><li>修改协议类型：在设置中切换至 HTTPS 代理模式</li></ul><h4 id="3-移动端加速方案">3. <strong>移动端加速方案</strong></h4><ul><li>Android 版支持 GitHub Mobile 客户端加速（需开启「强制全局代理」）</li><li>iOS 用户可通过 TestFlight 安装测试版</li></ul><h2 id="五、Tips">五、Tips</h2><h3 id="1-深度应用：不只是-GitHub-加速器">1. 深度应用：不只是 GitHub 加速器</h3><ol><li><strong>科研加速</strong>：支持 arXiv、Google Scholar 论文高速下载</li><li><strong>多账号管理</strong>：一键切换 Steam/Epic/Uplay 游戏账号（开发者的摸鱼神器）</li><li>安全增强：<ul><li>本地令牌管理：统一保存 2FA 验证码（支持 TOTP/HOTP 协议）</li><li>隐私保护模式：自动清理浏览器缓存与 DNS 记录</li></ul></li></ol><h3 id="2-2025-新特性：不止-GitHub，更懂开发者">2.2025 新特性：不止 GitHub，更懂开发者</h3><p>✅ 新增「AI 开发加速」模式</p><p>针对 Huggingface、Kaggle 等平台优化，实测 Llama3-7B 模型下载速度提升 400%，支持断点续传。</p><p>✅ <strong>多端协同</strong>（Win+Mac + 安卓）</p><p>手机版（v2.8.3）支持扫码同步令牌，出差时用手机热点也能秒连 GitHub，实测机场延迟降低 60%。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Blog美化</title>
      <link href="/2024/09/04/Blog%E7%BE%8E%E5%8C%96/"/>
      <url>/2024/09/04/Blog%E7%BE%8E%E5%8C%96/</url>
      
        <content type="html"><![CDATA[<h1>Hexo常用命令</h1><p>清除缓存</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo clean</span><br></pre></td></tr></table></figure><p>生成主题静态文件：</p><p>等价于hexo generate</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo g</span><br></pre></td></tr></table></figure><p>启动本地服务：</p><p>等价于hexo server</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo s</span><br></pre></td></tr></table></figure><p>部署到GitHub：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo d</span><br></pre></td></tr></table></figure><p>在<strong>博客根目录</strong>下cmd，执行以下命令，创建一篇新文章：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo new <span class="string">&quot;我的第一篇文章&quot;</span></span><br></pre></td></tr></table></figure><hr><h1>md功能展示</h1><blockquote><p>markdown不熟悉的功能效果展示</p></blockquote><p>正常          <strong>加粗</strong>          <em>斜体</em>          <u>下划线</u>          <code>代码</code></p><p>内联公式：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mi>p</mi></mrow><annotation encoding="application/x-tex">np</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">n</span><span class="mord mathnormal">p</span></span></span></span>          <s>删除线</s>          <mark>高亮文字</mark>          <!--注释--></p><p>公式块：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span></span></p><p>行内公式：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mo>=</mo><mi>m</mi><msup><mi>c</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">E = mc^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord mathnormal">m</span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></p><p>块级公式：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msubsup><mo>∫</mo><mrow><mo>−</mo><mi mathvariant="normal">∞</mi></mrow><mi mathvariant="normal">∞</mi></msubsup><msup><mi>e</mi><mrow><mo>−</mo><msup><mi>x</mi><mn>2</mn></msup></mrow></msup><mi>d</mi><mi>x</mi><mo>=</mo><msqrt><mi>π</mi></msqrt></mrow><annotation encoding="application/x-tex">\int_{-\infty}^{\infty} e^{-x^2} dx = \sqrt{\pi}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.3846em;vertical-align:-0.9703em;"></span><span class="mop"><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011em;">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4143em;"><span style="top:-1.7881em;margin-left:-0.4445em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">∞</span></span></span></span><span style="top:-3.8129em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∞</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9703em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.0369em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.931em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mord mathnormal">d</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.04em;vertical-align:-0.1908em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8492em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord mathnormal" style="margin-right:0.03588em;">π</span></span></span><span style="top:-2.8092em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.08em" viewBox="0 0 400000 1080" preserveAspectRatio="xMinYMin slice"><path d="M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1908em;"><span></span></span></span></span></span></span></span></span></span></p><p>警告框：</p><blockquote><p>[!NOTE]</p><p>提醒内容</p></blockquote><blockquote><p>[!TIP]</p><p>建议内容</p></blockquote><blockquote><p>[!IMPORTANT]</p><p>重要内容</p></blockquote><blockquote><p>[!WARNING]</p><p>警告内容</p></blockquote><blockquote><p>[!CAUTION]</p><p>注意内容</p></blockquote><blockquote><p>引用</p></blockquote><p>脚注：</p><h1>美化</h1><h2 id="Math数学公式">Math数学公式</h2><p>卸载掉 marked 插件，安装 markdown-it</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm un hexo-renderer-marked --save <span class="comment"># 如果有安装这个的话，卸载</span></span><br><span class="line">npm un hexo-renderer-kramed --save <span class="comment"># 如果有安装这个的话，卸载</span></span><br><span class="line"></span><br><span class="line">npm i hexo-renderer-markdown-it --save <span class="comment"># 需要安装这个渲染插件</span></span><br><span class="line">npm install katex @renbaoshuo/markdown-it-katex <span class="comment">#需要安装这个katex插件</span></span><br></pre></td></tr></table></figure><p>在 hexo 的根目录的 <code>_config.yml</code> 中配置</p><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># markdown配置</span></span><br><span class="line"><span class="attr">markdown:</span></span><br><span class="line">  <span class="attr">plugins:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&#x27;@renbaoshuo/markdown-it-katex&#x27;</span>  <span class="comment"># 数学公式插件</span></span><br></pre></td></tr></table></figure><p>如需配置其它参数，请参考 katex 官网</p><h2 id="md文字高亮">md文字高亮</h2><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># markdown配置</span></span><br><span class="line"><span class="attr">markdown:</span></span><br><span class="line">  <span class="attr">plugins:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&#x27;@renbaoshuo/markdown-it-katex&#x27;</span>  <span class="comment"># 数学公式插件</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">markdown-it-mark</span>  <span class="comment"># 文字高亮插件</span></span><br><span class="line">      <span class="attr">enable:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><h2 id="样式！！">样式！！</h2><p>样式统一写在<code>index.styl</code>文件</p><p>C:\Code\KikaBlog\blog\themes\butterfly\source\css\index.styl</p><figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="built_in">hexo-config</span>(<span class="string">&#x27;css_prefix&#x27;</span>)</span><br><span class="line">  <span class="keyword">@import</span> <span class="string">&#x27;nib&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@import</span> <span class="string">&#x27;_third-party/normalize.min.css&#x27;</span></span><br><span class="line"><span class="comment">// project</span></span><br><span class="line"><span class="keyword">@import</span> <span class="string">&#x27;var&#x27;</span></span><br><span class="line"><span class="keyword">@import</span> <span class="string">&#x27;_global/*&#x27;</span></span><br><span class="line"><span class="keyword">@import</span> <span class="string">&#x27;_highlight/highlight&#x27;</span></span><br><span class="line"><span class="keyword">@import</span> <span class="string">&#x27;_page/*&#x27;</span></span><br><span class="line"><span class="keyword">@import</span> <span class="string">&#x27;_layout/*&#x27;</span></span><br><span class="line"><span class="keyword">@import</span> <span class="string">&#x27;_tags/*&#x27;</span></span><br><span class="line"><span class="keyword">@import</span> <span class="string">&#x27;_mode/*&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// search</span></span><br><span class="line"><span class="keyword">@import</span> <span class="string">&#x27;_search/index&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// ======================================================================================</span></span><br><span class="line"><span class="comment">// 确保图标正常显示</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 全局：设置所有伪元素 :before 使用 FontAwesome 字体</span></span><br><span class="line">*<span class="selector-pseudo">:before</span></span><br><span class="line">  <span class="attribute">font-family</span>: FontAwesome <span class="meta">!important</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ======================================================================================</span></span><br><span class="line"><span class="comment">// 背景统一半透明</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 文章阅读区域背景</span></span><br><span class="line"><span class="selector-tag">html</span><span class="selector-pseudo">:not</span>(<span class="selector-attr">[data-theme=<span class="string">&#x27;dark&#x27;</span>]</span>) <span class="selector-id">#post</span></span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, .<span class="number">94</span>)</span><br><span class="line"><span class="selector-tag">html</span><span class="selector-pseudo">:not</span>(<span class="selector-attr">[data-theme=<span class="string">&#x27;light&#x27;</span>]</span>) <span class="selector-id">#post</span></span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, .<span class="number">7</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 侧栏所有卡片</span></span><br><span class="line"><span class="comment">// 说明：匹配包含 .card-widget 的全部卡片类型</span></span><br><span class="line"><span class="selector-tag">html</span><span class="selector-pseudo">:not</span>(<span class="selector-attr">[data-theme=<span class="string">&#x27;dark&#x27;</span>]</span>) <span class="selector-id">#aside-content</span> <span class="selector-class">.card-widget</span></span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, .<span class="number">94</span>)</span><br><span class="line"><span class="selector-tag">html</span><span class="selector-pseudo">:not</span>(<span class="selector-attr">[data-theme=<span class="string">&#x27;light&#x27;</span>]</span>) <span class="selector-id">#aside-content</span> <span class="selector-class">.card-widget</span></span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, .<span class="number">7</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 首页的文章卡片</span></span><br><span class="line"><span class="selector-tag">html</span><span class="selector-pseudo">:not</span>(<span class="selector-attr">[data-theme=<span class="string">&#x27;dark&#x27;</span>]</span>) <span class="selector-id">#recent-posts</span> <span class="selector-class">.recent-post-item</span></span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, .<span class="number">94</span>)</span><br><span class="line"><span class="selector-tag">html</span><span class="selector-pseudo">:not</span>(<span class="selector-attr">[data-theme=<span class="string">&#x27;light&#x27;</span>]</span>) <span class="selector-id">#recent-posts</span> <span class="selector-class">.recent-post-item</span></span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, .<span class="number">7</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 卡片（分类页、标签页、链接页）</span></span><br><span class="line"><span class="selector-tag">html</span><span class="selector-pseudo">:not</span>(<span class="selector-attr">[data-theme=<span class="string">&#x27;dark&#x27;</span>]</span>) <span class="selector-id">#page</span></span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, .<span class="number">94</span>)</span><br><span class="line"><span class="selector-tag">html</span><span class="selector-pseudo">:not</span>(<span class="selector-attr">[data-theme=<span class="string">&#x27;light&#x27;</span>]</span>) <span class="selector-id">#page</span></span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, .<span class="number">7</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 归档页</span></span><br><span class="line"><span class="selector-tag">html</span><span class="selector-pseudo">:not</span>(<span class="selector-attr">[data-theme=<span class="string">&#x27;dark&#x27;</span>]</span>) <span class="selector-id">#archive</span></span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, .<span class="number">94</span>)</span><br><span class="line"><span class="selector-tag">html</span><span class="selector-pseudo">:not</span>(<span class="selector-attr">[data-theme=<span class="string">&#x27;light&#x27;</span>]</span>) <span class="selector-id">#archive</span></span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, .<span class="number">7</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// ======================================================================================</span></span><br><span class="line"><span class="comment">// 顶部图片设置透明</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 将文章页头部的背景强制设为透明，避免使用封面图作为背景</span></span><br><span class="line"><span class="selector-id">#page-header</span><span class="selector-class">.post-bg</span></span><br><span class="line">  <span class="attribute">background</span>: transparent <span class="meta">!important</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 分类页、标签页、归档页头部</span></span><br><span class="line"> <span class="selector-id">#page-header</span><span class="selector-class">.not-home-page</span></span><br><span class="line">  <span class="attribute">background</span>: transparent <span class="meta">!important</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ======================================================================================</span></span><br><span class="line"><span class="comment">// 顶部背景设置半透明并去掉黑罩</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 分类页、标签页、归档页头部</span></span><br><span class="line"><span class="comment">// 针对所有非首页的页面头部：去掉黑罩，隐藏了黑罩层</span></span><br><span class="line"><span class="comment">// #page-header.not-home-page</span></span><br><span class="line"><span class="comment">//   &amp;:before</span></span><br><span class="line"><span class="comment">//   display: none !important</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ======================================================================================</span></span><br><span class="line"><span class="comment">// hexo-blog-encrypt 插件（Hexo 博客的文章加密插件）</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 插件主题修改</span></span><br><span class="line"><span class="selector-class">.hbe-input-field-blink</span></span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#d89f68</span> <span class="meta">!important</span></span><br><span class="line"><span class="selector-class">.hbe-input-field-blink</span><span class="selector-pseudo">:focus</span></span><br><span class="line">  <span class="attribute">border-color</span>: <span class="number">#d89f68</span> <span class="meta">!important</span></span><br><span class="line"><span class="selector-class">.hbe-input-label-content-blink</span><span class="selector-pseudo">::after</span></span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#c97d3a</span> <span class="meta">!important</span></span><br><span class="line"><span class="selector-class">.hbe-input-field</span></span><br><span class="line">  <span class="attribute">margin</span> <span class="number">6px</span> <span class="meta">!important</span></span><br></pre></td></tr></table></figure><h2 id="悬浮栏">悬浮栏</h2><ul><li>增加了【去到底部】按钮和【自动隐藏】功能</li></ul><h2 id="评论">评论</h2><p><a href="https://kika2378.netlify.app/.netlify/functions/twikoo">https://kika2378.netlify.app/.netlify/functions/twikoo</a></p><p><a href="https://www.boke360.cn/post/twikoo-netlify-deploy/">Twikoo Netlify部署方法及操作流程，给博客网站添加评论功能</a></p><h1>遇到的问题</h1><h2 id="图片路径">图片路径</h2><p>这样是无法显示的：</p><p><img src="./../Blog%E7%BE%8E%E5%8C%96/image-20260122121921375.png" alt="image-20260122121921375"></p><p>然后我去GitHub上看了，发现2025/04/11文件夹不存放图片，这一段路径是多余的</p><p>然后尝试直接打开图片：</p><p><img src="./../Blog%E7%BE%8E%E5%8C%96/image-20260122122052767.png" alt="image-20260122122052767"></p><p>所以，解决方法是去掉 <code>http://localhost:4000/2025/04/11/pic/test1-2.png</code>中的 <code>2025/04/11</code></p><p>是因为我之前把marked插件换成markdown-it所以图片路径才会变吗？？？</p><p><strong>修改 loadLightbox 函数</strong></p><ul><li>文件路径 : <code>C:\Code\KikaBlog\blog\themes\butterfly\source\js\utils.js</code></li><li>修改内容 :<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 原代码</span></span><br><span class="line"><span class="attr">loadLightbox</span>: <span class="function"><span class="params">ele</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> service = <span class="variable constant_">GLOBAL_CONFIG</span>.<span class="property">lightbox</span></span><br><span class="line">  <span class="keyword">if</span> (service === <span class="string">&#x27;medium_zoom&#x27;</span>) &#123;</span><br><span class="line">    <span class="title function_">mediumZoom</span>(ele, &#123; <span class="attr">background</span>: <span class="string">&#x27;var(--zoom-bg)&#x27;</span> &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (service === <span class="string">&#x27;fancybox&#x27;</span>) &#123;</span><br><span class="line">    <span class="title class_">Array</span>.<span class="title function_">from</span>(ele).<span class="title function_">forEach</span>(<span class="function"><span class="params">i</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (i.<span class="property">parentNode</span>.<span class="property">tagName</span> !== <span class="string">&#x27;A&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> dataSrc = i.<span class="property">dataset</span>.<span class="property">lazySrc</span> || i.<span class="property">src</span></span><br><span class="line">        <span class="keyword">const</span> dataCaption = i.<span class="property">title</span> || i.<span class="property">alt</span> || <span class="string">&#x27;&#x27;</span></span><br><span class="line">        btf.<span class="title function_">wrap</span>(i, <span class="string">&#x27;a&#x27;</span>, &#123; <span class="attr">href</span>: dataSrc, <span class="string">&#x27;data-fancybox&#x27;</span>: </span><br><span class="line">        <span class="string">&#x27;gallery&#x27;</span>, <span class="string">&#x27;data-caption&#x27;</span>: dataCaption, </span><br><span class="line">        <span class="string">&#x27;data-thumb&#x27;</span>: dataSrc &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="comment">// 其他代码...</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 修改后</span></span><br><span class="line"><span class="attr">loadLightbox</span>: <span class="function"><span class="params">ele</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> service = <span class="variable constant_">GLOBAL_CONFIG</span>.<span class="property">lightbox</span></span><br><span class="line">  <span class="keyword">if</span> (service === <span class="string">&#x27;medium_zoom&#x27;</span>) &#123;</span><br><span class="line">    <span class="title function_">mediumZoom</span>(ele, &#123; <span class="attr">background</span>: <span class="string">&#x27;var(--zoom-bg)&#x27;</span> &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (service === <span class="string">&#x27;fancybox&#x27;</span>) &#123;</span><br><span class="line">    <span class="title class_">Array</span>.<span class="title function_">from</span>(ele).<span class="title function_">forEach</span>(<span class="function"><span class="params">i</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// 处理图片 src 属性，去除 ./../ 前缀</span></span><br><span class="line">      <span class="keyword">let</span> imgSrc = i.<span class="title function_">getAttribute</span>(<span class="string">&#x27;src&#x27;</span>) || i.<span class="property">src</span></span><br><span class="line">      <span class="keyword">if</span> (imgSrc.<span class="title function_">startsWith</span>(<span class="string">&#x27;./../&#x27;</span>)) &#123;</span><br><span class="line">        imgSrc = imgSrc.<span class="title function_">substring</span>(<span class="number">4</span>) <span class="comment">// 移除 ./../ 前缀</span></span><br><span class="line">        i.<span class="title function_">setAttribute</span>(<span class="string">&#x27;src&#x27;</span>, imgSrc)</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> (i.<span class="property">parentNode</span>.<span class="property">tagName</span> !== <span class="string">&#x27;A&#x27;</span>) &#123;</span><br><span class="line">        <span class="comment">// 获取原始的相对路径，而不是浏览器解析的绝对路径</span></span><br><span class="line">        <span class="keyword">let</span> dataSrc = imgSrc</span><br><span class="line">        <span class="keyword">const</span> dataCaption = i.<span class="property">title</span> || i.<span class="property">alt</span> || <span class="string">&#x27;&#x27;</span></span><br><span class="line">        btf.<span class="title function_">wrap</span>(i, <span class="string">&#x27;a&#x27;</span>, &#123; <span class="attr">href</span>: dataSrc, <span class="string">&#x27;data-fancybox&#x27;</span>: </span><br><span class="line">        <span class="string">&#x27;gallery&#x27;</span>, <span class="string">&#x27;data-caption&#x27;</span>: dataCaption, </span><br><span class="line">        <span class="string">&#x27;data-thumb&#x27;</span>: dataSrc &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="comment">// 其他代码...</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li>原因 :<ul><li>使用 <code>i.getAttribute('src')</code> 获取原始的相对路径，而不是 <code>i.src</code> （浏览器解析的绝对路径，会包含日期前缀）</li><li>去除路径中的 <code>./../</code> 前缀，使路径更简洁（如将 <code>./../pic/test1-2.png</code> 改为 <code>pic/test1-2.png</code> ）</li><li>同时更新图片的 src 属性和包裹图片的 <code>&lt;a&gt;</code> 标签的 href 、 data-thumb 属性，确保所有路径都不包含日期前缀</li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> blog </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>牛客-SQL快速入门40题</title>
      <link href="/2024/06/21/%E7%89%9B%E5%AE%A2-SQL%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A840%E9%A2%98/"/>
      <url>/2024/06/21/%E7%89%9B%E5%AE%A2-SQL%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A840%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<h1>1.查询所有列</h1><p>题目描述：现在运营想要查看用户信息表中所有的数据，请你取出相应结果。</p><p>星号*的使用</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">from</span> user_profile</span><br></pre></td></tr></table></figure><h1>2.查询多列</h1><p>题目描述：现在运营想要用户的设备id对应的性别、年龄和学校的数据，请你取出相应数据。</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">    device_id</span><br><span class="line">    ,gender</span><br><span class="line">    ,age</span><br><span class="line">    ,university</span><br><span class="line"><span class="keyword">from</span> user_profile</span><br></pre></td></tr></table></figure><h1>3.结果去重</h1><p>题目描述：现在运营想要查看用户来自于哪些学校，请从用户信息表中取出学校的去重数据。</p><p>写法一（distinct去重）：</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> </span><br><span class="line"><span class="keyword">distinct</span> university</span><br><span class="line"><span class="keyword">from</span> user_profile</span><br></pre></td></tr></table></figure><p>写法二（group by去重）：</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">university</span><br><span class="line"><span class="keyword">from</span> user_profile</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> <span class="number">1</span></span><br></pre></td></tr></table></figure><h1>4.查询结果限制返回行数</h1><p>题目描述：现在运营只需要查看前2个用户明细设备ID数据，请你从用户信息表user_profile中取出相应结果。</p><p>关键字<code>limit</code></p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">device_id</span><br><span class="line"><span class="keyword">from</span> user_profile</span><br><span class="line">limit <span class="number">2</span></span><br></pre></td></tr></table></figure><h1>5.将查询后的列重新命名</h1><p>题目描述：需要查看前2个用户明细设备ID数据，并将列user_infos_example’，请你从用户信息表取出相应结果。</p><p>关键字<code>as</code></p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">device_id <span class="keyword">as</span> users_infos_example</span><br><span class="line"><span class="keyword">from</span> user_profile</span><br><span class="line">limit <span class="number">2</span></span><br></pre></td></tr></table></figure><h1>6.查询学校是北大的学生信息</h1><p>关键字<code>where</code></p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">device_id</span><br><span class="line">,university</span><br><span class="line"><span class="keyword">from</span> user_profile</span><br><span class="line"><span class="keyword">where</span> university <span class="operator">=</span> <span class="string">&#x27;北京大学&#x27;</span></span><br></pre></td></tr></table></figure><h1>7.查找年龄大于24岁的用户信息</h1><p>age：int可用<code>＞ ＜ =</code>符号</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">device_id</span><br><span class="line">,gender</span><br><span class="line">,age</span><br><span class="line">,university</span><br><span class="line"><span class="keyword">from</span> user_profile</span><br><span class="line"><span class="keyword">where</span> age <span class="operator">&gt;</span> <span class="number">24</span></span><br></pre></td></tr></table></figure><h1>8.查找某个年龄段的用户信息</h1><p>题目描述：现在运营想要针对20岁及以上且23岁及以下的用户开展分析，请你取出满足条件的设备ID、性别、年龄。</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">device_id</span><br><span class="line">,gender</span><br><span class="line">,age</span><br><span class="line"><span class="keyword">from</span> user_profile</span><br><span class="line"><span class="keyword">where</span> age <span class="operator">&gt;=</span> <span class="number">20</span> </span><br><span class="line"><span class="keyword">and</span> age <span class="operator">&lt;=</span><span class="number">23</span></span><br></pre></td></tr></table></figure><h1>9.查找去除复旦大学的用户信息</h1><p>题目描述：现在运营想要查看除复旦大学以外的所有用户明细，请你取出相应数据。</p><ul><li>university：<code>varchar</code>，字符串要用单引号 <code>''</code>包裹起来</li><li>不等于：<code>！=</code></li></ul><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">    device_id</span><br><span class="line">    ,gender</span><br><span class="line">    ,age</span><br><span class="line">    ,university</span><br><span class="line"><span class="keyword">from</span> user_profile</span><br><span class="line"><span class="keyword">where</span> university <span class="operator">!=</span> <span class="string">&#x27;复旦大学&#x27;</span></span><br></pre></td></tr></table></figure><h1>10.用where过滤空值练习</h1><p>题目描述：想要对用户的年龄分布开展分析，在分析时想要剔除没有获取到年龄的用户，请你取出所有年龄值不为空的用户的设备ID、性别、年龄、学校的信息。</p><ul><li>取<strong>字段的非空值</strong>使用：is not null</li></ul><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">device_id</span><br><span class="line">,gender</span><br><span class="line">,age</span><br><span class="line">,university</span><br><span class="line"><span class="keyword">from</span> user_profile</span><br><span class="line"><span class="keyword">where</span> age <span class="keyword">is</span> <span class="keyword">not null</span></span><br></pre></td></tr></table></figure><h1>11.操作符练习（1）</h1><p>题目描述：现在运营想要找到男性且GPA在3.5以上(不包括3.5)的用户进行调研，请你取出相应数据。</p><ul><li>gender：<code>varchar</code></li><li>gpa：<code>float</code></li></ul><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">device_id</span><br><span class="line">,gender</span><br><span class="line">,age</span><br><span class="line">,university</span><br><span class="line">,gpa</span><br><span class="line"><span class="keyword">from</span> user_profile</span><br><span class="line"><span class="keyword">where</span> gender <span class="operator">=</span> <span class="string">&#x27;male&#x27;</span> <span class="keyword">and</span> gpa <span class="operator">&gt;</span><span class="number">3.5</span></span><br></pre></td></tr></table></figure><h1>12.操作符练习（2）</h1><p>题目描述：现在运营想要找到学校为北大或GPA在3.7以上(不包括3.7)的用户进行调研，请你取出相应数据（使用OR实现）。</p><ul><li>university：<code>varchar</code></li><li>gpa：<code>float</code></li></ul><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">device_id</span><br><span class="line">,gender</span><br><span class="line">,age</span><br><span class="line">,university</span><br><span class="line">,gpa</span><br><span class="line"><span class="keyword">from</span> user_profile</span><br><span class="line"><span class="keyword">where</span> university <span class="operator">=</span> <span class="string">&#x27;北京大学&#x27;</span> <span class="keyword">or</span> gpa <span class="operator">&gt;</span><span class="number">3.7</span></span><br></pre></td></tr></table></figure><h1>13.Where in</h1><p>题目描述：现在运营想要找到学校为北大、复旦和山大的用户进行调研，请你取出相应数据。</p><p>写法一：</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">device_id</span><br><span class="line">,gender</span><br><span class="line">,age</span><br><span class="line">,university</span><br><span class="line">,gpa</span><br><span class="line"><span class="keyword">from</span> user_profile</span><br><span class="line"><span class="keyword">where</span> university <span class="operator">=</span> <span class="string">&#x27;北京大学&#x27;</span></span><br><span class="line"><span class="keyword">or</span> university <span class="operator">=</span> <span class="string">&#x27;复旦大学&#x27;</span></span><br><span class="line"><span class="keyword">or</span> university <span class="operator">=</span> <span class="string">&#x27;山东大学&#x27;</span></span><br></pre></td></tr></table></figure><p>写法二（通常使用这个写法，写法一只是便于理解）：</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">device_id</span><br><span class="line">,gender</span><br><span class="line">,age</span><br><span class="line">,university</span><br><span class="line">,gpa</span><br><span class="line"><span class="keyword">from</span> user_profile</span><br><span class="line"><span class="keyword">where</span> university <span class="keyword">in</span> (<span class="string">&#x27;北京大学&#x27;</span>, <span class="string">&#x27;复旦大学&#x27;</span>, <span class="string">&#x27;山东大学&#x27;</span>)</span><br></pre></td></tr></table></figure><h1>14.操作符混合运用</h1><p>题目描述：找到GPA在3.5以上(不包括3.5)的山东大学用户 或 GPA在3.8以上(不包括3.8)的复旦大学用户进行调研，请你取出相应数据。</p><p><strong><mark>优先级</mark></strong>：<code>NOT</code> &gt; <code>AND</code> &gt; <code>OR</code>，可以用括号<code>()</code>改变优先级</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">device_id</span><br><span class="line">,gender</span><br><span class="line">,age</span><br><span class="line">,university</span><br><span class="line">,gpa</span><br><span class="line"><span class="keyword">from</span> user_profile</span><br><span class="line"><span class="keyword">where</span> </span><br><span class="line">gpa<span class="operator">&gt;</span><span class="number">3.5</span> <span class="keyword">and</span> university<span class="operator">=</span><span class="string">&#x27;山东大学&#x27;</span></span><br><span class="line"><span class="keyword">or</span></span><br><span class="line">gpa<span class="operator">&gt;</span><span class="number">3.8</span> <span class="keyword">and</span> university<span class="operator">=</span><span class="string">&#x27;复旦大学&#x27;</span></span><br></pre></td></tr></table></figure><p>加不加括号都行：</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">where</span> </span><br><span class="line">(gpa<span class="operator">&gt;</span><span class="number">3.5</span> <span class="keyword">and</span> university<span class="operator">=</span><span class="string">&#x27;山东大学&#x27;</span>)</span><br><span class="line"><span class="keyword">or</span></span><br><span class="line">(gpa<span class="operator">&gt;</span><span class="number">3.8</span> <span class="keyword">and</span> university<span class="operator">=</span><span class="string">&#x27;复旦大学&#x27;</span>)</span><br></pre></td></tr></table></figure><h1>15.查看学校名称中含北京的用户</h1><p>题目描述：现在运营想要查看所有大学中带有北京的用户的信息，请你取出相应数据。</p><ul><li>关键字<code>like</code></li><li>占位符(通配符)<code>%</code></li></ul><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">    device_id,</span><br><span class="line">    age,</span><br><span class="line">    university</span><br><span class="line"><span class="keyword">from</span></span><br><span class="line">    user_profile</span><br><span class="line"><span class="keyword">where</span></span><br><span class="line">    university <span class="keyword">like</span> <span class="string">&#x27;%北京%&#x27;</span></span><br></pre></td></tr></table></figure><h1>16.查找GPA最高值</h1><p>题目描述：现在运营想要知道复旦大学学生GPA最高值是多少，请你取出相应数据。</p><p>执行顺序是先where再from（准确的说这里是max函数的使用）</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">round(<span class="built_in">max</span>(gpa), <span class="number">1</span>)</span><br><span class="line"><span class="keyword">from</span> user_profile</span><br><span class="line"><span class="keyword">where</span> university <span class="operator">=</span> <span class="string">&#x27;复旦大学&#x27;</span></span><br></pre></td></tr></table></figure><ul><li>excel里也是先筛选再聚合？？为什么捏?<ul><li>好处是：先筛选之后数据量就变少了，然后再计算（或者更复杂的操作），数据量越少，执行速度就快，大概率</li></ul></li></ul><h1>17.计算男生人数以及他们的平均GPA</h1><p>函数<code>count()</code></p><p>可以是</p><ul><li><code>count(字段)</code>：统计某个列中非 NULL 值的数量</li><li><code>count(*)</code>：统计表中的总行数（包括NULL）</li><li><code>count(distinct 字段id)</code>：统计id去重后的非NULL值数量</li></ul><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line"><span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">as</span> male_num</span><br><span class="line">,round(<span class="built_in">avg</span>(gpa), <span class="number">1</span>) <span class="keyword">as</span> avg_gpa</span><br><span class="line"><span class="keyword">from</span> user_profile</span><br><span class="line"><span class="keyword">where</span> gender<span class="operator">=</span><span class="string">&#x27;male&#x27;</span></span><br></pre></td></tr></table></figure><ul><li><strong>历史背景</strong><ul><li><code>COUNT(1)</code> 是早期数据库优化不佳时的&quot;民间偏方&quot;</li><li>现代数据库优化器会自动将两者识别为<strong>等效操作</strong></li><li><strong>推荐使用 <code>COUNT(*)</code></strong>：标准、规范、易读</li></ul></li></ul><h1>18.分组计算练习题</h1><p>分组聚合</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">    gender</span><br><span class="line">    ,university</span><br><span class="line">    ,<span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">as</span> user_num</span><br><span class="line">    ,round(<span class="built_in">avg</span>(active_days_within_30), <span class="number">1</span>) <span class="keyword">as</span> avg_active_day</span><br><span class="line">    ,round(<span class="built_in">avg</span>(question_cnt), <span class="number">1</span>) <span class="keyword">as</span> avg_question_cnt</span><br><span class="line"><span class="keyword">from</span> user_profile</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> <span class="number">1</span>,<span class="number">2</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> <span class="number">1</span>,<span class="number">2</span></span><br></pre></td></tr></table></figure><ul><li>分组：严格指<code>group by</code>子句（分组操作）</li><li>分组后，核心聚合函数5个<ul><li><code>count()</code>：计数</li><li><code>sum()</code>：求和</li><li><code>avg()</code>：平均值</li></ul></li></ul><h1>19.分组过滤练习题</h1><p>题目：现在运营想查看每个学校用户的平均发贴和回帖情况，寻找低活跃度学校进行重点运营，请取出平均发贴数低于5的学校或平均回帖数小于20的学校。</p><p>在excel里会怎么做：先求出平均发帖和回帖情况（用数据透视表做），然后再筛选符合条件的</p><ul><li>关键字：<code>having</code><ul><li>having是在聚合之后的数据里进行筛选</li></ul></li></ul><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">    university</span><br><span class="line">    ,<span class="built_in">avg</span>(question_cnt) <span class="keyword">as</span> avg_question_cnt</span><br><span class="line">    ,<span class="built_in">avg</span>(answer_cnt) <span class="keyword">as</span> avg_answer_cnt</span><br><span class="line"><span class="keyword">from</span> user_profile</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">having</span> avg_question_cnt<span class="operator">&lt;</span><span class="number">5</span> <span class="keyword">or</span> avg_answer_cnt<span class="operator">&lt;</span><span class="number">20</span></span><br></pre></td></tr></table></figure><p>解法2：可以用子查询</p><p>不过having存在，就是让你可以少写一层子查询，仅此</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line"><span class="operator">*</span></span><br><span class="line"><span class="keyword">from</span>(</span><br><span class="line">    <span class="keyword">select</span></span><br><span class="line">        university,</span><br><span class="line">        <span class="built_in">avg</span>(question_cnt) <span class="keyword">as</span> avg_question_cnt,</span><br><span class="line">        <span class="built_in">avg</span>(answer_cnt) <span class="keyword">as</span> avg_answer_cnt</span><br><span class="line">    <span class="keyword">from</span></span><br><span class="line">        user_profile</span><br><span class="line">    <span class="keyword">group</span> <span class="keyword">by</span></span><br><span class="line">        university</span><br><span class="line">) <span class="keyword">as</span> a</span><br><span class="line"><span class="keyword">where</span> <span class="built_in">avg</span>(question_cnt) <span class="operator">&lt;</span> <span class="number">5</span> <span class="keyword">or</span> <span class="built_in">avg</span>(answer_cnt) <span class="operator">&lt;</span> <span class="number">20</span></span><br></pre></td></tr></table></figure><h1>20.分组排序练习</h1><p>关键字：order by</p><p>默认升序排列asc；降序加desc，如 order by 2 desc</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> </span><br><span class="line">university</span><br><span class="line">,<span class="built_in">avg</span>(question_cnt) <span class="keyword">as</span> avg_question_cnt</span><br><span class="line"><span class="keyword">from</span> user_profile</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> <span class="number">2</span></span><br></pre></td></tr></table></figure><h1>21.表连接</h1><p>excel里XLOOKUP，只连接某个字段</p><p>关键字<code>join</code>，表连接</p><ul><li>左连接：<code>left join</code>，保证<strong>左表完整性</strong>（左表所有记录都保留），左表不动，右表记录根据匹配条件&quot;拼&quot;到左表上，右表找到匹配记录 → 左右表字段合并显示，右表没找到匹配记录 → 左表字段正常显示，右表字段显示为<strong>NULL</strong><ul><li>左表<strong>所有行</strong>都在结果中</li><li>右表<strong>只有匹配上的行</strong>才会出现</li><li>右表无法匹配的行（右表有但左表没有）<strong>确实会被丢弃</strong></li><li>匹配不上时右表字段<strong>值为NULL</strong></li></ul></li><li>右连接：同理</li><li>全连接：为空也保留，左右都保留</li><li>内连接：join，只要一边没连上全都丢掉</li></ul><p>1）只连接指定列：</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> </span><br><span class="line">字段</span><br><span class="line"><span class="keyword">from</span> question_practice_detail a</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span>(</span><br><span class="line">    <span class="keyword">select</span></span><br><span class="line">    device_id</span><br><span class="line">    , university</span><br><span class="line">    <span class="keyword">from</span> user_profile</span><br><span class="line">) b <span class="keyword">on</span> a.device_id <span class="operator">=</span> b.device_id</span><br></pre></td></tr></table></figure><p>2）连接所有列：</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> </span><br><span class="line">字段</span><br><span class="line"><span class="keyword">from</span> question_practice_detail a</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> user_profile b <span class="keyword">on</span> a.device_id <span class="operator">=</span> b.device_id</span><br></pre></td></tr></table></figure><p>先连接，后筛选（右表的university字段）</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> </span><br><span class="line">a.device_id <span class="keyword">as</span> device_id</span><br><span class="line">,a.question_id <span class="keyword">as</span> question_id</span><br><span class="line">,a.result <span class="keyword">as</span> <span class="keyword">result</span></span><br><span class="line"><span class="keyword">from</span> question_practice_detail a</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> user_profile b <span class="keyword">on</span> a.device_id <span class="operator">=</span> b.device_id</span><br><span class="line"><span class="keyword">where</span> b.university <span class="operator">=</span> <span class="string">&#x27;浙江大学&#x27;</span></span><br></pre></td></tr></table></figure><h1><mark>22</mark>.统计每个学校的答过题的用户的平均题数</h1><p>题目：运营想要了解每个学校<strong>答过题的</strong>用户平均答题数量情况，请你取出数据。</p><p>说明：某学校用户平均答题数量计算方式为该学校用户答题总次数除以答过题的<strong>不同</strong>用户个数</p><ul><li>用户信息表user_profile</li><li>答题情况明细表question_practice_detail</li></ul><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">b.university <span class="keyword">as</span> university</span><br><span class="line">,round(<span class="built_in">count</span>(<span class="operator">*</span>) <span class="operator">/</span> <span class="built_in">count</span>(<span class="keyword">distinct</span> a.device_id), <span class="number">4</span>) <span class="keyword">as</span> avg_answer_cnt</span><br><span class="line"><span class="keyword">from</span> question_practice_detail a</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> user_profile b <span class="keyword">on</span> a.device_id <span class="operator">=</span> b.device_id</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> <span class="number">1</span></span><br></pre></td></tr></table></figure><h1>23.事实表vs维度表</h1><blockquote><p>（这题有详细解题步骤，因为开始变难了）</p></blockquote><p>题目：运营想要计算一些<strong>参加了答题</strong>的不同学校、不同难度的用户平均答题量，请你写SQL取出相应数据</p><p><strong>事实表</strong>、维度表、信息表？</p><ul><li>事实表：带着业务的？</li><li>这里的用户信息表user_profile是一张维度表</li></ul><p>bug?刚刚在牛客提交，明明是一样的答案提交错误，等了一会就可以了</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">b.university <span class="keyword">as</span> university</span><br><span class="line">,c.difficult_level <span class="keyword">as</span> difficult_level</span><br><span class="line">,round(<span class="built_in">count</span>(<span class="operator">*</span>) <span class="operator">/</span> <span class="built_in">count</span>(<span class="keyword">distinct</span> a.device_id), <span class="number">4</span>) <span class="keyword">as</span> avg_answer_cnt</span><br><span class="line"><span class="keyword">from</span> question_practice_detail a</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> user_profile b <span class="keyword">on</span> a.device_id <span class="operator">=</span> b.device_id</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> question_detail c <span class="keyword">on</span> a.question_id <span class="operator">=</span> c.question_id</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> <span class="number">1</span>, <span class="number">2</span></span><br></pre></td></tr></table></figure><ul><li><p>怎么区分事实表和维度表</p></li><li><p>给你个字段，问两个问题：</p><p><strong>1. 这个字段能进行数学运算吗？</strong></p><ul><li>能算 → <strong>事实</strong>（如：销售额可以求和）</li><li>不能算 → 进入下一题</li></ul><p><strong>2. 这个字段用来分组/筛选吗？</strong></p><ul><li>用来分组 → <strong>维度</strong>（如：按&quot;省份&quot;分组统计）</li><li>不用来分组 → 可能是维度属性</li></ul><p>真实案例</p><p><strong>订单数据</strong>：</p><ul><li>订单金额、数量、折扣 → <strong>事实表</strong></li><li>用户姓名、商品名称、下单日期、城市 → <strong>维度表</strong></li></ul></li><li><p>事实表和维度表在查询时为什么要区分</p><ul><li><p><strong>数据量差距 = 生死差距</strong></p><ul><li><strong>事实表</strong>：1亿行（订单明细）</li><li><strong>维度表</strong>：1万行（商品信息）</li></ul><p><strong>如果不区分</strong>，你可能把1亿行 × 1亿行做JOIN，系统直接卡死。<br><strong>区分后</strong>，1亿行 JOIN 1万行，数据库可以轻松优化。</p></li></ul></li></ul><h1>24统计每个用户的平均刷题数</h1><blockquote><p>24题与23题只有些许不同</p></blockquote><p>题目：运营想要查看<strong>参加了答题的山东大学的</strong>用户在不同难度下的平均答题题目数，请取出相应数据</p><ul><li>要在join的on就把“山东大学”的用户筛选出来→打了题∩山东大学</li></ul><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">    b.university <span class="keyword">as</span> university</span><br><span class="line">    ,c.difficult_level <span class="keyword">as</span> difficult_level</span><br><span class="line">,round(<span class="built_in">count</span>(<span class="operator">*</span>) <span class="operator">/</span> <span class="built_in">count</span>(<span class="keyword">distinct</span> a.device_id), <span class="number">4</span>) <span class="keyword">as</span> avg_answer_cnt</span><br><span class="line"><span class="keyword">from</span> question_practice_detail a</span><br><span class="line"><span class="keyword">join</span> user_profile b</span><br><span class="line">    <span class="keyword">on</span> a.device_id <span class="operator">=</span> b.device_id</span><br><span class="line">    <span class="keyword">and</span> b.university <span class="operator">=</span> <span class="string">&#x27;山东大学&#x27;</span></span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> question_detail c <span class="keyword">on</span> a.question_id <span class="operator">=</span> c.question_id</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> <span class="number">1</span>,<span class="number">2</span></span><br></pre></td></tr></table></figure><h1>25.查找山东大学或者性别为男生的信息</h1><p>题目：现在运营想要分别查看学校为山东大学或者性别为男性的用户的device_id、gender、age和gpa数据，请取出相应结果，结果不去重。根据示例，你的查询应返回以下结果（注意输出的顺序，先输出学校为山东大学再输出性别为男生的信息）</p><p>关键字：union，上下拼接（列的数量要匹配）</p><ul><li>union：会帮你去重</li><li>union all：不去重</li></ul><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">    device_id</span><br><span class="line">    ,gender</span><br><span class="line">    ,age</span><br><span class="line">    ,gpa</span><br><span class="line"><span class="keyword">from</span> user_profile</span><br><span class="line"><span class="keyword">where</span> university <span class="operator">=</span> <span class="string">&#x27;山东大学&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">union</span> <span class="keyword">all</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span></span><br><span class="line">    device_id</span><br><span class="line">    ,gender</span><br><span class="line">    ,age</span><br><span class="line">    ,gpa</span><br><span class="line"><span class="keyword">from</span> user_profile</span><br><span class="line"><span class="keyword">where</span> gender <span class="operator">=</span> <span class="string">&#x27;male&#x27;</span></span><br></pre></td></tr></table></figure><ul><li><p>为什么使用 <code>union all</code> 而不是<code>where university = '山东大学' or gender = 'male'</code></p><ul><li>结果不去重</li><li>顺序，先山大再男性</li></ul></li><li><p><code>union all</code>的经典用法<br><strong>可以合并不同表的&quot;同类&quot;数据，且支持字段计算转换</strong></p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">    order_id,</span><br><span class="line">    amount,</span><br><span class="line">    <span class="string">&#x27;正向订单&#x27;</span> <span class="keyword">AS</span> order_type,</span><br><span class="line">    create_time</span><br><span class="line"><span class="keyword">FROM</span> formal_orders</span><br><span class="line"><span class="keyword">WHERE</span> create_date <span class="keyword">BETWEEN</span> <span class="string">&#x27;2024-01-01&#x27;</span> <span class="keyword">AND</span> <span class="string">&#x27;2024-01-07&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">UNION</span> <span class="keyword">ALL</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">    refund_id <span class="keyword">AS</span> order_id,</span><br><span class="line">    <span class="operator">-</span>amount <span class="keyword">AS</span> amount,  <span class="comment">-- 退款为负值</span></span><br><span class="line">    <span class="string">&#x27;退款订单&#x27;</span> <span class="keyword">AS</span> order_type,</span><br><span class="line">    refund_time <span class="keyword">AS</span> create_time</span><br><span class="line"><span class="keyword">FROM</span> refund_orders</span><br><span class="line"><span class="keyword">WHERE</span> refund_date <span class="keyword">BETWEEN</span> <span class="string">&#x27;2024-01-01&#x27;</span> <span class="keyword">AND</span> <span class="string">&#x27;2024-01-07&#x27;</span>;</span><br></pre></td></tr></table></figure></li></ul><h1>26.计算25岁以上和以下的用户数量</h1><p>题目：现在运营想要将用户划分为25岁以下和25岁及以上两个年龄段，分别查看这两个年龄段用户数量。<strong>本题注意：age为null 也记为 25岁以下</strong></p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">    if(age <span class="operator">&lt;</span> <span class="number">25</span> <span class="keyword">or</span> age <span class="keyword">is</span> <span class="keyword">null</span>, <span class="string">&#x27;25岁以下&#x27;</span>, <span class="string">&#x27;25岁及以上&#x27;</span>) <span class="keyword">as</span> age_cut</span><br><span class="line">    ,<span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">as</span> number</span><br><span class="line"><span class="keyword">from</span> user_profile</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> <span class="number">1</span></span><br></pre></td></tr></table></figure><p>excel中，用if函数做辅助列</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">=IF(判断条件, 条件成立时的值, 条件不成立时的值)</span><br></pre></td></tr></table></figure><h1>27.查看不同年龄段的用户明细</h1><p><code>case when</code>的使用</p><p>当条件有三个或以上的时候就不用if了，改用<strong>case when</strong></p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">    device_id</span><br><span class="line">    ,gender</span><br><span class="line">    ,<span class="keyword">case</span> </span><br><span class="line">        <span class="keyword">when</span> age <span class="operator">&lt;</span> <span class="number">20</span> <span class="keyword">then</span> <span class="string">&#x27;20岁以下&#x27;</span></span><br><span class="line">        <span class="keyword">when</span> age <span class="operator">&gt;=</span> <span class="number">20</span> <span class="keyword">and</span> age <span class="operator">&lt;=</span> <span class="number">24</span> <span class="keyword">then</span> <span class="string">&#x27;20-24岁&#x27;</span></span><br><span class="line">        <span class="keyword">when</span> age <span class="operator">&gt;=</span> <span class="number">25</span> <span class="keyword">then</span> <span class="string">&#x27;25岁及以上&#x27;</span></span><br><span class="line">    <span class="keyword">else</span> <span class="string">&#x27;其他&#x27;</span> <span class="keyword">end</span> <span class="keyword">as</span> age_cut</span><br><span class="line"><span class="keyword">from</span> user_profile</span><br></pre></td></tr></table></figure><h1>28.day() left()</h1><p>题目：现在运营想要计算出<strong>2021年8月每天用户练习题目的数量</strong>，请取出相应数据。</p><p>date：date</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">    <span class="keyword">day</span>(<span class="type">date</span>) <span class="keyword">as</span> <span class="keyword">day</span></span><br><span class="line">    ,<span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">as</span> question_cnt</span><br><span class="line"><span class="keyword">from</span> question_practice_detail</span><br><span class="line"><span class="keyword">where</span> <span class="keyword">left</span>(<span class="type">date</span>, <span class="number">7</span>) <span class="operator">=</span> <span class="string">&#x27;2021-08&#x27;</span></span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> <span class="number">1</span></span><br></pre></td></tr></table></figure><h1><a href="https://www.nowcoder.com/practice/126083961ae0415fbde061d7ebbde453?tpId=199&amp;tags=&amp;title=&amp;difficulty=0&amp;judgeStatus=0&amp;rp=0&amp;sourceUrl=%2Fexam%2Fcompany"><mark>SQL29</mark> 计算用户的平均次日留存率</a></h1><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">with</span> tmp <span class="keyword">as</span>(</span><br><span class="line">    <span class="keyword">select</span></span><br><span class="line">    device_id</span><br><span class="line">    ,<span class="type">date</span></span><br><span class="line">    <span class="keyword">from</span> question_practice_detail</span><br><span class="line">    <span class="keyword">group</span> <span class="keyword">by</span> <span class="number">1</span>,<span class="number">2</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">select</span></span><br><span class="line"><span class="built_in">count</span>(b.device_id) <span class="operator">/</span> <span class="built_in">count</span>(a.device_id) <span class="keyword">as</span> avg_ret</span><br><span class="line"><span class="keyword">from</span> tmp a</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> tmp b</span><br><span class="line"><span class="keyword">on</span> a.device_id <span class="operator">=</span> b.device_id</span><br><span class="line"><span class="keyword">and</span> a.date <span class="operator">=</span> date_sub(b.date, <span class="type">interval</span> <span class="number">1</span> <span class="keyword">day</span>)</span><br></pre></td></tr></table></figure><ul><li>步骤1：获取每个用户每天的刷题日期（去重）<br>步骤2：通过<strong>自连接</strong>，将每个用户每天的记录与第二天的记录连接起来。<br>步骤3：统计所有的记录数作为分母，统计第二天有记录的记录数作为分子，然后计算比例。</li><li>自连接说的是inner join吗<ul><li>我们通常说自连接（self-join）是指同一个表自己和自己连接，可以使用INNER JOIN，也可以使用LEFT JOIN等</li></ul></li></ul><h1>30.substring_index()</h1><p>题目：现在运营举办了一场比赛，收到了一些参赛申请，表数据记录形式如下所示，现在运营想要统计每个性别的用户分别有多少参赛者，请取出相应结果</p><p>profile：varchar</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">    substring_index(profile, <span class="string">&#x27;,&#x27;</span>, <span class="number">-1</span>) <span class="keyword">as</span> gender</span><br><span class="line">    ,<span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">as</span> number</span><br><span class="line"><span class="keyword">from</span> user_submit</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> <span class="number">1</span></span><br></pre></td></tr></table></figure><ul><li><code>substring_index()</code>的使用<ul><li>用于根据分隔符提取子字符串</li><li><code>substring_index(str, delim, count)</code><br>参数说明：<ul><li><code>str</code>：要处理的原始字符串</li><li><code>delim</code>：分隔符（可以是单个字符或多个字符）</li><li><code>count</code>：计数值<ul><li><strong>正数</strong>：从左向右查找，返回第 <code>count</code> 个分隔符<strong>之前</strong>的<strong>所有</strong>字符</li><li><strong>负数</strong>：从右向左查找，返回第 <code>abs(count)</code> 个分隔符<strong>之后</strong>的<strong>所有</strong>字符</li><li><strong>零</strong>：返回空字符串</li></ul></li></ul></li></ul></li></ul><h1>31.提取博客URL中的用户名</h1><p>题目：对于申请参与比赛的用户，blog_url字段中url字符后的字符串为用户个人博客的用户名，现在运营想要把用户的个人博客用户字段提取出单独记录为一个新的字段，请取出所需数据。</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">    device_id</span><br><span class="line">    ,substring_index(blog_url, <span class="string">&#x27;/&#x27;</span>, <span class="number">-1</span>) <span class="keyword">as</span> gender</span><br><span class="line"><span class="keyword">from</span> user_submit</span><br></pre></td></tr></table></figure><h1>32.截取出年龄</h1><p>题目：现在运营举办了一场比赛，收到了一些参赛申请，表数据记录形式如下所示，现在运营想要统计每个年龄的用户分别有多少参赛者，请取出相应结果</p><p><code>profile</code> 字段的格式是：<code>身高,体重,年龄,性别</code></p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">substring_index(substring_index(profile, <span class="string">&#x27;,&#x27;</span>, <span class="number">3</span>), <span class="string">&#x27;,&#x27;</span>, <span class="number">-1</span>) <span class="keyword">as</span> age</span><br><span class="line">,<span class="built_in">count</span>(device_id) <span class="keyword">as</span> number</span><br><span class="line"><span class="keyword">from</span> user_submit</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> <span class="number">1</span></span><br></pre></td></tr></table></figure><ul><li>如果不是最前/最后一个字段的话，substring_index()就要写<strong>嵌套</strong></li></ul><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">substring_index(substring_index(profile, <span class="string">&#x27;,&#x27;</span>, 正数第几个), <span class="string">&#x27;,&#x27;</span>, <span class="number">-1</span>) <span class="keyword">as</span> 字段名</span><br></pre></td></tr></table></figure><ul><li>示例：对于 <code>profile = '180cm,75kg,27,male'</code>：</li></ul><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 提取第一个字段（身高）：</span></span><br><span class="line">SUBSTRING_INDEX(profile, <span class="string">&#x27;,&#x27;</span>, <span class="number">1</span>) <span class="comment">-- &#x27;180cm&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 提取第二个字段（体重）：</span></span><br><span class="line">SUBSTRING_INDEX(SUBSTRING_INDEX(profile, <span class="string">&#x27;,&#x27;</span>, <span class="number">2</span>), <span class="string">&#x27;,&#x27;</span>, <span class="number">-1</span>) <span class="comment">-- &#x27;75kg&#x27;</span></span><br><span class="line"><span class="comment">-- 内层：SUBSTRING_INDEX(profile, &#x27;,&#x27;, 2) = &#x27;180cm,75kg&#x27;</span></span><br><span class="line"><span class="comment">-- 外层：SUBSTRING_INDEX(&#x27;180cm,75kg&#x27;, &#x27;,&#x27;, -1) = &#x27;75kg&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 提取第三个字段（年龄）：</span></span><br><span class="line">SUBSTRING_INDEX(SUBSTRING_INDEX(profile, <span class="string">&#x27;,&#x27;</span>, <span class="number">3</span>), <span class="string">&#x27;,&#x27;</span>, <span class="number">-1</span>) <span class="comment">-- &#x27;27&#x27;</span></span><br><span class="line"><span class="comment">-- 内层：SUBSTRING_INDEX(profile, &#x27;,&#x27;, 3) = &#x27;180cm,75kg,27&#x27;</span></span><br><span class="line"><span class="comment">-- 外层：SUBSTRING_INDEX(&#x27;180cm,75kg,27&#x27;, &#x27;,&#x27;, -1) = &#x27;27&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 提取第四个字段（性别）：</span></span><br><span class="line">SUBSTRING_INDEX(profile, <span class="string">&#x27;,&#x27;</span>, <span class="number">-1</span>) <span class="comment">-- &#x27;male&#x27;</span></span><br><span class="line"><span class="comment">-- 或者：SUBSTRING_INDEX(SUBSTRING_INDEX(profile, &#x27;,&#x27;, 4), &#x27;,&#x27;, -1)</span></span><br></pre></td></tr></table></figure><h1>33.找出每个学校GPA最低的同学</h1><blockquote><p>这33题有很多的解法，主要还是关注对表格结构（结果和原表）的分析和理解</p></blockquote><p>题目：现在运营想要找到每个学校gpa最低的同学来做调研，请你取出每个学校的最低gpa。输出结果按university升序排序</p><p>如果一个学校有多个最低值—&gt;使用窗口函数</p><p><strong>解法一</strong>：子查询</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">device_id</span><br><span class="line">,university</span><br><span class="line">,gpa</span><br><span class="line"><span class="keyword">from</span> user_profile</span><br><span class="line"><span class="keyword">where</span> (university, gpa) <span class="keyword">in</span> (</span><br><span class="line"><span class="keyword">select</span> university, <span class="built_in">min</span>(gpa)</span><br><span class="line">    <span class="keyword">from</span> user_profile</span><br><span class="line">    <span class="keyword">group</span> <span class="keyword">by</span> <span class="number">1</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> <span class="number">2</span></span><br></pre></td></tr></table></figure><p>子查询的使用</p><ul><li>记得加别名</li></ul><p><strong>解法二</strong>：join，性能更好</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">t.device_id</span><br><span class="line">,t.university</span><br><span class="line">,t.gpa</span><br><span class="line"><span class="keyword">from</span> user_profile t</span><br><span class="line"><span class="keyword">join</span>(</span><br><span class="line"><span class="keyword">select</span> university,<span class="built_in">min</span>(gpa) <span class="keyword">as</span> min_gpa</span><br><span class="line">    <span class="keyword">from</span> user_profile</span><br><span class="line">    <span class="keyword">group</span> <span class="keyword">by</span> <span class="number">1</span></span><br><span class="line">)t1 </span><br><span class="line"><span class="keyword">on</span> t.university<span class="operator">=</span>t1.university</span><br><span class="line"><span class="keyword">and</span> t.gpa<span class="operator">=</span>t1.min_gpa</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> <span class="number">2</span>    </span><br></pre></td></tr></table></figure><h1><a href="https://www.nowcoder.com/practice/53235096538a456b9220fce120c062b3?tpId=199&amp;tqId=1980673&amp;sourceUrl=%2Fexam%2Fcompany"><mark>SQL34</mark> 统计复旦用户8月练题情况</a></h1><p>题目： 现在运营想要了解复旦大学的每个用户在8月份练习的总题目数和回答正确的题目数情况，请取出相应明细数据，对于在8月份没有练习过的用户，答题数结果返回0</p><ul><li>对象：复旦大学的每个用户（就像前面的题会有：答过题的用户）</li></ul><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">t1.device_id <span class="keyword">as</span> device_id</span><br><span class="line">,t1.university <span class="keyword">as</span> university</span><br><span class="line">,<span class="built_in">count</span>(t2.question_id) <span class="keyword">as</span> question_cnt</span><br><span class="line">,<span class="built_in">sum</span>(<span class="keyword">case</span> <span class="keyword">when</span> t2.result<span class="operator">=</span><span class="string">&#x27;right&#x27;</span> <span class="keyword">then</span> <span class="number">1</span> <span class="keyword">else</span> <span class="number">0</span> <span class="keyword">end</span>) <span class="keyword">as</span> right_question_cnt</span><br><span class="line"><span class="keyword">from</span> user_profile t1</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> question_practice_detail t2</span><br><span class="line"><span class="keyword">on</span> t1.device_id<span class="operator">=</span>t2.device_id</span><br><span class="line"><span class="keyword">and</span> t2.date <span class="operator">&gt;=</span> <span class="string">&#x27;2021-08-01&#x27;</span></span><br><span class="line"><span class="keyword">and</span> t2.date <span class="operator">&lt;=</span> <span class="string">&#x27;2021-08-31&#x27;</span></span><br><span class="line"><span class="keyword">where</span> t1.university<span class="operator">=</span><span class="string">&#x27;复旦大学&#x27;</span></span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> <span class="number">1</span></span><br></pre></td></tr></table></figure><ul><li>日期在t2<ul><li>join时，在on子句就要过滤！</li><li>如果把日期条件放在<code>where</code>子句中，<code>left join</code>会退化成<code>inner join</code>，无法显示未练习的用户</li></ul></li><li>question_cnt数做了多少题</li><li>right_question_cnt把答对的题标记为1，把这些1相加</li></ul><h3 id="步骤1：筛选复旦大学用户"><strong>步骤1：筛选复旦大学用户</strong></h3><p>从用户表 <code>user_profile</code> 中过滤出 <code>university</code> 为“复旦大学”的用户。</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">字段</span><br><span class="line"><span class="keyword">FROM</span> user_profile</span><br><span class="line"><span class="keyword">WHERE</span> university <span class="operator">=</span> <span class="string">&#x27;复旦大学&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="步骤2：关联答题表并限制时间范围"><strong>步骤2：关联答题表并限制时间范围</strong></h3><p>使用 <strong>左连接</strong> 将用户表与答题表 <code>question_practice_detail</code> 关联，并限定答题时间为8月份（<code>date</code> 在 <code>2021-08-01</code> 到 <code>2021-08-31</code> 之间）。<br>⚠️ 注意：时间条件必须放在 <code>LEFT JOIN</code> 的 <code>ON</code> 子句中，而不是 <code>WHERE</code> 子句，否则会错误过滤掉无答题记录的用户。</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">    字段</span><br><span class="line"><span class="keyword">FROM</span> user_profile u</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> question_practice_detail q</span><br><span class="line">    <span class="keyword">ON</span> u.device_id <span class="operator">=</span> q.device_id</span><br><span class="line">    <span class="keyword">AND</span> q.date <span class="keyword">BETWEEN</span> <span class="string">&#x27;2021-08-01&#x27;</span> <span class="keyword">AND</span> <span class="string">&#x27;2021-08-31&#x27;</span></span><br><span class="line"><span class="keyword">WHERE</span> u.university <span class="operator">=</span> <span class="string">&#x27;复旦大学&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="步骤3：聚合统计答题数"><strong>步骤3：聚合统计答题数</strong></h3><p>通过 <code>COUNT</code> 统计总题数，使用 <code>SUM(CASE ...)</code> 统计正确题数。<br>🔑 关键点：</p><ul><li><code>COUNT(q.question_id)</code> 会自动忽略 <code>NULL</code>，因此无答题记录的用户结果为0。</li><li><code>SUM(CASE WHEN q.result = 'right' THEN 1 ELSE 0 END)</code> 对正确结果计数，无记录时结果为0。</li></ul><h1>35.浙大不同难度题目的正确率</h1><p>题目：现在运营想要了解<strong>浙江大学的用户在不同难度题目下答题的正确率情况</strong>，请取出相应数据，并按照准确率升序输出。</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">    t2.difficult_level</span><br><span class="line">    ,round(<span class="built_in">sum</span>(if(t1.result<span class="operator">=</span><span class="string">&#x27;right&#x27;</span>, <span class="number">1</span>, <span class="number">0</span>)) <span class="operator">/</span> <span class="built_in">count</span>(<span class="operator">*</span>), <span class="number">4</span>) <span class="keyword">as</span> correct_rate</span><br><span class="line"><span class="keyword">from</span> question_practice_detail t1</span><br><span class="line"><span class="keyword">join</span> question_detail t2 <span class="keyword">on</span> t1.question_id<span class="operator">=</span>t2.question_id</span><br><span class="line"><span class="keyword">join</span> (</span><br><span class="line">    <span class="keyword">select</span> device_id</span><br><span class="line">    <span class="keyword">from</span> user_profile</span><br><span class="line">    <span class="keyword">where</span> university <span class="operator">=</span> <span class="string">&#x27;浙江大学&#x27;</span></span><br><span class="line">) t3 <span class="keyword">on</span> t1.device_id<span class="operator">=</span>t3.device_id</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> <span class="number">2</span></span><br></pre></td></tr></table></figure><p><strong>1. 致命错误：<code>COUNT(IF(...))</code>用法错误</strong></p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="built_in">count</span>(if(t1.result<span class="operator">=</span><span class="string">&#x27;right&#x27;</span>, <span class="number">1</span>, <span class="number">0</span>))  <span class="comment">-- 错误！</span></span><br></pre></td></tr></table></figure><ul><li><code>IF()</code>返回0时，<code>COUNT()</code><strong>也会计入0</strong>，因为COUNT只忽略NULL，不忽略0</li><li>这会导致<strong>分子 = 分母</strong>，正确率永远为<strong>1.0000</strong></li></ul><p><strong>正确写法</strong>：</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 方法1：IF返回NULL</span></span><br><span class="line"><span class="built_in">count</span>(if(t1.result<span class="operator">=</span><span class="string">&#x27;right&#x27;</span>, <span class="number">1</span>, <span class="keyword">null</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 方法2：用SUM代替COUNT</span></span><br><span class="line"><span class="built_in">sum</span>(if(t1.result<span class="operator">=</span><span class="string">&#x27;right&#x27;</span>, <span class="number">1</span>, <span class="number">0</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 方法3：CASE WHEN（最规范）</span></span><br><span class="line"><span class="built_in">sum</span>(<span class="keyword">case</span> <span class="keyword">when</span> t1.result<span class="operator">=</span><span class="string">&#x27;right&#x27;</span> <span class="keyword">then</span> <span class="number">1</span> <span class="keyword">else</span> <span class="number">0</span> <span class="keyword">end</span>)</span><br></pre></td></tr></table></figure><p><strong>2.子查询先筛选→再join关联</strong></p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">join</span> (</span><br><span class="line">    <span class="keyword">select</span> device_id</span><br><span class="line">    <span class="keyword">from</span> user_profile</span><br><span class="line">    <span class="keyword">where</span> university <span class="operator">=</span> <span class="string">&#x27;浙江大学&#x27;</span></span><br><span class="line">) t3</span><br><span class="line"></span><br><span class="line"><span class="keyword">join</span> user_profile t3 <span class="keyword">on</span> t1.device_id<span class="operator">=</span>t3.device_id</span><br><span class="line"><span class="keyword">where</span> t3.university <span class="operator">=</span> <span class="string">&#x27;浙江大学&#x27;</span></span><br><span class="line"></span><br><span class="line">哪个性能优？</span><br></pre></td></tr></table></figure><h1>36.查找后排序</h1><p>题目：现在运营想要取出用户信息表中的用户设备ID和用户年龄，请取出相应数据，并按照年龄升序排序。</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">    device_id</span><br><span class="line">    ,age</span><br><span class="line"><span class="keyword">from</span> user_profile</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> age</span><br></pre></td></tr></table></figure><h1>37.查找后多列排序</h1><p>题目：现在运营想要取出用户信息表中的device_id、年龄和gpa数据，并先按照gpa升序排序，再按照年龄升序排序输出，请取出相应数据。</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">    device_id</span><br><span class="line">    ,gpa</span><br><span class="line">    ,age</span><br><span class="line"><span class="keyword">from</span> user_profile</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> gpa <span class="keyword">asc</span>,age <span class="keyword">asc</span></span><br></pre></td></tr></table></figure><h1>38.查找后降序排列</h1><p>题目：现在运营想要取出用户信息表中对应的数据，并先按照gpa降序排列、gpa相同的按照年龄降序排序输出，请取出相应数据。</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">    device_id</span><br><span class="line">    ,gpa</span><br><span class="line">    ,age</span><br><span class="line"><span class="keyword">from</span> user_profile</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> gpa <span class="keyword">desc</span>,age <span class="keyword">desc</span></span><br></pre></td></tr></table></figure><h1>39.21年8月份练题总数</h1><p>题目： 现在运营想要了解2021年8月份所有练习过题目的总用户数和练习过题目的总次数，请取出相应结果</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">    <span class="built_in">count</span>(<span class="keyword">distinct</span> device_id) <span class="keyword">as</span> did_cnt</span><br><span class="line">    ,<span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">as</span> question_cnt</span><br><span class="line"><span class="keyword">from</span> question_practice_detail</span><br></pre></td></tr></table></figure><h1>40.正则表达式regexp</h1><p>题目：在一张contacts表中，存储了用户的联系信息。请查询出所有符合以下条件的电话号码，并按id升序输出所有字段：</p><ol><li>电话号码必须是 10 位数字。</li><li>电话号码的第一位不能以 0 开头。</li><li>电话号码的格式可以是连续的 10 位数字，或以-分隔的格式（如123-456-7890）。</li></ol><ul><li>读题：<ul><li>– 10位数字且非0开头</li><li>– 3-3-4格式电话号码</li></ul></li></ul><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">from</span> contacts</span><br><span class="line"><span class="keyword">where</span> phone_number regexp <span class="string">&#x27;^[1-9][0-9]&#123;9&#125;$&#x27;</span></span><br><span class="line"><span class="keyword">or</span> phone_number regexp <span class="string">&#x27;^[1-9][0-9]&#123;2&#125;-[0-9]&#123;3&#125;-[0-9]&#123;4&#125;$&#x27;</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> id</span><br></pre></td></tr></table></figure><p>regexp在MySQL中用于正则表达式匹配，正确的用法是：字段名 REGEXP ‘正则表达式’</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">where</span> phone_number regexp <span class="string">&#x27;^([1-9][0-9]&#123;9&#125;|[1-9][0-9]&#123;2&#125;-[0-9]&#123;3&#125;-[0-9]&#123;4&#125;)$&#x27;</span></span><br></pre></td></tr></table></figure><p><strong>语法分解：</strong></p><ul><li><code>^</code> - 字符串开始</li><li><code>()</code> - 分组</li><li><code>|</code> - 或逻辑（匹配左侧或右侧模式）<strong>不能有空格！</strong>！！</li><li><code>[1-9]</code> - 非零数字</li><li><code>[0-9]&#123;9&#125;</code> - 恰好9个数字</li><li><code>[0-9]&#123;2&#125;</code> - 恰好2个数字</li><li><code>[0-9]&#123;3&#125;</code> - 恰好3个数字</li><li><code>[0-9]&#123;4&#125;</code> - 恰好4个数字</li><li><code>$</code> - 字符串结束</li></ul><p><strong>正则表达式中的空格是有特殊含义的——它们会被当作字面意义上的字符来匹配！</strong></p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- ❌ 错误示例（管道符周围有空格）</span></span><br><span class="line"><span class="keyword">where</span> phone_number regexp <span class="string">&#x27;^([1-9][0-9]&#123;9&#125; | [1-9][0-9]&#123;2&#125;-[0-9]&#123;3&#125;-[0-9]&#123;4&#125;)$&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 这个表达式实际要求：</span></span><br><span class="line"><span class="comment">-- 要么是：10位数字 + 一个空格</span></span><br><span class="line"><span class="comment">-- 要么是：一个空格 + 3-3-4格式的号码</span></span><br></pre></td></tr></table></figure><hr><h1>常用的</h1><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="built_in">count</span>(<span class="operator">*</span>)             <span class="comment">-- 总行数</span></span><br><span class="line"><span class="built_in">count</span>(device_id)     <span class="comment">-- 非NULL值数量</span></span><br><span class="line"><span class="built_in">count</span>(<span class="keyword">distinct</span> 字段)  <span class="comment">-- 去重用户数</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">sum</span>(if(条件, <span class="number">1</span>, <span class="number">0</span>)) <span class="keyword">as</span> 字段名</span><br><span class="line"><span class="built_in">sum</span>(<span class="keyword">case</span> <span class="keyword">when</span> 条件 <span class="keyword">then</span> <span class="number">1</span> <span class="keyword">else</span> <span class="number">0</span> <span class="keyword">end</span>) <span class="keyword">as</span> 字段名</span><br><span class="line"><span class="comment">-- 注意：COUNT(IF(...))会统计0，导致错误！</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">where</span> 字段 <span class="keyword">like</span> <span class="string">&#x27;%北京%&#x27;</span>  <span class="comment">-- 包含北京</span></span><br><span class="line"><span class="keyword">where</span> 字段 <span class="keyword">like</span> <span class="string">&#x27;北京%&#x27;</span>   <span class="comment">-- 以北京开头</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">day</span>(字段) <span class="keyword">as</span> <span class="keyword">day</span>          <span class="comment">-- 提取日（1-31）</span></span><br><span class="line"><span class="keyword">left</span>(字段, <span class="number">7</span>) <span class="keyword">as</span> <span class="keyword">month</span>    <span class="comment">-- 提取年月（2026-01）</span></span><br><span class="line"><span class="keyword">month</span>(字段) <span class="keyword">as</span> month_num  <span class="comment">-- 提取月份（1）</span></span><br><span class="line"></span><br><span class="line">data_sub(字段, <span class="type">interval</span> <span class="number">1</span> <span class="keyword">day</span>)    <span class="comment">-- 前一天</span></span><br><span class="line">date_add(字段, <span class="type">interval</span> <span class="number">1</span> <span class="keyword">month</span>)  <span class="comment">-- 后一月</span></span><br><span class="line"></span><br><span class="line">substring_index(字段, 分隔符, 计数值)  <span class="comment">-- 分隔符</span></span><br><span class="line"></span><br><span class="line">字段 regexp <span class="string">&#x27;正则表达式&#x27;</span>  <span class="comment">-- 匹配正则表达式</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 自连接计算留存率</span></span><br><span class="line"><span class="keyword">with</span> tmp <span class="keyword">as</span>(</span><br><span class="line">    <span class="keyword">select</span></span><br><span class="line">    device_id</span><br><span class="line">    ,<span class="type">date</span></span><br><span class="line">    <span class="keyword">from</span> question_practice_detail</span><br><span class="line">    <span class="keyword">group</span> <span class="keyword">by</span> <span class="number">1</span>,<span class="number">2</span>  <span class="comment">-- 去重</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">select</span></span><br><span class="line"><span class="built_in">count</span>(b.device_id) <span class="operator">/</span> <span class="built_in">count</span>(a.device_id) <span class="keyword">as</span> avg_ret</span><br><span class="line"><span class="keyword">from</span> tmp a</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> tmp b</span><br><span class="line"><span class="keyword">on</span> a.device_id <span class="operator">=</span> b.device_id</span><br><span class="line"><span class="keyword">and</span> a.date <span class="operator">=</span> date_sub(b.date, <span class="type">interval</span> <span class="number">1</span> <span class="keyword">day</span>)</span><br></pre></td></tr></table></figure><ul><li><strong>优先使用GROUP BY去重</strong>：比DISTINCT性能更好</li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> Practice </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【已解决】windows电脑连蓝牙耳机总是断断续续？</title>
      <link href="/2024/06/12/%E3%80%90%E5%B7%B2%E8%A7%A3%E5%86%B3%E3%80%91windows%E7%94%B5%E8%84%91%E8%BF%9E%E8%93%9D%E7%89%99%E8%80%B3%E6%9C%BA%E6%80%BB%E6%98%AF%E6%96%AD%E6%96%AD%E7%BB%AD%E7%BB%AD%EF%BC%9F/"/>
      <url>/2024/06/12/%E3%80%90%E5%B7%B2%E8%A7%A3%E5%86%B3%E3%80%91windows%E7%94%B5%E8%84%91%E8%BF%9E%E8%93%9D%E7%89%99%E8%80%B3%E6%9C%BA%E6%80%BB%E6%98%AF%E6%96%AD%E6%96%AD%E7%BB%AD%E7%BB%AD%EF%BC%9F/</url>
      
        <content type="html"><![CDATA[<h1>【已解决】Windows 电脑连蓝牙耳机总是断断续续？</h1><p>结论：多半是蓝牙驱动（与无线网卡打包）导致，更新无线驱动到最新版即可。</p><ul><li>下载入口（Intel 平台）：<a href="https://www.intel.cn/content/www/cn/zh/download/18649/intel-wireless-bluetooth-drivers-for-windows-10-and-windows-11.html">Windows 10/11 的 Intel Wireless Bluetooth 驱动</a></li></ul><h2 id="步骤截图">步骤截图</h2><p>进入<a href="https://www.intel.cn/content/www/cn/zh/download/18649/intel-wireless-bluetooth-drivers-for-windows-10-and-windows-11.html">平台</a>，下载完成后打开文件：<img src="./../%E3%80%90%E5%B7%B2%E8%A7%A3%E5%86%B3%E3%80%91windows%E7%94%B5%E8%84%91%E8%BF%9E%E8%93%9D%E7%89%99%E8%80%B3%E6%9C%BA%E6%80%BB%E6%98%AF%E6%96%AD%E6%96%AD%E7%BB%AD%E7%BB%AD%EF%BC%9F/96a7d9d4d283767115233688d3a02188.png" alt="img"> 是：<img src="./../%E3%80%90%E5%B7%B2%E8%A7%A3%E5%86%B3%E3%80%91windows%E7%94%B5%E8%84%91%E8%BF%9E%E8%93%9D%E7%89%99%E8%80%B3%E6%9C%BA%E6%80%BB%E6%98%AF%E6%96%AD%E6%96%AD%E7%BB%AD%E7%BB%AD%EF%BC%9F/e9330db4eebe4742e1c41c23ed4c07ca.png" alt="img"></p><p>下一步：<img src="./../%E3%80%90%E5%B7%B2%E8%A7%A3%E5%86%B3%E3%80%91windows%E7%94%B5%E8%84%91%E8%BF%9E%E8%93%9D%E7%89%99%E8%80%B3%E6%9C%BA%E6%80%BB%E6%98%AF%E6%96%AD%E6%96%AD%E7%BB%AD%E7%BB%AD%EF%BC%9F/2bfca0f2647e110effbceb0087d4e0fb.png" alt="img"></p><p>下一步：<img src="./../%E3%80%90%E5%B7%B2%E8%A7%A3%E5%86%B3%E3%80%91windows%E7%94%B5%E8%84%91%E8%BF%9E%E8%93%9D%E7%89%99%E8%80%B3%E6%9C%BA%E6%80%BB%E6%98%AF%E6%96%AD%E6%96%AD%E7%BB%AD%E7%BB%AD%EF%BC%9F/79beffc2343ca1e837e01c09ddf61355.png" alt="img"></p><p>下一步：<img src="./../%E3%80%90%E5%B7%B2%E8%A7%A3%E5%86%B3%E3%80%91windows%E7%94%B5%E8%84%91%E8%BF%9E%E8%93%9D%E7%89%99%E8%80%B3%E6%9C%BA%E6%80%BB%E6%98%AF%E6%96%AD%E6%96%AD%E7%BB%AD%E7%BB%AD%EF%BC%9F/67a3568ac66ee16f6fd9b90502130a5a.png" alt="img"></p><p>选择典型：<img src="./../%E3%80%90%E5%B7%B2%E8%A7%A3%E5%86%B3%E3%80%91windows%E7%94%B5%E8%84%91%E8%BF%9E%E8%93%9D%E7%89%99%E8%80%B3%E6%9C%BA%E6%80%BB%E6%98%AF%E6%96%AD%E6%96%AD%E7%BB%AD%E7%BB%AD%EF%BC%9F/6a32b5086a66b870ef243f5655e6b0e4.png" alt="img"></p><p>安装：<img src="./../%E3%80%90%E5%B7%B2%E8%A7%A3%E5%86%B3%E3%80%91windows%E7%94%B5%E8%84%91%E8%BF%9E%E8%93%9D%E7%89%99%E8%80%B3%E6%9C%BA%E6%80%BB%E6%98%AF%E6%96%AD%E6%96%AD%E7%BB%AD%E7%BB%AD%EF%BC%9F/430fe61a301ee7c023231264d9350acc.png" alt="img"></p><p>安装完之后<strong>重启电脑</strong>，再试试吧~</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Markdown语法表</title>
      <link href="/2024/02/18/Markdown%E8%AF%AD%E6%B3%95%E8%A1%A8/"/>
      <url>/2024/02/18/Markdown%E8%AF%AD%E6%B3%95%E8%A1%A8/</url>
      
        <content type="html"><![CDATA[<p><strong>语法速查表</strong></p><table><thead><tr><th style="text-align:left">功能 (Feature)</th><th style="text-align:left">Markdown 语法 (Syntax)</th><th style="text-align:left">效果预览 (Result)</th></tr></thead><tbody><tr><td style="text-align:left">一级标题</td><td style="text-align:left"><code># 标题内容</code></td><td style="text-align:left">最大的标题</td></tr><tr><td style="text-align:left">二级标题</td><td style="text-align:left"><code>## 标题内容</code></td><td style="text-align:left"></td></tr><tr><td style="text-align:left">三级标题</td><td style="text-align:left"><code>### 标题内容</code></td><td style="text-align:left">(依此类推，可到六级)</td></tr><tr><td style="text-align:left">—</td><td style="text-align:left">—</td><td style="text-align:left">—</td></tr><tr><td style="text-align:left"><strong>加粗</strong></td><td style="text-align:left"><code>**需要加粗的文字**</code></td><td style="text-align:left"><strong>需要加粗的文字</strong></td></tr><tr><td style="text-align:left"><em>斜体</em></td><td style="text-align:left"><code>*需要倾斜的文字*</code></td><td style="text-align:left"><em>需要倾斜的文字</em></td></tr><tr><td style="text-align:left"><em><strong>加粗并斜体</strong></em></td><td style="text-align:left"><code>***又粗又斜的文字***</code></td><td style="text-align:left"><em><strong>又粗又斜的文字</strong></em></td></tr><tr><td style="text-align:left"><s>删除线</s></td><td style="text-align:left"><code>~~被删除的文字~~</code></td><td style="text-align:left"><s>被删除的文字</s></td></tr><tr><td style="text-align:left">—</td><td style="text-align:left">—</td><td style="text-align:left">—</td></tr><tr><td style="text-align:left">无序列表</td><td style="text-align:left"><code>- 列表项</code> 或 <code>* 列表项</code></td><td style="text-align:left">• 列表项</td></tr><tr><td style="text-align:left">有序列表</td><td style="text-align:left"><code>1. 列表项一</code><br><code>2. 列表项二</code></td><td style="text-align:left">1. 列表项一<br>2. 列表项二</td></tr><tr><td style="text-align:left">任务列表（待办）</td><td style="text-align:left"><code>- [ ] 未完成的任务</code><br><code>- [x] 已完成的任务</code></td><td style="text-align:left">☐ 未完成的任务<br>☑ 已完成的任务</td></tr><tr><td style="text-align:left">—</td><td style="text-align:left">—</td><td style="text-align:left">—</td></tr><tr><td style="text-align:left">&gt; 引用</td><td style="text-align:left"><code>&gt; 这是一段引用的文字</code></td><td style="text-align:left">&gt; 这是一段引用的文字</td></tr><tr><td style="text-align:left"><code>行内代码</code></td><td style="text-align:left"><code>`code`</code></td><td style="text-align:left">用于突出显示单个变量或命令</td></tr><tr><td style="text-align:left">代码块</td><td style="text-align:left"><code>```python `&lt;br&gt;`print(&quot;Hello, World!&quot;)`&lt;br&gt;` ```</code></td><td style="text-align:left">用于显示多行代码片段</td></tr><tr><td style="text-align:left">—</td><td style="text-align:left">—</td><td style="text-align:left">—</td></tr><tr><td style="text-align:left">链接</td><td style="text-align:left"><code>[链接显示的文字](https://obsidian.md)</code></td><td style="text-align:left"><a href="https://obsidian.md">链接显示的文字</a></td></tr><tr><td style="text-align:left">图片</td><td style="text-align:left"><code>![图片的替代文字](图片链接或路径)</code></td><td style="text-align:left">(在笔记中会直接显示图片)</td></tr><tr><td style="text-align:left">水平分割线</td><td style="text-align:left"><code>---</code> 或 <code>***</code></td><td style="text-align:left">一条横跨整个页面的线</td></tr></tbody></table><blockquote><p>[!note]+ 标题</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">注意：所有符号都是英文输入法下的符号</span><br><span class="line">井号加空格，几个井号就是几级标题，一级标题字体最大。</span><br><span class="line"># 一级标题</span><br><span class="line">## 二级标题</span><br></pre></td></tr></table></figure></blockquote><h1>标题 1</h1><h2 id="标题-2">标题 2</h2><h3 id="标题-3">标题 3</h3><h4 id="标题-4">标题 4</h4><h5 id="标题-5">标题 5</h5><h6 id="标题-6">标题 6</h6><hr><blockquote><p>[!note]+ 文本</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">注意：所有符号都是英文输入法下的符号</span><br><span class="line">两个星号是加粗：**我是加粗字体**</span><br><span class="line">一个型号是斜体：*我是斜体*</span><br><span class="line">三个星号，或者三个下划线是粗斜体：***我是粗斜体***，___我是粗斜体___</span><br><span class="line">两个等号是高亮：==我是高亮==</span><br><span class="line">两个波浪线是删除：~~我是删除~~</span><br></pre></td></tr></table></figure></blockquote><h2 id="文本">文本</h2><p>普通文本</p><p><strong>段落粗体文本</strong></p><p><em>段落斜体文本</em></p><p><mark>高亮</mark></p><p><s>删除</s></p><p><em><strong>粗斜体</strong></em><br><em><strong>粗斜体</strong></em><br><s>删除</s></p><hr><blockquote><p>[!note]+ 列表</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">注意：所有符号都是英文输入法下的符号</span><br><span class="line">无序列表：减号/加号/星号 + 空格，三个符号哪个都可以，但是建议用减号。 - 列表项1</span><br><span class="line">有序列表：数字+点+空格：1. 列表项</span><br><span class="line">输入完一个列表项后，打回车可以继续下一个列表项</span><br><span class="line">列表嵌套：使用tab可以让列表缩进，使用shift+tab可以取消缩进。</span><br><span class="line"></span><br><span class="line">任务列表：方括号里面一个空格或者叉，空格代表未完成，叉代表已完成。</span><br><span class="line">[x] 任务 1</span><br><span class="line">[ ] 任务 2</span><br><span class="line">Task插件可以使已完成的任务后面自动显示完成时间。</span><br><span class="line"></span><br><span class="line">任务列表并非原始的、John Gruber 定义的 Markdown 标准语法。然而，它已经成为一种被广泛接受和支持的 Markdown 扩展语法，许多现代的 Markdown 编辑器和笔记应用也都采纳了这种任务列表语法，因为它非常直观和实用。</span><br></pre></td></tr></table></figure></blockquote><h2 id="列表">列表</h2><p><strong>无序列表</strong></p><ul><li>列表项 1</li><li>列表项 2<ul><li>列表项 2.1</li><li>列表项 2.2</li></ul></li><li>列表项 3</li></ul><p><strong>有序列表</strong></p><ol><li>列表项 a</li><li>列表项 b<ol><li>列表项 b1</li><li>列表项 b2</li></ol></li><li>列表项 c</li></ol><p><strong>任务列表</strong></p><ul><li>[ ] 任务 1</li><li>[ ] 任务 2<ul><li>[ ] 嵌套任务 2.1</li><li>[ ] 嵌套任务 2.2</li></ul></li><li>[ ] 任务 3</li></ul><hr><h2 id="段落">段落</h2><blockquote><p>[!note]+ 段落</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">注意：所有符号都是英文输入法下的符号</span><br><span class="line">引用：大于号+空格：&gt; 我是引用</span><br><span class="line">嵌套引用：多个大于号，每多一个大于号，代表深一层嵌套</span><br><span class="line">分割线：三个减号然后回车：---</span><br><span class="line">强制换行 (Soft Break / Line Break)：在同一段落内强制开始一个新行，而不是开始一个新段落。使用方法：在一行的末尾输入两个或更多的空格，然后按回车键。</span><br><span class="line">备选方法：(如果 Markdown 解析器支持 HTML)：直接使用 HTML 的 &lt;br&gt; 标签。</span><br><span class="line"></span><br></pre></td></tr></table></figure></blockquote><p>引用语法：</p><blockquote><p>引用了一段名人名言</p><blockquote><p>嵌套引用</p><blockquote><p>俄罗斯套娃</p></blockquote></blockquote></blockquote><p>强制换行：</p><pre><code>这是第一行文字（假设末尾有两个空格）   第二行</code></pre><p>分割线：</p><hr><blockquote><p>[!note]+ 链接</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">注意：所有符号都是英文输入法下的符号</span><br><span class="line">[普通链接](https://www.bing.com/)</span><br><span class="line">[普通链接带标题](https://www.bing.com/ &quot;普通链接带标题&quot;)</span><br><span class="line">直接链接：&lt;https://github.com&gt;</span><br><span class="line">锚点链接：1. 在文稿起草阶段，还没确定具体网址，但可以先给出网址标题。2. 同一篇文章需要重复出现同一个网址时.</span><br><span class="line">使用方法：[网址标题][网址名]</span><br><span class="line">然后在其他地方（一般是文章最后）给出网址名的地址：[网址名]:https://www.bing.com/</span><br><span class="line">[锚点链接][anchor-id]</span><br><span class="line">[anchor-id]: http://www.this-anchor-link.com/</span><br><span class="line"></span><br></pre></td></tr></table></figure></blockquote><h2 id="链接">链接</h2><p><a href="https://www.bing.com/">普通链接</a></p><p>直接链接：<a href="https://github.com">https://github.com</a></p><p><a href="http://www.this-anchor-link.com/">锚点链接</a></p><hr><blockquote><p>[!note]+ 脚注</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">注意：所有符号都是英文输入法下的符号</span><br><span class="line">方括号内，上箭头，外加脚注名称（一般为标号）</span><br><span class="line">本句话要加脚注[^01]</span><br><span class="line">[^01]:这是解释脚注 01的内容</span><br></pre></td></tr></table></figure></blockquote><h2 id="脚注">脚注</h2><ol><li>要添加脚注的话<a href="%E8%84%9A%E6%B3%A8%E5%86%85%E5%AE%B9%E4%B8%80">^01</a></li><li>第二个要添加脚注的话<a href="%E8%84%9A%E6%B3%A8%E5%86%85%E5%AE%B9%E4%BA%8C">^02</a></li></ol><hr><blockquote><p>[!note]+ 图片</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">注意：所有符号都是英文输入法下的符号</span><br><span class="line">图片语法与链接类似，只是在前面多一个感叹号!。</span><br><span class="line">示例：![替代文本](图片路径 &quot;可选的图片标题&quot;)</span><br><span class="line">替代文本：当图片无法显示时展示的文字，也有助于屏幕阅读器。</span><br><span class="line">图片路径：可以是网络图片的 URL，也可以是本地文件的相对或绝对路径。</span><br><span class="line">可选的图片标题：鼠标悬停在图片上时显示的提示文字。</span><br><span class="line"></span><br><span class="line">带链接的图片 (Clickable Images)：</span><br><span class="line">使用方法：将图片的 Markdown 语法作为链接的“链接文本”部分。</span><br><span class="line">[![替代文本](图片路径)](链接地址)</span><br><span class="line">[![可爱的猫咪](/assets/obsidian.jpg)](https://www.bing.com/)</span><br><span class="line">点击即可跳转到bing.com，哪怕图片找不到，点击依然跳转到链接。</span><br></pre></td></tr></table></figure></blockquote><h2 id="图片">图片</h2><p><img src="./../Markdown%E8%AF%AD%E6%B3%95%E8%A1%A8/obsidian-logo-gradient.svg+xml" alt="Obsidian Logo" title="Obsidian Logo"></p><p><a href="https://www.bing.com/"><img src="/assets/obsidian.jpg" alt="可爱的猫咪"></a></p><hr><blockquote><p>[!note]+ 表格</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">注意：所有符号都是英文输入法下的符号</span><br><span class="line">表头： 用竖线 | 分隔单元格内容。</span><br><span class="line">分隔行： 用竖线 | 分隔，并使用至少三个减号 - 来创建每个单元格的分隔线。可以通过在减号前后添加冒号 : 来控制该列的对齐方式：</span><br><span class="line">左对齐 (默认)：:--- (或 :-)</span><br><span class="line">居中对齐：:---: (或 :-:)</span><br><span class="line">右对齐：---: (或 -:)</span><br><span class="line">内容行 (Content Rows): 用竖线 | 分隔单元格内容。</span><br><span class="line">最外层的竖线 | 是可选的，但为了美观和清晰，建议加上。</span><br></pre></td></tr></table></figure></blockquote><h2 id="表格">表格</h2><table><thead><tr><th>名字</th><th>姓氏</th><th>电子邮件</th></tr></thead><tbody><tr><td>John</td><td>Doe</td><td><a href="mailto:john.doe@example.com">john.doe@example.com</a></td></tr><tr><td>Muffin</td><td>Poppies</td><td><a href="mailto:muffin.poppies@example.com">muffin.poppies@example.com</a></td></tr><tr><td>Jane</td><td>Doe</td><td><a href="mailto:jane.doe@example.com">jane.doe@example.com</a></td></tr></tbody></table><table><thead><tr><th style="text-align:left">左对齐</th><th style="text-align:center">居中对齐</th><th style="text-align:right">右对齐</th></tr></thead><tbody><tr><td style="text-align:left">AAA</td><td style="text-align:center">BBB</td><td style="text-align:right">CCC</td></tr></tbody></table><hr><blockquote><p>[!note]+ 代码</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">注意：所有符号都是英文输入法下的符号</span><br><span class="line">行内代码用一个点包裹，代码块用三个点包裹，点是键盘上数字1左边的点。</span><br><span class="line">代码块可以指定代码语言，比如python、javascript，直接加在三个点后面即可。</span><br><span class="line">对于 Markdown 中的语言标识符（例如 javascript），通常不区分大小写。这意味着 javascript、JavaScript 和 JAVASCRIPT 应该产生相同的语法高亮效果。不过，最佳实践是使用小写形式。但这也可能取决于具体的 Markdown 解析器。</span><br><span class="line"></span><br><span class="line">Mermaid代码可以生成各种图标，感兴趣的可以单独学习Mermaid语法。</span><br></pre></td></tr></table></figure></blockquote><h2 id="代码">代码</h2><p><strong>行内代码</strong><br>变量 <code>myvar</code> 被设置为值 <code>100</code>。</p><p><strong>代码块</strong></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">calc</span>(<span class="params">a</span>):</span><br><span class="line"><span class="keyword">return</span> np.sqrt(a)*<span class="number">3</span></span><br><span class="line"></span><br><span class="line">test = calc(<span class="number">12</span>)</span><br></pre></td></tr></table></figure><p>Mermaid代码：</p><pre><code class="highlight mermaid">graph TD    A[开始] --&gt; B(处理);    B --&gt; C&#123;条件?&#125;;    C -- 是 --&gt; D[操作1];    C -- 否 --&gt; E[操作2];    D --&gt; F[结束];    E --&gt; F;</code></pre><h1>[[Obsidian]]特有或增强的Markdown 功能</h1><blockquote><p>[!note]+ 双链</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">注意：所有符号都是英文输入法下的符号</span><br><span class="line">1. [[笔记文件名]]：链接到仓库内的另一篇笔记。使用方法：用双层方括号 [[]] 包裹笔记的文件名 (无需 .md 后缀)。示例：[[我的待办事项]]</span><br><span class="line">2. [[笔记文件名#标题名]]：链接到另一篇笔记中的特定标题。使用方法：在文件名后加 # 和目标标题的文本。示例：[[Markdown 语法详解#10. 表格]]</span><br><span class="line">3. [[笔记文件名|自定义显示文本]]：链接到另一篇笔记，但显示自定义的链接文字。使用方法：在文件名后加 | 和希望显示的文本。示例： [[2024-05-27 Daily Note|昨天的日记]]</span><br><span class="line">4. ![[笔记文件名]]：将另一篇笔记的全部内容嵌入到当前笔记中。使用方法：与图片嵌入类似，但使用双层方括号，并以 ! 开头。示例： ![[常用代码片段]]</span><br><span class="line">5. ![[笔记文件名#标题名]]：将另一篇笔记中特定标题下的内容嵌入。使用方法：在文件名后跟特定标题。示例： ![[会议记录#行动项]]</span><br><span class="line">6. ![[笔记文件名#^块ID]]：嵌入笔记中被 \^块ID 标记的特定块（段落、列表项等）。使用方法：先在源笔记中，在你想要引用的段落或列表项的末尾添加一个块引用ID，格式为 ^yourBlockID (例如 ^task123)。然后在目标笔记中用 ![[源笔记文件名#^yourBlockID]] 来嵌入它。示例：在 &quot;任务列表.md&quot; 中： - [ ] 完成报告 ^reportTask，然后在当前笔记中嵌入： ![[任务列表#^reportTask]]</span><br></pre></td></tr></table></figure></blockquote><h2 id="双链">双链</h2><p>注意：这里使用反斜杠，是为了让Obsidian不把他识别为一个双链，否则Dashboard就会被认为是一个双链，从而在关系图谱中看到这个Dashboard节点。<br>内部链接: [[Dashboard]]</p><hr><blockquote><p>[!note]+ 标签</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">注意：所有符号都是英文输入法下的符号</span><br><span class="line">以井号 # 开头，后跟标签名称。标签名不能包含空格，可以用 - 或 _ 连接多词标签 (如 #读书笔记 或 #project-alpha)。标签可以放在笔记的任意位置，包括 YAML Frontmatter 中的 tags 字段。</span><br></pre></td></tr></table></figure></blockquote><h2 id="标签">标签</h2><p>标签: #dashboard #notes</p><hr><blockquote><p>[!note]+ 数学与公式</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">注意：所有符号都是英文输入法下的符号</span><br><span class="line">Obsidian 内置了对 KaTeX 的支持，用于渲染 LaTeX 数学公式。</span><br><span class="line">$行内数学公式$：将公式嵌入到文本行中。</span><br><span class="line">使用方法：用一对美元符号 $ 包裹 LaTeX 公式。</span><br><span class="line">$$块级数学公式$$：将公式在单独的块中居中显示。</span><br><span class="line">使用方法：两对美元符号包裹</span><br></pre></td></tr></table></figure></blockquote><h2 id="数学与公式">数学与公式</h2><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>g</mi><mo>=</mo><msub><mi>g</mi><mn>0</mn></msub><mfrac><msup><mi>R</mi><mn>2</mn></msup><msup><mrow><mo fence="true">(</mo><mi>R</mi><mo>+</mo><mi>z</mi><mo fence="true">)</mo></mrow><mn>2</mn></msup></mfrac><mo>=</mo><mfrac><msub><mi>g</mi><mn>0</mn></msub><msup><mrow><mo fence="true">(</mo><mn>1</mn><mo>+</mo><mi>z</mi><mi mathvariant="normal">/</mi><mi>R</mi><mo fence="true">)</mo></mrow><mn>2</mn></msup></mfrac></mrow><annotation encoding="application/x-tex">g=g_0 \frac{R^2}{\left( R + z \right)^2} = \frac{g_0}{\left(1 + z/R \right)^2} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.5851em;vertical-align:-1.094em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4911em;"><span style="top:-2.156em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.954em;"><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.094em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.2016em;vertical-align:-1.094em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1076em;"><span style="top:-2.156em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.954em;"><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.094em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>其中,<br><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi></mrow><annotation encoding="application/x-tex">g</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span></span></span></span> = 指定距离处的相对引力。<br><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>g</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">g_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> = [[Surface Gravity |物体的表面引力]]。<br><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> = 物体的半径。(通常是物体的赤道半径)。<br><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi></mrow><annotation encoding="application/x-tex">z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span></span></span></span> = 物体表面以上的距离。</p><hr><blockquote><p>[!note]+ 引用块</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">注意：所有符号都是英文输入法下的符号</span><br><span class="line">使用方法: 引用块 (&gt;) 之后紧跟 [!类型]。类型可以是 note, abstract, info, todo, tip, success, question, warning, failure, danger, bug, example, quote 等。</span><br><span class="line">可选标题**: 在 [!类型] 后可以添加自定义标题文本。</span><br><span class="line">可折叠**: 在类型后加减号 - (如 [!INFO]-) 可使标注默认折叠，加加号 + (如 [!INFO]+) 可使其默认展开 (通常默认就是展开)。</span><br></pre></td></tr></table></figure></blockquote><h2 id="引用块-Callouts">引用块 (Callouts)</h2><blockquote><p>[!note]+ 笔记引用块<br>这是一个笔记引用块…</p></blockquote><blockquote><p>[!warning]- 警示引用块<br>这是一个警示引用块…</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> Markdown </tag>
            
            <tag> Obsidian </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
